/*! For license information please see HereMaps_Interativo2.js.LICENSE.txt */
(()=>{"use strict";var __webpack_modules__={192:(module,__unused_webpack___webpack_exports__,__webpack_require__)=>{module=__webpack_require__.hmd(module),function(){var p,aa=[];function ba(t){return function(){return aa[t].apply(this,arguments)}}function ca(t,e){return aa[t]=e}function da(t){var e=0;return function(){return e<t.length?{done:!1,value:t[e++]}:{done:!0}}}function ea(t){var e="undefined"!=typeof Symbol&&Symbol.iterator&&t[Symbol.iterator];return e?e.call(t):{next:da(t)}}function fa(t){for(var e,r=[];!(e=t.next()).done;)r.push(e.value);return r}var ia="function"==typeof Object.defineProperties?Object.defineProperty:function(t,e,r){t!=Array.prototype&&t!=Object.prototype&&(t[e]=r.value)},ja="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global&&null!=global?global:this;function ka(t,e){if(e){var r=ja;t=t.split(".");for(var i=0;i<t.length-1;i++){var n=t[i];n in r||(r[n]={}),r=r[n]}(e=e(i=r[t=t[t.length-1]]))!=i&&null!=e&&ia(r,t,{configurable:!0,writable:!0,value:e})}}function la(){la=function(){},ja.Symbol||(ja.Symbol=ma)}function na(t,e){this.a=t,ia(this,"description",{configurable:!0,writable:!0,value:e})}ka("Array.prototype.find",(function(t){return t||function(t,e){t:{var r=this;r instanceof String&&(r=String(r));for(var i=r.length,n=0;n<i;n++){var o=r[n];if(t.call(e,o,n,r)){t=o;break t}}t=void 0}return t}})),na.prototype.toString=function(){return this.a};var ma=(b=0,function t(e){if(this instanceof t)throw new TypeError("Symbol is not a constructor");return new na("jscomp_symbol_"+(e||"")+"_"+b++,e)}),b,ra;function oa(){la();var t=ja.Symbol.iterator;t||(t=ja.Symbol.iterator=ja.Symbol("Symbol.iterator")),"function"!=typeof Array.prototype[t]&&ia(Array.prototype,t,{configurable:!0,writable:!0,value:function(){return pa(da(this))}}),oa=function(){}}function pa(t){return oa(),(t={next:t})[ja.Symbol.iterator]=function(){return this},t}function qa(t,e){oa(),t instanceof String&&(t+="");var r=0,i={next:function(){if(r<t.length){var n=r++;return{value:e(n,t[n]),done:!1}}return i.next=function(){return{done:!0,value:void 0}},i.next()}};return i[Symbol.iterator]=function(){return i},i}if(ka("Array.prototype.keys",(function(t){return t||function(){return qa(this,(function(t){return t}))}})),"function"==typeof Object.setPrototypeOf)ra=Object.setPrototypeOf;else{var sa;t:{var ta={Fg:!0},ua={};try{ua.__proto__=ta,sa=ua.Fg;break t}catch(a){}sa=!1}ra=sa?function(t,e){if(t.__proto__=e,t.__proto__!==e)throw new TypeError(t+" is not extensible");return t}:null}var va=ra;ka("Object.setPrototypeOf",(function(t){return t||va})),ka("Object.values",(function(t){return t||function(t){var e,r=[];for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&r.push(t[e]);return r}})),ka("Object.is",(function(t){return t||function(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}})),ka("Array.prototype.includes",(function(t){return t||function(t,e){var r=this;r instanceof String&&(r=String(r));var i=r.length;for(0>(e=e||0)&&(e=Math.max(e+i,0));e<i;e++){var n=r[e];if(n===t||Object.is(n,t))return!0}return!1}})),ka("Promise",(function(t){function e(t){this.C=0,this.b=void 0,this.a=[];var e=this.c();try{t(e.resolve,e.reject)}catch(t){e.reject(t)}}function r(){this.a=null}function i(t){return t instanceof e?t:new e((function(e){e(t)}))}if(t)return t;r.prototype.b=function(t){if(null==this.a){this.a=[];var e=this;this.c((function(){e.g()}))}this.a.push(t)};var n=ja.setTimeout;r.prototype.c=function(t){n(t,0)},r.prototype.g=function(){for(;this.a&&this.a.length;){var t=this.a;this.a=[];for(var e=0;e<t.length;++e){var r=t[e];t[e]=null;try{r()}catch(t){this.f(t)}}}this.a=null},r.prototype.f=function(t){this.c((function(){throw t}))},e.prototype.c=function(){function t(t){return function(i){r||(r=!0,t.call(e,i))}}var e=this,r=!1;return{resolve:t(this.m),reject:t(this.f)}},e.prototype.m=function(t){if(t===this)this.f(new TypeError("A Promise cannot resolve to itself"));else if(t instanceof e)this.U(t);else{t:switch(typeof t){case"object":var r=null!=t;break t;case"function":r=!0;break t;default:r=!1}r?this.s(t):this.g(t)}},e.prototype.s=function(t){var e=void 0;try{e=t.then}catch(t){return void this.f(t)}"function"==typeof e?this.u(e,t):this.g(t)},e.prototype.f=function(t){this.i(2,t)},e.prototype.g=function(t){this.i(1,t)},e.prototype.i=function(t,e){if(0!=this.C)throw Error("Cannot settle("+t+", "+e+"): Promise already settled in state"+this.C);this.C=t,this.b=e,this.l()},e.prototype.l=function(){if(null!=this.a){for(var t=0;t<this.a.length;++t)o.b(this.a[t]);this.a=null}};var o=new r;return e.prototype.U=function(t){var e=this.c();t.sf(e.resolve,e.reject)},e.prototype.u=function(t,e){var r=this.c();try{t.call(e,r.resolve,r.reject)}catch(t){r.reject(t)}},e.prototype.then=function(t,r){function i(t,e){return"function"==typeof t?function(e){try{n(t(e))}catch(t){o(t)}}:e}var n,o,a=new e((function(t,e){n=t,o=e}));return this.sf(i(t,n),i(r,o)),a},e.prototype.catch=function(t){return this.then(void 0,t)},e.prototype.sf=function(t,e){function r(){switch(i.C){case 1:t(i.b);break;case 2:e(i.b);break;default:throw Error("Unexpected state: "+i.C)}}var i=this;null==this.a?o.b(r):this.a.push(r)},e.resolve=i,e.reject=function(t){return new e((function(e,r){r(t)}))},e.race=function(t){return new e((function(e,r){for(var n=ea(t),o=n.next();!o.done;o=n.next())i(o.value).sf(e,r)}))},e.all=function(t){var r=ea(t),n=r.next();return n.done?i([]):new e((function(t,e){function o(e){return function(r){a[e]=r,0==--s&&t(a)}}var a=[],s=0;do{a.push(void 0),s++,i(n.value).sf(o(a.length-1),e),n=r.next()}while(!n.done)}))},e})),ka("Object.entries",(function(t){return t||function(t){var e,r=[];for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&r.push([e,t[e]]);return r}}));var wa="function"==typeof Object.assign?Object.assign:function(t,e){for(var r=1;r<arguments.length;r++){var i=arguments[r];if(i)for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t};ka("Object.assign",(function(t){return t||wa})),ka("Math.log2",(function(t){return t||function(t){return Math.log(t)/Math.LN2}}));var xa=this||self;function ya(t,e,r){t=t.split("."),r=r||xa,t[0]in r||void 0===r.execScript||r.execScript("var "+t[0]);for(var i;t.length&&(i=t.shift());)t.length||void 0===e?r=r[i]&&r[i]!==Object.prototype[i]?r[i]:r[i]={}:r[i]=e}function za(){}function Aa(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var r=Object.prototype.toString.call(t);if("[object Window]"==r)return"object";if("[object Array]"==r||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==r||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e}function Ca(t){var e=Aa(t);return"array"==e||"object"==e&&"number"==typeof t.length}function Da(t){return"function"==Aa(t)}function Ea(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var Ga="closure_uid_"+(1e9*Math.random()>>>0),Ha=0;function Ia(t,e,r){return t.call.apply(t.bind,arguments)}function Ja(t,e,r){if(!t)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var r=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(r,i),t.apply(e,r)}}return function(){return t.apply(e,arguments)}}function Ka(t,e,r){return(Ka=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Ia:Ja).apply(null,arguments)}function La(t,e){var r=Array.prototype.slice.call(arguments,1);return function(){var e=r.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function t(t,e){ya(t,e,void 0)}function u(t,e){function r(){}r.prototype=e.prototype,t.j=e.prototype,t.prototype=new r,t.prototype.constructor=t,t.ap=function(t,r,i){for(var n=Array(arguments.length-2),o=2;o<arguments.length;o++)n[o-2]=arguments[o];return e.prototype[r].apply(t,n)}}function Ma(t){if(Error.captureStackTrace)Error.captureStackTrace(this,Ma);else{var e=Error().stack;e&&(this.stack=e)}t&&(this.message=String(t))}function Na(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function Oa(){this.b=this.a=null}u(Ma,Error),Ma.prototype.name="CustomError",Na.prototype.get=function(){if(0<this.b){this.b--;var t=this.a;this.a=t.next,t.next=null}else t=this.c();return t},Na.prototype.put=function(t){this.f(t),100>this.b&&(this.b++,t.next=this.a,this.a=t)};var Qa=new Na((function(){return new Pa}),(function(t){t.reset()}));function Pa(){this.next=this.b=this.a=null}Oa.prototype.add=function(t,e){var r=Qa.get();r.set(t,e),this.b?this.b.next=r:this.a=r,this.b=r},Oa.prototype.remove=function(){var t=null;return this.a&&(t=this.a,this.a=this.a.next,this.a||(this.b=null),t.next=null),t},Pa.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},Pa.prototype.reset=function(){this.next=this.b=this.a=null};var Ra=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Sa(t,e){return-1!=t.indexOf(e)}function Ta(t,e){return t<e?-1:t>e?1:0}function Ua(t,e){for(var r in t)if(e.call(void 0,t[r],r,t))return!0;return!1}function Va(t){for(var e in t)return!1;return!0}function Wa(t){var e,r={};for(e in t)r[e]=t[e];return r}var Xa="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" "),Za;function Ya(t,e){for(var r,i,n=1;n<arguments.length;n++){for(r in i=arguments[n])t[r]=i[r];for(var o=0;o<Xa.length;o++)r=Xa[o],Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])}}t:{var $a=xa.navigator;if($a){var ab=$a.userAgent;if(ab){Za=ab;break t}}Za=""}function bb(t){return Sa(Za,t)}var cb=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var r=0;r<t.length;r++)if(r in t&&t[r]===e)return r;return-1};function db(t,e){this.b=t===eb&&e||"",this.a=fb}var fb={},eb={},gb=new db(eb,"");function hb(t,e){this.b=t===ib&&e||"",this.a=jb}hb.prototype.rc=function(){return 1};var jb={},ib={};function kb(){this.b="",this.c=lb,this.a=null}function mb(){var t=nb;return t instanceof kb&&t.constructor===kb&&t.c===lb?t.b:(Aa(t),"type_error:SafeHtml")}kb.prototype.rc=function(){return this.a};var lb={};function ob(t){var e=new kb;return e.b=t,e.a=0,e}ob("<!DOCTYPE html>");var nb=ob("");function pb(t){var e=new hb(ib,gb instanceof db&&gb.constructor===db&&gb.a===fb?gb.b:"type_error:Const");e instanceof hb&&e.constructor===hb&&e.a===jb?e=e.b:(Aa(e),e="type_error:TrustedResourceUrl"),t.src=e.toString()}function qb(t){return qb[" "](t),t}function sb(t,e){var r=tb;return Object.prototype.hasOwnProperty.call(r,t)?r[t]:r[t]=e(t)}ob("<br>"),qb[" "]=za;var ub=bb("Opera"),vb=bb("Trident")||bb("MSIE"),wb=bb("Edge"),xb=bb("Gecko")&&!(Sa(Za.toLowerCase(),"webkit")&&!bb("Edge"))&&!(bb("Trident")||bb("MSIE"))&&!bb("Edge"),yb=Sa(Za.toLowerCase(),"webkit")&&!bb("Edge"),Ab,a;function zb(){var t=xa.document;return t?t.documentMode:void 0}t:{var Bb="",Cb=(a=Za,xb?/rv:([^\);]+)(\)|;)/.exec(a):wb?/Edge\/([\d\.]+)/.exec(a):vb?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(a):yb?/WebKit\/(\S+)/.exec(a):ub?/(?:Version)[ \/]?(\S+)/.exec(a):void 0);if(Cb&&(Bb=Cb?Cb[1]:""),vb){var Db=zb();if(null!=Db&&Db>parseFloat(Bb)){Ab=String(Db);break t}}Ab=Bb}var tb={},Fb,Ib,Mb;function Eb(t){return sb(t,(function(){for(var e=0,r=Ra(String(Ab)).split("."),i=Ra(String(t)).split("."),n=Math.max(r.length,i.length),o=0;0==e&&o<n;o++){var a=r[o]||"",s=i[o]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==a[0].length&&0==s[0].length)break;e=Ta(e=0==a[1].length?0:parseInt(a[1],10),0==s[1].length?0:parseInt(s[1],10))||Ta(0==a[2].length,0==s[2].length)||Ta(a[2],s[2]),a=a[3],s=s[3]}while(0==e)}return 0<=e}))}function Gb(t){var e=document;return t=String(t),"application/xhtml+xml"===e.contentType&&(t=t.toLowerCase()),e.createElement(t)}function Hb(t){xa.setTimeout((function(){throw t}),0)}function Kb(){var t=xa.MessageChannel;if(void 0===t&&"undefined"!=typeof window&&window.postMessage&&window.addEventListener&&!bb("Presto")&&(t=function(){var t=Gb("IFRAME");t.style.display="none",pb(t),document.documentElement.appendChild(t);var e=t.contentWindow;(t=e.document).open(),t.write(mb()),t.close();var r="callImmediate"+Math.random(),i="file:"==e.location.protocol?"*":e.location.protocol+"//"+e.location.host;t=Ka((function(t){"*"!=i&&t.origin!=i||t.data!=r||this.port1.onmessage()}),this),e.addEventListener("message",t,!1),this.port1={},this.port2={postMessage:function(){e.postMessage(r,i)}}}),void 0!==t&&!bb("Trident")&&!bb("MSIE")){var e=new t,r={},i=r;return e.port1.onmessage=function(){if(void 0!==r.next){var t=(r=r.next).bj;r.bj=null,t()}},function(t){i.next={bj:t},i=i.next,e.port2.postMessage(0)}}return"undefined"!=typeof document&&"onreadystatechange"in Gb("SCRIPT")?function(t){var e=Gb("SCRIPT");e.onreadystatechange=function(){e.onreadystatechange=null,e.parentNode.removeChild(e),e=null,t(),t=null},document.documentElement.appendChild(e)}:function(t){xa.setTimeout(t,0)}}function Lb(t,e){Mb||Nb(),Ob||(Mb(),Ob=!0),Pb.add(t,e)}function Nb(){if(xa.Promise&&xa.Promise.resolve){var t=xa.Promise.resolve(void 0);Mb=function(){t.then(Qb)}}else Mb=function(){var t=Qb;!Da(xa.setImmediate)||xa.Window&&xa.Window.prototype&&!bb("Edge")&&xa.Window.prototype.setImmediate==xa.setImmediate?(Ib||(Ib=Kb()),Ib(t)):xa.setImmediate(t)}}Fb=xa.document&&vb?zb():void 0,!xb&&!vb||vb&&9<=Number(Fb)||xb&&Eb("1.9.1"),vb&&Eb("9");var Ob=!1,Pb=new Oa;function Qb(){for(var t;t=Pb.remove();){try{t.a.call(t.b)}catch(t){Hb(t)}Qa.put(t)}Ob=!1}function Rb(t){if(this.C=Sb,this.i=void 0,this.c=this.a=this.b=null,this.f=this.g=!1,t!=za)try{var e=this;t.call(void 0,(function(t){Tb(e,Ub,t)}),(function(t){Tb(e,Vb,t)}))}catch(t){Tb(this,Vb,t)}}var Sb=0,Ub=2,Vb=3;function Wb(){this.next=this.c=this.b=this.f=this.a=null,this.g=!1}Wb.prototype.reset=function(){this.c=this.b=this.f=this.a=null,this.g=!1};var Xb=new Na((function(){return new Wb}),(function(t){t.reset()}));function Yb(t,e,r){var i=Xb.get();return i.f=t,i.b=e,i.c=r,i}function Zb(t){if(t instanceof Rb)return t;var e=new Rb(za);return Tb(e,Ub,t),e}function $b(t){return new Rb((function(e,r){r(t)}))}function ac(){var t,e;return new cc(new Rb((function(r,i){t=r,e=i})),t,e)}function fc(t,e){if(t.C==Sb)if(t.b){var r=t.b;if(r.a){for(var i=0,n=null,o=null,a=r.a;a&&(a.g||(i++,a.a==t&&(n=a),!(n&&1<i)));a=a.next)n||(o=a);n&&(r.C==Sb&&1==i?fc(r,e):(o?((i=o).next==r.c&&(r.c=i),i.next=i.next.next):gc(r),hc(r,n,Vb,e)))}t.b=null}else Tb(t,Vb,e)}function ic(t,e){t.a||t.C!=Ub&&t.C!=Vb||jc(t),t.c?t.c.next=e:t.a=e,t.c=e}function dc(t,e,r,i){var n=Yb(null,null,null);return n.a=new Rb((function(t,o){n.f=e?function(r){try{var n=e.call(i,r);t(n)}catch(t){o(t)}}:t,n.b=r?function(e){try{var n=r.call(i,e);void 0===n&&e instanceof ec?o(e):t(n)}catch(t){o(t)}}:o})),n.a.b=t,ic(t,n),n.a}function Tb(t,e,r){if(t.C==Sb){t===r&&(e=Vb,r=new TypeError("Promise cannot resolve to itself")),t.C=1;t:{var i=r,n=t.s,o=t.m;if(i instanceof Rb){ic(i,Yb(n||za,o||null,t));var a=!0}else{if(i)try{var s=!!i.$goog_Thenable}catch(t){s=!1}else s=!1;if(s)i.then(n,o,t),a=!0;else{if(Ea(i))try{var l=i.then;if(Da(l)){kc(i,l,n,o,t),a=!0;break t}}catch(e){o.call(t,e),a=!0;break t}a=!1}}}a||(t.i=r,t.C=e,t.b=null,jc(t),e!=Vb||r instanceof ec||lc(t,r))}}function kc(t,e,r,i,n){function o(t){a||(a=!0,i.call(n,t))}var a=!1;try{e.call(t,(function(t){a||(a=!0,r.call(n,t))}),o)}catch(t){o(t)}}function jc(t){t.g||(t.g=!0,Lb(t.l,t))}function gc(t){var e=null;return t.a&&(e=t.a,t.a=e.next,e.next=null),t.a||(t.c=null),e}function hc(t,e,r,i){if(r==Vb&&e.b&&!e.g)for(;t&&t.f;t=t.b)t.f=!1;if(e.a)e.a.b=null,mc(e,r,i);else try{e.g?e.f.call(e.c):mc(e,r,i)}catch(t){nc.call(null,t)}Xb.put(e)}function mc(t,e,r){e==Ub?t.f.call(t.c,r):t.b&&t.b.call(t.c,r)}function lc(t,e){t.f=!0,Lb((function(){t.f&&nc.call(null,e)}))}Rb.prototype.then=function(t,e,r){return dc(this,Da(t)?t:null,Da(e)?e:null,r)},Rb.prototype.$goog_Thenable=!0,Rb.prototype.cancel=function(t){if(this.C==Sb){var e=new ec(t);Lb((function(){fc(this,e)}),this)}},Rb.prototype.s=function(t){this.C=Sb,Tb(this,Ub,t)},Rb.prototype.m=function(t){this.C=Sb,Tb(this,Vb,t)},Rb.prototype.l=function(){for(var t;t=gc(this);)hc(this,t,this.C,this.i);this.g=!1};var nc=Hb;function ec(t){Ma.call(this,t)}function cc(t,e,r){this.Ak=t,this.resolve=e,this.reject=r}u(ec,Ma),ec.prototype.name="cancel";var x=this;function oc(){return Object.create(z,void 0)}var A=Ka,pc=String,qc=x.Object.freeze||function(t){return t};function rc(t){for(var e,r=Object.keys(t),i=r.length;i--;)Ea(e=t[r[i]])&&rc(e);return qc(t)}function sc(t){var e=Aa(t);if("object"==e||"array"==e){if(Da(t.clone))return t.clone();for(var r in e="array"==e?[]:{},t)t.hasOwnProperty(r)&&(e[r]=sc(t[r]));return e}return t}var B=[].pop(),z=/x/.exec("");function tc(t,e){return pc(t).split(e!==B?e:" ")}var uc="prototype constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function C(t,e,r,i,n){if(!(e=t instanceof e)&&r)throw new D(r,i,vc(n)?n:t);return e}function xc(t,e){if(!0===(C(t,e)&&t.constructor===e))throw new TypeError("Illegal constructor "+yc(e))}function zc(t,e,r,i,n){if(!(e=Ac(t)===e)&&r)throw new D(r,i,vc(n)?n:t);return e}function Bc(t,e,r,i){return zc(t,"Array",e,r,i)}function vc(t){return t!==B}function Cc(t){return"string"==typeof t}t("H.lang.isArray",Bc),t("H.lang.isString",Cc);var Dc=parseInt,Ec=parseFloat,E=isNaN;function Fc(t){return t===+t}function Gc(t){return!E(+t)}function Ac(t){var e=Object[uc[0]][uc[6]].call(t).match(/^\[object (\w+)\]$/);return e?e[1]:typeof t}t("H.lang.isNumber",Fc),t("H.lang.isInteger",Number.isInteger?Number.isInteger:function(t){return"number"==typeof t&&0==t%1});var Hc=[];function Ic(t){0>Hc.indexOf(t)&&Hc.push(t)}function yc(t,e,r,i){var n,o="",a=2>arguments.length;return a&&(e={H:x.H},r="",i=Hc.slice()),Jc(e,!0,(function(e,a){try{if(a=Kc(e,n=e[a]),!(Ea(n)&&n.window===n&&n.self===n||Ea(n)&&0<n.nodeType&&Da(n.cloneNode))&&Ea(n)){if(n===t)return o=r+"."+a,!0;if(0>i.indexOf(n)&&(i.push(n),o=yc(t,n,r+"."+a,i)))return!0}}catch(t){}})),a&&(o=o?o.substr(1).replace("."+uc[0]+".","#"):"~"+(Da(t)?Lc(t)+"()":Ac(t))),o}function Kc(t,e){var r=[];return Jc(t,!1,(function(t,i){t[i]===e&&r.push(i)})),r.sort(Mc)[0]}function Mc(t,e){return e.length-t.length}Ic(Hc);var Nc=Object[uc[0]][uc[2]];function Jc(t,e,r){var i;if(t){for(n in t)if((!e||Nc.call(t,n))&&r(t,n,!0))return;for(i=uc.length;i--;){var n=uc[i];if((!e||Nc.call(t,n))&&r(t,n,!1))break}}}function Lc(t){return(t=/^\s*function ([^\( ]+)/.exec(t))?t[1]:"anonymous"}function Oc(t,e,r){r[e]="#"+e}var Pc=!!x.__karma__;function Qc(){throw Error("unimplemented method")}function Rc(t,e){"status"in(e=e||{})&&(this.status=+e.status),"statusText"in e&&(this.statusText=e.statusText),this.ok=200<=this.status&&300>this.status,this.f=!1,t?"string"==typeof t?this.c=t:(e=x.ArrayBuffer)&&e.prototype.isPrototypeOf(t)?this.a=t:e&&t.buffer?this.a=t.buffer:x.Blob.prototype.isPrototypeOf(t)&&(this.b=t):this.c=""}function Sc(t){if(t.f)return $b(new TypeError("Already read"));t.f=!0}function Tc(t){var e=new FileReader;return e.readAsText(t),new Rb((function(t,r){e.onload=function(){t(e.result)},e.onerror=function(){r(e.error)}}))}function D(t,e,r){var i=arguments.length;if((e=e!==B?+e:e)!==B){var n=(n=/^.*?\(([^\)]+)/.exec((""+t).replace(/(\/\*([\s\S]*?)\*\/)|(\/\/(.*)$)/gm,"")))?tc(n[1].replace(/\s+/g,""),","):[];n.forEach(Oc),n=n[e]||"#"+e}var o=t?yc(t):"";return i=2<i?pc(r):"",(n||i)&&(o+=" (Argument "+(n||"")+(i?" "+i:"")+")"),i=Error(o),Object.setPrototypeOf(i,D.prototype),i}function Uc(t,e,r){var i,n,o,a,s,l=r&&r.headers||{},c={},u=this;if(!Da(e))throw new D(Uc,1,"function required");Ya(l,Xc.headers,l),Ya(c,Xc,r||{}),c.headers=l,this.c=e,this.a=i=new XMLHttpRequest,e=c.method;try{for(n in i.open(e,t,!0),l)l.hasOwnProperty(n)&&(o=l[n])&&i.setRequestHeader(n,o);i.withCredentials=!!c.withCredentials,a=A(u.b,u),s=+c.timeout||0,Vc?(Wc(u,"timeout",a),i.timeout=s):s&&(u.f=setTimeout((function(){i.abort(),u.b({type:"timeout"})}),s)),Wc(u,"error",a),Wc(u,"load",a),i.send(c.data)}catch(a){this.b({type:"cors"})}}t("H.net.Response",Rc),Rc.prototype.type="default",Rc.prototype.type=Rc.prototype.type,Rc.prototype.status=200,Rc.prototype.status=Rc.prototype.status,Rc.prototype.statusText="OK",Rc.prototype.statusText=Rc.prototype.statusText,Rc.error=function(){return Rc.a||(Rc.a=new Rc(null,{status:0,statusText:""}),Rc.a.type="error"),Rc.a},Rc.error=Rc.error,Rc.prototype.text=function(){var t=Sc(this);if(!t)if(this.c)t=Zb(this.c);else if(this.a){var e,r=(t=new Uint8Array(this.a)).length,i=Array(r);for(e=0;e<r;e++)i[e]=String.fromCharCode(t[e]);t=Zb(i.join(""))}else t=this.b?Tc(this.b):$b("Unsupported response body");return t},Rc.prototype.json=function(){return this.text().then(x.JSON.parse)},Rc.prototype.blob=function(){var t,e=Sc(this);return e||(this.b?t=this.b:this.a&&(t=new Blob([this.a],{type:"application/octet-stream"}))),e||Zb(t)},Rc.prototype.arrayBuffer=function(){return this.a?Sc(this)||Zb(this.a.slice(0)):this.blob().then(Rc.b)},Rc.b=function(t){var e=new FileReader;return e.readAsArrayBuffer(t),new Rb((function(t,r){e.onload=function(){t(e.result)},e.onerror=function(){r(e.error)}}))},!Pc&&x.Response&&x.Response.error&&(Rc=x.Response,Ic(Rc.prototype)),u(D,Error),t("H.lang.InvalidArgumentError",D),D.prototype.name="InvalidArgumentError",t("H.net.Xhr",Uc);var Xc={method:"GET",headers:{},data:null},Yc="withCredentials"in new XMLHttpRequest,Vc="timeout"in new XMLHttpRequest,bd,cd,dd,gd,hd;function Wc(t,e,r){Yc?t.a.addEventListener(e,r):t.a["on"+e]=r}function Zc(t,e,r){Yc?t.a.removeEventListener(e,r):t.a["on"+e]=null}function $c(t,e){var r=[];return t&&r.push(yc(t)),1<arguments.length&&r.push(""+e),r=Error(r.join(" ")),Object.setPrototypeOf(r,$c.prototype),r}function ed(){if(this.constructor=this.constructor,!Cc("STATIC_DB"))throw new D(this.constructor,0);if(this.g=fd(),!this.g)throw new $c(this.constructor,"This browser does not support IndexedDB");this.a=[],this.c=[],this.Zh=A(this.Zh,this)}function md(t,e,r){if(t.b)t.a?(t.a.push(e),r&&t.c.push(r)):t.f?r&&r(t.f):e(t.b.result);else{t.b=t.g.open("H_STATIC_DB",1),t.b.onupgradeneeded=t.Zh;var i=t.b.onerror=function(){clearTimeout(t.i),t.f=this.error,t.c.forEach((function(e){e(t.f)})),delete t.a,delete t.c};t.i=setTimeout((function(){i.call({error:Error("DbOpenTimeoutError")})}),500),t.b.onsuccess=function(){clearTimeout(t.i),t.a?(t.a.forEach((function(t){t(this.result)}),this),delete t.a,delete t.c):(delete t.b,delete t.f,t.a=[],t.c=[])},t.a.push(e),r&&t.c.push(r)}}function jd(t,e,r){md(t,(function(t){t=t.transaction(["data"],"readwrite"),e(t.objectStore("data"))}),r)}function kd(t,e,r){e&&(t.onsuccess=function(){e(this.result)}),r&&(t.onerror=function(){r(this.error)})}function id(t){var e=Object.prototype.toString.call(t);return"[object Blob]"===e||"[object ArrayBuffer]"===e||Cc(t)||Ea(t)}function nd(){return gd||(gd=new ed),gd}function fd(){return x.indexedDB||x.webkitIndexedDB||x.mozIndexedDB||x.msIndexedDB}function od(){var t="";if(!vc(hd))if("file:"===window.location.protocol&&-1<navigator.userAgent.toLowerCase().indexOf("firefox")&&128<=window.location.href.length)hd=!1;else{try{var e=fd();t="H_TEST_DB";var r=e&&e.open(t,1)}catch(t){}hd=!!r&&null===r.onupgradeneeded,r&&e.deleteDatabase&&e.deleteDatabase(t)}return hd}function qd(){0!=rd&&(sd[this[Ga]||(this[Ga]=++Ha)]=this),this.zd=this.zd,this.mb=this.mb}Uc.prototype.abort=function(){this.a&&(this.a.abort(),this.a&&this.b({type:"abort"}))},Uc.prototype.abort=Uc.prototype.abort,Uc.prototype.b=function(t){var e,r=t.type;t=this.a,this.f&&clearTimeout(this.f),"load"===r?t instanceof XMLHttpRequest&&200!==t.status&&(e="network"):e=4===t.readyState&&0===t.status&&"error"==r?"cors":"error"!=r?r:"network",Zc(this,"timeout",r=this.b),Zc(this,"error",r),Zc(this,"load",r),t=0===t.status||e&&"network"!==e?Rc.error():new Rc(t.responseText||null,t),e=this.c,delete this.b,delete this.c,delete this.a,e(t)},u($c,Error),t("H.lang.IllegalOperationError",$c),$c.prototype.name="IllegalOperationError",p=ed.prototype,p.put=function(t,e,r,i){if(!Cc(t)&&!Fc(t))throw new D(this.put,0);if(!id(e))throw new D(this.put,1);jd(this,(function(n){kd(n.put(e,t),r,i)}),i)},p.get=function(t,e,r){var i;if(!Cc(t)&&!Fc(t))throw new D(this.get,0);if(!Da(e))throw new D(this.get,1);return jd(this,(function(n){kd(i=n.get(t),e,r)}),r),{cancel:function(){i&&(i.onsuccess=ld)}}},p.remove=function(t,e,r){if(!Cc(t)&&!Fc(t))throw new D(this.remove,0);jd(this,(function(i){kd(i.delete(t),e,r)}),r)},p.clear=function(t,e){jd(this,(function(r){kd(r.clear(),t,e)}),e)},p.Zh=function(){var t=this.b.result;t.objectStoreNames.contains("data")||t.createObjectStore("data")},t("H.util.IndexedDBStorage.getInstance",nd),t("H.util.IndexedDBStorage.isSupported",od);var rd=0,sd={};function td(t){t&&"function"==typeof t.F&&t.F()}function ud(t,e){this.type=t,this.currentTarget=this.target=e,this.c=this.a=!1,this.Ik=!0}function vd(t,e,r){vd.j.constructor.call(this,t,r),this.data=e}function wd(t,e,r){wd.j.constructor.call(this,t,r),this.message=e}qd.prototype.zd=!1,qd.prototype.F=function(){if(!this.zd&&(this.zd=!0,this.o(),0!=rd)){var t=this[Ga]||(this[Ga]=++Ha);if(0!=rd&&this.mb&&0<this.mb.length)throw Error(this+" did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass' method.");delete sd[t]}},qd.prototype.tb=function(t,e){this.zd?void 0!==e?t.call(e):t():(this.mb||(this.mb=[]),this.mb.push(void 0!==e?Ka(t,e):t))},qd.prototype.o=function(){if(this.mb)for(;this.mb.length;)this.mb.shift()()},ud.prototype.stopPropagation=function(){this.a=!0},ud.prototype.preventDefault=function(){this.c=!0,this.Ik=!1},t("H.util.Event",ud),ud.prototype.stopPropagation=ud.prototype.stopPropagation,ud.prototype.stopPropagation=ud.prototype.stopPropagation,ud.prototype.CAPTURING_PHASE=1,ud.prototype.CAPTURING_PHASE=ud.prototype.CAPTURING_PHASE,ud.prototype.AT_TARGET=2,ud.prototype.AT_TARGET=ud.prototype.AT_TARGET,ud.prototype.BUBBLING_PHASE=3,ud.prototype.BUBBLING_PHASE=ud.prototype.BUBBLING_PHASE,ud.prototype.eventPhase=0,ud.prototype.eventPhase=ud.prototype.eventPhase,u(vd,ud),t("H.util.DataEvent",vd),u(wd,ud),t("H.util.ErrorEvent",wd);var xd=Math,yd=xd.min,zd=xd.max,Ad=xd.round,Bd=xd.floor,Cd=xd.ceil,Dd=xd.abs,Ed=xd.log,Fd=xd.sqrt,Gd=xd.pow,Hd=xd.exp,Id=xd.sin,Jd=xd.asin,Kd=xd.cos,Ld=xd.tan,Md=xd.atan,Nd=xd.atan2,Od=xd.LN2,Pd=xd.PI,Qd=Pd/2,Rd=Pd/4,Sd=2*Pd,Td=3*Pd,Ud=Pd/180,Vd=180/Pd,Wd=1/0,Xd=Gd(-2,53),Yd=Yd||function(t){return Ed(t)/Od};function Zd(t,e){var r;return 0>(r=t%e)==0>e?r:r+e}function $d(t,e,r){return e-=r=r||0,(t-=r)-Bd(t/e)*e+r}function ae(t,e,r){return t>r?r:t<e?e:t}function be(t,e,r,i){return i||(i=0),e<r?t>=e-i&&t<=r+i:t>=r-i&&t<=e+i}function ce(t,e,r,i,n,o){return Fd(Gd((t-n)*(i-o)-(e-o)*(r-n),2)/(Gd(r-n,2)+Gd(i-o,2)))}t("H.math.normalize",$d),t("H.math.clamp",ae);var de={NONE:0,VERTEX:1,EDGE:2,SURFACE:3};function ee(t,e,r,i,n,o){var a=r.length,s=a,l=r[0],c=0,u=0,h=0;i=i/2||0;var p=o||2;o=p*(n?0:1)+1;for(var f=p-2;1!=c&&s>o;){s-=f;var d=r[--s];p=r[--s];var y=r[s?s-f-1:(a+(s-f-1))%a],g=r[s?s-f-2:(a+(s-f-2))%a];p>=t-i&&p<=t+i&&d>=e-i&&d<=e+i||g>=t-i&&g<=t+i&&y>=e-i&&y<=e+i?c=1:c||p!==t?!c&&be(t,p,g,i)&&((p<t&&g>t||p>t&&g<t)&&(u+=(l=d+(t-p)/(g-p)*(y-d))>e,h+=l<e),c=be(e,d,y,i)&&ce(t,e,p,d,g,y)<=i?2:0):(g===t&&(d<e&&y>e||d>e&&y<e)||(l<=t&&g>t||l>=t&&g<t)&&(d>=e?++u:++h),c=be(e,d,y,i)&&ce(t,e,p,d,g,y)<=i?2:0),l=p}return!c&&n&&0!==h&&0!=u%2&&(c=3),c}function fe(t,e){return ee(t.x,t.y,e,0,!0)!==de.NONE}function ge(t){for(var e=t.length,r=new Float64Array(2*e),i=e&&vc(t[0].x);e--;){var n=t[e],o=e<<1;r[o]=i?n.x:n[0],r[o+1]=i?n.y:n[1]}return r}function he(){}function ie(t,e,r){this.type=t,this.data=e,this.c=ac(),this.resolve=A(this.resolve,this),this.reject=A(this.reject,this),this.priority=je,r!==B&&(this.priority=r),this.fh().add(this)}t("H.math.CoverType",de),t("H.math.isPointInsidePolygon",fe),t("H.math.flatten",ge),t("H.util.ICancelable",he),he.prototype.cancel=function(){},he.prototype.cancel=he.prototype.cancel;var je=1,ke={Vo:0,Yo:je,To:2};function le(t){var e;for(e in this.a={},ke)this.a[ke[e]]=[];this.Ze=t,this.Ze.addEventListener("allocatable",A(this.b,this))}p=ie.prototype,p.then=function(t,e,r){return this.c.Ak.then(t,e,r)},p.resolve=function(t){this.Yd=3,this.c.resolve(t)},p.reject=function(t){this.Yd=5,this.c.reject(t)},p.Yd=0,p.cancel=function(){3>this.Yd&&(this.oe(),this.fh().remove(this),this.Yd=4)},ie.prototype.cancel=ie.prototype.cancel,t("H.util.JobManager",le);var me=Object.keys(ke).map((function(t){return ke[t]})).sort().reverse();function ne(t,e,r){var i=[],n=arguments.length;return t&&i.push(yc(t)),1<n&&(n=2<n&&Bc(r)?" out of ["+r[0]+"..."+r[1]+"]":"",i.push("("+e+n+")")),i=Error(i.join(" ")),Object.setPrototypeOf(i,ne.prototype),i}le.prototype.add=function(t){C(t,ie,this.add,0),this.a[t.priority].push(t),this.b()},le.prototype.contains=function(t){return-1<this.a[t.priority].indexOf(t)},le.prototype.remove=function(t){var e=t.priority,r=this.a[e].indexOf(t);return-1<r?(this.a[e].splice(r,1),!0):(t.Li&&this.Ze.yf(t.Li),!1)},le.prototype.b=function(){me.forEach((function(t){this.a[t]=this.a[t].filter((function(t){var e;if((e=this.Ze.Jg(t))===z)return!0;var r=A(this.Ze.yf,this.Ze,e,t);t.Li=e,t.then(r,r),t.Yd=t.qj(e)?1:5}),this)}),this)},u(ne,Error),t("H.lang.OutOfRangeError",ne),ne.prototype.name="OutOfRangeError";var oe="closure_listenable_"+(1e6*Math.random()|0);function pe(t){return!(!t||!t[oe])}var qe=0;function re(t,e,r,i,n){this.listener=t,this.proxy=null,this.src=e,this.type=r,this.capture=!!i,this.Mf=n,this.key=++qe,this.be=this.rf=!1}function se(t){t.be=!0,t.listener=null,t.proxy=null,t.src=null,t.Mf=null}function te(t){this.src=t,this.a={},this.b=0}function ve(t,e){var r=e.type;if(!(r in t.a))return!1;var i,n=t.a[r],o=cb(n,e);return(i=0<=o)&&Array.prototype.splice.call(n,o,1),i&&(se(e),0==t.a[r].length&&(delete t.a[r],t.b--)),i}function ue(t,e,r,i){for(var n=0;n<t.length;++n){var o=t[n];if(!o.be&&o.listener==e&&o.capture==!!r&&o.Mf==i)return n}return-1}te.prototype.add=function(t,e,r,i,n){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var a=ue(t,e,i,n);return-1<a?(e=t[a],r||(e.rf=!1)):((e=new re(e,this.src,o,!!i,n)).rf=r,t.push(e)),e},te.prototype.remove=function(t,e,r,i){if(!((t=t.toString())in this.a))return!1;var n=this.a[t];return-1<(e=ue(n,e,r,i))&&(se(n[e]),Array.prototype.splice.call(n,e,1),0==n.length&&(delete this.a[t],this.b--),!0)},te.prototype.na=function(t){t=t&&t.toString();var e,r=0;for(e in this.a)if(!t||e==t){for(var i=this.a[e],n=0;n<i.length;n++)++r,se(i[n]);delete this.a[e],this.b--}return r},te.prototype.sh=function(t,e){var r=void 0!==t,i=r?t.toString():"",n=void 0!==e;return Ua(this.a,(function(t){for(var o=0;o<t.length;++o)if(!(r&&t[o].type!=i||n&&t[o].capture!=e))return!0;return!1}))};var we=!vb||9<=Number(Fb),xe=vb&&!Eb("9");!yb||Eb("528"),xb&&Eb("1.9b")||vb&&Eb("8")||ub&&Eb("9.5")||yb&&Eb("528"),xb&&!Eb("8")||vb&&Eb("9");var ye=function(){if(!xa.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{xa.addEventListener("test",za,e),xa.removeEventListener("test",za,e)}catch(t){}return t}();function ze(t,e){if(ud.call(this,t?t.type:""),this.relatedTarget=this.currentTarget=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.b=null,t){var r=this.type=t.type,i=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.currentTarget=e,e=t.relatedTarget){if(xb){t:{try{qb(e.nodeName);var n=!0;break t}catch(t){}n=!1}n||(e=null)}}else"mouseover"==r?e=t.fromElement:"mouseout"==r&&(e=t.toElement);this.relatedTarget=e,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Ae[t.pointerType]||"",this.b=t,t.defaultPrevented&&this.preventDefault()}}u(ze,ud);var Ae={2:"touch",3:"pen",4:"mouse"};ze.prototype.stopPropagation=function(){ze.j.stopPropagation.call(this),this.b.stopPropagation?this.b.stopPropagation():this.b.cancelBubble=!0},ze.prototype.preventDefault=function(){ze.j.preventDefault.call(this);var t=this.b;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,xe)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(t){}};var Be="closure_lm_"+(1e6*Math.random()|0),Ce={},De=0;function Ee(t,e,r,i,n){if(i&&i.once)return Fe(t,e,r,i,n);if("array"==Aa(e)){for(var o=0;o<e.length;o++)Ee(t,e[o],r,i,n);return null}return r=Ge(r),pe(t)?t.U.add(String(e),r,!1,Ea(i)?!!i.capture:!!i,n):He(t,e,r,!1,i,n)}function He(t,e,r,i,n,o){if(!e)throw Error("Invalid event type");var a=Ea(n)?!!n.capture:!!n,s=Ie(t);if(s||(t[Be]=s=new te(t)),(r=s.add(e,r,i,a,o)).proxy)return r;if(i=Je(),r.proxy=i,i.src=t,i.listener=r,t.addEventListener)ye||(n=a),void 0===n&&(n=!1),t.addEventListener(e.toString(),i,n);else if(t.attachEvent)t.attachEvent(Ke(e.toString()),i);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(i)}return De++,r}function Je(){var t=Le,e=we?function(r){return t.call(e.src,e.listener,r)}:function(r){if(!(r=t.call(e.src,e.listener,r)))return r};return e}function Fe(t,e,r,i,n){if("array"==Aa(e)){for(var o=0;o<e.length;o++)Fe(t,e[o],r,i,n);return null}return r=Ge(r),pe(t)?t.U.add(String(e),r,!0,Ea(i)?!!i.capture:!!i,n):He(t,e,r,!0,i,n)}function Me(t,e,r,i,n){if("array"==Aa(e)){for(var o=0;o<e.length;o++)Me(t,e[o],r,i,n);return null}return i=Ea(i)?!!i.capture:!!i,r=Ge(r),pe(t)?t.U.remove(String(e),r,i,n):!!t&&!!((t=Ie(t))&&(e=t.a[e.toString()],t=-1,e&&(t=ue(e,r,i,n)),r=-1<t?e[t]:null))&&Ne(r)}function Ne(t){if("number"==typeof t||!t||t.be)return!1;var e=t.src;if(pe(e))return ve(e.U,t);var r=t.type,i=t.proxy;return e.removeEventListener?e.removeEventListener(r,i,t.capture):e.detachEvent?e.detachEvent(Ke(r),i):e.addListener&&e.removeListener&&e.removeListener(i),De--,(r=Ie(e))?(ve(r,t),0==r.b&&(r.src=null,e[Be]=null)):se(t),!0}function Ke(t){return t in Ce?Ce[t]:Ce[t]="on"+t}function Oe(t,e,r,i){var n=!0;if((t=Ie(t))&&(e=t.a[e.toString()]))for(e=e.concat(),t=0;t<e.length;t++){var o=e[t];o&&o.capture==r&&!o.be&&(o=Pe(o,i),n=n&&!1!==o)}return n}function Pe(t,e){var r=t.listener,i=t.Mf||t.src;return t.rf&&Ne(t),r.call(i,e)}function Le(t,e){if(t.be)return!0;if(!we){if(!e)t:{e=["window","event"];for(var r=xa,i=0;i<e.length;i++)if(null==(r=r[e[i]])){e=null;break t}e=r}if(e=new ze(i=e,this),r=!0,!(0>i.keyCode||null!=i.returnValue)){t:{var n=!1;if(0==i.keyCode)try{i.keyCode=-1;break t}catch(t){n=!0}(n||null==i.returnValue)&&(i.returnValue=!0)}for(i=[],n=e.currentTarget;n;n=n.parentNode)i.push(n);for(t=t.type,n=i.length-1;!e.a&&0<=n;n--){e.currentTarget=i[n];var o=Oe(i[n],t,!0,e);r=r&&o}for(n=0;!e.a&&n<i.length;n++)e.currentTarget=i[n],o=Oe(i[n],t,!1,e),r=r&&o}return r}return Pe(t,new ze(e,this))}function Ie(t){return(t=t[Be])instanceof te?t:null}var Qe="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ge(t){return Da(t)?t:(t[Qe]||(t[Qe]=function(e){return t.handleEvent(e)}),t[Qe])}function F(){qd.call(this),this.U=new te(this),this.wn=this,this.Mg=null}function Re(t){var e=(t=t||{}).callback;this.b=t.label,Da(e)&&(this.callback=e),this.a=!!t.disabled,Re.j.constructor.call(this)}u(F,qd),F.prototype[oe]=!0,p=F.prototype,p.Mb=function(){return this.Mg},p.ka=function(t){this.Mg=t},p.addEventListener=function(t,e,r,i){Ee(this,t,e,r,i)},p.removeEventListener=function(t,e,r,i){Me(this,t,e,r,i)},p.dispatchEvent=function(t){var e,r=this.Mb();if(r)for(e=[];r;r=r.Mb())e.push(r);r=this.wn;var i=t.type||t;if("string"==typeof t)t=new ud(t,r);else if(t instanceof ud)t.target=t.target||r;else{var n=t;Ya(t=new ud(i,r),n)}if(n=!0,e)for(var o=e.length-1;!t.a&&0<=o;o--){var a=t.currentTarget=e[o];n=a.jd(i,!0,t)&&n}if(t.a||(n=(a=t.currentTarget=r).jd(i,!0,t)&&n,t.a||(n=a.jd(i,!1,t)&&n)),e)for(o=0;!t.a&&o<e.length;o++)n=(a=t.currentTarget=e[o]).jd(i,!1,t)&&n;return n},p.o=function(){F.j.o.call(this),this.U&&this.U.na(void 0),this.Mg=null},p.jd=function(t,e,r){if(!(t=this.U.a[String(t)]))return!0;t=t.concat();for(var i=!0,n=0;n<t.length;++n){var o=t[n];if(o&&!o.be&&o.capture==e){var a=o.listener,s=o.Mf||o.src;o.rf&&ve(this.U,o),i=!1!==a.call(s,r)&&i}}return i&&0!=r.Ik},p.sh=function(t,e){return this.U.sh(void 0!==t?String(t):void 0,e)},t("H.util.EventTarget",F),F.prototype.ka=F.prototype.ka,F.prototype.setParentEventTarget=F.prototype.ka,F.prototype.Mb=F.prototype.Mb,F.prototype.getParentEventTarget=F.prototype.Mb,F.prototype.addEventListener=F.prototype.addEventListener,F.prototype.addEventListener=F.prototype.addEventListener,F.prototype.removeEventListener=F.prototype.removeEventListener,F.prototype.removeEventListener=F.prototype.removeEventListener,F.prototype.dispatchEvent=F.prototype.dispatchEvent,F.prototype.dispatchEvent=F.prototype.dispatchEvent,F.prototype.F=F.prototype.F,F.prototype.dispose=F.prototype.F,F.prototype.tb=F.prototype.tb,F.prototype.addOnDisposeCallback=F.prototype.tb,F.prototype.xn=F.prototype.jd,F.prototype.jd=function(t,e,r){var i,n,o=!0,a=r[r.currentTarget===r.target?"AT_TARGET":e?"CAPTURING_PHASE":(i=!0,"BUBBLING_PHASE")];return(!i||"pointerenter"!==(n=r.type)&&"pointerleave"!==n)&&(r.eventPhase=a,o=F.prototype.xn.apply(this,arguments),i&&this.Mb&&null===this.Mb()&&delete r.eventPhase),o},F.prototype.Tk=function(t){for(var e,r=this;r&&(e=r.Mb())&&e!==t;)r=e;e||r.ka(t)},F.prototype.setRootParentEventTarget=F.prototype.Tk,u(Re,F),t("H.util.ContextItem",Re),Re.prototype.Ge=function(){return this.b},Re.prototype.getLabel=Re.prototype.Ge,Re.prototype.Jc=function(t){return this.b!==t&&(this.b=t,this.dispatchEvent("update")),this},Re.prototype.setLabel=Re.prototype.Jc,Re.prototype.dc=function(){return this.a},Re.prototype.isDisabled=Re.prototype.dc,Re.prototype.va=function(t){return t!==this.a&&(this.a=t,this.dispatchEvent("update")),this},Re.prototype.setDisabled=Re.prototype.va;var Se=new Re;function Te(t){if(x.document){var e=document.createElement("canvas");return e.width=e.height=1,e.getContext("2d",{fp:t})}return null}function Ue(){return window.devicePixelRatio||1}Re.SEPARATOR=Se,t("H.util.getPixelRatio",Ue);var Ve=/^rgba\(([^,]+),([^,]+),([^,]+),([^)]+)\)$/;function We(t){var e=Xe[t],r=x.RegExp;return e||(x.Uint8ClampedArray||(x.Uint8ClampedArray=function(t){return t instanceof Number?Array(t):t.map((function(t){return ae(Ad(t),0,255)}))}),"none"===t?e=new Uint8ClampedArray([0,0,0,0]):(Ye.fillStyle="black",Ye.fillStyle=t,Ve.test(Ye.fillStyle)?e=new Uint8ClampedArray([r.$1,r.$2,r.$3,255*r.$4]):(Ye.clearRect(0,0,1,1),Ye.fillRect(0,0,1,1),e=Ye.getImageData(0,0,1,1).data)),Xe[t]=e),e}function Ze(t){return"none"!==t&&0<We(t)[3]}var Xe=oc(),$e=!!x.VBArray;function af(t,e){return t!==B?t:e}function bf(t){return/^<svg/.test(t)?"data:image/svg+xml;charset=utf-8,"+encodeURIComponent(t):t}function cf(t){this.fc=0<+t?xd.round(t):0}t("H.util.eval",(function(a){return eval(a)})),t("H.util.provide",(function(t){var e=xa.$jscomp;if(e&&"function"==typeof e.Vl&&e.Vl())throw Error("goog.provide cannot be used within a module.");ya(t,void 0)})),cf.prototype.next=function(t){if(9007199254740992===this.fc)throw new ne(t,this.fc,[0,9007199254740991]);return this.fc++};var df=new cf,ef=A(df.next,df);function ff(){return!0}function gf(){return!1}function ld(){}var hf=qc([]),jf=qc({});function kf(t){return"CANVAS"===t.tagName?[t]:t.getElementsByTagName("CANVAS")}function lf(t,e,r){var i;if(e=t.ownerDocument===e?t.cloneNode(!0):e.importNode(t,!0),r)for(t=kf(t),i=(r=kf(e)).length;i--;)r[i].getContext("2d").drawImage(t[i],0,0);return e}var Ye=Te(!0),mf=Te(!1);function nf(t){var e=t.complete,r=0<t.naturalWidth;if(e&&!r&&$e)try{mf.drawImage(t,0,0),r=!0}catch(t){}return e&&r}var of=x.BlobBuilder||x.WebKitBlobBuilder||x.MozBlobBuilder;function pf(t,e){if(e=e||"",of){var r=new of;r.append(t),t=r.getBlob(e)}else t=new Blob([t],{type:e});return t}var qf=x.navigator;function rf(){var t=rf.a;return t||(t=this,rf.a=t,Ic(rf.a),F.call(t),sf(this)),t}function sf(t){t.g=10,t.i=6,t.a=oc(),t.b=oc(),t.c=0}function tf(t,e,r,i){if(!uf[t])throw new D(tf,0,"Mime type is not supported");this.f=t,"crossOrigin"in(t=i?Wa(i):{})||(t.crossOrigin="anonymous"),this.a=t,vf.href=e.toString(),ie.call(this,vf.protocol+"//"+vf.hostname,e,r)}cd=/Edge\/\d+/.test(qf.appVersion),dd=/(A|a)ndroid/.test(qf.appVersion),u(rf,F),rf.prototype.o=function(){rf.j.o.call(this),sf(this)},rf.prototype.Jg=function(t){t=t.type;var e=this.a[t]||0;if(this.c<this.g&&e<this.i){var r=++this.f;return this.c++,this.a[t]=e+1,this.b[r+""]=t,r}return z},rf.prototype.yf=function(t){var e=this.b[t];if(!vc(e)||!this.a[e])throw new $c(this.yf,"Unknown requestId");this.c--,this.a[e]--,this.a[e]||delete this.a[e],delete this.b[t],this.dispatchEvent("allocatable")},rf.prototype.f=-1,u(tf,ie),tf.prototype.qj=function(){return this.b=uf[this.f].call(this),!0},tf.prototype.oe=function(){this.b&&(this.b.abort(),delete this.b)};var uf={"application/json":function(){var t=this,e=wf(this.a),r=e.headers;return e.headers=r=r?Wa(r):{},r.Accept="application/json",new Uc(this.data,(function(e){200<=e.status&&300>e.status?t.resolve(e.json()):t.reject(e)}),e)},"text/plain":function(){var t=this;return new Uc(this.data,(function(e){200<=e.status&&300>e.status?t.resolve(e.text()):t.reject(e)}),wf(this.a))},image:function(){var t=x.document.createElement("img"),e=this,r=this.data;return t.onload=A(this.resolve,this,t),t.onerror=function(){e.reject(Rc.error())},t.crossOrigin=this.a.crossOrigin,t.src=r,{abort:function(){t.onerror=t.onload=null,$e&&nf(t)||t.removeAttribute("src")}}}};!function(){try{var t=new XMLHttpRequest;t.open("get","/",!0)}catch(e){t={}}"response"in t&&(uf.arraybuffer=function(){var t,e=new XMLHttpRequest,r=this,i=this.a,n=i.headers;if(e.open("GET",this.data),xf(e,i),e.responseType="arraybuffer",n)for(t in n)e.setRequestHeader(t,n[t]);return e.onerror=e.ontimeout=function(){r.reject(Rc.error())},e.onload=function(){r.resolve(new Rc(e.response))},e.send(),e})}();var yf=new le(new rf);tf.prototype.fh=function(){return yf};var vf=x.document.createElement("a");function wf(t){var e=Wa(t);return delete e.crossOrigin,xf(e,t),e}function xf(t,e){t.withCredentials="use-credentials"===e.crossOrigin}function J(t,e){this.x=+t,this.y=+e}function zf(t){if(!t)throw Error("invalid argument");return t instanceof J?t:new J(t.x,t.y)}function Af(t){var e=Bf[t];if(!e)if(t in Cf)e=Bf[t]=t;else{e=Df.length;var r="",i=t.charAt(0).toUpperCase()+t.substr(1),n="",o=!1;Ef&&(o=(n=Ef+i)in Cf);for(;e--&&!o;)o=(n=(r=Df[e])+i)in Cf;if(o&&(Ef=r),!(e=o?n:null))throw Error("Could not find any variant of CSS property ["+t+"]");Bf[t]=e}return e}t("H.math.Point",J),J.prototype.set=J,J.prototype.set=J.prototype.set,J.prototype.clone=function(t){return t?(t.x=this.x,t.y=this.y):t=new J(this.x,this.y),t},J.prototype.clone=J.prototype.clone,J.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this},J.prototype.add=J.prototype.add,J.prototype.sub=function(t){return this.x-=t.x,this.y-=t.y,this},J.prototype.sub=J.prototype.sub,J.prototype.scale=function(t,e){return this.x*=t,this.y*=void 0===e?t:e,this},J.prototype.scale=J.prototype.scale,J.prototype.round=function(){return this.x=Ad(this.x),this.y=Ad(this.y),this},J.prototype.round=J.prototype.round,J.prototype.floor=function(){return this.x=Bd(this.x),this.y=Bd(this.y),this},J.prototype.floor=J.prototype.floor,J.prototype.ceil=function(){return this.x=Cd(this.x),this.y=Cd(this.y),this},J.prototype.ceil=J.prototype.ceil,J.prototype.ia=function(t){return!(!t||this.x!==t.x||this.y!==t.y)},J.prototype.equals=J.prototype.ia,J.prototype.Cj=function(t,e){var r=e.x-t.x,i=e.y-t.y,n=t;if(r||i){var o=((this.x-t.x)*r+(this.y-t.y)*i)/(r*r+i*i);n=0>=o?t:1<=o?e:new J(t.x+o*r,t.y+o*i)}return n},J.prototype.getNearest=J.prototype.Cj,J.prototype.Wa=function(t){return Fd(Gd(this.x-t.x,2)+Gd(this.y-t.y,2))},J.prototype.distance=J.prototype.Wa,J.fromIPoint=zf,t("H.dom.cssPrefixer.prefix",Af);var Df=["O","Ms","ms","Moz","Webkit"],Bf={},Ef="",Cf=document.createElement("span").style;function Ff(t,e,r,i){if(!t||!e||!r)throw new D(Ff,B,"Must specify name, version and revision parameter");this.name=t,this.version=e,this.revision=r,i&&Ya(this,i)}t("H.util.BuildInfo",Ff),Ff.prototype.toString=function(){var t,e=[];for(t in this)Cc(this[t])&&e.push(this[t]);return e.join(";")};var Gf={};function Hf(t,e,r,i){if(!t)throw new D(Hf,1,"Must specify a name parameter");return Gf[t]||(Gf[t]=new Ff(t,e,r,i))}function If(){If.j.constructor.call(this),this.a=Jf(this),this.f=oc(),this.c=A(this.c,this),this.a.addEventListener("message",this.c),this.b={}}Ff.get=Hf,u(If,F),If.prototype.o=function(){this.a.terminate()},If.prototype.g=function(t){var e=t.type,r=!!this.f[e],i=t.data,n=Kf++,o=i&&i.Mo?i.Mo:B,a=!0;return r?(this.b[n]=t,Lf(this,e,n,i&&i.message,o)):(t.reject(new D(this.g,0,"processor_not_found")),a=!1),a},If.prototype.c=function(t){t=t.data;var e=this.b[t.taskId],r=t.taskId,i=t.data,n=this;if(2===t.type)new tf("arraybuffer",i).then((function(t){return t.arrayBuffer()})).then((function(t){n.a.postMessage(["3",r,[t]],[t])}),(function(){n.a.postMessage(["3",r,[null,"ERROR"]])}));else{if(e){switch(t.type){case 1:e.resolve(i);break;case 0:e.reject(i)}delete this.b[r]}this.dispatchEvent(new ud(this.A.IDLE))}};var Kf=0,Qf,Tf;function Mf(t,e,r){var i,n=Kf++;return t.b[n]=i=ac(),Lf(t,e,n,r),i.Ak}function Lf(t,e,r,i,n){i===B||Ca(i)||(i=[i]);try{t.a.postMessage([e,r,i],n)}catch(e){(t=t.b[r]).reject(e.message)}}function Jf(a){var b=x.H.__bootstrap__;if(b=Da(b)?(""+b).replace(/^[^{]+{((.|[\r\n])+?)}\s*$/,"$1"):""+b,x.Worker&&x.URL)try{var c=new x.Worker(x.URL.createObjectURL(pf(b,"application/javascript")))}catch(t){}return c||(a=new Nf(a),function(){eval("var self = arguments[0];"+b)}(a),c=new Of(a)),c}function Of(t){F.call(this),this.a=t}function Nf(a){F.call(this),this.a=a,this.addEventListener=A(this.addEventListener,this),this.removeEventListener=A(this.removeEventListener,this),this.postMessage=A(this.postMessage,this),this.eval=A(eval,this)}function Pf(){var t=Qf;return t||(t=Qf=this,F.call(t),Rf(this)),t}function Rf(t){var e,r=t.b;if(r)for(e=r.length;e--;)r[e].F();t.b=[],Ic(t.b),t.c={},t.f=oc()}function Sf(t,e,r){ie.call(this,t,e,r)}function Uf(t,e,r,i,n,o){var a,s,l,c,u=t.length;if(u)for(a=[];u--;){var h=t[u],p=h.length,f=0;for(l=1;l<p;l++)if(c=Vf(h[l-1],h[l],r,e,i,n)){var d=c[0],y=c[1];f&&f.ia(d)?s.push(y):a.push(s=c),f=y,o&&(l=p,u=0)}}else a=t;return a}function Vf(t,e,r,i,n,o){var a=t.x;t=-t.y;var s=e.x;if(e=-e.y,r=-r,o=-o,a>s){if(s>n||a<i)return;var l=a,c=t;a=s,t=e,s=l,e=c,l=1}else if(a>n||s<i)return;if(t>e){if(e>r||t<o)return;var u=1;t=-t,e=-e,c=o,o=-r,r=-c}else if(t>r||e<o)return;if(a<i){if((t+=(i-a)*(e-t)/(s-a))>r)return;a=i}if(t<o){if((a+=(o-t)*(s-a)/(e-t))>n)return;t=o}return s>n&&(e=t+(n-a)*(e-t)/(s-a),s=n),e>r&&(s=a+(r-t)*(s-a)/(e-t),e=r),u&&(t=-t,e=-e),l?[new J(s,-e),new J(a,-t)]:[new J(a,-t),new J(s,-e)]}function Wf(t,e,r){var i,n;t=Xf(t,!0),e=Xf(e,!1);var o={},a=i=1;switch(~~(r||0)){case 1:a=i=0;break;case 2:i=0,a=1;break;case 3:i=1,a=0}r=i;var s=a;if(e&&t){for(e.se=new Yf(e.x,e.y,null,Zf(e)),t.se=new Yf(t.x,t.y,null,Zf(t)),a=e;a.next;a=a.next)if(!a.Za)for(i=t;i.next;i=i.next)if(!i.Za){var l=$f(a.next),c=$f(i.next);if(n=ag(a,l,i,c,o)){n=o.pl;var u=o.ql,h=o.Po,p=o.Qo;bg(n=new Yf(h,p,null,null,null,null,!0,0,0,n),a,l),bg(l=new Yf(h,p,null,null,null,null,!0,0,0,u),i,c),n.Th=l,l.Th=n}}for(o=fe(e,cg(t)),r&&(o=!o),a=e;a;a=a.next)a.Za&&(a.vh=o,o=!o);for(o=fe(t,cg(e)),s&&(o=!o),i=t;i.next;i=i.next)i.Za&&(i.vh=o,o=!o);for(dg(e),dg(t);(t=eg(e))!=e;){for(r=null;!t.yg;t=t.Th){for(o=t.vh;(r=new Yf(t.x,t.y,r)).artificial=t.Za||t.Sj,t.yg=1,t=o?t.next:t.gc;)if(t.Za){t.yg=1;break}if(!t)break}r.Uh=f||null;var f=r}return f}}function Yf(t,e,r,i,n,o,a,s,l,c){this.x=t,this.y=e,this.next=r||null,this.gc=i||null,this.Uh=n||null,this.Th=o||null,this.Za=!!a,this.vh=!!s,this.yg=l||0,this.alpha=c||0,i&&(i.next=this),r&&(r.gc=this),this.Sj=!1,this.se=null}function $f(t){for(;t&&t.Za;)t=t.next;return t}function Zf(t){if(t)for(;t.next;)t=t.next;return t}function eg(t){var e=t;if(e)do{e=e.next}while(e!=t&&(!e.Za||e.Za&&e.yg));return e}function dg(t){var e=Zf(t);e.gc.next=t,t.gc=e.gc}function ag(t,e,r,i,n,o){var a,s=e.x-t.x,l=e.y-t.y,c=i.x-r.x,u=i.y-r.y,h=s*u-l*c;return h?(c=((r.x-t.x)*u-(r.y-t.y)*c)/h,h=(l*(r.x-t.x)-s*(r.y-t.y))/h,0>c||1<c||0>h||1<h?0:(0===c?a=t:1===c?a=e:0===h?a=r:1===h&&(a=i),a&&!o?(a.x+=2480549651603763e-20,a.y+=7321997314118067e-20,a.se&&(a.se.x=a.x,a.se.y=a.y),ag(t,e,r,i,n)):(n.Po=t.x+c*s,n.Qo=t.y+c*l,n.pl=c,n.ql=h,1))):0}function cg(t){for(var e=[];t;)e.push(t.x,t.y),t=t.next;return e}function bg(t,e,r){for(e=e.next;e!==r&&e.alpha<=t.alpha;)e=e.next;t.next=e,t.gc=e.gc,t.next.gc=t,t.gc.next=t}function Xf(t,e){for(var r,i=null,n=0,o=t.length;n<o;n++)(r=new Yf(t[n].x,t[n].y,i)).Sj=e,(r.next=i)&&(i.gc=r),i=r;return i}function fg(t,e,r){var i=ae(+t,-90,90);if(e&&E(i))throw new D(e,r,t);return i}function gg(t,e,r){var i=+t;if((-180>i||180<i)&&(i=Zd(i+180,360)-180),e&&E(i))throw new D(e,r,t);return i}function hg(t,e,r){var i;if(t!==B&&E(i=+t)&&e)throw new D(e,r,t);return i}function ig(t,e){return 0>t!=0>e&&180<Dd(e-t)}function jg(){xc(this,jg)}function kg(t,e,r){this.lat=fg(t,kg,0),this.lng=gg(e,kg,1),r!==B&&(this.alt=hg(r,kg,2))}function lg(t,e,r){var i=Ea(t)&&!(E(t.lat=fg(t.lat))||E(t.lng=gg(t.lng))||t.alt!==B&&E(t.alt=hg(t.alt)));if(!i&&e)throw new D(e,r,t);return i}function ng(t){if(!t)throw new D(ng,0,t);return new kg(t.lat,t.lng,t.alt)}function K(t,e,r,i){og(this,fg(t,K,0),gg(e,K,1),fg(r,K,2),gg(i,K,3))}function og(t,e,r,i,n){return t.a=r,t.b=n,e<i&&(r=e,e=i,i=r),t.c=e,t.f=i,t.l=t.g=t.i=null,t}function qg(t,e){return(t=e-t)+(0>t?360:0)}function pg(t,e){return(t+=e/2)-(180<t?360:0)}function rg(t,e,r,i,n,o,a,s,l){r=yd(r,a),t=zd(t,n);var c=pg(e,n=qg(e,i)),u=pg(o,a=qg(o,s))-c;if(180>(u+=0>u-1e-6?360:0)-1e-6){c=e;var h=s}else u=360-u,c=o,h=i;return 360<=(u=u+n/2+a/2)+5e-7?(c=-180,h=180):u-5e-7<n?(c=e,h=i):u-5e-7<a&&(c=o,h=s),l?og(l,t,c,r,h):new K(t,c,r,h)}function sg(t,e,r){return r||(lg(t,sg,0),lg(e,sg,1)),new K(t.lat,t.lng,e.lat,e.lng)}function tg(t,e){var r=1,i=t.length,n=null;if(!Ca(t))throw new D(tg,0,t);if(0<i){var o=t[0];for(n=sg(o,o,e);r<i;r++)o=t[r],n.Xc(o.lat,o.lng,e,n)}return n}function ug(t,e){var r,i=3,n=t.length;if(!(e||t&&null!=t.length))throw new D(ug,0,t);if(0<n)for(r=new K(t[0],t[1],t[0],t[1]);i<n;i+=3)r.Xc(t[i],t[i+1],e,r);return r}function vg(t,e){var r,i=1,n=t.length;if(e&&(!t||null==t.length))throw new D(vg,0,t);if(0<n)for(r=new K(t[0].c,t[0].a,t[0].f,t[0].b);i<n;i++)r.ec(t[i],e,r);return r}function wg(t,e,r,i,n,o){xc(this,wg),this.c=t||10,this.b=null,this.f=i||0,this.g=n||0,this.i=e||1,this.l=r||1,this.m=!!o,this.flush()}function xg(t){var e=t.b;if(t.m&&!e){var r=t.head;(r.entries||r[0]||r[1]||r[2]||r[3])&&(e=yg([e=[r],e,e,e],[r[6],r[7],r[4],r[5]]),t.b=e)}return e}function yg(t,e){var r,i,n,o,a=0;for(r=3;0<=r;r--){var s=r+4,l=0<r%3,c=[],u=e[r],h=t[r];for(i=h.length;i--;){var p=h[i];if(n=p.entries)for(o=n.length;o--;){var f=n[o].a(r);(l?f>u:f<u)&&(u=f)}for(o=4;o--;)(n=p[o])&&(l?n[s]>u:n[s]<u)&&c.push(n)}a+=c.length,e[r]=u,t[r]=c}return a&&(e=yg(t,e)),e}function zg(t,e,r){var i,n;if(t.m&&(i=t.b))for(n=3;0<=n;n--){var o=e.a(n);if(n%3?o>=i[n]:o<=i[n]){if(!r){t.b=null;break}i[n]=o}}}function Bg(t,e){var r,i=t.head;if(e){var n=e;if(n!==i)for(i=n;n=n.parent;)(n.entries||1<n.a)&&(i=n)}else for(;!i.entries&&2>(r=i.a)&&r;)i=n;t.head=i}function Cg(t,e,r,i,n,o,a,s,l){var c,u=e.entries,h=e[7],p=e[4],f=e[5],d=e[6],y=e[8],g=e[9];if(u){var v=u.length;if(n>p||i>h||a<d||o<f)for(;v--;)p=(h=u[v]).a(3),f=h.a(0),d=h.a(1),h.a(2)>=n&&d>=i&&(f<a||s&&f==a)&&(p<o||l&&p==o)&&r.push(h);else for(;v--;)r.push(u[v])}(o>y||l&&o==y)&&(n<g&&(c=e[1])&&Cg(t,c,r,i,n,o,a,s,l),(a>g||s&&a==g)&&(c=e[3])&&Cg(t,c,r,i,n,o,a,s,l)),i<y&&(n<g&&(c=e[0])&&Cg(t,c,r,i,n,o,a,s,l),(a>g||s&&a==g)&&(c=e[2])&&Cg(t,c,r,i,n,o,a,s,l))}If.prototype.A={IDLE:"idle",Ni:"error"},If.prototype.i=function(t,e){var r=this.l||(this.l=new ud(this.A.Ni));r.data=e,delete this.f[t],this.dispatchEvent(r)},u(Of,F),Of.prototype.postMessage=function(t){x.setTimeout(A(this.b,this,t),0)},Of.prototype.b=function(t){var e=new ud("message");e.data=t,this.a.dispatchEvent(e)},Of.prototype.terminate=function(){this.a.F(),this.F()},u(Nf,F),Nf.prototype.postMessage=function(t){var e=new ud("message");e.data=t,x.setTimeout(A(this.a.c,this.a,e),0)},u(Pf,F),Pf.prototype.o=function(){Pf.j.o.call(this),Rf(this)},Pf.prototype.Jg=function(t){var e;if(t=t.type,!(e=this.f[t]))throw new $c(this.Jg,'Unknown type "'+t+'"');var r=this.b,i=r[0];return i||(i=r[0]=new If,this.tb(La(td,i)),Va(this.c)||Mf(i,"0",r=x.Object.keys(this.c))),(r=i).f[t]||(r.f[t]=e,Mf(r,"1",[t,Da(e)?e+"":e]).then(ld,A(r.i,r,t))),i},Pf.prototype.yf=function(){},Pf.prototype.a=function(t,e){var r=this.f,i=r[t];if(i){if(e!==i)throw new $c(this.a,'Type "'+t+'" is already registered')}else r[t]=e},u(Sf,ie),Sf.prototype.fh=function(){return Tf||(Tf=new le(new Pf)),Tf},Sf.prototype.oe=function(){},Sf.prototype.qj=function(t){return t.g(this)},t("H.math.clipping.clipStrips",Uf),t("H.math.clipping.clipPolygon",Wf),t("H.geo.isDBC",ig),t("H.geo.AbstractGeometry",jg),jg.prototype.getBoundingBox=jg.prototype.K,jg.prototype.equals=jg.prototype.ia,jg.prototype.rb="",jg.prototype.Hb="",jg.prototype.toString=function(){return this.cd([this.rb.toUpperCase()," "]).join("")},jg.prototype.toString=jg.prototype.toString,jg.prototype.Kc=function(){return{type:this.Hb,coordinates:this.bd()}},jg.prototype.toGeoJSON=jg.prototype.Kc,jg.prototype.Y=function(){return{type:this.rb,coordinates:this.pc(),boundingBox:this.K().Y()}},jg.prototype.forWorkerMessage=jg.prototype.Y,u(kg,jg),t("H.geo.Point",kg),kg.prototype.ia=function(t){return this===t||!!t&&this.lat===t.lat&&this.lng===t.lng&&(this.alt||0)===(t.alt||0)},kg.prototype.equals=kg.prototype.ia,kg.prototype.Wa=function(t){if(this===t||this.lat===t.lat&&this.lng===t.lng)t=0;else{var e=this.lat*Ud,r=t.lat*Ud;t=12742001.58*Jd(yd(1,Fd(Gd(Id((e-r)/2),2)+Kd(e)*Kd(r)*Gd(Id((this.lng*Ud-t.lng*Ud)/2),2))))}return t},kg.prototype.distance=kg.prototype.Wa,kg.prototype.zg=function(t,e,r){var i;if(r){if(i=e/6371000.79){e=t*Ud,t=Ud*this.lat;var n=Id(t);r=Id(i);var o=Kd(i);i=Ud*this.lng;var a=Kd(t);t=Jd(a*Kd(e)*r+n*o),e=(i+(e=Nd(Id(e)*a*r,o-n*Id(t)))+Pd)%(2*Pd)-Pd,n=new kg(t*Vd,(540+(e*=Vd))%360-180)}return n||this}return 0==(90+(t=(t%360+360)%360))%180?(t=this.lng+e/(6371000.79*Sd*Kd(this.lat*Ud))*(270===t?-360:360),new kg(this.lat,(t+540)%360-180)):((e/=6371000.79)&&(t*=Ud,n=this.lat*Ud,r=this.lng*Ud,o=(i=n+e*Kd(t))-n,a=Ed(Ld(i/2+Rd)/Ld(n/2+Rd)),a=E(o/a)?Kd(n):o/a,t=e*Id(t)/a,Dd(i)>Qd&&(i=0<i?Pd-i:-(Pd+i)),i=new kg(i*Vd,((r+t+Td+(Dd(n+o)>Qd?Pd:0))%Sd-Pd)*Vd)),i||this)},kg.prototype.walk=kg.prototype.zg,kg.prototype.K=function(){return new K(this.lat,this.lng,this.lat,this.lng)},kg.prototype.getBoundingBox=kg.prototype.K,kg.validate=lg,kg.fromIPoint=ng,p=kg.prototype,p.rb="Point",p.cd=function(t){return t.push("(",this.lng," ",this.lat,")"),t},p.Hb="Point",p.bd=function(){return[this.lng,this.lat,this.alt||0]},p.pc=function(){return[this.lat,this.lng,this.alt||0]},u(K,jg),t("H.geo.Rect",K),K.prototype.rb="Polygon",K.prototype.cd=function(t){var e=this.c,r=this.a,i=this.f,n=this.b;return t.push("(","(",r," ",e,",",n," ",e,",",n," ",i,",",r," ",i,",",r," ",e,")",")"),t},K.prototype.ia=function(t){var e=this===t;return!e&&C(t,K)&&(e=this.c===t.c&&this.a===t.a&&this.f===t.f&&this.b===t.b),e},K.prototype.equals=K.prototype.ia,K.prototype.clone=function(){return new K(this.c,this.a,this.f,this.b)},K.prototype.clone=K.prototype.clone,K.prototype.Nb=function(){return this.l||(this.l=new kg(this.c,this.a)),this.l},K.prototype.getTopLeft=K.prototype.Nb,K.prototype.Jb=function(){return this.g||(this.g=new kg(this.f,this.b)),this.g},K.prototype.getBottomRight=K.prototype.Jb,K.prototype.bn=function(){return this.c},K.prototype.getTop=K.prototype.bn,K.prototype.Pl=function(){return this.f},K.prototype.getBottom=K.prototype.Pl,K.prototype.xm=function(){return this.a},K.prototype.getLeft=K.prototype.xm,K.prototype.Sm=function(){return this.b},K.prototype.getRight=K.prototype.Sm,K.prototype.bb=function(){return this.i||(this.i=new kg(this.f+(this.c-this.f)/2,pg(this.a,this.Ab()))),this.i},K.prototype.getCenter=K.prototype.bb,K.prototype.Ab=function(){return qg(this.a,this.b)},K.prototype.getWidth=K.prototype.Ab,K.prototype.Ld=function(){return this.c-this.f},K.prototype.getHeight=K.prototype.Ld,K.prototype.Bb=function(){return this.a>this.b},K.prototype.isCDB=K.prototype.Bb,K.prototype.Rf=function(){return!this.Ab()&&!this.Ld()},K.prototype.isEmpty=K.prototype.Rf,K.prototype.K=function(){return new K(this.c,this.a,this.f,this.b)},K.prototype.getBoundingBox=K.prototype.K,K.prototype.uf=function(t,e,r){var i=this.bb();return r||(t=fg(t,this.uf,0),e=gg(e,this.uf,1)),(t=(e=this.Xc(t,e,r)).bb()).lat===i.lat&&t.lng===i.lng&&this.Ld()===e.Ld()&&this.Ab()===e.Ab()},K.prototype.containsLatLng=K.prototype.uf,K.prototype.gd=function(t,e){return e||lg(t,this.gd,0),this.uf(t.lat,t.lng,e)},K.prototype.containsPoint=K.prototype.gd,K.prototype.Qg=function(t,e){var r=this.bb();if(!e&&!C(t,K))throw new D(this.Qg,0,t);return(t=(e=this.ec(t,e)).bb()).lat===r.lat&&t.lng===r.lng&&this.Ld()===e.Ld()&&this.Ab()===e.Ab()},K.prototype.containsRect=K.prototype.Qg,K.prototype.Xc=function(t,e,r,i){if(!r){if(E(t=fg(t)))throw new D(this.Xc,0,t);if(E(e=gg(e)))throw new D(this.Xc,1,e)}return rg(this.c,this.a,this.f,this.b,t,e,t,e,i)},K.prototype.mergeLatLng=K.prototype.Xc,K.prototype.jk=function(t,e,r){return e||lg(t,this.jk,0),this.Xc(t.lat,t.lng,e,r)},K.prototype.mergePoint=K.prototype.jk,K.prototype.ec=function(t,e,r){if(!e&&!C(t,K))throw new D(this.ec,0,t);return rg(this.c,this.a,this.f,this.b,t.c,t.a,t.f,t.b,r)},K.prototype.mergeRect=K.prototype.ec,K.prototype.Bc=function(t,e,r,i,n,o){return n||(t=fg(t,this.Bc,0),e=gg(e,this.Bc,1),r=fg(r,this.Bc,2),i=gg(i,this.Bc,3)),rg(this.c,this.a,this.f,this.b,t,e,r,i,o)},K.prototype.mergeTopLeftBottomRight=K.prototype.Bc,K.prototype.nd=function(t,e){var r=this.a<=this.b,i=t.a<=t.b,n=this.a<t.b,o=t.a<this.b;if(!e&&!C(t,K))throw new D(this.nd,0,t);return this.f<=t.c&&t.f<=this.c&&(!r&&(!i||n||o)||!i&&(n||o)||n&&o)},K.prototype.intersects=K.prototype.nd,K.merge=rg,K.fromPoints=sg,K.coverPoints=tg,K.coverLatLngAlts=ug,K.coverRects=vg,K.prototype.Hk=function(t,e){var r=this.a,i=this.c,n=this.b,o=this.f,a=this.bb().lng;lg(t,this.Hk,0);var s=t.lat-o-(i-o)/2,l=t.lng-a;return t=-180>(t=r+(0>(l=180<l||-180>l?-(a+t.lng):l)?2*l:0))?360+t:t,n=180<(n+=0<l?2*l:0)?n-360:n,90<=(i=0<s?i+2*s:i)&&(i=90),-90>=(o=0>s?o+2*s:o)&&(o=-90),e?og(e,i,t,o,n):new K(i,t,o,n)},K.prototype.resizeToCenter=K.prototype.Hk,K.prototype.Hb="Polygon",K.prototype.bd=function(){return[[this.a,this.c,0],[this.b,this.c,0],[this.b,this.f,0],[this.a,this.f,0],[this.a,this.c,0]]},K.prototype.Y=function(){return this.pc()},K.prototype.pc=function(){return[this.c,this.a,this.f,this.b]},wg.prototype.remove=function(t){var e,r,i,n=!1;return t&&(e=t.node)&&e.b===this&&(r=e.entries)&&0<=(i=r.indexOf(t))&&(r.splice(i,1),this.s(e),zg(this,t,!1),n=!0),n},wg.prototype.flush=function(){var t=new Ag(B,NaN,this.f-this.i,this.g-this.l,this.f+this.i,this.g+this.l);t.b=this,this.head=this.a=t,this.b=null},wg.prototype.Za=function(t,e,r,i,n,o){var a=[],s=this.head,l=this.a;return t<=s[5]&&e<=s[6]&&(n?r>=s[7]:r>s[7])&&(o?i>=s[4]:i>s[4])&&Cg(this,s,a,t,e,r,i,o||i>=l[6],n||r>=l[5]),a},wg.prototype.Lc=ba(1);var Dg=0;function Ag(t,e,r,i,n,o){this.c=e,t&&(this.parent=t,this.b=t.b,1&e?(r=t[8],n=t[5]):(r=t[7],n=t[8]),2&e?(i=t[9],o=t[6]):(i=t[4],o=t[9])),this[7]=r,this[5]=n,this[8]=(r+n)/2,this[4]=i,this[6]=o,this[9]=(i+o)/2}function Eg(t,e){return t[e]||(++t.a,t[e]=new Ag(t,e))}function Fg(t,e){(t.entries||(t.entries=[])).push(e),e.node=t}function Gg(t,e,r,i,n){var o=t[5],a=t[6];return t[7]<=e&&t[4]<=r&&(o>i||o===i&&o===t.b.a[5])&&(a>n||a===n&&a===t.b.a[6])}function Hg(t,e,r,i,n,o){Hg.j.constructor.apply(this,arguments)}function Ig(t,e,r,i,n){if(Gg(t.a,e,r,i,n))return Jg(t,t.a,e,r,i,n,t.c);throw Error("Coordinates out of bounds")}function Jg(t,e,r,i,n,o,a){var s=e[8],l=e[9],c=0,u=0;return a&&(n<s||(c=+(r>=s)))&&(o<l||(u=+(i>=l)))?r=Jg(t,Eg(e,c|u<<1),r,i,n,o,a-1):(Fg(e,r=new Kg(r,i,n,o)),zg(t,r,!0),Bg(t,e)),r}function Kg(t,e,r,i){this.id=Dg++,this[0]=e,this[1]=r,this[2]=i,this[3]=t}function Lg(t){this.g=new Hg(+t||10,180,90,0,0,!0),this.f=[],this.i=!1,this.a=this.b=this.c=null}function Mg(t,e,r,i,n,o){return o?(o=new Kg(n,-e,r+360,-i),t.f.push(o),t.i=!0,t.a&&t.a.Bc(e,r,i,n,!0,t.a)):(o=Ig(t.g,r,-e,n,-i),t.b&&t.b.Bc(e,r,i,n,!0,t.b)),++t.Eh,t.c=null,o}function Ng(t,e,r,i,n,o,a){var s,l=(t=t.f).length,c=[];if(l){var u=r+360;for(s=n+360;l--;){var h=t[l];(Og(h,e,r,i,n,o,a)||Og(h,e,u,i,s,o,a))&&c.push(h)}}return c}function Og(t,e,r,i,n,o,a){var s=t[3],l=t[0],c=t[1];return t=t[2],(o?l<=i:l<i)&&(a?s<=n:s<n)&&t>=e&&c>=r}function Pg(t,e){var r,i,n;if(r=e.length){var o=t.length;for(i={};o--;)i[t[o].id]=1;for(;r--;)(n=e[r]).id in i||t.push(n)}}Ag.prototype.a=0,Ag.prototype.removeChild=function(t){var e=t.c;this[e]===t&&(delete this[e],delete t.parent,--this.a)},Ag.prototype.Lc=ba(0),u(Hg,wg),Hg.prototype.s=function(t){for(var e,r,i=this.head;t&&!((e=t.entries)&&e.length||(e&&delete t.entries,t.a||!(r=t.parent)));)r.removeChild(t),i===t&&(i=r),t=r;this.head!==i&&(this.head=i,Bg(this))},Hg.prototype.yc=function(t,e){return Ig(this,t,e,t,e)},Kg.prototype.a=function(t){return this[t]},t("H.geo.QuadTree",Lg),p=Lg.prototype,p.Eh=0,p.Rc=function(){return this.Eh},p.Bb=function(){return this.i},p.K=function(){var t,e;if(!this.c){var r,i,n,o=[];if(!this.b&&(t=xg(this.g))&&(this.b=new K(-t[0],t[3],-t[2],t[1])),(e=this.b)&&o.push(e),!this.a&&(n=(i=this.f).length)){t=90;var a=360,s=-90;for(r=0;n--;){var l=i[n];t=yd(t,l[0]),a=yd(a,l[3]),s=zd(s,l[2]),r=zd(r,l[1])}this.a=new K(-t,a,-s,r-360)}(e=this.a)&&o.push(e),(e=o[0])&&(o[1]&&(e=e.ec(o[1],!0)),this.c=e)}return this.c},p.yc=function(t){var e=t.lng;return Mg(this,t=t.lat,e,t,e,!1)},p.Pj=function(t){var e=t.Nb(),r=t.Jb();return(t=t.Bb())?Mg(this,e.lat,r.lng,r.lat,e.lng,t):Mg(this,e.lat,e.lng,r.lat,r.lng,t)},Lg.prototype.insertBoundingBox=Lg.prototype.Pj,Lg.prototype.remove=function(t){var e;if(t.node){var r=this.g.remove(t);this.b=null}else(r=0<=(t=(e=this.f).indexOf(t)))&&(e.splice(t,1),this.i=0<e.length,this.a=null);return r&&(--this.Eh,this.c=null),r},Lg.prototype.remove=Lg.prototype.remove,Lg.prototype.Pf=function(t,e,r){var i=this.g,n=t.Nb(),o=t.Jb(),a=-n.lat;n=n.lng;var s=-o.lat;return o=o.lng,!e&&a===s||!r&&n===o?t=[]:t.Bb()?(Pg(t=i.Za(-180,a,o,s,r,e),i.Za(n,a,180,s,!1,e)),Pg(t,Ng(this,a,o,s,n+360,e,r))):Pg(t=i.Za(n,a,o,s,r,e),Ng(this,a,n,s,o,e,r)),t},Lg.prototype.intersectBoundingBox=Lg.prototype.Pf;var Qg=[62,-1,-1,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,63,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],Rg="undefined"!=typeof BigInt?BigInt:Number;function Sg(t){var e=Rg(0),r=Rg(0),i=[];if(t.split("").forEach((function(t){t=Rg(Qg[t.charCodeAt(0)-45]),e|=(t&Rg(31))<<r,(t&Rg(32))===Rg(0)?(i.push(e),e=Rg(0),r=Rg(0)):r+=Rg(5)})),0<r)throw Error("Invalid encoding");return i}function Tg(t){return t&Rg(1)&&(t=~t),+(t>>=Rg(1)).toString()}function Ug(t){var e=void 0===t.precision?5:t.precision,r=void 0===t.hf?0:t.hf,i=void 0===t.jf?0:t.jf;t=t.ci;var n=Math.pow(10,e),o=Math.pow(10,i);e=Vg(e,r,i);var a=[],s=Rg(0),l=Rg(0),c=Rg(0);return t.forEach((function(t){var e=Rg(Math.round(t[0]*n));a.push(Wg(e-s)),s=e,e=Rg(Math.round(t[1]*n)),a.push(Wg(e-l)),l=e,r&&(t=Rg(Math.round(t[2]*o)),a.push(Wg(t-c)),c=t)})),(e instanceof Array?e:fa(ea(e))).concat(a instanceof Array?a:fa(ea(a))).join("")}function Vg(t,e,r){if(0>t||15<t)throw Error("precision out of range. Should be between 0 and 15");if(0>r||15<r)throw Error("thirdDimPrecision out of range. Should be between 0 and 15");if(0>e||7<e||4===e||5===e)throw Error("thirdDim should be between 0, 1, 2, 3, 6 or 7");return t|=r<<7|e<<4,Xg(1)+Xg(t)}function Xg(t){var e="";for(t=Rg(t);31<t;)e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"[t&Rg(31)|Rg(32)],t>>=Rg(5);return e+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"[t]}function Wg(t){var e=0>(t=Rg(t));return t<<=Rg(1),e&&(t=~t),Xg(t)}function Yg(t){return Ug({ci:t.polyline,precision:t.precision,hf:t.thirdDim,jf:t.thirdDimPrecision})}function Zg(t){if(1!=+(t=Sg(t))[0].toString())throw Error("Invalid format version");var e=+t[1].toString();e={precision:15&e,hf:e>>4&7,jf:e>>7&15};for(var r=Math.pow(10,e.precision),i=Math.pow(10,e.jf),n=e.hf,o=0,a=0,s=0,l=[],c=2;c<t.length;){var u=Tg(t[c])/r;o+=u,a+=Tg(t[c+1])/r,n?(s+=u=Tg(t[c+2])/i,l.push([o,a,s]),c+=3):(l.push([o,a]),c+=2)}if(c!==t.length)throw Error("Invalid encoding. Premature ending reached");return{polyline:(t=Object.assign({},e,{ci:l})).ci,precision:t.precision,thirdDim:t.hf,thirdDimPrecision:t.jf}}function L(t){L.j.constructor.call(this),t&&$g(t,L,0),this.$=t||[],this.a=ah(this,0,this.$.length)}function ah(t,e,r){t=t.$;var i=0;for(e=zd(e,0),r=yd(r,t.length),r-=2,e+=1;e<r;)i+=ig(t[e],t[e+=3]);return i}function bh(t,e,r,i,n){var o=t.$.length;e=fg(e,n),r=gg(r,n),t.$.push(fg(e,n),gg(r,n),i===B?0:hg(i,n)),o&&(t.a+=ig(t.$[o-2],r)),delete t.b,delete t.c}function $g(t,e,r){for(var i,n=t.length,o=!(n%3);o&&n;)o=!(E(t[--n]=hg((i=t[n])===B?0:i))||E(t[--n]=gg(t[n]))||E(t[--n]=fg(t[n])));if(!o&&e)throw new D(e,r,t)}function ch(t){var e=new L,r=0,i=t.length;if(i%2)throw new D(ch,0,t);for(;r<i;)bh(e,t[r++],t[r++],0,ch);return e}function dh(t,e){return t.b-e.b}function eh(t,e){var r,i=t.$,n=-2,o=[],a=t.c;if(!a){a=t.c=new Lg;var s=0,l=t.$,c=l.length;for(r=0;r<c;r+=3){var u=l[r],h=l[r+1];if(r){if(f<h)var p=f,f=h;else p=h;if(y<u)var d=u;else{d=y;var y=u}(p=Mg(a,d,p,y,f,180<f-p)).b=s++}y=u,f=h}}for(l=(a=a.Pf(e).sort(dh)).length,e=0;e<l;e++){if(c=3*(s=(s=a[e]).b),s>n+1){var g=[i[c],i[c+1]];o.push(g)}n=s,g.push(i[c+3],i[c+4])}if(t.a){for(i=[],n=o.length,e=0;e<n;e++)if(a=(g=o[e]).length){for(l=[],t=0;t<a;t+=2)s=g[t],c=g[t+1],l.push(s,c),r=g[t-1],t&&ig(c,r)&&(i.push(l),r+=0>r?360:-360,(l=[]).push(g[t-2],r,s,c));i.push(l)}o=i}return o}function fh(t){var e=Zg(t);t=e.polyline;var r=e.thirdDim;if(e=2===r||3===r,r=0===r,!t)throw new D(fh,0,"data");if(e||r){r=t.length;for(var i=Array(3*r),n=0,o=0;n<r;n++){var a=t[n];i[o++]=a[0],i[o++]=a[1],i[o++]=e?a[2]:0}}if(!i)throw new D(fh,0,"only ABSENT, ALTITUDE or ELEVATION are supported as type of the 3rd dimension");return new L(i)}function gh(t){xc(this,gh),gh.j.constructor.call(this),this.la=hh(this,t,this.constructor,0)}function hh(t,e,r,i){var n,o=[];if(!Bc(e))throw new D(r,i);for(n=0;n<e.length;n++){if(!t.b(e[n]))throw new D(r,i);o.push(t.c(e[n]))}return o}function ih(t){ih.j.constructor.call(this,t)}function jh(){}t("H.util.flexiblePolyline.encode",Yg),t("H.util.flexiblePolyline.decode",Zg),u(L,jg),t("H.geo.LineString",L),L.prototype.gi=function(t,e,r){bh(this,t,e,r,this.gi)},L.prototype.pushLatLngAlt=L.prototype.gi,L.prototype.ff=function(t,e,r){r&&$g(r,this.ff,2),void 0===e&&(e=this.$.length),e&&(this.a-=ah(this,t-3,t+e+3));var i=r?this.$.splice.apply(this.$,[t,e].concat(r)):this.$.splice(t,e);return r&&(this.a+=ah(this,t-3,t+r.length+3)),e&&!r&&(this.a+=ah(this,t-3,t-3)),delete this.b,delete this.c,i},L.prototype.spliceLatLngAlts=L.prototype.ff,L.prototype.Qj=function(t,e,r,i){this.ff(t,0,[e,r,i])},L.prototype.insertLatLngAlt=L.prototype.Qj,L.prototype.Dk=function(t){this.ff(t,3)},L.prototype.removeLatLngAlt=L.prototype.Dk,L.prototype.qd=function(t){bh(this,t.lat,t.lng,t.alt,this.qd)},L.prototype.pushPoint=L.prototype.qd,L.prototype.yc=function(t,e){this.Qj(3*t,e.lat,e.lng,e.alt)},L.prototype.insertPoint=L.prototype.yc,L.prototype.Xe=function(t){this.Dk(3*t)},L.prototype.removePoint=L.prototype.Xe,L.prototype.ye=function(t,e){var r=this.$,i=3*t;t=r[i];var n=r[i+1];return r=r[i+2],e&&(e.lat=t,e.lng=n,e.alt=r),e||new kg(t,n,r)},L.prototype.extractPoint=L.prototype.ye,L.prototype.El=function(t,e,r){var i=this.$;e=e||0,r=af(r,i.length/3);for(var n=3*e;e<r;)t(i[n++],i[n++],i[n++],e++)},L.prototype.eachLatLngAlt=L.prototype.El,L.isDBC=ig,L.prototype.eh=function(t){var e=this.a;return t&&(e+=ig((t=this.$)[t.length-2],t[1])),e},L.prototype.getDBCs=L.prototype.eh,L.prototype.Ie=function(){return this.$.length/3},L.prototype.getPointCount=L.prototype.Ie,L.prototype.um=function(){return this.$},L.prototype.getLatLngAltArray=L.prototype.um,L.prototype.b=z,L.prototype.K=function(){var t;if(!(t=this.b)){var e,r,i=(t=this.$).length,n=3,o=z;if(3<=i){var a=e=t[0],s=r=t[1];for(o=new K(a,s,e,r);n<i;n+=3){if(a=t[n-3],s=t[n-2],e=t[n],s>(r=t[n+1])&&180<r-s||s<r&&-180>s-r||r<s&&180>Dd(r-s)){var l=s;s=r,r=l}a<e&&(l=a,a=e,e=l),rg(o.c,o.a,o.f,o.b,a,s,e,r,o)}}t=this.b=o}return t},L.prototype.getBoundingBox=L.prototype.K,L.prototype.nn=function(){return this.b!==z},L.prototype.hasBoundingBox=L.prototype.nn,L.fromLatLngArray=ch,L.prototype.ia=function(t){var e,r=this===t;if(!r&&(r=C(t,L))){var i=this.$;for(t=t.$,r=(e=i.length)===t.length;r&&e--;)r=i[e]==t[e]}return r},L.prototype.equals=L.prototype.ia,p=L.prototype,p.rb="LineString",p.cd=function(t,e){var r,i=this.$,n=i.length;if(n){for(t.push("("),r=0;r<n;r+=3)r&&t.push(","),t.push(i[r+1]," ",i[r]);e&&(i[0]!==i[n-3]||i[1]!==i[n-2])&&t.push(",",i[1]," ",i[0]),t.push(")")}else t.push("EMPTY");return t},p.Hb="LineString",p.bd=function(){var t,e=[],r=this.$,i=r.length;for(t=0;t<i;t+=3)e.push([r[t+1],r[t],r[t+2]]);return e},p.pc=function(){var t,e=this.$;if(this.K().Bb()){var r=1;for(t=(e=e.slice()).length;r<t;r+=3)0>e[r]&&(e[r]+=360)}return e},p.Ko=function(t){t=void 0===t?5:t;for(var e=this.$,r=e.length,i=[],n=0;n<r;n+=3)i.push([e[n],e[n+1],e[n+2]]);return Yg({polyline:i,precision:t,thirdDim:2,thirdDimPrecision:t})},L.prototype.toFlexiblePolyline=L.prototype.Ko,L.fromFlexiblePolyline=fh,u(gh,jg),t("H.geo.MultiGeometry",gh),gh.prototype.splice=function(t,e,r){return t=[t],e!==B&&t.push(e),r&&(e=hh(this,r,this.splice,2),t=t.concat(e)),this.a=z,this.la.splice.apply(this.la,t)},gh.prototype.splice=gh.prototype.splice,gh.prototype.hc=function(t){var e=this.la.length;if(!(0<=t&&t<e))throw new ne(this.hc,t,[0,e-1]);return this.a=z,this.la.splice(t,1)[0]},gh.prototype.removeAt=gh.prototype.hc,gh.prototype.remove=function(t){if(0<=(t=this.la.indexOf(t))){var e=this.la.splice(t,1)[0];this.a=z}return e||z},gh.prototype.remove=gh.prototype.remove,gh.prototype.mm=function(){return this.la},gh.prototype.getGeometries=gh.prototype.mm,gh.prototype.push=function(t){var e=hh(this,[t],this.push,0)[0];this.a&&(this.a=this.a.ec(t.K())),this.la.push(e)},gh.prototype.push=gh.prototype.push,gh.prototype.K=function(){var t,e,r;if(!(t=this.a)&&(t=z,this.la.length))for(t=this.la[0].K(),r=1;r<this.la.length;r++)(e=this.la[r].K())&&(t=t?t.ec(e):e);return this.a=t},gh.prototype.getBoundingBox=gh.prototype.K,gh.prototype.a=z,gh.prototype.c=function(t){return t},gh.prototype.ia=function(t){var e,r=this===t;if(!r&&(r=C(t,this.constructor))){var i=this.la;for(t=t.la,r=(e=i.length)===t.length;r&&e--;)r=i[e].ia(t[e])}return r},gh.prototype.equals=gh.prototype.ia,gh.prototype.cd=function(t){var e,r,i=this.la,n=i.length,o=!1;if(n){for(t.push("("),e=0;e<n;e++)(r=0<e&&o)&&t.push(","),i[e].cd(t),"EMPTY"===t[t.length-1]?t.splice(-1-+r,+r+1):o=!0;o?t.push(")"):t.splice(-1,1,"EMPTY")}else t.push("EMPTY");return t},gh.prototype.pc=function(){for(var t=[],e=this.la,r=e.length;r--;)t[r]=e[r].pc();return t},gh.prototype.Y=function(){var t=gh.j.Y.call(this);return t.type=this.rb,t},gh.prototype.bd=function(){for(var t=[],e=this.la,r=e.length;r--;)t[r]=e[r].bd();return t},u(ih,gh),t("H.geo.MultiLineString",ih),ih.prototype.b=function(t){return C(t,L)},ih.prototype.rb="Multi"+L.prototype.rb,ih.prototype.Hb="Multi"+L.prototype.Hb,t("H.map.provider.Invalidations",jh),jh.MARK_INITIAL=Xd,jh.prototype.update=function(t,e){e!==kh.NONE&&(this.a=t,e&kh.SPATIAL&&(this.f=t),e&kh.VISUAL&&(this.g=t),e&kh.ADD&&(this.b=t),e&kh.REMOVE&&(this.c=t),e&kh.Z_ORDER&&(this.l=t),e&kh.VOLATILITY&&(this.i=t))},jh.prototype.update=jh.prototype.update,jh.prototype.Bm=function(){return this.a},jh.prototype.getMark=jh.prototype.Bm,jh.prototype.a=Xd,jh.prototype.rn=function(t){return this.a>t},jh.prototype.isAny=jh.prototype.rn,jh.prototype.g=Xd,jh.prototype.Vd=function(t){return this.g>t},jh.prototype.isVisual=jh.prototype.Vd,jh.prototype.f=Xd,jh.prototype.yh=function(t){return this.f>t},jh.prototype.isSpatial=jh.prototype.yh,jh.prototype.b=Xd,jh.prototype.Rj=function(t){return this.b>t},jh.prototype.isAdd=jh.prototype.Rj,jh.prototype.c=Xd,jh.prototype.Sf=function(t){return this.c>t},jh.prototype.isRemove=jh.prototype.Sf,jh.prototype.l=Xd,jh.prototype.zh=function(t){return this.l>t},jh.prototype.isZOrder=jh.prototype.zh,jh.prototype.i=Xd,jh.prototype.vn=function(t){return this.i>t},jh.prototype.isVolatility=jh.prototype.vn;var kh={NONE:0,VISUAL:1,SPATIAL:2,ADD:4,REMOVE:8,Z_ORDER:16,VOLATILITY:32};function lh(t){lh.j.constructor.call(this),void 0!==t&&(this.data=t)}function M(t){if(xc(this,M),M.j.constructor.call(this,t?t.data:B),this.ea=mh.next(),t){var e="min";Fc(t[e])&&(this.m=t[e]),Fc(t[e="max"])&&(this.s=t[e]),(e="visibility")in t&&(this.u=!!t[e]),(e="volatility")in t&&(this.P=!!t[e]),(e="zIndex")in t&&(this.l=+t[e]||0),(e="provider")in t&&!C(t[e],N)&&(this.ma=t[e],this.ra(kh.ADD))}}jh.Flag=kh,u(lh,F),t("H.map.Feature",lh),lh.prototype.getData=function(){return this.data},lh.prototype.getData=lh.prototype.getData,lh.prototype.o=function(){lh.j.o.call(this),delete this.data},u(M,lh),t("H.map.Object",M);var mh=new cf(1),nh={ANY:31,OVERLAY:1,SPATIAL:2,MARKER:4,DOM_MARKER:8,GROUP:16};function oh(t,e,r){var i,n;if(!r||t[0]|e[0]){var o=t.length,a=e.length,s=yd(o,a),l=1;for(n=+r+1;l<s;l+=n)if(i=t[l]-e[l])return i}return r?0:o-a}function ph(t,e){return t.cj(e)}function qh(t,e,r){if(null===e||e===B)return null;if(0<=Object.keys(e).length&&"[object Object]"!==Object.prototype.toString.call(e))throw Error(vh(t,r));try{return JSON.stringify(e),e}catch(e){throw Error(vh(t,r))}}function vh(t,e){return"Object Remote-Id: "+t.i+" - "+(e?"The value returned by the callback is not a valid JSON object and cannot be set as Feature properties.":"The given object data is not a valid JSON object and cannot be set as Feature properties.")}function wh(t){var e;if(t){var r=xh;for(e=C(t,wh);r--;){var i=yh[r];if(t.hasOwnProperty(i)){var n=t[i];if(e)this[i]=n;else{if((n=zh[r](n))===Ah)throw new D(wh,0,i+": "+t[i]);n!==this[i]&&n!==B&&(this[i]=n)}}}(r=e?t.b:this.lineWidth&&Ze(this.strokeColor))||(this.b=r),(r=e?t.Ob:Ze(this.fillColor))||(this.Ob=r),(r=e?t.a:"none"!==this.strokeColor&&this.lineWidth)||(this.a=r)}qc(this)}M.Type=nh,M.prototype.cb=function(){return this.ea},M.prototype.getId=M.prototype.cb,M.prototype.Ai=function(t){if(!Fc(t)&&!Cc(t))throw new D(this.Ai,0,"id must be a number or a string");return this.i=t,this},M.prototype.setRemoteId=M.prototype.Ai,M.prototype.Rm=function(){return this.i},M.prototype.getRemoteId=M.prototype.Rm,M.prototype.m=-1/0,M.prototype.s=1/0,M.prototype.zj=function(t){var e=this.s;if(t)for(t=this;t=t.Fa;)e=yd(e,t.s);return e},M.prototype.getMax=M.prototype.zj,M.prototype.Bj=function(t){var e=this.m;if(t)for(t=this;t=t.Fa;)e=zd(e,t.m);return e},M.prototype.getMin=M.prototype.Bj,M.prototype.u=!0,M.prototype.qb=function(t){return(t=!!t)!==this.u&&(this.u=t,this.invalidate(kh.VISUAL)),this},M.prototype.setVisibility=M.prototype.qb,M.prototype.wc=function(t){for(var e,r=this;(e=r.u)&&t&&(r=r.Fa););return e},M.prototype.getVisibility=M.prototype.wc,M.prototype.P=!1,M.prototype.Lf=function(t){for(var e,r=this;!(e=r.P)&&t&&(r=r.Fa););return e},M.prototype.getVolatility=M.prototype.Lf,M.prototype.Vk=function(t){var e=this.P;return e!==!!t&&(this.P=!e,this.invalidate(kh.VOLATILITY)),this},M.prototype.setVolatility=M.prototype.Vk,M.prototype.l=B,M.prototype.Ij=function(){return this.l},M.prototype.getZIndex=M.prototype.Ij,M.prototype.fe=function(t){return t!==this.l&&(this.Ye(),this.l=t,this.invalidate(kh.Z_ORDER)),this},M.prototype.setZIndex=M.prototype.fe,M.prototype.L=B,M.prototype.Uc=function(){var t,e,r=this.L;if(!r){var i=+((t=this.l)!==B);(r=this.Fa)?(r=r.Uc().slice())[0]|=i:r=[i],r.push(t||0,0>(e=this.Di)?this.ea:e),this.L=r}return r},M.prototype.getZInfo=M.prototype.Uc,M.prototype.Ye=function(){this.L=B},M.compareZInfo=oh,M.compareZOrder=ph,M.prototype.cj=function(t){return this.T-t.T||oh(this.Uc(),t.Uc(),!1)},M.prototype.compareZOrder=M.prototype.cj,p=M.prototype,p.previousSibling=z,p.nextSibling=z,p.Di=-1,p.Fa=z,p.Fm=function(){return this.Fa},M.prototype.getParentGroup=M.prototype.Fm,M.prototype.bc=function(){for(var t,e=this;t=e.Fa;)e=t;return e},M.prototype.getRootGroup=M.prototype.bc,M.prototype.contains=function(t){return this===t},M.prototype.contains=M.prototype.contains,M.prototype.ka=function(t){if(this.Fa)throw new $c(this.ka,"Not allowed for a child of a group");M.j.ka.call(this,t)},M.prototype.setParentEventTarget=M.prototype.ka,M.prototype.draggable=!1,M.prototype.ma=z,M.prototype.ca=function(){return this.ma},M.prototype.getProvider=M.prototype.ca,M.prototype.ee=function(t,e){var r,i=this.ma;if(r=i!==t){if(e&&(i&&!C(i,N)||t&&!C(t,N)))throw new $c(e,"Only LocalObjectProvider allows an object transfers");e=this.type!==nh.GROUP,i&&(this.invalidate(kh.REMOVE),e&&i.Ga(this)),(this.ma=t)&&(e&&t.fa(this),this.ta=z,this.invalidate(kh.ADD))}return r},M.prototype.ta=z,M.prototype.Kb=function(){return this.ta||(this.ta=new jh)},M.prototype.getInvalidations=M.prototype.Kb,M.prototype.ra=function(t){var e,r=this.ca();return(e=!!r)&&r.invalidateObject(this,t),e},M.prototype.invalidate=M.prototype.ra,M.prototype.o=function(){this.Fa&&this.Fa.Ga(this),M.j.o.call(this)},M.prototype.setData=function(t){return this.data=t,this},M.prototype.setData=M.prototype.setData,M.prototype.Kc=function(t){var e;if(t&&!Da(t))throw new D(M.prototype.Kc,0,"opt_callback must be a function");return t=qh(this,t?t(this.data):this.data,!!t),e=this instanceof rh||this instanceof sh||this instanceof th||this instanceof uh?{type:"Feature",properties:t,geometry:this.ga().Kc()}:{type:"FeatureCollection",features:hf},this.i&&(e.id=this.i),e},M.prototype.toGeoJSON=M.prototype.Kc,M.prototype.Y=function(){return{id:this.ea,properties:{min:this.Bj(),max:this.zj(),zIdx:this.l,sIdx:this.Di,parent:this.Fa?this.Fa.cb():0,visible:this.wc(),volatile:this.Lf()},type:"Feature"}},M.prototype.forWorkerMessage=M.prototype.Y,t("H.map.SpatialStyle",wh),wh.prototype.Ob=!0,wh.prototype.b=!0,wh.prototype.a=!0;var yh="strokeColor fillColor lineWidth lineCap lineJoin miterLimit lineDash lineDashOffset lineDashImage lineHeadCap lineTailCap".split(" ");wh.prototype.strokeColor="rgba(0,85,170,.6)",wh.prototype.strokeColor=wh.prototype.strokeColor,wh.prototype.fillColor="rgba(0,85,170,.4)",wh.prototype.fillColor=wh.prototype.fillColor,wh.prototype.lineWidth=2,wh.prototype.lineWidth=wh.prototype.lineWidth,wh.prototype.lineCap="round",wh.prototype.lineCap=wh.prototype.lineCap,wh.prototype.lineJoin="miter",wh.prototype.lineJoin=wh.prototype.lineJoin,wh.prototype.miterLimit=1,wh.prototype.miterLimit=wh.prototype.miterLimit,wh.prototype.Bn=hf,wh.prototype.lineDash=wh.prototype.Bn,wh.prototype.lineDashOffset=0,wh.prototype.lineDashOffset=wh.prototype.lineDashOffset,wh.prototype.Cn=B,wh.prototype.lineDashImage=wh.prototype.Cn,wh.prototype.Dn=B,wh.prototype.lineHeadCap=wh.prototype.Dn,wh.prototype.En=B,wh.prototype.lineTailCap=wh.prototype.En;var xh=yh.length;wh.prototype.ia=function(t){var e=this===t;if(!e&&t){for(e=0;e<xh;e++){var r=yh[e];if(this[r]!==t[r])break}e=e===xh}return e},wh.prototype.equals=wh.prototype.ia,wh.prototype.vj=function(t){if(t){var e={};Ya(e,this,t)}else e=this;return new wh(e)},wh.prototype.getCopy=wh.prototype.vj;var Ah=qc({}),zh=[function(t){return t?pc(t):Ah},function(t){return t?pc(t):Ah},function(t){return 0<=t&&100>=t?+t:Ah},function(t){return"butt"===(t=pc(t))||"square"===t||"round"===t||"arrow-head"===t||"arrow-tail"===t?t:Ah},function(t){return"round"===t||"bevel"===t||"miter"===t?t:Ah},function(t){return 0<t&&100>=t?+t:Ah},function(t){return t&&t.every&&t.every(Gc)?t:Ah},function(t){return E(+t)?Ah:+t},function(t){return t===B||t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||Object.values(Bh).includes(t)?t:Ah},function(t){return vc(t)?zh[3](t):B},function(t){return vc(t)?zh[3](t):B}],Ch=new Image;Ch.src="data:image/svg+xml;base64,"+btoa('<svg width="128" height="128" viewBox="0 0 128 128" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg"><g id="arrow"><path style="fill:#ff0000" d="M 0,0 32,64 2,128 128,64 Z"/></g></svg> ');var Dh=new Image;Dh.src="data:image/svg+xml;base64,"+btoa('<svg width="128" height="128" viewBox="0 0 128 128" xmlns="http://www.w3.org/2000/svg"><circle style="fill:#ffffff" cx="64" cy="64" r="64" /></svg>');var Bh={ARROW:Ch,CIRCLE:Dh};wh.DashImage=Bh,wh.MAX_LINE_WIDTH=100;var Eh=new wh;wh.DEFAULT_STYLE=Eh;var Fh="fillColor strokeColor lineWidth lineCap lineJoin miterLimit lineDashOffset lineDash lineTailCap lineHeadCap".split(" ");function Gh(t){var e;if(t){var r=C(t,Gh);for(e in t)if(e in this){var i=t[e];i!==this[e]&&("fillColor"===e||0<(i=+i))&&(this[e]=i)}(t=r?t.Ob:!!(Ze(this.fillColor)&&this.width&&this.width))||(this.Ob=t)}qc(this)}function Hh(t,e){var r;Hh.j.constructor.call(this,e),e&&this.gb(e.style),t&&(this.g=!0),e&&(r=e.arrows)&&this.Mk(r)}function Ih(t,e){var r,i=!1,n=!1;if(e.length){for(i=0;i<e.length;i++)if(e[i]!==Jh){n=!0;break}e=t.style,i=n?e.b||e.Ob&&t.g||(r=t.c||!1)&&e.a&&r.Ob:e.Ob}return i&&t.wc(!0)}function Kh(t,e){Kh.j.constructor.call(this,t,e)}function Lh(t,e,r,i){var n,o=[],a=e.length;for(n=0;n<a;n++){var s=e[n];s.length&&o.push(Mh(t,s,r,i))}return o}function Mh(t,e,r,i){var n,o=[],a=e.length,s=0;for(t.xa=0,n=n||0;s<a;)o.push(Nh(t,e[s++],e[s++],n,i));return r&&o.push(Nh(t,e[0],e[1],n,i)),o}function Nh(t,e,r,i,n){var o=t.xa;return o&&180<Dd(o-r)&&(r+=0>o?-360:360),t.xa=r,n.Ah(e,r+i)}function Oh(t,e,r){for(var i,n,o,a=e,s=t.length+e;a--;){for(n=(e=t[a]).length,i=Array(n);n--;)o=e[n],i[n]=new J(o.x+r,o.y);t[--s]=i}}function Ph(t,e,r){this.paths=this.a=t,e!==B&&(this.interiorsIndex=this.b=e),r!==B&&(this.outlinesIndex=this.c=r)}wh.prototype.Y=function(){for(var t,e={},r=Fh.length;r--;)e[t=Fh[r]]=this[t];return e},wh.prototype.forWorkerMessage=wh.prototype.Y,t("H.map.ArrowStyle",Gh),Gh.prototype.Ob=!0,Gh.prototype.fillColor="rgba(255,255,255,.75)",Gh.prototype.width=1.2,Gh.prototype.length=1.6,Gh.prototype.frequency=5,Gh.prototype.uj=function(){return new Gh(this)},Gh.prototype.ia=function(t){var e=this===t;return!e&&t&&(e=t.width===this.width&&t.fillColor===this.fillColor&&t.length===this.length&&t.frequency===this.frequency),e},Gh.prototype.equals=Gh.prototype.ia,u(Hh,M),t("H.map.Spatial",Hh),Hh.prototype.type=nh.SPATIAL,Hh.prototype.T=0,Hh.prototype.style=Eh,Hh.prototype.V=function(){return this.style},Hh.prototype.getStyle=Hh.prototype.V,Hh.prototype.gb=function(t){var e=!0;return t?this.style=C(t,wh)?t:new wh(t):this.style?delete this.style:e=!1,e&&this.invalidate(kh.VISUAL),this},Hh.prototype.setStyle=Hh.prototype.gb,Hh.prototype.Ml=function(){return this.c},Hh.prototype.getArrows=Hh.prototype.Ml,Hh.prototype.Mk=function(t){var e=this.c,r=!1;return!t&&e?(delete this.c,r=!0):!t||e&&e.ia(t)||(this.c=new Gh(t),r=!0),r&&"none"!==this.style.strokeColor&&this.ra(1),this},Hh.prototype.setArrows=Hh.prototype.Mk,Hh.prototype.g=!1,Hh.prototype.sn=function(){return this.g},Hh.prototype.isClosed=Hh.prototype.sn,Hh.prototype.getGeometriesForTile=Hh.prototype.Kd,Hh.prototype.gh=function(){return B},Hh.prototype.getLabels=Hh.prototype.gh,u(Kh,Hh),t("H.map.GeoShape",Kh),Kh.prototype.getBoundingBox=Kh.prototype.K,Ph.prototype.b=Wd,Ph.prototype.interiorsIndex=Ph.prototype.b,Ph.prototype.c=Wd,Ph.prototype.outlinesIndex=Ph.prototype.c;var Jh=rc(new Ph([])),Qh=qc([]),Th;function th(t,e){th.j.constructor.call(this,!1,e),this.da(t)}function Rh(t,e){if(!C(t,L)||2>t.Ie())throw new D(e,0)}function Sh(t,e,r,i){var n=eh(e,r.Hf());if(n.length&&(n=(t=Lh(t,n,!1,e=r.Jf())).length)){var o=r.Le();e=e.w,r.x||Oh(t,n,-e),r.x===(1<<r.z)-1&&Oh(t,n,e),(r=Uf(t,o.left,o.top,o.right,o.bottom,!1)).length&&i.push(new Ph(r))}}function Uh(t,e){if(x.URL)return new x.URL(t,e).toString();if(!t||!Vh(t))return t;if(!e||Vh(e))throw new TypeError("Failed to construct 'URL': Invalid base URL");Th||Ic(Th=document.createElement("a"));var r=Th;return r.href=e,"/"!==t[0]?t=r.href.replace(/\/[^\/]*$/,"/")+t:((e=r.origin)||(e=r.protocol+"//"+r.host),t=e+t),t}function Vh(t){var e=!1;return"string"==typeof t&&(e=!(-1<t.search(/^(http|https|data|blob):/)||"//"===t.substr(0,2))),e}function Wh(t,e){if(Wh.j.constructor.call(this),e&&Vh(e))throw new D(Wh,1,"Base URL must be absolute");this.C=Xh.INIT,this.Ca=null,this.Yb=e}u(th,Kh),t("H.map.Polyline",th),th.prototype.K=function(){return this.a.K()},th.prototype.getBoundingBox=th.prototype.K,th.prototype.da=function(t){var e,r,i=this.da;if(C(t,ih)){var n=t.la;if(!(e=n.length))throw new D(i,0);for(r=0;r<e;r++)Rh(n[r],i)}else Rh(t,i);return this.b=!!n,this.a=t,this.ra(kh.SPATIAL),this},th.prototype.setGeometry=th.prototype.da,th.prototype.ga=function(){return this.a},th.prototype.getGeometry=th.prototype.ga,th.prototype.clip=function(t){var e=this.a;return eh(this.b?e.la[0]:e,t)},th.prototype.clip=th.prototype.clip,th.prototype.Kd=function(t){var e,r=this.a,i=[];if(this.b)for(e=(r=r.la).length;e--;)Sh(this,r[e],t,i);else Sh(this,r,t,i);return i.length?i:B},th.prototype.getGeometriesForTile=th.prototype.Kd,th.prototype.Y=function(){var t=th.j.Y.call(this),e=t.properties;return t.geometry=this.ga().Y(),e.style=this.V().Y(),e.height=0,t},th.prototype.forWorkerMessage=th.prototype.Y,u(Wh,F),t("H.map.render.Style",Wh),Wh.prototype.load=Wh.prototype.load,Wh.prototype.getState=function(){return this.C},Wh.prototype.getState=Wh.prototype.getState,Wh.prototype.O=function(t){this.C=t},Wh.prototype.setState=Wh.prototype.O,Wh.prototype.Ib=function(){return this.Yb},Wh.prototype.getBaseUrl=Wh.prototype.Ib,Wh.prototype.qc=function(){return sc(this.Ca)},Wh.prototype.getConfig=Wh.prototype.qc,Wh.prototype.Tl=function(){return this.Ca},Wh.prototype.getConfigReference=Wh.prototype.Tl,Wh.prototype.vd=function(t){this.Ca=t},Wh.prototype.setConfig=Wh.prototype.vd,Wh.prototype.Gb=function(t){this.Ca=null,this.O(Xh.ERROR),this.sh(Yh)?this.dispatchEvent(new wd(Yh,t,this)):console.error(t)},Wh.prototype.dispatchError=Wh.prototype.Gb,Wh.prototype.o=function(){Wh.j.o.call(this),this.Ca=null};var Yh="error",Zh={ed:"change",Ni:Yh},Xh={ERROR:-1,INIT:0,LOADING:1,READY:2};function $h(t,e){var r,i,n,o=arguments.length;for(r=1;r<o;r++)if((i=arguments[r])&&i!==t&&i!==a){var a=i;for(n in i){var s=i[n];t[n]!==s&&(ai(s)?ai(t[n])?t[n]=$h(t[n],s):t[n]=sc(s):void 0!==s&&(t[n]=sc(s)))}}return t}Wh.State=Xh,t("H.util.webgl.mergeObjects",$h);var bi=oc();function ci(t,e,r){var i=r[t];return e&&i in e&&0>uc.indexOf(i)?(e=e[i],++t<r.length?ci(t,e,r):e):bi}var di=ci.bind(null,0),ei={polygons:1,lines:1,"pattern-lines":1,points:1,text:1,raster:1,custom_icons:1,overlays:1},fi={data:1,draw:1,enabled:1,filter:1,properties:1},gi=Object.keys(fi);function hi(t,e,r,i,n,o){var a=i[t],s=r[a];if(++t<i.length){var l=e[a]||{};for(r=gi.length;r--;){var c=gi[r];if("draw"!==c||!o){var u=s[c];u!==B&&(l[c]=sc(u))}}hi(t,l,s,i,n,o)}else n?l=sc(s):(l=s,delete r[a]);e[a]=e[a]?$h(e[a],l):l}var ii=hi.bind(null,0);function ji(t,e){t in ei&&(e[t]=1)}function ki(t,e,r){var i,n,o;for(i in t)if(fi[i]){if("draw"===i){var a=t[i];for(n in a){var s=a[n];(o=s.style)?(s.style=e+o,ji(o,r)):(delete a[n],a[e+n]=s,ji(n,r))}}}else ki(t[i],e,r)}function li(t,e){var r,i,n,o,a={};if(e+="_",r=(t=$h({},t)).styles)for(i in r){var s=r[i];if(delete r[i],r[e+i]=s,n=s.mix)for(Cc(n)&&(n=[n]),o=n.length;o--;)ji(n[o],a),n[o]=e+n[o];(o=s.base)&&(n||(n=s.mix=[]),n.unshift(e+o),delete s.base,ji(o,a)),ji(i,a)}else r=t.styles={};if(s=t.layers)for(i in s)n=s[i],delete s[i],(o=n.data)&&!o.layer&&(o.layer=i),s[e+i]=n,ki(n,e,a);for(i in a)r[e+i]={base:i};return t}function mi(t,e){var r,i=t.sources,n=Object.keys(i)[0],o=$h(i[n],{uid:e});for(r in i=t.layers,t.sources={},t.sources[e]=o,i)(t=i[r]).data?t.data.source===n&&(t.data.source=e):t.data={source:e}}function ni(t,e){var r,i=t.textures;for(r in t=t.fonts,i){var n=i[r];n.url&&(n.url=Uh(n.url,e))}for(r in t)if(Bc(n=t[r]))for(i=0;i<n.length;i++){var o=n[i];o.url=o.url&&Uh(o.url,e)}else(o=n).url=o.url&&Uh(o.url,e)}function oi(t,e){return"function(){return feature."+t+(e||"")+";}"}function pi(t){return oi("style."+t,void 0)}function qi(t,e,r,i){return t={base:t,blend:e,blend_order:r},i&&(t.clean_depth=!!i),t}function ri(t){var e={};return e["translucent-"+(t?"extruded-":"")+"polygons"]={color:pi("fillColor"),order:1,interactive:!0,extrude:t},e}function si(t,e,r,i){return t={data:{source:t,layer:e}},r&&(t.draw=r),i&&(t.filter=i),t}function ai(t){return Ea(t)&&!Bc(t)}function ti(t,e){if(ti.j.constructor.call(this,t,e),Cc(t))ui.test(t)&&-1===t.indexOf("import:")?(this.b=t,e||(this.g=Vh(this.b)?B:this.b)):this.c=t;else{if(!Ea(t))throw new D(ti,0,"invalid style configuration");this.vd(sc(t))}}function Ai(t){var e,r=t.Ca;if(Ea(r)){var i;if(i=t.f){for(var n in i=!1,r=r&&r.sources)if(r[n].type===t.f){i=!0;break}i=!(!r||i)}i&&(e="invalid source, the only valid type is "+t.f)}else e="invalid style configuration";return e&&t.Gb(e),!e}function yi(t){t.dispatchEvent(new ud("change",t))}function wi(t){if(t.getState()!==Xh.READY)throw new $c(t.Oe,"style is not ready yet")}function xi(t,e,r,i){var n,o,a=[],s=Bc(e)?e:[e];for(void 0===i&&(i=!0),s=s.sort().reverse();n=s.pop();){e=String(n).split(".");for(var l=t.Ca,c=e.length;c--&&!fi[e[c]];);if(l&&0>c&&ai(l=di(l.layers,e))||(l=bi),l===bi)throw new D(r,0,'Unresolvable layer ID "'+n+'"');if(a.push({id:e,eb:l}),i)for(o in l)!fi[o]&&ai(l[o])&&s.push(n+"."+o)}return a}function zi(t,e){var r,i=0;for(r=e.length;i!==r;){var n=e[i++],o=t;if(!(t=o[n]))break}return i===r?{node:t,parent:o,fg:n}:void 0}u(ti,Wh),t("H.map.render.webgl.Style",ti),ti.prototype.load=function(){var t=this,e=this.Ib();this.b?(this.O(Xh.LOADING),new tf("text/plain",this.b).then((function(t){var r={};return vi(t,e,!1,(r[e]=!0,r))})).then((function(e){return t.vd(e)}),(function(e){return t.Gb(e.message)})),delete this.b):this.c&&(this.O(Xh.LOADING),vi(this.c,e).then((function(e){return t.vd(e)}),(function(e){return t.Gb(e.message)})),delete this.c)},ti.prototype.load=ti.prototype.load,ti.prototype.Rk=function(t,e,r){var i;for(wi(this),t=xi(this,t,this.Rk,r),r=0;r<t.length;r++){var n=t[r].eb.draw;for(i in n){var o=n[i];ai(o)&&(o.interactive=!!e)}}yi(this)},ti.prototype.setInteractive=ti.prototype.Rk,ti.prototype.setProperty=function(t,e,r){var i,n=t.split("."),o=0,a=n.length;if(wi(this),!vc(e))throw new D(this.setProperty,1,"value");if(i=zi(this.Ca,n)){if(!(i.parent instanceof Object)||i.parent instanceof Array){if(!r)throw new D(this.setProperty,0,t+" property is not primitive type");n.pop(),n=zi(this.Ca,n),i.parent=n.parent[n.fg]={}}i.parent[i.fg]=e}else{for(i=this.Ca;o!==a-1;)i[n[o]]={},i=i[n[o++]];i[n[o]]=e}Ai(this)&&yi(this)},ti.prototype.setProperty=ti.prototype.setProperty,ti.prototype.kh=function(t){return wi(this),(t=zi(this.Ca,t.split(".")))?sc(t.node):void 0},ti.prototype.getProperty=ti.prototype.kh,ti.prototype.removeProperty=function(t){wi(this),(t=zi(this.Ca,t.split(".")))&&t.parent&&t.parent.hasOwnProperty(t.fg)&&(delete t.parent[t.fg],Ai(this)&&yi(this))},ti.prototype.removeProperty=ti.prototype.removeProperty,ti.prototype.xe=function(t,e,r){var i;wi(this);var n=this.Ca,o=n.layers,a=xi(this,t,this.xe,!1);for(t=a.length,i={};t--;)ii(i,o,a[t].id,!!e,!!r);for(r={},t=(a=Object.keys(n)).length;t--;){var s=a[t],l=n[s];r[s]=l===o?i:sc(l)}return e||yi(this),r},ti.prototype.extractConfig=ti.prototype.xe,ti.prototype.Oe=function(t){if(wi(this),!Ea(t))throw new D(this.Oe,0,"config");this.vd($h(this.Ca,t))},ti.prototype.mergeConfig=ti.prototype.Oe,ti.prototype.a=ba(2),ti.prototype.toString=function(){return this.getState()===Xh.READY?x.H.gl.yaml.safeDump(this.Ca,{lineWidth:120}):""},ti.prototype.o=function(){ti.j.o.call(this),delete this.c,delete this.b};var ui=/^(http[s]?)?.*\.ya?ml/i;function vi(t,e,r,i){r=void 0!==r&&r,i=void 0===i?{}:i;try{var n=x.H.gl.yaml.safeLoad(t,{json:!0})}catch(t){return Promise.reject(t)}return n&&(Cc(t=n.import)&&(t=[t]),r&&e&&Bi(n,e),delete n.import,Bc(t)&&t.length)?(r=t.reduce((function(t,r){var n=e?Uh(r,e):r;return i[n]||(i[n]=!0,t.push(new tf("text/plain",n).then((function(t){return vi(t,n,!0,i)})))),t}),[]),Promise.all(r).then((function(t){var e={};return t.forEach((function(t){return t&&$h(e,t)})),$h(e,n),e}))):Promise.resolve(n)}function Bi(t,e){function r(t){t.url&&(t.url=Uh(t.url,e))}var i=t&&t.fonts;if(i)for(var n in i)Bc(i[n])?i[n].forEach(r):r(i[n]);if(t=t&&t.textures)for(var o in t)r(t[o])}function O(t,e){var r;if(O.j.constructor.call(this),C(t,L,O,0),e!==B&&Bc(e,O,1)){for(r=0;r<e.length;r++)C(e[r],L,O,1,"index "+r);this.a=e}else this.a=[];this.b=t,this.c=[]}function Ci(t){var e=O,r=L,i=t.c,n=t.a,o=t.f,a=t.b;return n=[i,n,B,i,a,B,o,a,B,o,n,B],180<=t.Ab()&&(n.splice(9,0,o,t=t.bb().lng,B),n.splice(3,0,i,t,B)),new e(new r(n))}ti.normalize=Bi,ti.prototype.vd=function(t){ti.j.vd.call(this,t),Ai(this)&&(this.O(Xh.READY),yi(this))},ti.prototype.qc=function(){return ti.j.qc.call(this)},ti.prototype.getConfig=ti.prototype.qc,ti.prototype.Ib=function(){return this.g||ti.j.Ib.call(this)},ti.prototype.getBaseUrl=ti.prototype.Ib,t("H.map.Style",ti),ti.State=Xh,u(O,jg),t("H.geo.Polygon",O),O.fromRect=Ci;var Di={NORTH:90,SOUTH:-90};function Ei(t,e){var r,i,n;return(n=t.K())&&((r=t.eh(!0))&&(i=t.Ie())&&(n=n.ec(tg([t.ye(0),t.ye(i-1)],!0),!0)),360===n.Ab()&&1==r%2&&(n=n.Xc(e,0))),n}function Fi(t,e,r,i){i=void 0===i||i;var n=t.a,o=Gi.bind(null,e,r);return!(ee(e,r,t.b.$,0,!0,3)===de.NONE||i&&n.some(o))}function Gi(t,e,r){return ee(t,e,r.$,0,!0,3)===de.SURFACE}function Hi(t,e){e=e.$,t=t.b.$;var r,i,n=e.length-3,o=t.length-3,a={};for(r=0;r<n;r+=3){var s=e[r],l=e[r+1],c=e[r+3],u=e[r+4];for(i=0;i<o;i+=3){var h=t[i],p=t[i+1],f=t[i+3],d=t[i+4];if(ag(new Yf(l,s),new Yf(u,c),new Yf(p,h),new Yf(d,f),a,!0))return!0}}return!1}function Ii(t,e){var r=e.b,i=e.a,n=i.length,o=r.$,a=o.length,s=t.b.$,l=s.length;if(Hi(t,r))return!0;for(r=0;r<a;r+=3)if(Fi(t,o[r],o[r+1]))return!0;for(r=0;r<l;r+=3)if(Fi(e,s[r],s[r+1]))return!0;for(r=0;r<n;r++)if(Hi(t,i[r]))return!0;return!1}function Ji(t){Ji.j.constructor.call(this,t)}function uh(t,e){var r=e&&(+e.extrusion||+e.extrude)||0,i=e&&+e.elevation||0,n=0;if(uh.j.constructor.call(this,!0,e),0<i&&(n+=i,this.b=i),0<r&&(n+=r,this.f=r),2047<n)throw new ne(uh,n,[0,2047]);C(t,L)?this.da(new O(t)):this.da(t)}O.Direction=Di,O.prototype.pd=Di.NORTH,O.prototype.Sk=function(t){return this.pd!==t&&(this.f=z,this.c.length=0,this.pd=t),this},O.prototype.setPoleCovering=O.prototype.Sk,O.prototype.Km=function(){return this.pd},O.prototype.getPoleCovering=O.prototype.Km,O.prototype.fm=function(){return this.b},O.prototype.getExterior=O.prototype.fm,O.prototype.Pk=function(t){if(!C(t,L))throw new D(this.Pk,0,t);this.b=t,this.f=z},O.prototype.setExterior=O.prototype.Pk,O.prototype.rm=function(){return this.a},O.prototype.getInteriors=O.prototype.rm,O.prototype.xg=function(t,e,r){var i,n=arguments.length;for(i=2;i<n;i++)C(arguments[i],L,this.xg,i);var o=this.a.splice.apply(this.a,arguments);for(i=2;i<n;i++)arguments[i]=B;return this.c.splice.apply(this.c,arguments),o},O.prototype.spliceInteriors=O.prototype.xg,O.prototype.no=function(t){return this.xg(t,1)[0]},O.prototype.removeInteriorAt=O.prototype.no,O.prototype.mo=function(t){return 0>(t=this.a.indexOf(t))?B:this.xg(t,1)[0]},O.prototype.removeInterior=O.prototype.mo,O.prototype.Bk=function(t){if(!C(t,L))throw new D(this.Bk,0,t);this.a.push(t)},O.prototype.pushInterior=O.prototype.Bk,O.prototype.K=function(){var t=this.f;return t||(this.f=t=Ei(this.b,this.pd)),t},O.prototype.getBoundingBox=O.prototype.K,p=O.prototype,p.tj=function(t){var e=this.a.length;if(0>t||t>=e)throw new ne(this.tj,t,[0,e-1]);return(e=this.c[t])||(this.c[t]=e=Ei(this.a[t],this.pd)),e},p.rb="Polygon",p.cd=function(t){var e,r=this.a,i=r.length;if(this.b.Ie()){for(t.push("("),this.b.cd(t,!0),e=0;e<i;e++)r[e].Ie()&&(t.push(","),r[e].cd(t,!0));t.push(")")}else t.push("EMPTY");return t},p.Hb="Polygon",p.bd=function(){var t,e=[],r=this.a,i=this.b.bd();for(i[0].toString()!==i[i.length-1].toString()&&i.push(i[0]),e.push(i),t=0;t<r.length;t++)(i=r[t].bd())[0].toString()!==i[i.length-1].toString()&&i.push(i[0]),e.push(i);return e},p.Y=function(){var t=O.j.Y.call(this);return this.K().Bb()&&(t.type="Multi"+t.type),t},p.pc=function(){var t=[],e=this.a,r=e.length;for(t.push(this.b.pc());r--;)t[r+1]=e[r].pc();return this.K().Bb()?[t]:t},p.ia=function(t){var e=!1;if(C(t,O)){var r=t.a,i=this.a.length;e=r.length;var n=0;for(e=this.b.ia(t.b)&&i===e;e&&n<i;)e=e&&this.a[n].ia(r[n]),n++}return e},O.prototype.equals=O.prototype.ia,u(Ji,gh),t("H.geo.MultiPolygon",Ji),Ji.prototype.b=function(t){return C(t,O)},Ji.prototype.rb="Multi"+O.prototype.rb,Ji.prototype.Hb="Multi"+O.prototype.Hb,u(uh,Kh),t("H.map.Polygon",uh);var Ki=new O(new L([0,0,0,0,0,0,0,0,0]));function Li(t,e,r,i){var n,o,a=0,s=!0;if(n=Mi(t,e.b,r,i,e.K())){var l=new Ph(n),c=e.a;if(o=c.length)for(l.b=l.a.length;a<o;a++)(n=Mi(t,c[a],r,i,e.tj(a)))&&(l.a=l.a.concat(n));for(o=l.a.length,a=0;a<o;a++)if(l.a[a]!==Qh){s=!1;break}s&&(l=a%2?Jh:B)}return l}function Mi(t,e,r,i,n){var o,a=r.Le(),s=n,l=s.Ab(),c=[[]],u=e.$,h=[],p=u.length,f=!1;for(o=0;o<p;o+=3){var d=u[o],y=u[o+1];f||180!=Dd(y)||(h.push(d),h.push(y),h.push(d),h.push(-y),f=!0),h.push(d),h.push(y)}if(u=h,360>l&&-180==s.a&&(s=new K(s.c,180,s.f,s.b)),360>l&&180==s.b&&(s=new K(s.c,s.a,s.f,-180)),s.Bb()){for(d=(l=u).length,u=-1,h=0;h<d-2;h+=2)if(ig(l[h+1],l[h+3])){u=h+2;break}-1===u&&ig(l[d-1],l[1])&&(u=d),-1!==u&&(p=l[u-2],h=l[u-1],o=l[u%d],f=l[(u+1)%d],180!==Dd(p)&&180!==Dd(o)&&(y=Dd(o-p),d=Dd(f-h),d+=180<d?-360:0,f=Dd(180-f),f+=180<f?-360:0,d&&f&&(y/=Dd(d)/Dd(f),p=o+(o>p?-y:y),h=0<h?180:-180,l.splice(u,0,p,h,p,-h)))),u=l}if(c[0]=Ni(u.concat(),s.a),360>s.Ab()&&s.gd(new kg(s.c,180))&&(u=Ni(u.concat(),s.b),c.push(u)),t=Lh(t,c,!0,s=r.Jf()),360===n.Ab()&&1==e.eh(!0)%2){for(e=t,t=r.Le(),e[0][1].x>e[0][e[0].length-1].x&&(e[0]=e[0].reverse()),u=[],l=e[0].length-1,c=0;c<l;c++)h=e[0][c],u[c]=new J(h.x-2*s.w,h.y),u[c+l]=new J(h.x-s.w,h.y),u[c+2*l]=new J(h.x,h.y),u[c+3*l]=new J(h.x+s.w,h.y),u[c+4*l]=new J(h.x+2*s.w,h.y);e[0]=u,(c=s.Ah(i,0)).y=2*t[i===Di.NORTH?"top":"bottom"],i=c.clone(),c.x=e[0][e[0].length-1].x+1,i.x=e[0][0].x-1,e[0].push(c,i),t=e}if(Uf(t,i=a.left,e=a.top,c=a.right,a=a.bottom,!0).length){if(!r.Hf().Qg(n)){for(r=t,n=[new J(i,e),new J(c,e),new J(c,a),new J(i,a)],a=[],t=r.length;t--;)if(i=Wf(n,r[t]))for(e=Oi(i),a.push(e);i.Uh;)e=Oi(i=i.Uh),a.push(e);t=a}}else r=Pi(i,e,t[0]),t[1]&&(r=r!==Pi(i,e,t[1])),t=r?[Qh]:B;return t}function Pi(t,e,r){var i,n,o,a=i=r[0].x,s=n=r[0].y,l=1;for(o=r.length;l<o;l++){var c=r[l].x,u=r[l].y;c>i?i=c:c<a&&(a=c),u>n?n=u:u<s&&(s=u)}return a<=t&&t<=i&&s<=e&&e<=n&&fe({x:t,y:e},ge(r.concat(r[0])))}function Oi(t){var e=[],r=t;do{var i=Ad(100*(r.eo?r.eo:r.x))/100,n=Ad(100*(r.fo?r.fo:r.y))/100;if(!o||.01<Fd(Gd(o.x-i,2)+Gd(o.y-n,2))){var o=new J(i,n);e.push(o)}r=r.next}while(r&&r!==t);return e}function Ni(t,e){var r,i=Number.POSITIVE_INFINITY,n=-1,o=t.length;for(r=0;r<o;r+=2){var a=Dd(t[r+1]-e);(a+=180<a?360-a:a)<i&&(i=a,n=r)}return 0<r?(e=t.splice(n,t.length-n)).concat(t):t}function Qi(t,e,r){Qi.j.constructor.call(this,Ki,r),this.tg(t),this.zi(e),r&&"precision"in r&&this.yi(r.precision)}function Ri(t){t.a!==z&&Qi.j.da.call(t,Si(t))}function Si(t){var e=t.R,r=e.lat,i=t.wa,n=0,o=new L;if(90===Dd(r))for(r=e.zg(0,i,!0).lat;360>n;n+=120)o.gi(r,n-180,B);else for(t=360/(t=t.D);360>n;n+=t)o.qd(e.zg(n,i,!0));return e=new O(o),0>r&&e.Sk(Di.SOUTH),e}function Ti(t,e){if(!C(t,Element)){if(Ui.innerHTML=t,!(t=Ui.firstElementChild))throw new D(Ti,0,"No element data");Ui.removeChild(t);var r=!0;Ui.innerHTML=""}this.a=0!==kf(t).length,this.f=r?t:lf(t,x.document,this.a),e&&((r="onAttach")in e&&zc(t=e[r],"Function",Ti,1,r)&&(this.Vh=t),(r="onDetach")in e&&zc(t=e[r],"Function",Ti,1,r)&&(this.b=t))}uh.prototype.f=0,uh.prototype.b=0,uh.prototype.a=Ki,uh.MAX_EXTRUDE_HEIGHT=2047,uh.prototype.pi=function(t){var e=+t;if(e!==t)throw new D(this.pi,0,t);if(0>e||2047<this.b+e)throw new ne(this.pi,this.b+e,[0,2047]);this.f=e,this.ra(kh.SPATIAL)},uh.prototype.setExtrusion=uh.prototype.pi,uh.prototype.gm=function(){return this.f},uh.prototype.getExtrusion=uh.prototype.gm,uh.prototype.oi=function(t){var e=+t;if(e!==t)throw new D(this.oi,0,t);if(0>e||2047<this.f+e)throw new ne(this.oi,this.f+e,[0,2047]);this.b=e,this.ra(kh.SPATIAL)},uh.prototype.setElevation=uh.prototype.oi,uh.prototype.bm=function(){return this.b},uh.prototype.getElevation=uh.prototype.bm,uh.prototype.ga=function(){return this.a},uh.prototype.getGeometry=uh.prototype.ga,uh.prototype.da=function(t){if(C(t,O))var e=!1;else C(t,Ji,this.da,0),e=!0;return this.J=e,e=this.a,this.a=t,e!==Ki&&this.ra(kh.SPATIAL),this},uh.prototype.setGeometry=uh.prototype.da,uh.prototype.K=function(){return this.ga().K()},uh.prototype.getBoundingBox=uh.prototype.K,uh.prototype.Kd=function(t){var e,r,i,n=this.ga();if(this.J){var o=0;for(i=(n=n.la).length;o<i;o++)(r=Li(this,n[o],t,n[o].pd))&&(e||(e=[]),e.push(r))}else(r=this.ab)===B&&(r=this.J?Di.NORTH:this.ga().pd),(r=Li(this,n,t,r))&&(e=[r]);return e},uh.prototype.getGeometriesForTile=uh.prototype.Kd,uh.prototype.aa=z,uh.prototype.Y=function(){var t,e=uh.j.Y.call(this),r=this.ga(),i=this.J?r.la:[r],n=e.properties,o=e.geometry=r.Y();if(n.style=this.V().Y(),n.height=this.f+this.b,n.min_height=this.b,this.K().Bb()&&(o.type="MultiPolygon",this.J)){var a=[];i.forEach((function(e,r){t=o.coordinates[r],e.K().Bb()?a=a.concat(t):a.push(t)})),o.coordinates=a}return e},uh.prototype.forWorkerMessage=uh.prototype.Y,u(Qi,uh),t("H.map.Circle",Qi),Qi.prototype.tg=function(t){(t=ng(t)).ia(this.R)||(this.R=t,Ri(this))},Qi.prototype.setCenter=Qi.prototype.tg,Qi.prototype.bb=function(){return this.R},Qi.prototype.getCenter=Qi.prototype.bb,Qi.prototype.zi=function(t){if(E(t=ae(t,0,6371000.79*Pd/2)))throw new D(this.zi,0,t);this.wa!==t&&(this.wa=t,Ri(this))},Qi.prototype.setRadius=Qi.prototype.zi,Qi.prototype.Qm=function(){return this.wa},Qi.prototype.getRadius=Qi.prototype.Qm,Qi.prototype.D=60,Qi.prototype.yi=function(t){if(!Fc(t))throw new D(this.yi,0,t);this.D!==(t=ae(Ad(t),4,360))&&(this.D=t,Ri(this))},Qi.prototype.setPrecision=Qi.prototype.yi,Qi.prototype.Nm=function(){return this.D},Qi.prototype.getPrecision=Qi.prototype.Nm,Qi.prototype.da=function(){return this},Qi.prototype.setGeometry=Qi.prototype.da,Qi.prototype.ga=function(){return this.a===Ki&&Qi.j.da.call(this,Si(this)),this.a},Qi.prototype.getGeometry=Qi.prototype.ga,t("H.map.DomIcon",Ti);var Ui=document.createElement("DIV");function Vi(t){Vi.j.constructor.call(this,t)}function Wi(t,e){this.w=+t,this.h=+e}function Xi(t,e){var r,i=t,n=e||[];if(t!==Yi.NONE){if(e=r=n.length,-1===Zi.indexOf(i))throw new D(Xi,0,t);if(!n)throw new D(Xi,1,n);for(;r--;)if(E(n[r]))throw new D(Xi,1,n);if(i===Yi.RECT&&3<e&&(n=[n[0],n[1],n[2],n[1],n[2],n[3],n[0],n[3]],i=Yi.POLYGON),i===Yi.CIRCLE&&2<e&&0<(t=n[2])){i=n[0];var o=n[1],a=360/(r=yd(2*Cd(t),40));for(n=[];r--;){var s=a*r*Ud;n.push(i+Id(s)*t,o+Kd(s)*t)}i=Yi.POLYGON}if(i!==Yi.POLYGON||!e||n.length%2)throw new D(Xi,1,n);this.a=n}}Ti.prototype.Vh=null,Ti.prototype.b=null,Ti.prototype.uj=function(t){return lf(this.f,t,this.a)},Ti.prototype.a=!1,u(Vi,gh),t("H.geo.MultiPoint",Vi),Vi.prototype.b=function(t){return lg(t)},Vi.prototype.c=function(t){return C(t,kg)?t:ng(t)},Vi.prototype.rb="Multi"+kg.prototype.rb,Vi.prototype.Hb="Multi"+kg.prototype.Hb,t("H.math.Size",Wi),t("H.map.HitArea",Xi);var Yi={NONE:0,RECT:1,CIRCLE:2,POLYGON:3};Xi.ShapeType=Yi;var Zi=[Yi.RECT,Yi.CIRCLE,Yi.POLYGON];function rh(t,e){var r;xc(this,rh),rh.j.constructor.call(this,e),this.da(t),e&&"icon"in e&&(r=e.icon),this.Ic(r||$i(this))}function $i(t){var e=t.c;return e||(e=t.constructor.prototype.c=t.b(aj)),e}Xi.prototype.Of=function(t,e,r){return this.a?ee(t,e,this.a,r,!0):de.NONE},Xi.prototype.hitTest=Xi.prototype.Of,u(rh,M),t("H.map.AbstractMarker",rh),rh.prototype.ga=function(){return this.a},rh.prototype.getGeometry=rh.prototype.ga,rh.prototype.da=function(t){var e=this.a;return C(t,kg)||C(t,Vi)?this.a=t:(lg(t,this.da,0),this.a=ng(t)),e&&this.ra(kh.SPATIAL),this},rh.prototype.setGeometry=rh.prototype.da,rh.prototype.K=function(){return this.a.K()},rh.prototype.xb=function(){return this.icon},rh.prototype.getIcon=rh.prototype.xb,rh.prototype.Ic=function(t){var e=this.icon,r=!e;if(e!==t){if(!this.Uj(t)){if(r)throw new D(this.constructor,1,t);throw new D(this.Ic,0,t)}this.icon=t,r||this.ra(kh.VISUAL)}return this},rh.prototype.setIcon=rh.prototype.Ic;var aj={svg:'<svg xmlns="http://www.w3.org/2000/svg" width="38" height="47" viewBox="0 0 38 47"><g fill="none"><path fill="#0F1621" fill-opacity=".4" d="M15 46c0 .317 1.79.574 4 .574s4-.257 4-.574c0-.317-1.79-.574-4-.574s-4 .257-4 .574z"></path><path fill="#01b6b2" d="M33.25 31.652A19.015 19.015 0 0 0 38 19.06C38 8.549 29.478 0 19 0S0 8.55 0 19.059c0 4.823 1.795 9.233 4.75 12.593L18.975 46 33.25 31.652z"></path><path fill="#6A6D74" fill-opacity=".5" d="M26.862 37.5l4.714-4.77c3.822-3.576 5.924-8.411 5.924-13.62C37.5 8.847 29.2.5 19 .5S.5 8.848.5 19.11c0 5.209 2.102 10.044 5.919 13.614l4.719 4.776h15.724zM19 0c10.493 0 19 8.525 19 19.041 0 5.507-2.348 10.454-6.079 13.932L19 46 6.079 32.973C2.348 29.495 0 24.548 0 19.04 0 8.525 8.507 0 19 0z"></path></g></svg>',size:new Wi(38,47),anchor:new J(19,45),hitArea:new Xi(Yi.POLYGON,[19,46,2,27,0,18,5,6,19,0,32,5,38,15,36,27,19,47])};function bj(t,e){bj.j.constructor.call(this,t,e)}function cj(t,e,r){cj.j.constructor.call(this,t),this.oldValue=r,this.newValue=e}function dj(t,e,r,i){dj.j.constructor.call(this,t,e,r),this.modifiers=i}rh.prototype.Y=function(){var t=rh.j.Y.call(this),e=this.xb(),r=e.yb(),i=e.kd();return t.geometry=this.ga().Y(),r&&((e=t.properties.icon={id:e.uid}).size={w:r.w,h:r.h},e.offset=[r.w/2-(i?i.x:0),r.h/2-(i?i.y:0)]),t},rh.prototype.forWorkerMessage=rh.prototype.Y,u(bj,rh),t("H.map.DomMarker",bj),bj.prototype.type=nh.DOM_MARKER,bj.prototype.T=2,bj.prototype.b=function(t){var e=new Ti(t.svg,t);return t=t.anchor,e.f.style.margin=-t.y+"px 0 0 -"+t.x+"px",e},bj.prototype.Uj=function(t){return C(t,Ti)},u(cj,ud),t("H.util.ChangeEvent",cj),u(dj,cj),t("H.map.ChangeEvent",dj);var ej={SIZE:1,POSITION:2,HEADING:4,TILT:8,INCLINE:16,ZOOM:32,BOUNDS:64};function fj(){this.a=[],fj.j.constructor.call(this)}function gj(t,e,r){if(t=t.a.length,r)var i=t;else if(E(i=0>(i=+e)?zd(0,t+i):yd(t,i)))throw new ne(fj,e,[0,t-1]);return i}function ij(t,e){var r=t.a.splice(e,1)[0];return t.dispatchEvent(new hj(t,t.A.je,e,null,r,null)),r}function hj(t,e,r,i,n,o){hj.j.constructor.call(this,e,t),this.idx=r,this.added=i,this.removed=n,this.moved=o}function jj(){}function kj(t){return yd(1,zd(0,.5-Ed(Ld(Rd+Qd*t/180))/Pd/2))}function lj(t){return 0>=t?90:1<=t?-90:Vd*(2*Md(Hd(Pd*(1-2*t)))-Qd)}dj.Type=ej,dj.prototype.ll=ej.SIZE,dj.prototype.SIZE=dj.prototype.ll,dj.prototype.Ui=ej.POSITION,dj.prototype.POSITION=dj.prototype.Ui,dj.prototype.Oi=ej.HEADING,dj.prototype.HEADING=dj.prototype.Oi,dj.prototype.Wi=ej.TILT,dj.prototype.TILT=dj.prototype.Wi,dj.prototype.Pi=ej.INCLINE,dj.prototype.INCLINE=dj.prototype.Pi,dj.prototype.Xi=ej.ZOOM,dj.prototype.ZOOM=dj.prototype.Xi,dj.prototype.Mi=ej.BOUNDS,dj.prototype.BOUNDS=dj.prototype.Mi,u(fj,F),t("H.util.OList",fj),fj.prototype.add=function(t,e){e=gj(this,e,E(e)),this.a.splice(e,0,t),this.dispatchEvent(new hj(this,this.A.he,e,t,null,null))},fj.prototype.add=fj.prototype.add,fj.prototype.hc=function(t){return this.get(t),ij(this,t)},fj.prototype.removeAt=fj.prototype.hc,fj.prototype.remove=function(t){return 0<=(t=this.indexOf(t))&&(ij(this,t),!0)},fj.prototype.remove=fj.prototype.remove,fj.prototype.set=function(t,e){if(0!==this.a.length||0!==t){this.get(t),t=gj(this,t,!1);var r=this.a[t]}return this.a[t]=e,this.dispatchEvent(new hj(this,this.A.ke,t,e,r,null)),r},fj.prototype.set=fj.prototype.set,fj.prototype.indexOf=function(t){return this.a.indexOf(t)},fj.prototype.indexOf=fj.prototype.indexOf,fj.prototype.get=function(t){var e=gj(this,t,!1),r=this.a;if(e>=r.length)throw new ne(this.get,t,[0,r.length-1]);return r[e]},fj.prototype.get=fj.prototype.get,fj.prototype.ym=function(){return this.a.length},fj.prototype.getLength=fj.prototype.ym,fj.prototype.La=function(){return this.a.concat()},fj.prototype.asArray=fj.prototype.La,fj.prototype.flush=function(){for(var t=this.a.length;t--;)ij(this,t)},fj.prototype.flush=fj.prototype.flush,fj.prototype.o=function(){this.flush(),fj.j.o.call(this)},fj.prototype.A={he:"add",je:"remove",ke:"set",Xo:"move"},u(hj,ud),fj.Event=hj,jj.prototype.Tf=function(t,e,r){return r?(r.x=e/360+.5,r.y=kj(t)):r=new J(e/360+.5,kj(t)),r},jj.prototype.latLngToPoint=jj.prototype.Tf,jj.prototype.Pc=function(t,e){return this.Tf(t.lat,t.lng,e)},jj.prototype.geoToPoint=jj.prototype.Pc,jj.prototype.Ra=function(t,e,r){return r?(r.lat=lj(e),r.lng=360*(1===t?1:Zd(t,1))-180):r=new kg(lj(e),360*(1===t?1:Zd(t,1))-180),r},jj.prototype.xyToGeo=jj.prototype.Ra,jj.prototype.dg=function(t,e){return this.Ra(t.x,t.y,e)},jj.prototype.pointToGeo=jj.prototype.dg;var mj=new jj;function nj(t,e){this.projection=t||mj,this.b=0,this.a=this.exp=Ed(e||256)/Od,oj(this),this.y=this.x=0}t("H.geo.mercator",mj),t("H.util.constants.DEFAULT_MIN_ZOOM_LEVEL",0),t("H.util.constants.DEFAULT_MAX_ZOOM_LEVEL",22),t("H.geo.PixelProjection",nj);var pj=Dd(24)+Dd(-8);function oj(t){t.a>pj&&(t.a=pj),t.w=Gd(2,t.a),t.h=Gd(2,t.a)}function qj(t){t=t||{},qj.j.constructor.call(this),this.min=0,this.max=22,this.yl=this.dark=!!t.dark,t.min&&this.ui(t.min),t.max&&this.si(t.max),this.pixelProjection=new nj(t.projection,t.minWorldSize),t.provider&&(this.ma=t.provider,this.Va=A(this.Va,this),this.ma.addEventListener(P.prototype.A.za,this.Va,!1,this),this.hb=A(this.hb,this),this.ma.addEventListener(P.prototype.A.ie,this.hb,!1,this))}function rj(t,e,r){var i=t[e],n="min"===e,o=n?t.ui:t.si;if(r!==i){if(!(n?r<=t.max:r>=t.min))throw new D(o,0,"Invalid condition min <= max");t[e]=r,t.Va(),t.hb(),t.dispatchEvent(new cj(n?t.A.Ti:t.A.Si,r,i))}return t}function sj(t){var e;if(sj.j.constructor.call(this),this.dispatchEvent=A(this.dispatchEvent,this),t){var r=t.length;for(e=0;e<r;e++)this.add(t[e])}}function tj(t,e){var r=e.getProvider&&e.getProvider();r&&(uj[r.uid]=r),e.ka(t)}function vj(t){var e=t.getProvider&&t.getProvider();e&&delete uj[e.uid],t.ka(null)}nj.prototype.eg=mj,nj.prototype.projection=nj.prototype.eg,nj.prototype.x=0,nj.prototype.x=nj.prototype.x,nj.prototype.y=0,nj.prototype.y=nj.prototype.y,nj.prototype.Oo=Gd(2,pj),nj.prototype.w=nj.prototype.Oo,nj.prototype.ln=Gd(2,pj),nj.prototype.h=nj.prototype.ln,nj.prototype.Oa=function(t){if(E(t))throw new D(this.Oa,0,t);var e=this.x/this.w,r=this.y/this.h;this.b=t,this.a=this.exp+t,oj(this),this.x=e*this.w,this.y=r*this.h},nj.prototype.rescale=nj.prototype.Oa,nj.prototype.Jj=function(){return this.b||0},nj.prototype.getZoomScale=nj.prototype.Jj,nj.prototype.ib=function(t,e){return(t=this.projection.Tf(t.lat,t.lng,e)).x=t.x*this.w-this.x,t.y=t.y*this.h-this.y,t},nj.prototype.geoToPixel=nj.prototype.ib,nj.prototype.Re=function(t,e){return this.projection.Ra((t.x+this.x)/this.w,(t.y+this.y)/this.h,e)},nj.prototype.pixelToGeo=nj.prototype.Re,nj.prototype.Ra=function(t,e,r){return this.projection.Ra((t+this.x)/this.w,(e+this.y)/this.h,r)},nj.prototype.xyToGeo=nj.prototype.Ra,nj.prototype.Ah=function(t,e,r){return(t=this.projection.Tf(t,e,r)).x=t.x*this.w-this.x,t.y=t.y*this.h-this.y,t},nj.prototype.latLngToPixel=nj.prototype.Ah,nj.prototype.Zd=function(t){return new J(t.x*this.w-this.x,t.y*this.h-this.y)},nj.prototype.pointToPixel=nj.prototype.Zd,u(qj,F),t("H.map.layer.Layer",qj),qj.prototype.min=0,qj.prototype.min=qj.prototype.min,qj.prototype.max=22,qj.prototype.max=qj.prototype.max,qj.prototype.A={za:"update",ie:"configchange",Ti:"minchange",Si:"maxchange"},qj.prototype.ca=function(){return this.ma},qj.prototype.getProvider=qj.prototype.ca,qj.prototype.un=function(t){return this.min<=t&&t<=this.max},qj.prototype.isValid=qj.prototype.un,qj.prototype.ui=function(t){return rj(this,"min",+t)},qj.prototype.setMin=qj.prototype.ui,qj.prototype.si=function(t){return rj(this,"max",+t)},qj.prototype.setMax=qj.prototype.si,qj.prototype.Va=function(){this.dispatchEvent(this.A.za)},qj.prototype.hb=function(t){t=new cj(this.A.ie,t&&t.newValue,t&&t.oldValue),this.dispatchEvent(t)},qj.prototype.o=function(){qj.j.o.call(this)},qj.prototype.ba=function(){return null},qj.prototype.getCopyrights=qj.prototype.ba,u(sj,fj),t("H.map.DataModel",sj),sj.prototype.add=function(t,e){C(t,qj,this.add,0),tj(this,t),sj.j.add.call(this,t,e)},sj.prototype.add=sj.prototype.add,sj.prototype.set=function(t,e){return C(e,qj,this.set,0),tj(this,e),(t=sj.j.set.call(this,t,e))&&vj(t),t},sj.prototype.set=sj.prototype.set,sj.prototype.hc=function(t){var e;return(e=sj.j.hc.call(this,t))&&vj(e),e},sj.prototype.removeAt=sj.prototype.hc,sj.prototype.remove=function(t){var e;return(e=sj.j.remove.call(this,t))&&vj(t),e},sj.prototype.remove=sj.prototype.remove,sj.prototype.flush=function(){for(var t=this.a.length;t--;)this.hc(t);sj.j.flush.call(this)},sj.prototype.flush=sj.prototype.flush;var uj={};function wj(t,e,r){if(t=uj[t])return C(t[e],Function,wj,1,"invalid method"),t[e].apply(t,r)}function xj(t,e){Da(t)&&(this.i=t),Fc(e)&&(this.a=e)}Ic(uj),sj.invoke=wj,t("H.util.Request",xj),xj.State={PENDING:0,PROCESSING:1,COMPLETE:2,CANCELLED:3,ERROR:4};var yj=[0,1,2,3,4],Ej;function zj(t,e){t.b<t.a&&(vc(e)||(e=2),0===e||1===e||0!==t.C&&1!==t.C||(t.b++,2!==e&&t.g++,t.O(t.b<t.a?1:2)))}function Aj(){}function Bj(t,e){var r=t.N(),i=r.ownerDocument;Bj.j.constructor.call(this),this.a=t,this.S=r=r.appendChild(Cj(i,"DIV","position:absolute;bottom:0;right:0;left:0px;z-index:1;direction:ltr;pointer-events:none;height:40px-webkit-touch-callout: none;-webkit-user-select:none;-khtml-user-select: none;-moz-user-select: none;-ms-user-select: none;user-select:none;",null,"H_imprint")),this.qf=Cj(i,"DIV","margin: 0 0 16px 16px;display:inline-block;",'<svg height="40" viewBox="0 0 47 40" width="47" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="m45.2054149 8.82876345.6003191.40637037-.2240425.6914074-.4490426 1.38570368c-.1024468.3148889-.6998936 1.9596297-2.43 3.5918519l-.017234.0163704c-.188617.1887407-.3801064.3659259-.5467021.5084444l-.4605319.4285185-.486383.4516296-.1407447-.0702963c-.7257447.4583704-1.4926596.7886667-2.2796809.9831852l.5840426.5864445-.6769149.6817778-2.052766 2.0636296-.169468.1704444-.019149.0192593-2.3821276 2.3958518c-.4902128.8493334-1.1202128 1.6331852-1.8497873 2.3111112-.6031915.6047407-1.2504255 1.1054814-1.935 1.4954814l-.4777659.4805186-4.3247873 4.3506666-.0296808.0298519-.0315958.0269629-2.1532978 1.8171111-.2661702.2253334h-.3485107-3.8948936l-3.968617 3.9914815-1.3547873 1.3616296-.6769148.6808148-.6769149-.6808148-1.3538298-1.3616296-4.80925535-4.837926-3.2687234-3.2875555-1.63436171-1.6437778h2.3112766 4.62255319 2.67223407l-4.71063832-4.7368148-.6769149-.6808148.6769149-.6808148 4.93851062-4.9650371.6769149-.6798518.6769149.6808148 2.7296809 2.7454074c.9363829-.8820741 2.1485106-1.4685185 3.4037234-1.6562963.278617-1.4694815 1.0187234-2.834963 2.168617-3.9885926.5696808-.572 1.1843617-1.0438519 1.8335106-1.4107407l.2901064-.2917778 4.3094681-4.31985187c.5830851-1.0582963 1.4256383-1.78918519 2.0364893-2.12718519l.4471277-.24748148c.3829787-.7617037.9047872-1.47622222 1.5539362-2.12622222 1.510851-1.51666667 3.3165957-2.31881482 5.22-2.31881482.0871276 0 .1752127.00192593.2594681.00577778 1.9484042.06933334 3.8441489.97933334 5.4775532 2.62792593.1512765.15022222.3303191.34859259.5361702.5797037l.0526595.05874074c.1120213.12518519.2345745.26192593.370532.40733334l1.2657446 1.36066666.6328724.67985185-.6548936.65866667-.2508511.25325926zm-27.9288192 22.17414815h-9.57446804l4.78723404 4.8148148zm23.1864894-21.70422223c-.9220213 1.38666663-2.5180851 3.63037033-4.1984042 1.94133333l4.2510638-4.27651851c-.3810638-.41022222-.6711702-.754-.8923404-.97740741-2.2921277-2.31207407-4.8743617-2.34192593-6.8984043-.312-1.3528723 1.35681481-1.7071277 2.91007407-1.313617 4.38533332l-1.332766-1.52629628c-.385851.21474074-2.0182979 1.65918518-.7937234 3.84703708l-1.5252127-1.274963-2.0240426 2.0299259 2.7344681 2.7502222c-2.1121277-1.6861481-4.3889362-1.5205185-6.2157447.312-1.9560638 1.9615556-1.8181915 4.3381482-.3532979 6.293926l-.295851-.2946667c-1.9321277-1.9432593-4.0318085-1.2576296-5.0706383-.2128148-.8023405.8079259-1.2944681 1.9191852-1.0924468 2.6905185l-4.195532-4.2187407-2.22893613 2.2408148 8.25893613 8.3065185h4.4339362l-2.9767021-2.9938519c-.5893908-.6029568-.9604155-1.0987731-1.1531529-1.5232627-.3182349-.7008886-.1504161-1.2073234.3230465-1.680515.7334043-.7318519 1.583617-.2763704 3.0829787 1.2277777l2.9412766 2.9562963 2.2164894-2.2292592-2.7909575-2.8060741c2.0125532 1.5291852 4.4224468 1.612 6.5728724-.545037 1.3567021-1.2653334 1.7425532-2.4565185 1.7425532-2.4565185l-1.6755319-1.1314815c-.9229788 1.3866666-2.5152128 3.6361481-4.195532 1.9461481l4.2606383-4.2851852 2.655 2.6712593 2.3160639-2.3294074-3.3223405-3.3424445c-1.5520212-1.5609629-.6328723-3.0275555.0124469-3.5793333.3025531.6442222.7448936 1.2624445 1.3078723 1.8296296 2.1485106 2.1676297 4.9260638 2.6038519 7.3685106.1550371 1.3567022-1.2643704 1.7425532-2.4565185 1.7425532-2.4565185zm-3.6564894-1.35537321-2.0211702 2.03377777c-.9890425-1.18251851-.9392553-1.81422222-.3245744-2.43051851.7439361-.7462963 1.4993617-.43044445 2.3457446.39674074zm-12.4879787 12.56088884c-.9890425-1.1825185-.9411702-1.819037-.3284042-2.4353333.7448936-.7462963 1.5003191-.4304444 2.3467021.3967408z" fill="#0f1621" fill-opacity=".7"/><path d="m17.2765957 31.0029116-4.787234 4.8148148-4.78723404-4.8148148zm23.1864894-21.70422223 1.6755319 1.13148153s-.385851 1.1921481-1.7425532 2.4565185c-2.4424468 2.4488148-5.22 2.0125926-7.3685106-.1550371-.5629787-.5671851-1.0053192-1.1854074-1.3078723-1.8296296-.6453192.5517778-1.5644681 2.0183704-.0124469 3.5793333l3.3223405 3.3424445-2.3160639 2.3294074-2.655-2.6712593-4.2606383 4.2851852c1.6803192 1.69 3.2725532-.5594815 4.195532-1.9461481l1.6755319 1.1314815s-.3858511 1.1911851-1.7425532 2.4565185c-2.1504256 2.157037-4.5603192 2.0742222-6.5728724.545037l2.7909575 2.8060741-2.2164894 2.2292592-2.9412766-2.9562963c-1.4993617-1.5041481-2.3495744-1.9596296-3.0829787-1.2277777-.4734626.4731916-.6412814.9796264-.3230465 1.680515.1927374.4244896.5637621.9203059 1.1531529 1.5232627l2.9767021 2.9938519h-4.4339362l-8.25893613-8.3065185 2.22893613-2.2408148 4.195532 4.2187407c-.2020213-.7713333.2901063-1.8825926 1.0924468-2.6905185 1.0388298-1.0448148 3.1385106-1.7304445 5.0706383.2128148l.295851.2946667c-1.4648936-1.9557778-1.6027659-4.3323704.3532979-6.293926 1.8268085-1.8325185 4.103617-1.9981481 6.2157447-.312l-2.7344681-2.7502222 2.0240426-2.0299259 1.5252127 1.274963c-1.2245745-2.1878519.4078724-3.63229634.7937234-3.84703708l1.332766 1.52629628c-.3935107-1.47525925-.0392553-3.02851851 1.313617-4.38533332 2.0240426-2.02992593 4.6062766-2.00007407 6.8984043.312.2211702.22340741.5112766.56718519.8923404.97740741l-4.2510638 4.27651851c1.6803191 1.689037 3.2763829-.5546667 4.1984042-1.94133333zm-16.1444681 11.20551563 2.0182979-2.0385925c-.846383-.8271852-1.6018085-1.1430371-2.3467021-.3967408-.612766.6162963-.6606383 1.2528148.3284042 2.4353333zm12.4879787-12.56088884c-.8463829-.82718519-1.6018085-1.14303704-2.3457446-.39674074-.6146809.61629629-.6644681 1.248.3245744 2.43051851z" fill="#fff" fill-opacity=".3"/></g></svg>',"H_logo"),r.appendChild(this.qf),r=r.appendChild(Cj(i,"DIV","right:0;bottom:0;position:absolute;background-color:rgba(255,255,255,.8);color:#0F1621;padding:2px 16px",null,"H_copyright")),this.i=r.appendChild(Cj(i,"A","color:inherit; margin:0px 8px; text-decoration:none; pointer-events:all;","Terms of use")),this.i.target="_blank",this.g=r.appendChild(Cj(i,"SPAN","margin:0px 8px")),this.c=r.appendChild(Cj(i,"SPAN")),this.s=Wa(Dj),this.vi(e),this.f=A(this.f,this),this.b=A(this.b,this),this.a.addEventListener(this.a.A.Ri,this.f),this.a.a.addEventListener("add",this.b),this.a.a.addEventListener("remove",this.b),this.a.a.addEventListener("set",this.b),this.b()}xj.prototype.C=0,xj.prototype.getState=function(){return this.C},xj.prototype.getState=xj.prototype.getState,xj.prototype.O=function(t){if(0>yj.indexOf(t))throw new D(this.O,0,t);(this.C!==t||1===t&&1<this.a)&&(this.C=t,this.i&&this.i(this))},xj.prototype.a=1,xj.prototype.cn=function(){return this.a},xj.prototype.getTotal=xj.prototype.cn,xj.prototype.b=0,xj.prototype.Om=function(){return this.b},xj.prototype.getProcessed=xj.prototype.Om,xj.prototype.g=0,xj.prototype.hm=function(){return this.g},xj.prototype.getFailed=xj.prototype.hm,xj.prototype.oe=function(){},xj.prototype.cancel=function(){3!==this.C&&(this.oe(),this.O(3))},xj.prototype.cancel=xj.prototype.cancel,t("H.util.ICapturable",Aj),Aj.prototype.capture=function(){},Aj.prototype.capture=Aj.prototype.capture,t("H.util.Disposable",qd),qd.prototype.tb=qd.prototype.tb,qd.prototype.addOnDisposeCallback=qd.prototype.tb,t("H.util.dispose",td),qd.prototype.F=qd.prototype.F,qd.prototype.dispose=qd.prototype.F,qd.prototype.o=qd.prototype.o,qd.prototype.disposeInternal=qd.prototype.o,u(Bj,qd),t("H.map.Imprint",Bj);var Dj={font:'11px "Lucida Grande", Arial, Helvetica, sans-serif',href:"https://legal.here.com/{LN}/terms/serviceterms/{CN}",invert:!1,reportHref:"https://wego.here.com/",locale:"en-US",mark:""};function Cj(t,e,r,i,n){return t=t.createElement(e),r&&(t.style.cssText=r),i&&(t.innerHTML=i),n&&(t.className=n),t}Bj.prototype.vi=function(t){var e,r=this.qf.firstElementChild.firstElementChild.children;t||(this.s=Wa(Dj));var i=this.s;for(e in i)t&&e in t&&(i[e]=t[e]);t=(this.wh=t=i.invert)?Fj:Gj,r[0].style.fill=t.Wk,r[0].style.fillOpacity=""+t.Xk,r[1].style.fill=t.al,r[1].style.fillOpacity=""+t.bl,t=i.locale,Hj[t]||(t="en-US",i.locale=t),this.i.innerHTML=Hj[t],t=t.split("-"),this.i.href=i.href.replace("{LN}",t[0]).replace("{CN}",t[1].toLowerCase()),i.mark?(this.c.innerHTML=i.mark,this.c.style.margin="0px 8px"):(this.c.innerHTML="",this.c.style.margin="0px"),this.S.style.font=i.font},Bj.prototype.setOptions=Bj.prototype.vi,Bj.prototype.N=function(){return this.S},Bj.prototype.f=function(){this.g.innerHTML=this.l+" "+this.ba()},Bj.prototype.b=function(){this.f(),setTimeout(this.f,5e3)};var Gj={al:"#0F1621",bl:.3,Wk:"#fff",Xk:.6},Fj={al:"#fff",bl:1,Wk:"#0F1621",Xk:.7},Ij="1987&ndash;"+zd(2015,(new Date).getFullYear())+" HERE";function Jj(t,e,r,i){Kj(A((function(t){t?this.wh?r("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAeCAYAAABe3VzdAAADNklEQVRYR82XW6hVVRSGv7+rmJfSMKSnSkMEfY7EogcJC7tilGRopBAiSaI+SBARQSCIIqgFISih2YW0oAgLCsKXojA0RB+81VugZEFZv/yHuWTt7d7Hfc4+6+h4OWefNfcc3xlj/v+YS1zjoab5bE8DZgGngB8keSg5GwO0PQ54F3i2BnQIWCLpx14hGwG0fT3wOfBwB5DzwOOSDvQC2RTgM8Ae4D/gaeA3YDdwN5AWvyxp+6gD2r4OmAq8AbwInAMmA/OAT4CbgBWStvYClzUjWkHbrwHLgF8LVHJ8DDxah7P9JHCil7M40oA/A7OBC8ANtSqlrQOVs30/8CWQat8r6cxg1RwRQNvPA88Bk4D7gJzBV4A5teSp5MlS4VuA/ZIeu1Kr+wa0/QTwIRDlRhT5eTswBvi2CKOd42AULilndNAYCcA7gK+BmbVMiyXtsh3Qt4FFBTgW8w6wXtLfV4LrSyS2FwAvAWOBX+JtwF0laUDmS/oun23fDNwJnJb0Ty9g1ZphVdB2qrK2LdFfBbb685/AIxXkUKDqa4cMaDs2kjalRe8Fola57J3qRQSJviGHA3gMuAdYI2lDUfDOArQLWAd8VTuTOW9vjUoFy6TIGYpS9wKfAjuK5wVuSfn91iKcvZJeHy5ci0hsZwzNk5Qh3xIFbLyks7aPAtPLgv+L4VZwDwLvA6uKz6XdfcVAi22PBz4q4+lVSRurXW2vKYKIZfwEHCmmXC35HngAyITYD0ys2t8XWflyBfhmvKm24QCk7aVFCPVc7WMszzKucknI+NoHPCUppt13VICZm2nNwjoksByY0SXL72Vi3FieZ97mgrpyqF432H9xScW2O0H+W6oSE/4D2FYuA9kzlUzVTwO3Ad9IOtx3ydo2aLGZLpABm5KW2Z4AfAbMLfsEcpGkKLqRuMwHu0CukrSpCCrvGlF6hBEVL5MUw24kOhp1B8gc+FTqgxpkFLuzSbjk6jpJOkC2tDPeKCkVbDRkO67fDTTC2VK7vgfyBUlfNEpV2zyAK4HNXRLmZfshScdHC6g9T+WDGU2XpkdZdNXhWs6g7dXAhmsJ7jKR2M77bG4kV7Wt9TZfBLgYEC7PSpcIAAAAAElFTkSuQmCC"):r("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAeCAYAAABe3VzdAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAOxAAADsQBlSsOGwAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAIMSURBVFiFzdZPiE1RGADwXzPTTPIMQoodVpbKgpoUG5qExUi8DSVJQv4slJJsbNjYWFhNETWLUUosRDRLUVLCYhIiojFojHkW997uvefNGIuZc99Xp/fOO6/Or++c75xDi0d7hDlWYQNqeB9hvv+OGq6jUWjPsKZKVBbtuKOMy9p3bKqOlsROCWYc27AWr9PfJnCgKlgbluNqivmGDmzBrxR3sCocnMEw7sqXdEAzboeK9uLTFPVbed8VcesxglFJtqNEHbcxlIL68ChADuCSpEgauBULt11SDI3C5yJJdrLCCNsQumMBl+J5AKinY4slBfNTfsRcxJwYsK0YxD3J0r1RPut6Cv/twgp0xoDBBc3LNhr0RwJktNifAn7gsnLmsuxVinyVTn4i7dcLoH4sU96Tp2Pi2uSVehN75Gdev+QO7pIXztmZnLwTvf+AzU+/v5Rn50+A24gP2IW5M4mbJ7+ejgVjJ/EpHXuCa8p77nGK68FX5eWfsTgfTJoh92qu1vAaa+CtPJuDZuEh3CHZUyHyxSSYrL3DWKE/gStm8aybDDkmKYperJM/BrJMnsJuHMLq2YJNh/wsX7JuPAyQfTFg0yGPFMZreCCv4n2xgTQjxyXP+CxquK8iXBYhMlzOtliQBVg4RVuCG/iSto/YHAuWxWFTHyXDWBkbNFkc1cK4LI5rYVwW57QY7i/pZeJv8QQJRQAAAABJRU5ErkJggg=="):((t=this.qf.cloneNode(!0)).firstChild.setAttribute("style","font:"+e),r(bf(t.innerHTML)))}),t),i)}function Kj(t,e){var r="data:image/svg+xml;charset=utf-8,"+encodeURIComponent('<svg height="40" viewBox="0 0 47 40" width="47" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="m45.2054149 8.82876345.6003191.40637037-.2240425.6914074-.4490426 1.38570368c-.1024468.3148889-.6998936 1.9596297-2.43 3.5918519l-.017234.0163704c-.188617.1887407-.3801064.3659259-.5467021.5084444l-.4605319.4285185-.486383.4516296-.1407447-.0702963c-.7257447.4583704-1.4926596.7886667-2.2796809.9831852l.5840426.5864445-.6769149.6817778-2.052766 2.0636296-.169468.1704444-.019149.0192593-2.3821276 2.3958518c-.4902128.8493334-1.1202128 1.6331852-1.8497873 2.3111112-.6031915.6047407-1.2504255 1.1054814-1.935 1.4954814l-.4777659.4805186-4.3247873 4.3506666-.0296808.0298519-.0315958.0269629-2.1532978 1.8171111-.2661702.2253334h-.3485107-3.8948936l-3.968617 3.9914815-1.3547873 1.3616296-.6769148.6808148-.6769149-.6808148-1.3538298-1.3616296-4.80925535-4.837926-3.2687234-3.2875555-1.63436171-1.6437778h2.3112766 4.62255319 2.67223407l-4.71063832-4.7368148-.6769149-.6808148.6769149-.6808148 4.93851062-4.9650371.6769149-.6798518.6769149.6808148 2.7296809 2.7454074c.9363829-.8820741 2.1485106-1.4685185 3.4037234-1.6562963.278617-1.4694815 1.0187234-2.834963 2.168617-3.9885926.5696808-.572 1.1843617-1.0438519 1.8335106-1.4107407l.2901064-.2917778 4.3094681-4.31985187c.5830851-1.0582963 1.4256383-1.78918519 2.0364893-2.12718519l.4471277-.24748148c.3829787-.7617037.9047872-1.47622222 1.5539362-2.12622222 1.510851-1.51666667 3.3165957-2.31881482 5.22-2.31881482.0871276 0 .1752127.00192593.2594681.00577778 1.9484042.06933334 3.8441489.97933334 5.4775532 2.62792593.1512765.15022222.3303191.34859259.5361702.5797037l.0526595.05874074c.1120213.12518519.2345745.26192593.370532.40733334l1.2657446 1.36066666.6328724.67985185-.6548936.65866667-.2508511.25325926zm-27.9288192 22.17414815h-9.57446804l4.78723404 4.8148148zm23.1864894-21.70422223c-.9220213 1.38666663-2.5180851 3.63037033-4.1984042 1.94133333l4.2510638-4.27651851c-.3810638-.41022222-.6711702-.754-.8923404-.97740741-2.2921277-2.31207407-4.8743617-2.34192593-6.8984043-.312-1.3528723 1.35681481-1.7071277 2.91007407-1.313617 4.38533332l-1.332766-1.52629628c-.385851.21474074-2.0182979 1.65918518-.7937234 3.84703708l-1.5252127-1.274963-2.0240426 2.0299259 2.7344681 2.7502222c-2.1121277-1.6861481-4.3889362-1.5205185-6.2157447.312-1.9560638 1.9615556-1.8181915 4.3381482-.3532979 6.293926l-.295851-.2946667c-1.9321277-1.9432593-4.0318085-1.2576296-5.0706383-.2128148-.8023405.8079259-1.2944681 1.9191852-1.0924468 2.6905185l-4.195532-4.2187407-2.22893613 2.2408148 8.25893613 8.3065185h4.4339362l-2.9767021-2.9938519c-.5893908-.6029568-.9604155-1.0987731-1.1531529-1.5232627-.3182349-.7008886-.1504161-1.2073234.3230465-1.680515.7334043-.7318519 1.583617-.2763704 3.0829787 1.2277777l2.9412766 2.9562963 2.2164894-2.2292592-2.7909575-2.8060741c2.0125532 1.5291852 4.4224468 1.612 6.5728724-.545037 1.3567021-1.2653334 1.7425532-2.4565185 1.7425532-2.4565185l-1.6755319-1.1314815c-.9229788 1.3866666-2.5152128 3.6361481-4.195532 1.9461481l4.2606383-4.2851852 2.655 2.6712593 2.3160639-2.3294074-3.3223405-3.3424445c-1.5520212-1.5609629-.6328723-3.0275555.0124469-3.5793333.3025531.6442222.7448936 1.2624445 1.3078723 1.8296296 2.1485106 2.1676297 4.9260638 2.6038519 7.3685106.1550371 1.3567022-1.2643704 1.7425532-2.4565185 1.7425532-2.4565185zm-3.6564894-1.35537321-2.0211702 2.03377777c-.9890425-1.18251851-.9392553-1.81422222-.3245744-2.43051851.7439361-.7462963 1.4993617-.43044445 2.3457446.39674074zm-12.4879787 12.56088884c-.9890425-1.1825185-.9411702-1.819037-.3284042-2.4353333.7448936-.7462963 1.5003191-.4304444 2.3467021.3967408z" fill="#0f1621" fill-opacity=".7"/><path d="m17.2765957 31.0029116-4.787234 4.8148148-4.78723404-4.8148148zm23.1864894-21.70422223 1.6755319 1.13148153s-.385851 1.1921481-1.7425532 2.4565185c-2.4424468 2.4488148-5.22 2.0125926-7.3685106-.1550371-.5629787-.5671851-1.0053192-1.1854074-1.3078723-1.8296296-.6453192.5517778-1.5644681 2.0183704-.0124469 3.5793333l3.3223405 3.3424445-2.3160639 2.3294074-2.655-2.6712593-4.2606383 4.2851852c1.6803192 1.69 3.2725532-.5594815 4.195532-1.9461481l1.6755319 1.1314815s-.3858511 1.1911851-1.7425532 2.4565185c-2.1504256 2.157037-4.5603192 2.0742222-6.5728724.545037l2.7909575 2.8060741-2.2164894 2.2292592-2.9412766-2.9562963c-1.4993617-1.5041481-2.3495744-1.9596296-3.0829787-1.2277777-.4734626.4731916-.6412814.9796264-.3230465 1.680515.1927374.4244896.5637621.9203059 1.1531529 1.5232627l2.9767021 2.9938519h-4.4339362l-8.25893613-8.3065185 2.22893613-2.2408148 4.195532 4.2187407c-.2020213-.7713333.2901063-1.8825926 1.0924468-2.6905185 1.0388298-1.0448148 3.1385106-1.7304445 5.0706383.2128148l.295851.2946667c-1.4648936-1.9557778-1.6027659-4.3323704.3532979-6.293926 1.8268085-1.8325185 4.103617-1.9981481 6.2157447-.312l-2.7344681-2.7502222 2.0240426-2.0299259 1.5252127 1.274963c-1.2245745-2.1878519.4078724-3.63229634.7937234-3.84703708l1.332766 1.52629628c-.3935107-1.47525925-.0392553-3.02851851 1.313617-4.38533332 2.0240426-2.02992593 4.6062766-2.00007407 6.8984043.312.2211702.22340741.5112766.56718519.8923404.97740741l-4.2510638 4.27651851c1.6803191 1.689037 3.2763829-.5546667 4.1984042-1.94133333zm-16.1444681 11.20551563 2.0182979-2.0385925c-.846383-.8271852-1.6018085-1.1430371-2.3467021-.3967408-.612766.6162963-.6606383 1.2528148.3284042 2.4353333zm12.4879787-12.56088884c-.8463829-.82718519-1.6018085-1.14303704-2.3457446-.39674074-.6146809.61629629-.6644681 1.248.3245744 2.43051851z" fill="#fff" fill-opacity=".3"/></g></svg>'),i=Ej;vc(i)?t(i):new tf("image",r).then((function(e){Ye.drawImage(e,0,0);try{Ye.getImageData(0,0,1,1),i=!1}catch(t){i=18===t.code}finally{Ej=i,t(i)}}),e)}Bj.prototype.ba=function(){var t,e,r,i=this.a,n=i.pb(),o=i.c.jb().bounds,a=(i=i.a).a.length,s={},l=0,c=[Ij];if(o)for(;l<a;l++)if(e=i.get(l).getCopyrights(o.K(),n))for(t=0;t<e.length;t++)s[r=e[t].label]||(c.push(r),s[r]=1);return c.join(", ")},Bj.prototype.getCopyrights=Bj.prototype.ba,Bj.prototype.V=function(){return this.S.style},Bj.prototype.l=String.fromCharCode(169),Bj.prototype.o=function(){if(this.a.removeEventListener(this.a.A.Ri,this.f),this.a.a.removeEventListener("add",this.b),this.a.a.removeEventListener("remove",this.b),this.a.a.removeEventListener("set",this.b),this.S.parentNode){var t=this.S;t.parentNode.removeChild(t)}},Bj.prototype.disposeInternal=Bj.prototype.o,Bj.prototype.capture=function(t,e,r,i){var n,o=t.getContext("2d"),a=window.getComputedStyle(this.g.parentElement),s=2*Dc(a.paddingLeft,10),l=(this.g.offsetWidth+2*s)*e,c=this.g.offsetHeight*e,u=0!==this.c.innerHTML.length?this.c.offsetWidth*e:0,h=Ec(a.getPropertyValue("font-size")),p=this.S.ownerDocument,f=+t.width,d=+t.height,y=16*e,g=this.qf.childNodes[0].getBoundingClientRect(),v=g.width*e,m=g.height*e,_=ld;Da(i)&&(_=function(){i("capture_error")}),o.fillStyle=a.backgroundColor,o.fillRect(f-l-u,d-c,l+u,c),l=this.c.innerHTML,l=this.l+" "+((n=Cj(p,"div",null,n=this.ba())).textContent||n.innerText||"")+(l?" "+l:""),o.font=h*e+"px "+a.getPropertyValue("font-family"),o.fillStyle=a.getPropertyValue("color"),o.textBaseline="bottom",o.textAlign="right",o.fillText(l,f-s*e,d),Jj(this,o.font,(function(e){new tf("image",e).then((function(e){o.drawImage(e,y,d-(m+y),v,m),r(t)}),_)}),_)},Bj.prototype.capture=Bj.prototype.capture,Bj.prototype.wh=!1,Bj.prototype.nl=function(t,e){Hj[t]=e},Bj.prototype.addL11NString=Bj.prototype.nl;var Hj={"de-DE":"Nutzungsbedingungen","en-US":"Terms of use","en-GB":"Terms of use","es-ES":"Condiciones de uso","fi-FI":"Palveluehdot","fr-FR":"Conditions d'utilisation","it-IT":"Condizioni di utilizzo","nl-NL":"Dienstvoorwaarden","pl-PL":"Warunki wiadczenia usugi","pt-BR":"Termos de servio","pt-PT":"Termos do servio","ru-RU":" ","tr-TR":"Servis Koullar","zh-CN":""};function R(t){var e={};this.f=e.previousSibling=e.nextSibling=e,this.g=new cf,R.j.constructor.call(this,t),t&&"objects"in t&&this.Xb(t.objects)}function Lj(t,e,r){t.ee(r.ma)}function Mj(t){t.Ye()}function Nj(t,e,r){t.ra(r.c)}function Oj(t){this.push(t)}function Pj(t,e){for(var r,i,n=0,o=e.length,a=[];n<o;n++)i=(r=e[n])instanceof R?{type:"GeometryCollection",geometries:Pj(t,r.Ua())}:r instanceof rh||r instanceof sh||r instanceof th||r instanceof uh?r.ga().Kc():{type:"FeatureCollection",features:hf},a.push(i);return a}u(R,M),t("H.map.Group",R),R.prototype.type=nh.GROUP,R.prototype.ee=function(t,e){return this.b=!0,t=R.j.ee.call(this,t,e),this.b=!1,t&&this.forEach(Lj,!0),t},R.prototype.setProvider=R.prototype.ee,R.prototype.contains=function(t){var e=this===t;if(!e&&this.a&&C(t,M))for(;!e&&t;)t===this?e=!0:t=t.Fa;return e},R.prototype.contains=R.prototype.contains,R.prototype.Ye=function(){this.L=B,this.forEach(Mj,!0)},R.prototype.resetZInfo=R.prototype.Ye,R.prototype.b=!1,R.prototype.ra=function(t){var e=R.j.ra.call(this,t);return e&&!this.b&&(this.c=t,this.forEach(Nj,!0),delete this.c),e},R.prototype.invalidate=R.prototype.ra,R.prototype.forEach=function(t,e,r){var i;if(this.a){var n=this.f,o=n.nextSibling;for(i=0;o!==n;){var a=o.nextSibling;t.call(r,o,i++,this),e&&C(o,R)&&o.forEach(t,e,r),o=a}}},R.prototype.forEach=R.prototype.forEach,R.prototype.Ua=function(t){var e=[];return this.forEach(Oj,t,e),e},R.prototype.getObjects=R.prototype.Ua,R.prototype.K=function(){var t=null;return this.a&&this.forEach((function(e){e.K&&(e=e.K())&&(t=t?t.ec(e):e)})),t},R.prototype.getBoundingBox=R.prototype.K,R.prototype.a=0,R.prototype.Rl=function(){return this.a},R.prototype.getChildCount=R.prototype.Rl,R.prototype.fa=function(t){var e=this.f,r=e.previousSibling;if(C(t,M,this.fa,0),t.contains(this))throw new $c(this.fa,"The new object contains the parent group");var i=t.Lf(!0),n=t.Fa;if(n!==this){if(n){n=t.previousSibling;var o=t.nextSibling;n.nextSibling=o,o.previousSibling=n}t.Fa=this,M.j.ka.call(t,this),r.nextSibling=t,t.previousSibling=r,t.nextSibling=e,e.previousSibling=t,this.a++}return t.Di=this.g.next(),t.Ye(),e=t.ee(this.ma,this.fa),t.Lf(!0)!==i&&t.ra(kh.VOLATILITY),e||t.ra(kh.Z_ORDER),t},R.prototype.addObject=R.prototype.fa,R.prototype.Xb=function(t){var e;Bc(t,this.Xb,0);var r=t.length;for(e=0;e<r;e++)this.fa(t[e])},R.prototype.addObjects=R.prototype.Xb,R.prototype.Ga=function(t){if(!t||t.Fa!==this)throw new $c(this.Ga,"object not found");var e=t.previousSibling,r=t.nextSibling;return e.nextSibling=r,r.previousSibling=e,t.Fa=null,M.j.ka.call(t,null),delete t.previousSibling,delete t.nextSibling,C(t.ma,N)&&t.ee(null,this.Ga),this.a--,t},R.prototype.removeObject=R.prototype.Ga,R.prototype.rd=function(t){var e;Bc(t,this.rd,0);var r=t.length;for(e=0;e<r;e++)this.Ga(t[e])},R.prototype.removeObjects=R.prototype.rd,R.prototype.na=function(){var t=this.Ua();this.rd(t)},R.prototype.removeAll=R.prototype.na,R.prototype.Kc=function(t){for(var e,r,i,n=this.Ua(),o=0,a=n.length,s=[];o<a;o++)(i=n[o])instanceof R?(r=qh(this,e=t?t(i.getData()):i.getData(),!!t),(e={type:"Feature"}).properties=r,i.i&&(e.id=i.i),e.geometry={},e.geometry.type="GeometryCollection",e.geometry.geometries=Pj(this,i.Ua()),s.push(e)):s.push(i.Kc(t));return{type:"FeatureCollection",features:s}},R.prototype.toGeoJSON=R.prototype.Kc,R.prototype.Y=function(){var t=R.j.Y.call(this);return t.type="Group",t},R.prototype.forWorkerMessage=R.prototype.Y;var Qj={PROVIDES_BY_VIEWPORT:1,PROVIDES_RASTERS:2,PROVIDES_SPATIALS:4,PROVIDES_OVERLAYS:8,PROVIDES_MARKERS:16,PROVIDES_DOM_MARKERS:32,PROVIDES_GEOJSON:64,PROVIDES_OMV:128,CROP_LINES_BY_TILE:256,CROP_POLYGONS_BY_TILE:512,HAS_VOLATILE_DATA:1024};function Rj(t,e,r,i,n){switch(e&&(this.f=e),vc(r)&&(this.c=!!r),this.c&&i&&(this.Lg=new Wi(i.w,i.h)),vc(n)&&(this.g={crossOrigin:n}),Sj[Ac(t)]){case 2:this.a=t,Tj(this,1);break;case 1:if(nf(t)){this.a=t,Uj(this),Tj(this,1);break}t=t.src;case 0:if(t){t=bf(t),this.b=new tf("image",t,B,this.g),this.b.then(A(this.$n,this),A(this.Zn,this));break}default:throw Tj(this,-1),new D(Rj,0,"No image data")}}function Tj(t,e){t.C=e,delete t.b,t.f&&t.f(e,t)}function Uj(t){if(t.c){var e=t.a,r=Vj(t),i=r&&r.w||+e.width,n=r&&r.h||+e.height,o=Ue();if(C(e,x.HTMLCanvasElement))r=e;else{(r=e.ownerDocument.createElement("canvas")).width=Cd(i*o),r.height=Cd(n*o);var a=r.getContext("2d");a.scale(o,o),a.drawImage(e,0,0,i,n),cd&&(a.clearRect(0,0,i,n),a.drawImage(e,0,0,i,n))}t.a=r}}t("H.map.provider.Capabilities",Qj),Qj.PROVIDES_WEBGL_RENDERABLE_OBJECTS=Qj.PROVIDES_SPATIALS|Qj.PROVIDES_OVERLAYS|Qj.PROVIDES_MARKERS,Rj.prototype.C=0,Rj.prototype.getState=function(){return this.C},Rj.prototype.c=!0,Rj.prototype.getData=function(){return this.a||z};var Sj={String:0,HTMLImageElement:1,HTMLCanvasElement:2};function Vj(t){var e,r=t.Lg;if(!r){var i=t.a;if(0===(r=i.naturalWidth||i.width)&&$e&&1===Sj[Ac(i)]){var n=!0;if(e=i.parentNode)var o=i.nextSibling;document.body.appendChild(i)}t.Lg=r=new Wi(i.naturalWidth||i.width,i.naturalHeight||i.height),n&&(e?e.insertBefore(i,o):document.body.removeChild(i))}return r}function Wj(t,e){var r,i="anonymous";if(this.uid=Xj.next(),Wj.j.constructor.call(this),e){var n="size";if(n in e){var o=e[n];if(!o||isNaN(o.w)||isNaN(o.h))throw new D(Wj,1,n);this.g=new Wi(o.w,o.h)}if((n="anchor")in e){if(!(o=e[n])||isNaN(o.x)||isNaN(o.y))throw new D(Wj,1,n);this.f=new J(o.x,o.y)}(n="hitArea")in e&&(C(o=e[n],Xi,Wj,1),this.c=e[n]),(n="asCanvas")in e&&(r=e[n]),(n="crossOrigin")in e&&(i=e[n]),(o=e.stickHeight)===+o&&0<o&&(this.Fo=o),o=e[n="stickColor"],n in e&&Cc(o)&&(this.Eo=o)}t=new Rj(t,A(this.i,this),r,this.g,i),0!==(e=this.C=t.getState())?this.i(e,t):this.b=t}p=Rj.prototype,p.Lg=z,p.yb=function(){return 1===this.C?Vj(this):z},p.$n=function(t){this.a=t,Uj(this),Tj(this,1)},p.Zn=function(){Tj(this,-1)},p.cancel=function(){this.b&&this.b.cancel()},u(Wj,F),t("H.map.Icon",Wj);var Xj=new cf;function Yj(t,e,r,i,n,o){Yj.j.constructor.call(this,isNaN(t)?15:t,e,r,i,n,o)}function Zj(t,e,r,i,n){var o=e.entries;if(n)if(e.a)o=ak(t,e,r,i,n);else if(o){var a=Eg(e,+((o=o[0])[1]>=e[8])|+(o[0]>=e[9])<<1);a.entries=e.entries,delete e.entries,o.node=a,Bg(t,a),o=ak(t,e,r,i,n)}else Fg(e,o=new bk(r,i)),Bg(t,e),zg(t,o,!0);else o||Bg(t,e),Fg(e,o=new bk(r,i)),zg(t,o,!0);return o}function ak(t,e,r,i,n){return Zj(t,Eg(e,+(r>=e[8])|+(i>=e[9])<<1),r,i,n-1)}function bk(t,e){this.id=Dg++,this[0]=e,this[1]=t}function ck(){this.a=new Yj(10,180,90,0,0,!0)}function dk(t){this.a=t}function ek(t,e,r){this.c=t,this.a=e,this.g=r,this.f=this.c&Qj.PROVIDES_BY_VIEWPORT?"function(){return sources[$source].isInMinMaxRange(feature, $zoom) && feature.ref.effectiveVisibility;}":B,this.b={}}function fk(t,e,r,i){this.a=t,this.b=e,this.c=r,this.kf=i}function gk(t,e,r,i){return t={type:e,uid:t.b,tiled:r,max_zoom:t.c},i&&Ya(t,i),t}function hk(t,e,r,i,n){this.a=t,this.b=e,this.c=r,this.f=i,this.kf=n}function ik(t){if(t.a&Qj.PROVIDES_DOM_MARKERS&&!(t.a&Qj.PROVIDES_MARKERS))return{};var e=new fk(t.a,t.b,t.c,t.kf),r=new dk(t.a);t=new ek(t.a,t.b,t.f);var i={},n=e.b;if(e=e.a&Qj.PROVIDES_BY_VIEWPORT?gk(e,"ObjectSource",!1,{progressiveUpdate:!0,has_volatile_data:!!(e.a&Qj.HAS_VOLATILE_DATA)}):e.a&Qj.PROVIDES_RASTERS?gk(e,"RemoteRasterTileSource",!0,{url:""}):gk(e,"ObjectTileSource",!0,{tile_size:e.kf}),i[n]=e,e={},r.a&Qj.PROVIDES_RASTERS&&(e={"translucent-raster":qi("raster","inlay",1)}),r.a&Qj.PROVIDES_WEBGL_RENDERABLE_OBJECTS){n=!!(r.a&Qj.CROP_LINES_BY_TILE);var o={"translucent-polygons":qi("polygons","inlay",2),"translucent-extruded-polygons":qi("polygons","translucent",3),"translucent-pattern-lines":qi("pattern-lines","translucent",4),"translucent-overlays":qi("overlays","inlay",5),markers:qi("custom_icons","overlay",6,!1)};o["translucent-polygons"].crop_by_tile=!!(r.a&Qj.CROP_POLYGONS_BY_TILE),o["translucent-pattern-lines"].crop_by_tile=n,o.markers.suppress_fade=!0,o.markers.stick=!0,Ya(e,o)}if(t.c&Qj.PROVIDES_RASTERS&&(t.b["tile_layer_"+t.a]=si(t.a,"_default",{"translucent-raster":{color:[1,1,1,t.g],order:0}})),t.c&Qj.PROVIDES_SPATIALS){r={"translucent-pattern-lines":{color:pi("strokeColor"),width:pi("lineWidth * $meters_per_pixel"),join:pi("lineJoin"),cap:pi("lineCap"),tail_cap:pi("lineTailCap"),head_cap:pi("lineHeadCap"),miter_limit:pi("miterLimit"),order:"function() { return 2 + feature.effectiveZIdx / 2; }",interactive:!0,dash:pi("lineDash"),extrude:!0,dash_phase:pi("lineDashOffset")}},n=t.b,o="polygon_layer_"+t.a;var a=si(t.a,"polygons",void 0,t.f);a.flat={filter:"function(){return !feature.height && !feature.min_height;}",draw:ri(!1)},a.extruded={filter:"function(){return feature.height || feature.min_height;}",draw:ri(!0)},n[o]=a,t.b["outline_layer_"+t.a]=si(t.a,"outlines",r,t.f),t.b["polyline_layer_"+t.a]=si(t.a,"polylines",r,t.f)}return t.c&Qj.PROVIDES_OVERLAYS&&(t.b["overlay_layer_"+t.a]=si(t.a,"overlays",{"translucent-overlays":{color:[1,1,1,t.g],order:8190,interactive:!0}})),t.c&Qj.PROVIDES_MARKERS&&(t.b["marker_layer_"+t.a]=si(t.a,"markers",{markers:{sprite:oi("icon.id"),offset:oi("icon.offset"),collide:!1,priority:8191,elevate_by_altitude:!0,interactive:!0,stick:{color:oi("icon.stick_color"),height:oi("icon.stick_height")}}},t.f)),{sources:i,styles:e,layers:t.b}}function P(t){var e,r=""+ef();if(P.j.constructor.call(this),t=t||{},this.min=t.min||0,this.max=t.max||22,e=t.uri){if(/_/.test(e))throw new D(P,0,"uri "+e)}else e=r;if(this.uri=e||r,this.uid=r,t.getCopyrights&&zc(t.getCopyrights,"Function",P)&&(this.getCopyrights=t.getCopyrights),this.hb=this.hb.bind(this),this.ta=!0,this.b=t.engineType||jk,this.b===kk.HARP&&!H.map.render.harp)throw new D(P,0,"HARP engine is not supported, module not found")}function lk(t,e){e=ae(e,0,1),E(e)&&(e=1),t.g!==e&&(t.g=e,t.ta&&mk(t),t.hb(),t.Va())}function mk(t){if(t.b===kk.WEBGL){var e=new hk(t.getCapabilities(),t.uid,t.max,t.g,t.tileSize);t.a=new ti(ik(e))}else t.b===kk.HARP&&H.map.render.harp&&(t.a=new H.map.render.harp.Style({}));t.ta=!0}function ok(t){var e;for(e in xc(this,ok),ok.j.constructor.call(this,t),this.wa=t=[],nh)t[nh[e]]=new jh}function N(t){t=t||{},N.j.constructor.call(this,t),this.f=t=new R({min:t.min,max:t.max}),t.ma=this,t.ka(this),t.ra(kh.ADD),this.J=new Lg,this.i=new Lg,this.m=new ck,this.u=new Lg,this.P=new ck,this.T=new Lg}function pk(t,e,r,i,n,o,a){if(a=a||[],e.Rc())for(t=e!==t.m&&e!==t.u,n=!n,r=(e=e.Pf(r,o,o)).length,o=0;o<r;o++){var s,l=e[o].c;if(s=void 0!==i){for(var c=Bd(i),u=l;(s=u.m<=c&&u.s>=c)&&(u=u.Fa););s=!s}s||!n&&!l.wc(!0)||(t||1===l.xb().getState())&&a.push(l)}return a}function qk(t,e,r,i,n){var o=pk(t,t.m,e,r,i,n);return pk(t,t.u,e,r,i,n,o),o}function rk(t,e,r,i,n){var o=pk(t,t.P,e,r,i,n);return pk(t,t.T,e,r,i,n,o),o}function sk(t,e,r){var i,n=r.ga(),o=tk.bind(null,t);t=uk.bind(null,t),C(r,th)?i=C(n,L)?o(n):n.la.some(o):C(r,uh)?i=C(n,O)?t(n):n.la.some(t):C(r,sh)&&(i=t(Ci(n))),i&&e.push(r)}function tk(t,e){t:{var r=e.$,i=Hi(t,e);if(!i){e=e.$.length;for(var n=0;n<e;n+=3)if(Fi(t,r[n],r[n+1])){t=!0;break t}}t=i}return t}function uk(t,e){return Ii(t,e)}function vk(t,e,r){for(var i=t.length;i--;){var n=t[i],o=n.ga();if(C(o,Vi)){for(var a,s=(o=o.la).length;s--;)if(Fi(e,(a=o[s]).lat,a.lng)){r.push(n);break}}else Fi(e,o.lat,o.lng)&&r.push(n)}}Wj.State={ERROR:-1,LOADING:0,READY:1},Wj.prototype.getState=function(){return this.C},Wj.prototype.getState=Wj.prototype.getState,Wj.prototype.i=function(t,e){if(this.a=e.getData(),1===t){var r=this.g;r||(r=this.g=e.yb()),this.f||(this.f=new J(r.w/2|0,r.h))}this.b&&(this.C=t,delete this.b,this.dispatchEvent("statechange"))},Wj.prototype.a=z,Wj.prototype.Qc=function(){return this.a},Wj.prototype.getBitmap=Wj.prototype.Qc,Wj.prototype.yb=function(){return this.g||z},Wj.prototype.getSize=Wj.prototype.yb,Wj.prototype.f=z,Wj.prototype.kd=function(){return this.f},Wj.prototype.getAnchor=Wj.prototype.kd,Wj.prototype.c=z,Wj.prototype.nm=function(){return this.c},Wj.prototype.getHitArea=Wj.prototype.nm,Wj.prototype.o=function(){Wj.j.o.call(this),this.a?(this.a.removeAttribute("src"),delete this.a):(this.b.cancel(),delete this.b)},u(Yj,wg),Yj.prototype.s=function(t){for(var e,r,i=this.head,n=t;n;){if(t=n.entries)if(e=t.length){if(2>e&&(r=n.parent)&&1===r.a){r.removeChild(n),i===n&&(i=r),r.entries=t,n=t[0].node=r;continue}}else if(delete n.entries,(r=n.parent)&&(r.removeChild(n),i===n&&(i=r),1===r.a)){n=r.a?r[0]||r[1]||r[2]||r[3]:null;continue}break}this.head!==i&&(this.head=i,Bg(this))},Yj.prototype.yc=function(t,e){if(Gg(this.a,t,e,t,e))return Zj(this,this.a,t,e,this.c);throw Error("Coordinates out of bounds")},bk.prototype.a=function(t){return this[t%2]},p=ck.prototype,p.Dh=0,p.Rc=function(){return this.Dh},p.Uf=null,p.K=function(){var t,e=this.Uf;return!e&&(t=xg(this.a))&&(this.Uf=e=new K(-t[0],t[3],-t[2],t[1])),e},p.yc=function(t){return++this.Dh,this.Uf=null,this.a.yc(t.lng,-t.lat)},p.remove=function(t){return(t=this.a.remove(t))&&(--this.Dh,this.Uf=null),t},p.Pf=function(t,e,r){var i=this.a,n=t.Nb(),o=t.Jb(),a=-n.lat;n=n.lng;var s=-o.lat;return o=o.lng,t.Bb()?i.Za(-180,a,o,s,r,e).concat(i.Za(n,a,180,s,r,e)):i.Za(n,a,o,s,r,e)},u(P,F),t("H.map.provider.Provider",P),p=P.prototype,p.A={ie:"configchange",za:"update"},p.Va=function(t,e){this.dispatchEvent(new vd(this.A.za,e,t))},p.hb=function(t){t=new cj(this.A.ie,t&&t.newValue,t&&t.oldValue),this.dispatchEvent(t)},p.o=function(){F.prototype.o.call(this),this.a&&(this.a.removeEventListener("change",this.hb),this.a.F(),delete this.a)},p.ba=function(){return null},P.prototype.getCopyrights=P.prototype.ba,P.prototype.getCapabilities=function(){var t=0;return this.di()&&(t|=Qj.PROVIDES_BY_VIEWPORT),this.providesRasters()&&(t|=Qj.PROVIDES_RASTERS),this.providesSpatials()&&(t|=Qj.PROVIDES_SPATIALS),this.providesOverlays()&&(t|=Qj.PROVIDES_OVERLAYS),this.providesMarkers()&&(t|=Qj.PROVIDES_MARKERS),this.providesDomMarkers()&&(t|=Qj.PROVIDES_DOM_MARKERS),this.providesGeoJSON()&&(t|=Qj.PROVIDES_GEOJSON),this.providesOMV()&&(t|=Qj.PROVIDES_OMV),t},P.prototype.getCapabilities=P.prototype.getCapabilities,P.prototype.di=gf,P.prototype.Ve=gf,P.prototype.providesRasters=P.prototype.Ve,P.prototype.Cc=gf,P.prototype.providesSpatials=P.prototype.Cc,P.prototype.fi=gf,P.prototype.providesOverlays=P.prototype.fi,P.prototype.Rb=gf,P.prototype.providesMarkers=P.prototype.Rb,P.prototype.Qb=gf,P.prototype.providesDomMarkers=P.prototype.Qb,P.prototype.ei=gf,P.prototype.providesGeoJSON=P.prototype.ei,P.prototype.Sb=gf,P.prototype.providesOMV=P.prototype.Sb,P.prototype.dm=function(){return this.b},P.prototype.getEngineType=P.prototype.dm,P.prototype.wo=function(t){this.b=t},P.prototype.setEngineType=P.prototype.wo,P.prototype.Ue=ld,P.prototype.preprocessData=P.prototype.Ue,P.prototype.g=1,P.prototype.Em=function(){return this.g},P.prototype.getOpacityInternal=P.prototype.Em,P.prototype.Qa=function(t,e){var r=this;if(this.b===kk.WEBGL&&!C(t,ti)||this.b===kk.HARP&&!C(t,H.map.render.harp.Style))throw t=Object.entries(kk).find((function(t){return t[1]===r.b})),new D(this.Qa,0,"Invalid style for engineType "+t);this.a&&(this.a.removeEventListener("change",this.hb),this.a.removeEventListener(Yh,this.hb),this.a.F()),this.a=t,this.a.addEventListener("change",this.hb),this.a.addEventListener(Yh,this.hb),e||this.hb(),this.ta=!1},P.prototype.setStyleInternal=P.prototype.Qa,P.prototype.Ya=function(){return this.a||mk(this),this.a},P.prototype.getStyleInternal=P.prototype.Ya,P.prototype.Ej=function(){var t=this.getCapabilities(),e=nk.FEATURE;return t&Qj.PROVIDES_BY_VIEWPORT?e=nk.SOURCE:t&Qj.PROVIDES_RASTERS?e=null:t&Qj.PROVIDES_WEBGL_RENDERABLE_OBJECTS&&(e=nk.PROVIDER),e},P.prototype.getPickingMode=P.prototype.Ej,P.prototype.im=function(){return!1},P.prototype.getFeatureProxy=P.prototype.im,u(ok,P),t("H.map.provider.ObjectProvider",ok),ok.prototype.di=ff,ok.prototype.providesByViewport=ok.prototype.di,ok.prototype.Kb=function(t){return this.wa[t||nh.ANY]},ok.prototype.getInvalidations=ok.prototype.Kb,ok.prototype.Td=function(t,e){if(e!==kh.NONE){var r=this.wa[nh.ANY],i=r.a+1;r.update(i,e),(r=this.wa[t.type]).update(i,e),t.Kb().update(i,e),this.Va(t)}},ok.prototype.invalidateObject=ok.prototype.Td,ok.prototype.requestOverlays=ok.prototype.sd,ok.prototype.requestSpatials=ok.prototype.kg,ok.prototype.requestSpatialsByTile=ok.prototype.mg,ok.prototype.qa=!1,ok.prototype.requestMarkers=ok.prototype.Ec,ok.prototype.requestDomMarkers=ok.prototype.Dc,u(N,ok),t("H.map.provider.LocalObjectProvider",N),N.prototype.getCapabilities=function(){return Qj.PROVIDES_BY_VIEWPORT|Qj.PROVIDES_WEBGL_RENDERABLE_OBJECTS|Qj.PROVIDES_DOM_MARKERS|Qj.CROP_LINES_BY_TILE},N.prototype.Ya=function(){if(!this.l&&(this.l=N.j.Ya.call(this),this.l instanceof ti)){var t=new hk(this.getCapabilities()|Qj.HAS_VOLATILE_DATA,this.uid+"_vol",this.max,this.g,this.tileSize);this.l.Oe(ik(t))}return this.l},N.prototype.getStyleInternal=N.prototype.Ya,N.prototype.Qa=function(t,e){N.j.Qa.call(this,t,e),this.l=null},N.prototype.setStyleInternal=N.prototype.Qa,N.prototype.bc=function(){return this.f},N.prototype.getRootGroup=N.prototype.bc,N.prototype.Td=function(t,e){e&kh.SPATIAL&&this.fa(t),N.j.Td.call(this,t,e)},N.prototype.invalidateObject=N.prototype.Td,N.prototype.fa=function(t){var e;if(C(t,M,this.fa,0),t.ma!==this)throw new $c(this.fa,"foreign object");this.Ga(t);var r=t.type;if(r===nh.MARKER)if((e=t.ga())instanceof kg){var i=!0;r=this.m}else r=this.u;else r===nh.DOM_MARKER?(e=t.ga())instanceof kg?(i=!0,r=this.P):r=this.T:r=r===nh.OVERLAY?this.J:this.i;(i=i?r.yc(e):r.Pj(t.K())).c=t,t.qa=i},N.prototype.Ga=function(t){var e;if(t)if(t.ma!==this){if(C(t,M))throw new $c(this.Ga,"foreign object")}else if(e=t.qa){var r=t.type;r===nh.MARKER?this.m.remove(e)||this.u.remove(e):r===nh.DOM_MARKER?this.P.remove(e)||this.T.remove(e):r===nh.OVERLAY?this.J.remove(e):this.i.remove(e),delete e.c,delete t.qa}},N.prototype.removeObject=N.prototype.Ga,N.prototype.fi=function(){return 0<this.J.Rc()},N.prototype.providesOverlays=N.prototype.fi,N.prototype.sd=function(t,e,r){return pk(this,this.J,t,e,r,!1).filter((function(t){return t.Qc()}))},N.prototype.requestOverlays=N.prototype.sd,N.prototype.Cc=function(){return 0<this.i.Rc()},N.prototype.providesSpatials=N.prototype.Cc,N.prototype.kg=function(t,e,r){return pk(this,this.i,t,e,r,!1)},N.prototype.requestSpatials=N.prototype.kg,N.prototype.mg=function(t,e){return pk(this,this.i,t.Hf(),t.zL,e,!1)},N.prototype.requestSpatialsByTile=N.prototype.mg,N.prototype.Rb=function(){return 0<this.m.Rc()+this.u.Rc()},N.prototype.providesMarkers=N.prototype.Rb,N.prototype.Ec=function(t,e,r){return qk(this,t,e,r,!1)},N.prototype.requestMarkers=N.prototype.Ec,N.prototype.Qb=function(){return 0<this.P.Rc()+this.T.Rc()},N.prototype.providesDomMarkers=N.prototype.Qb,N.prototype.Dc=function(t,e,r){return rk(this,t,e,r,!1)},N.prototype.requestDomMarkers=N.prototype.Dc,N.prototype.Ua=function(t,e,r,i,n){var o=this,a=t.K(),s=[],l=Zb(),c=1;if(a)for(;c&nh.ANY;){if(c&i)switch(c){case nh.MARKER:l=l.then((function(){return qk(o,a,r,e,!0)})).then((function(e){return vk(e,t,s)}));break;case nh.DOM_MARKER:l=l.then((function(){return rk(o,a,r,e,!0)})).then((function(e){return vk(e,t,s)}));break;case nh.SPATIAL:l=l.then((function(){return pk(o,o.i,a,r,e,!0)})).then((function(e){e.forEach(sk.bind(null,t,s))}));break;case nh.OVERLAY:l=l.then((function(){return pk(o,o.J,a,r,e,!0)})).then((function(e){e.forEach(sk.bind(null,t,s))}))}c<<=1}l.then((function(){return n(s)}))},N.prototype.ld=function(t,e,r){var i=(r=r||jf).zoom,n=r.visiblesOnly;r=r.types;var o=nh.ANY;C(t,O,this.ld,0,"area"),zc(e,"Function",this.ld,1,"callback"),zc(i,"Number",this.ld,2,"options"),this.Ua(t,!vc(n)||!!n,i,vc(r)?r&o:o,e)},N.prototype.getObjectsWithin=N.prototype.ld,N.prototype.o=function(){N.j.o.call(this),this.f.na()};var wk={PENDING:0,ACTIVE:1,DONE:2};function xk(t,e){var r;if(e=e||{},!C(t,Element))throw new D(xk,0,t);var i=t.ownerDocument.createElement("div");this.S=t,xk.j.constructor.call(this),this.padding=new yk(0,0,0,0),this.center=new J(0,0),this.margin=0,this.element=i,i.style.zIndex=0,i.style.height=i.style.width="100%",i.style.direction="ltr",i.style.position="relative"===t.style.position?"absolute":"relative",this.resize(),t.appendChild(i),(r=e.padding)!==B&&this.wi(r.top,r.right,r.bottom,r.left),this.ri((r=e.margin)!==B?r:0)}function zk(t){var e=t.padding;t.center.set((t.width+e.left-e.right)/2<<0,(t.height+e.top-e.bottom)/2<<0)}function Ak(t,e,r,i,n,o){var a;for(a=[];i<=n;i++)a=a.concat(Bk(t,r,i));for(t=a.length,xj.call(this,o,t),this.l=r=[],this.f=A(this.f,this),this.c=A(this.c,this),this.O(1);t--;)o=a[t],r.push(Ck(e,o[0],o[1],o[2],this.f,this.c))}function Dk(t,e){var r=this;if(!Da(e))throw new D(Ek,1,e);if(!Da(t.next||Da(t.cycle)))throw new D(Dk,2,'Argument "mode" must implement H.util.AsyncQueue.Mode');this.b=[],this.c=[],this.g=t,this.i=e,this.l=function(){Fk(r)},this.a=null,this.f=function(){r.a||(r.a=x.setTimeout(r.l,1))}}function Fk(t){var e=t.c,r=0,i=t.g;for(i.a(),t.a=null;r<e.length;){var n=e[r];n.Tj?e.splice(r,1):r++}for(;n=i.next(t.b,t.c);)n.cancelled?n.done(null,"cancelled"):(e.push(n),t.i(n,n.data))}function Hk(){Gk(this,null,null,null)}function Gk(t,e,r,i){return t.data=e,t.cancelled=!1,t.Tj=!1,t.b=r,t.c=i,t.a=null,t}function Ik(){}t("H.map.render.RenderState",wk),u(xk,F),t("H.map.ViewPort",xk),xk.prototype.A={za:"update",le:"sync"},xk.prototype.ri=function(t){if(this.margin!==+t){if(E(this.margin=+t))throw new D(this.ri,0,t);zk(this),this.dispatchEvent(this.A.za)}},xk.prototype.setMargin=xk.prototype.ri,xk.prototype.wi=function(t,e,r,i){var n=this.padding;if(n.top!==t||n.right!==e||n.bottom!==r||n.left!==i){if(E(t+e+r+i))throw new D(this.wi);n.top=t,n.right=e,n.bottom=r,n.left=i,zk(this),this.dispatchEvent(this.A.za)}},xk.prototype.setPadding=xk.prototype.wi,xk.prototype.resize=function(){var t=this.S.offsetWidth,e=this.S.offsetHeight;this.width===t&&this.height===e||(this.a=new Wi(this.width,this.height),this.width=t,this.height=e,zk(this),this.dispatchEvent(this.A.za))},xk.prototype.resize=xk.prototype.resize,xk.prototype.$a=function(t){this.dispatchEvent(new dj(this.A.le,this.a,t,ej.SIZE))},xk.prototype.synchronize=xk.prototype.$a,xk.prototype.o=function(){this.S.removeChild(this.element),delete this.S,delete this.element,xk.j.o.call(this)},xk.prototype.lc=Qc,xk.prototype.startInteraction=xk.prototype.lc,xk.prototype.cc=Qc,xk.prototype.interaction=xk.prototype.cc,xk.prototype.wb=Qc,xk.prototype.endInteraction=xk.prototype.wb,u(Ak,xj),Ak.prototype.f=function(){zj(this,2)},Ak.prototype.c=function(){zj(this,4)},Ak.prototype.oe=function(){for(var t=this.l,e=t.length;e--;)t[e].cancel();delete this.l},t("H.util.AsyncQueue",Dk),Dk.prototype.push=function(t,e){if(!Da(e))throw new D(this.push,1,e);return t=Gk(new Hk,t,this.f,e),this.b.push(t),this.f(),t},Dk.prototype.push=Dk.prototype.push,Dk.Task=Hk,Hk.prototype.done=function(t,e){this.Tj=!0,this.b(),this.c(this,t,e)},Hk.prototype.done=Hk.prototype.done,Hk.prototype.cancel=function(){this.a&&this.a(),this.cancelled=!0},Hk.prototype.cancel=Hk.prototype.cancel,Hk.prototype.vo=function(t){return this.a=t,this},Hk.prototype.setCancelFn=Hk.prototype.vo,Dk.Mode=Ik,Ik.prototype.next=function(){},Ik.prototype.a=function(){};var Jk,Kk=function(){function t(){}for(var e,r,i,n=tc("o ms moz webkit "),o=5;o--&&!e;)e=n[o],e=(r=x[e+(e?"R":"r")+"equestAnimationFrame"])&&!E(r.call(window,t))&&(i=x[e+(e?"C":"c")+"ancelAnimationFrame"]);return Jk=e?function(t){return r.call(x,t)}:function(t){return x.setTimeout(t,25)},e?function(t){return i.call(x,t)}:function(t){return x.clearTimeout(t)}}(),Lk=x.performance&&x.performance.now?function(){return x.performance.now()}:function(){return x.Date.now()};function Mk(t,e){Mk.j.constructor.call(this,new Nk(t),e)}function Nk(t){if(isNaN(t)||0>t)throw new D(Mk,1,'Argument "maxTime" must be a positive number');this.c=t,this.b=Lk()}function Ok(t){if(xc(this,Ok),Ok.j.constructor.call(this,t),t&&"tileSize"in t){var e=Ed(+t.tileSize)/Od;if(isNaN(e)||e%1||0>e||30<e)throw new D(Ok,0,"tileSize: "+t.tileSize);this.tileSize=+t.tileSize}}function Pk(t,e){return Yd(t)-8-Ad(Yd(e))}function Qk(){}function Rk(t,e,r){if(this.g=[],e&&this.$d(e),r&&!Da(r))throw new D(Rk,2,r);this.b=0,this.filter=r,this.a={},this.f=this.c=null,this.ti(t)}function Tk(t,e){return e&&(t.c=Uk(t,e,t.c)),e}function Vk(t){for(;t.b>t.i&&t.f;)Wk(t,t.f,!0)}function Uk(t,e,r){return r!==e&&((e.fc||e.Zc)&&Wk(t,e,!1),(e.fc=r)&&(e.Zc=r.Zc,r.Zc=e),e.Zc||(t.c=e),e.fc||(t.f=e),t.b+=e.size),e}function Wk(t,e,r){var i=e.Zc,n=e.fc;(i||n||e==t.c&&e==t.f)&&(i?i.fc=n:t.c=n,n?n.Zc=i:t.f=i,t.b-=e.size,r&&(delete t.a[e.id],Sk(t,e))),e.fc=e.Zc=null}function Sk(t,e){for(var r=t.g.length;r--;)t.g[r].call(t,e.id,e.data,e.size)}function Xk(t,e,r,i){this.key="",this.x=t,this.y=e,this.z=r,this.data=i,this.valid=!0}function Yk(t,e,r,i){return(t-=r)*t+(e-=i)*e}function Zk(t,e,r){return $k(t,e*e,r||0,0,t.length-1)}function $k(t,e,r,i,n){var o=0,a=i,s=t[i].x,l=t[i].y,c=t[n].x,u=t[n].y,h=i+1,p=Yk(s,l,c,u);if(p)for(;h<n;){var f=t[h++],d=f.x,y=((d-s)*(c-s)+((f=f.y)-l)*(u-l))/p;(d=0>y?Yk(d,f,s,l):1<y?Yk(d,f,c,u):Yk(d,f,s+y*(c-s),l+y*(u-l)))>o&&(o=d,a=h-1)}else for(;h<n;)(d=Yk(d=(f=t[h++]).x,f=f.y,s,l))>o&&(o=d,a=h-1);return o>=e||0<r&&a-i?(--r,1<a-i?(i=$k(t,e,r,i,a)).splice(i.length-1,1):i=[t[i]],i=1<n-a?i.concat($k(t,e,r,a,n)):i.concat(t.slice(a,n+1))):i=[t[i],t[n]],i}function al(t,e,r,i,n,o,a,s){al.j.constructor.call(this,e,r,i,null),this.key=t,this.U=s,this.a=n,this.g=o,this.i={},this.zL=a,this.m=Cd(wh.MAX_LINE_WIDTH/2*this.g+1)}function bl(t){return t.U.getInvalidations(nh.SPATIAL)}function cl(t){var e,r=bl(t),i=r.a,n=t.c,o=n===i;if(!(o||r.Rj(n)||r.yh(n))){o=t.f;var a=t.i;if(r.Sf(n))for(e=o.length;e--;){var s=o[e];if(s.Kb().Sf(n)){o.splice(e,1);var l=l||dl(t,s.cb())}}if(r.zh(n)){for(e=o.length;e--;)if((s=o[e]).Kb().zh(n)){var c=1;if((s=a[s.cb()])&&s.a){l=1;break}}c&&o.sort(el)}if(!l&&r.Vd(n))for(e=o.length;e--;)if(o[e].Kb().Vd(n)){var u=1;break}t.u!==n||u||(t.u=i,t.b!==n||l||(t.b=i)),t.c=i,o=!0}return o}function fl(t,e){this.b=t,this.a=e}function dl(t,e){var r=(t=t.i)[e];if(r)return delete t[e],r.a}function gl(t){var e,r=bl(t),i=t.c,n=t.f;if(!cl(t)){for(e=n.length;e--;){var o=n[e],a=o.Kb();(a.Sf(i)||a.yh(i))&&dl(t,o.cb())}t.f=t.U.requestSpatialsByTile(t,!1,!1).sort(el),t.c=r.a}}function el(t,e){return oh(t.Uc(),e.Uc(),!1)}u(Mk,Dk),t("H.util.SequentialQueue",Mk),Nk.prototype.next=function(t){return t.length&&Lk()-this.b<this.c?t=t.shift():null},Nk.prototype.a=function(){this.b=Lk()},u(Ok,P),t("H.map.provider.TileProvider",Ok),Ok.getZoomLevelOffset=Pk,Ok.prototype.requestTile=Ok.prototype.Ha,Ok.prototype.cancelTile=Ok.prototype.mc,Ok.prototype.cancelTileByKey=Ok.prototype.pe,Ok.prototype.createTileInternal=Ok.prototype.ac,Ok.prototype.uc=function(t,e,r){return this.uri.concat("_",t,"_",e,"_",r)},Ok.prototype.getTileKey=Ok.prototype.uc,Ok.prototype.kf=256,Ok.prototype.tileSize=Ok.prototype.kf,t("H.util.ICache",Qk),Qk.prototype.add=function(){},Qk.prototype.add=Qk.prototype.add,Qk.prototype.get=function(){},Qk.prototype.get=Qk.prototype.get,Qk.prototype.zf=function(){},Qk.prototype.drop=Qk.prototype.zf,Qk.prototype.forEach=function(){},Qk.prototype.forEach=Qk.prototype.forEach,Qk.prototype.na=function(){},Qk.prototype.removeAll=Qk.prototype.na,Qk.prototype.$d=function(){},Qk.prototype.registerOnDrop=Qk.prototype.$d,Qk.prototype.Ug=function(){},Qk.prototype.deRegisterOnDrop=Qk.prototype.Ug,t("H.util.Cache",Rk),Rk.prototype.add=function(t,e,r){var i,n;if(!Fc(r=+r)||0>r)throw new D(this.add,2,r);return t=String(t),(n=!this.filter||this.filter(t,e,r))&&((i=this.a[t])?(i.data!==e&&Sk(this,i),this.b+=r-i.size,i.size=r,i.data=e,Tk(this,i)):this.a[t]=Uk(this,{id:t,data:e,size:r,fc:null,Zc:null},this.c),Vk(this)),n},Rk.prototype.add=Rk.prototype.add,Rk.prototype.$d=function(t){if(!Da(t))throw new D(this.$d,0,t);this.g.push(t)},Rk.prototype.registerOnDrop=Rk.prototype.$d,Rk.prototype.Ug=function(t){this.g=this.g.filter((function(e){return e!==t}))},Rk.prototype.deRegisterOnDrop=Rk.prototype.Ug,Rk.prototype.get=function(t,e){return(t=e?this.a[t]:Tk(this,this.a[t]))&&t.data},Rk.prototype.get=Rk.prototype.get,Rk.prototype.zf=function(t){var e;(e=this.a[t])&&Wk(this,e,!0)},Rk.prototype.drop=Rk.prototype.zf,Rk.prototype.forEach=function(t,e,r){var i;for(i in this.a){var n=this.a[i];(!r||r(i,n.data,n.size))&&t.call(e,i,n.data,n.size)}},Rk.prototype.forEach=Rk.prototype.forEach,Rk.prototype.na=function(t){var e;for(e in this.a){var r=this.a[e];(!t||t(e,r.data,r.size))&&Wk(this,this.a[e],!0)}},Rk.prototype.removeAll=Rk.prototype.na,Rk.prototype.ti=function(t){if(!(0<+t))throw new D(Rk.prototype.ti,0,t);return this.i=+t,Vk(this),this},Rk.prototype.setMaxSize=Rk.prototype.ti,Rk.prototype.Cm=function(){return this.i},Rk.prototype.getMaxSize=Rk.prototype.Cm,Rk.prototype.Xl=function(){return this.b},Rk.prototype.getCurrentSize=Rk.prototype.Xl,t("H.map.provider.Tile",Xk),t("H.math.simplifyDP",Zk),u(al,Xk),t("H.map.provider.SpatialTile",al),al.prototype.c=Xd,al.prototype.u=Xd,al.prototype.b=Xd,al.prototype.Ud=function(){var t=bl(this),e=t.a,r=this.b,i=r===e;return i||(this.U.qa&&!t.Vd(r)?i=!0:cl(this)&&(i=this.b===e)),i},al.prototype.isCanvasValid=al.prototype.Ud,Object.defineProperty(al.prototype,"valid",{get:function(){return this.Ud()},set:ld,configurable:!0}),al.prototype.f=hf,al.prototype.Ua=function(){return this.f},al.prototype.getObjects=al.prototype.Ua,al.prototype.$m=function(){return this.a},al.prototype.getTileSize=al.prototype.$m;var hl={};function jl(t,e,r,i,n,o,a,s,l){var c=t.a,u=-a;if(a=o+a,s=s||0,l===B&&(l=c.length),n&&t===Jh)e.fillRect(0,0,o,o);else if(l>s){for(e.beginPath(),o=s;o<l;o++){var h=c[o],p=h.length;if(h===Qh)e.moveTo(u,u),e.lineTo(u,a),e.lineTo(a,a),e.lineTo(a,u);else{var f=h[0];for(e.moveTo(f.x,f.y),s=1;s<p;s++)f=h[s],e.lineTo(f.x,f.y)}r&&e.closePath()}r&&n&&e.fill(t.b!==Wd?"evenodd":"nonzero"),i&&e.stroke()}}function il(t,e,r){var i;t.strokeStyle=e.strokeColor,t.lineWidth=e.lineWidth*r,t.lineCap=e.lineCap,t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.setLineDash&&(i=e.lineDash)!==hf&&(t.setLineDash(i),t.lineDashOffset=e.lineDashOffset)}function kl(t,e){t.fillStyle=e.fillColor}function ll(t,e,r,i,n,o){var a=n*i.width/2,s=(n=n*i.length/2)/2;i=2*n*i.frequency;var l=Fd(Gd(n,2)+Gd(a,2));t=new yk(l,l,t=t.a-l,t),r=r.a;var c,u,h,p,f,d,y,g=Pd/2;for(o=o||0,l=r.length;l-- >o;){var v=0,m=r[l];if(u=c=m.length){var _=m;for(u=_.length,h=0;--u;)h+=_[u].Wa(_[u-1]);u=(_=h)>=i}if(u)for(h=(u=_/((u=yd(Bd(_/i),1e3))+1))/2;--c;){for(p=(f=m[c]).Wa(d=m[c-1]);h<=v+p;){var b=f.x+(d.x-f.x)*(y=(h-v)/p);y=f.y+(d.y-f.y)*y,t.vf(b,y)&&(e.save(),e.translate(b,y),e.rotate(-Md((d.y-f.y)/(f.x-d.x))+(f.x<d.x?g:-g)),e.beginPath(),e.moveTo(-a,-n),e.lineTo(0,n),e.lineTo(a,-n),e.lineTo(0,-s),e.closePath(),e.fill(),e.restore()),h+=u}v+=p}}}al.prototype.Le=function(){var t=this.a+"_"+this.g,e=hl[t];if(!e){e=-this.m;var r=this.a-e;e=hl[t]=new yk(e,e,r,r)}return e},al.prototype.getPxClipRect=al.prototype.Le,al.prototype.Hf=function(){var t=this.mb;if(!t){var e=this.Jf();t=0;var r=this.a;this.z&&(r-=t+=this.Le().top),t=this.mb=sg(e.Re(new J(t,t)),e.Re(new J(r,r)))}return t},al.prototype.getGeoClipRect=al.prototype.Hf,al.prototype.Jf=function(){var t=this.J;if(!t){var e=this.a;(t=this.J=new nj(B,e)).Oa(this.z),t.x=this.x*e,t.y=this.y*e}return t},al.prototype.getPxProj=al.prototype.Jf,al.prototype.Xa=function(){return this.g},al.prototype.getPixelRatio=al.prototype.Xa,al.prototype.gg=function(){var t=this.data;return t&&(this.data=null,this.b=Xd),t},al.prototype.releaseCanvas=al.prototype.gg,al.prototype.hg=function(){this.i={},delete this.f,this.c=Xd},al.prototype.releaseData=al.prototype.hg,al.prototype.W=function(t){var e,r,i,n,o=t.getContext("2d"),a=0;if(gl(this),this.b<this.c){var s=this.f;if(e=s.length){t.width=t.height=this.a,o.clearRect(0,0,this.a,this.a);var l=this.i;for(r=0;r<e;r++){var c=s[r],u=c.cb();if(n=(i=l[u])?i.b:c.getGeometriesForTile(this)){if(i)c.Kb().Vd(this.b)&&(i.a=Ih(c,n)),i=i.a;else{var h;i=Ih(c,n);for(var p=n,f=c.g?2:0,d=p.length;d--;){var y=p[d];if(y!==Jh){var g=y.a;for(h=g.length;h--;)4<(y=g[h]).length&&(g[h]=Zk(y,.6,f))}}this.i[u]=new fl(n,i)}if(i){for(o.save(),p=c.g?this.D:this.P,u=0;u<n.length;u++)p.call(this,c,n[u],c.V(),o);if(n=c.getLabels(this))for(c=o,u=n.length;u--;)for(p=(f=n[u]).size,c.font=p+"px "+f.font,c.fillStyle=f.color,c.textAlign="center",c.translate(f.x,f.y),c.rotate(f.angle),p=f.lineHeight||1.375*p,f=(d=f.lines).length;f--;)c.fillText(d[f],0,f*p);o.restore()}a|=+i}}}this.data=a?t:null,this.u=this.b=this.c}else this.data&&(a=1);return 0<a},al.prototype.render=al.prototype.W,al.prototype.data=null,al.prototype.P=function(t,e,r,i){var n;r.b&&(il(i,r,this.g),jl(e,i,!1,!0,!1,this.a,this.m)),r.a&&(n=t.c)&&n.Ob&&(kl(i,n),ll(this,i,e,n,r.lineWidth))},al.prototype.D=function(t,e,r,i){var n,o=r.Ob,a=r.b,s=this.a,l=this.m;if(e===Jh)o&&(kl(i,r),i.fillRect(0,0,s,s));else{if(a&&il(i,r,this.g),r.a&&(n=t.c)){var c=r.lineWidth;n.Ob||(n=null)}(t=e.c)===Wd?((a||o)&&(kl(i,r),jl(e,i,!0,a,o,s,this.m)),n&&(kl(i,n),ll(this,i,e,n,c,0))):(o&&(kl(i,r),jl(e,i,!0,!1,o,s,l,0,t)),a&&jl(e,i,!1,a,!1,s,l,t),n&&(kl(i,n),ll(this,i,e,n,c,t)))}};var ml=[];function nl(t,e){var r;nl.j.constructor.call(this,e),this.D=t,this.P=t=e.pixelRatio,this.tileSize=r=1<<Ad(Yd((e.tileSize||256)*t)),this.L=Pk(r,t),this.Gh=A(this.Gh,this),this.Wh=A(this.Wh,this),this.Hh=A(this.Hh,this),this.Fh=A(this.Fh,this),this.m=A(this.m,this),this.D.addEventListener(P.prototype.A.za,this.m,!1,this),this.f=[],this.i=new Rk(e.tileCacheSize||256,this.Gh),this.l=new Rk(e.dataCacheSize||512,this.Wh),this.J=new Mk(20,this.Hh),this.c={},this.u=Lk()}function yk(t,e,r,i){this.left=+t,this.top=+e,this.right=+r,this.bottom=+i}function ol(t,e){return new yk(t.x,t.y,e.x,e.y)}function pl(t,e){if(e=e||{},!t)throw new D(pl,0,t);this.tileSize=t.tileSize,this.a={},qj.call(this,{min:void 0!==e.min?e.min:t.min,max:void 0!==e.max?e.max:t.max,minWorldSize:this.tileSize,projection:e.eg,dark:e.dark,provider:t})}function ql(t,e,r,i,n){i=Bd(i);var o=Gd(2,i),a=e.left,s=e.top,l=e.right;r=l+(r?o+(l===e.left?0:1):1);var c=e.bottom,u=[];if(n)var h=a+(1+l-a)/2+n.x/t.tileSize-.5,p=s+(1+c-s)/2+n.y/t.tileSize-.5;for(;a<r;){for(s=e.top;s<=c;)t=a%o,u.push([t,s,i,n?Dd(h-a)+Dd(p-s):0]),s++;a++}return u}function Bk(t,e,r){r=Bd(r),t.pixelProjection.Oa(r),e=t.Ae(e);var i=t.Sd(e,r);return ql(t,i,e.left>e.right,r)}function rl(t,e){return e[3]-t[3]}function sl(t,e){pl.call(this,t,e)}function tl(t,e){(e=e?Wa(e):{}).tileSize=e.tileSize||256,e.pixelRatio=e.pixelRatio||Ue(),e.max=24,this.a=new nl(t,e),this.b=new sl(this.a),e.minWorldSize=this.a.tileSize,e.provider=t,tl.j.constructor.call(this,e),this.tileSize=this.b.tileSize,this.c=A(this.c,this),this.a.addEventListener(this.a.A.za,this.c),t.addEventListener(t.A.za,this.c)}al.prototype.Ea=function(t,e,r){for(var i,n,o,a,s,l,c,u=this.f,h=u.length,p=hf,f=this.g;h--;)if((n=u[h]).wc(!0)&&(o=this.i[n.cb()])&&(a=o.b)){for(l="none"!==(i=n.V()).fillColor&&n.g,c="none"===i.strokeColor?0:i.lineWidth*f,i=a.length;i--;){var d;if(s=a[i],!(d=l&&s===Jh)&&(d=l||c)){var y;d=t;var g=e,v=l,m=c,_=s.b,b=s.c,w=b!==Wd,x=s.a,E=x.length,T=0,A=0,S=!1;for(s=0;s<E;s++){var k=x[s],O=s>=b,L=!O&&s>=_;if(k===Qh&&v)L?T++:A++;else{var P=k.length;for(ml.length=2*P,y=0;y<P;y++){var R=k[y];ml[2*y]=R.x,ml[2*y+1]=R.y}if(y=v&&!O,O=w&&!O?0:m,y||O){if((O=ee(d,g,ml,O,y))===de.EDGE||O===de.VERTEX){S=!0;break}if(O===de.SURFACE)if(L)T++;else if(A++,_===Wd)break}}}d=S||0<A&&!(T%2)}if(d){p===hf&&(p=[]),p.push(n);break}}if(r&&p.length)break}return p},u(nl,Ok),nl.prototype.m=function(t){(t=t.target).type===nh.SPATIAL&&this.Va(t)},nl.prototype.Ha=function(t,e,r,i){var n,o=this.getTileKey(t,e,r);if(n=this.i.get(o,i)){if(i||n.Ud())return n;i||this.i.zf(o)}if((n=this.l.get(o,i))&&(i||cl(n)))return t=this.f.pop()||document.createElement("canvas"),n.W(t)||this.f.push(t),this.i.add(o,n,1),n;i||((n=this.c[o])?n.count++:((n=this.J.push([o,t,e,r],this.Fh)).count=1,this.c[o]=n))},nl.prototype.requestTile=nl.prototype.Ha,nl.prototype.ac=function(){},nl.prototype.createTileInternal=nl.prototype.ac,nl.prototype.mc=function(t,e,r){this.pe(this.getTileKey(t,e,r))},nl.prototype.cancelTile=nl.prototype.mc,nl.prototype.pe=function(t){var e;(e=this.c[t])&&(e.count--,e.count||(e.cancel(),delete this.c[t]))},nl.prototype.cancelTileByKey=nl.prototype.pe,p=nl.prototype,p.Hh=function(t,e){var r=e[0],i=e[1],n=e[2],o=e[3];i=(r=this.i.get(r)||new al(r,i,n,o,this.tileSize,this.P,o+this.L,this.D)).data||this.f.pop()||document.createElement("canvas"),r.W(i)||this.f.push(i),e.push(r),t.done(r)},p.Fh=function(t,e){t=t.data[0],e&&this.i.add(t,e,1),delete this.c[t],this.Va()},p.Gh=function(t,e){e.data&&this.f.push(e.gg()),this.l.add(t,e,1)},p.Wh=function(t,e){e.hg()},p.o=function(){for(var t in this.c)this.c[t].cancel();this.i.na(),this.l.na(),this.f.length=0,nl.j.o.call(this)},t("H.math.Rect",yk),yk.prototype.set=yk,yk.prototype.set=yk.prototype.set,yk.prototype.Nb=function(){return this.b||(this.b=new J(this.left,this.top))},yk.prototype.getTopLeft=yk.prototype.Nb,yk.prototype.Jb=function(){return this.a||(this.a=new J(this.right,this.bottom))},yk.prototype.getBottomRight=yk.prototype.Jb,yk.prototype.vf=function(t,e){return this.left<=t&&this.right>=t&&this.top<=e&&this.bottom>=e},yk.prototype.containsXY=yk.prototype.vf,yk.fromPoints=ol,yk.prototype.clone=function(){return new yk(this.left,this.top,this.right,this.bottom)},yk.prototype.clone=yk.prototype.clone,u(pl,qj),t("H.map.layer.BaseTileLayer",pl),pl.prototype.Ae=function(t,e){var r=this.pixelProjection;if(!C(t,K))throw new D(this.Ae,0,t);if(!E(e)){var i=r.Jj();r.Oa(e)}return t=ol(r.ib(t.Nb()),r.ib(t.Jb())),!E(i)&&r.Oa(i),t},pl.prototype.geoRectToRect=pl.prototype.Ae,pl.prototype.Sd=function(t,e){var r=Gd(2,Bd(e)),i=this.tileSize;if(!C(t,yk))throw new D(this.Sd,0,t);if(E(e=+e))throw new D(this.Sd,1,e);(e=Bd(t.left/i))===r&&--e;var n=Bd(t.right/i);return n===r&&--n,new yk(e,ae(Bd(t.top/i),0,r-1),n,ae(Bd(t.bottom/i),0,r-1))},pl.prototype.getTileBounds=pl.prototype.Sd,pl.prototype.Ha=function(t,e,r,i){return this.ma.requestTile(t,e,r,i)},pl.prototype.requestTile=pl.prototype.Ha,pl.prototype.mc=function(t,e,r){this.ma.cancelTile(t,e,r)},pl.prototype.cancelTile=pl.prototype.mc,pl.prototype.ba=function(t,e){return this.ma.getCopyrights?this.ma.getCopyrights(t,e):null},pl.prototype.getCopyrights=pl.prototype.ba,pl.prototype.Ke=function(t,e,r,i,n,o){var a,s,l=[],c=this.ma;o=null!=o?o:"__default__";var u=c.requestTile;if(!C(t,yk))throw new D(this.Ke,0,t);if(E(r=+r))throw new D(this.Ke,1,r);if(i||(a={}),t=(e=ql(this,t,e,r,n)).length)for(i||e.sort(rl),r=t;r--;)n=e[r],i||(a[c.uc.apply(c,n)]=!0),n[3]=+i,(s=u.apply(c,n))&&l.push(s);if(!i){var h;for(h in i=a,a=this.a[o]||{})a.hasOwnProperty(h)&&a[h]&&!i[h]&&this.ma.cancelTileByKey(h);this.a[o]=i}return{total:t,tiles:l}},pl.prototype.getProviderTiles=pl.prototype.Ke,u(sl,pl),t("H.map.layer.TileLayer",sl),sl.prototype.td=function(t,e,r,i,n){if(!C(t,K))throw new D(this.td,0,t);if(E(e=+e))throw new D(this.td,1,e);e=Bd(e),this.pixelProjection.Oa(e),t=this.Ae(t);var o=this.Sd(t,e);return this.Ke(o,t.left>t.right,e,r,i,n)},sl.prototype.requestTiles=sl.prototype.td,u(tl,qj),t("H.map.layer.ObjectLayer",tl),tl.prototype.c=function(t){t.currentTarget!==this.a&&t.target.type===nh.SPATIAL||this.Va()};var ul={markers:hf,total:0};tl.prototype.Ec=function(t,e,r){var i,n=this.ma;return n.providesMarkers()&&(i=n.requestMarkers(t,e,!0,r)).length?{markers:i,total:i.length}:ul},tl.prototype.requestMarkers=tl.prototype.Ec,tl.prototype.Dc=function(t,e,r){var i,n=this.ma;return n.providesDomMarkers()&&(i=n.requestDomMarkers(t,e,!0,r)).length?{markers:i,total:i.length}:ul},tl.prototype.requestDomMarkers=tl.prototype.Dc;var vl={tiles:hf,total:0};tl.prototype.td=function(t,e,r,i){if(this.ma.providesSpatials()){var n=this.b.td(t,e,r,i);r||(r=this.a,33<(n=Lk())-r.u&&(Fk(r.J),r.u=n),n=this.b.td(t,e,!0,i))}else n=vl;return n},tl.prototype.requestTiles=tl.prototype.td,tl.prototype.Ha=function(t,e,r,i){return this.b.Ha(t,e,r,i)},tl.prototype.requestTile=tl.prototype.Ha,tl.prototype.mc=function(t,e,r){this.b.mc(t,e,r)},tl.prototype.cancelTile=tl.prototype.mc;var wl={overlays:hf,total:0};function S(t){xc(this,S),S.j.constructor.call(this,t),this.sb=new xl,this.ub=A(this.ub,this),this.P=yl,this.createTileInternal=this.ac.bind(this)}tl.prototype.sd=function(t,e,r){var i=this.ma,n=wl;return i.providesOverlays&&i.providesOverlays()&&(e=(t=i.requestOverlays(t,e,!0,r)).length)&&(n={overlays:t,total:e}),n},tl.prototype.requestOverlays=tl.prototype.sd,tl.prototype.o=function(){this.a.F(),this.b.F(),this.ma.dispose(),tl.j.o.call(this)},u(S,Ok),t("H.map.provider.RemoteTileProvider",S),S.prototype.em=function(){return 1},S.prototype.getEntryWeight=S.prototype.em;var yl,zl=screen.width,Al=screen.height,Bl=Ue();Bl=zd(Bl,1);var Cl=Cd(zl*Bl*Al*Bl/1e6);yl=new Rk(Gd(2,zd(8,yd(12,7+Cl))));var Dl={},El={};function Ck(t,e,r,i,n,o){return i=~~i,t.requestInternal(e,r,i,(function(a,s){t.c().put(t.uc(e,r,i),{raw:s&&s.raw||a,timestamp:x.Date.now()},n,o)}),o,0)}function Gl(t){delete Dl[t],delete El[t]}function Fl(t){for(var e in Dl)t.ub(e)&&t.cancelTileByKey(e)}S.prototype.nb=function(){return this.P},S.prototype.getCache=S.prototype.nb,S.prototype.J=ba(3),S.prototype.ub=function(t){var e=this.uri;return!t.indexOf(e)&&"_"===t.charAt(e.length)},S.prototype.cacheFilter=S.prototype.ub,S.prototype.wa=function(t,e){e.valid=!1},S.prototype.reload=function(t){var e=this.getCache();t?e.na(this.ub):e.forEach(this.wa,this,this.ub),Fl(this),this.Va(this,{isReload:!0})},S.prototype.reload=S.prototype.reload,S.prototype.l=function(){return!1},S.prototype.MAX_STORE_TIME=1/0,S.prototype.c=function(){return this.sb},S.prototype.ea=function(t,e){e(t)},S.prototype.requestInternal=S.prototype.B,S.prototype.Ha=function(t,e,r,i){var n=this,o=this.getCache();if(E(t=+t))throw new D(this.Ha,0,t);if(E(e=+e))throw new D(this.Ha,0,e);if(E(r=+r))throw new D(this.Ha,0,r);r=~~r;var a=this.getTileKey(t,e,r);return(o=o.get(a))&&o.valid||i||Dl[a]||(o=B,this.requestTileAsPromise(t,e,r,i).then((function(t){n.Va(t)}),ld)),o},S.prototype.requestTile=S.prototype.Ha,S.prototype.Gk=function(t,e,r,i){var n,o,a=this,s=this.getCache(),l=this.getTileKey(t,e,r),c=this.c();return El[l]?El[l]:(El[l]=n=new Rb((function(n,u){function h(o){var h,p=0,f=function(i,o){(h=a.createTileInternal(t,e,r,i,o)).key=l,s.add(l,h,1),n(h),Gl(l)};o&&(p=x.Date.now()-o.timestamp),o&&p<a.MAX_STORE_TIME?a.ea(o.raw,f):(0<p&&c.remove(l),(h=s.get(l))&&h.valid||i?n(h||null):Dl[l]=a.requestInternal(t,e,r,f,u))}o=c.get(l,h,h)})),Dl[l]||(Dl[l]=o),n.then((function(){Gl(l)}),(function(){Gl(l)})),n)},S.prototype.requestTileAsPromise=S.prototype.Gk,S.prototype.Fk=function(t,e){var r=this,i=t.id,n=t.tile.coords;return new Rb((function(t,o){r.Gk(n.x,n.y,n.z,e).then((function(e){for(var r,n=z,o=(e=e.Ua?e.Ua():e.data).length;o--;)if((r=e[o]).cb()===i){n=r;break}t(n)}),o)}))},S.prototype.requestObjectAsPromise=S.prototype.Fk;var Hl={cancel:ld};function xl(){}function Ek(t){var e;if(Ek.j.constructor.call(this,t),t&&(this.u={crossOrigin:t.crossOrigin||"anonymous",headers:t.headers||{}},this.m=t.getURL),this.b===kk.HARP&&H.map.render.harp&&(e=t&&t.style&&t.style instanceof H.map.render.harp.Style?t.style:new H.map.render.harp.Style({styles:[{technique:"raster",attr:{gamma:1,brightness:1}}]}),this.Qa(e)),!Da(this.m))throw new D(Ek,0,"getURL");if(lk(this,t.opacity),this.f=x.URL||x.webkitURL,!(t="anonymous"===(t=this.u.crossOrigin)||"use-credentials"===t)){t=this.m(0,0,0),e=window.location;var r=document.createElement("a");r.href=t,t=r.hostname===e.hostname&&r.port===e.port&&r.protocol===e.protocol}(this.T=t&&!!uf.arraybuffer&&!!this.f)&&this.nb().$d(A(this.aa,this))}S.prototype.ac=function(t,e,r,i){return new Xk(t,e,r,i)},S.prototype.createTileInternal=S.prototype.ac,S.prototype.pe=function(t){var e=Dl[t];e&&(e.cancel(),Gl(t))},S.prototype.cancelTileByKey=S.prototype.pe,S.prototype.mc=function(t,e,r){this.cancelTileByKey(this.getTileKey(t,e,r))},S.prototype.cancelTile=S.prototype.mc,S.prototype.o=function(){S.j.o.call(this),this.getCache().na(this.ub),Fl(this)},S.NullStorage=xl,xl.prototype.get=function(t,e){return e(),Hl},xl.prototype.get=xl.prototype.get,xl.prototype.put=function(t,e,r){r&&r()},xl.prototype.put=xl.prototype.put,xl.prototype.clear=function(t){t&&t()},xl.prototype.clear=xl.prototype.clear,xl.prototype.remove=function(t,e){e&&e()},xl.prototype.remove=xl.prototype.remove,u(Ek,S),t("H.map.provider.ImageTileProvider",Ek),Ek.prototype.ic=function(t){lk(this,t)},Ek.prototype.setOpacity=Ek.prototype.ic,Ek.prototype.Tc=function(){return this.g},Ek.prototype.getOpacity=Ek.prototype.Tc,Ek.prototype.Ve=ff,Ek.prototype.providesRasters=Ek.prototype.Ve,Ek.prototype.B=function(t,e,r,i,n,o){var a,s=this,l=this.m(t,e,r);if(t=Hl,l){var c=x.setTimeout((function(){s.T?(a=new tf("arraybuffer",l,o,s.u)).then((function(t){return t.blob()})).then((function(t){var e=new Image;e.onload=A(i,null,e,{raw:t}),e.onerror=A(n,null,"bad url");try{e.src=s.f.createObjectURL(t)}catch(t){}}),n):(a=new tf("image",l,o,s.u)).then(i,n)}),150);t={cancel:function(){a?a.cancel():x.clearTimeout(c)}}}else i(null);return t},Ek.prototype.requestInternal=Ek.prototype.B,Ek.prototype.ea=function(t,e){var r=new Image;r.onload=function(){e(this)},r.src=this.f.createObjectURL(t)},Ek.prototype.aa=function(t,e){(t=e.data)&&t instanceof HTMLImageElement&&this.f.revokeObjectURL(t.src)},Ek.prototype.V=function(){return this.Ya()},Ek.prototype.getStyle=Ek.prototype.V,Ek.prototype.gb=function(t){H.map.render.harp&&this.b===kk.HARP&&t instanceof H.map.render.harp.Style&&this.Qa(t)},Ek.prototype.setStyle=Ek.prototype.gb,t("H.util.events.listenOnce",Fe),t("H.util.events.dispatchEvent",(function(t,e){return t.dispatchEvent(e)})),t("H.util.events.fireListeners",(function(t,e,r,i){return pe(t)?t.jd(e,r,i):Oe(t,e,r,i)})),t("H.util.events.listen",Ee),t("H.util.events.unlisten",Me);var Il=Pe;function Jl(t,e,r,i){var n=new yk(0,0,0,0);if(Jl.j.constructor.call(this),!t)throw new D(Jl,0,t);if(!e)throw new D(Jl,1,e);if(!r)throw new D(Jl,2,r);if("object"!=typeof i)throw new D(Jl,3,i+" is not an object");if("number"!=typeof i.pixelRatio)throw new D(Jl,3,i.pixelRatio+" is not a number");this.oa=i.pixelRatio,this.zoom=0,this.fb=Ed(this.oa)/Od,this.b=new nj,this.wa={1:n.clone(),2:n.clone(),4:n.clone()},this.s=new J(.5,.5),this.f=t,Kl(this,this.oa),this.lc=A(this.lc,this),this.cc=A(this.cc,this),this.wb=A(this.wb,this),t.startInteraction=this.lc,t.interaction=this.cc,t.endInteraction=this.wb,t.addEventListener(t.A.za,this.T,!1,this),this.getCapabilities=this.getCapabilities,this.capture=this.capture,this.zoomAt=this.xd,this.relaunch=this.ha,this.dispose=this.F,this.screenToGeo=this.Pa,this.geoToScreen=this.Da,this.screenToLookAtData=this.qg,this.J=e,this.kc=A(this.kc,this),this.control=A(this.control,this),this.vb=A(this.vb,this),e.startControl=this.kc,e.control=this.control,e.endControl=this.vb,e.addEventListener(e.A.za,this.Kg,!1,this),this.c=r,this.Zf=A(this.Zf,this),this.Me=A(this.Me,this),this.Ne=A(this.Ne,this),this.Yf=A(this.Yf,this),r.addEventListener(qj.prototype.A.za,this.Zf,!1,this),r.addEventListener(r.A.he,this.Me,!1,this),r.addEventListener(r.A.je,this.Ne,!1,this),r.addEventListener(r.A.ke,this.Yf,!1,this)}function Kl(t,e){var r=t.f,i=r.width,n=r.height,o=r.padding,a=o.top,s=o.left,l=o.bottom;o=o.right,r=r.margin;var c=-(i+s-o)/2<<0,u=-(n+a-l)/2<<0;i+=c,n+=u,(t=t.wa)[1].set((c-r)*e,(u-r)*e,(i+r)*e,(n+r)*e),t[2].set(c*e,u*e,i*e,n*e),t[4].set((c+s)*e,(u+a)*e,(i-o)*e,(n-l)*e)}function Ml(t,e){t.style.transition="opacity 1.5s",Fe(t,"transitionend",e,!1),t.style.opacity=0}Pe=function(t,e){var r,i,n=!0,o=e[e.currentTarget===e.target?"AT_TARGET":t.capture?"CAPTURING_PHASE":(r=!0,"BUBBLING_PHASE")];return(!r||"pointerenter"!==(i=e.type)&&"pointerleave"!==i)&&(e.eventPhase=o,n=Il(t,e),r&&t.src&&t.src.Mb&&null===t.src.Mb()&&delete e.eventPhase),n},u(Jl,F),t("H.map.render.RenderEngine",Jl),Jl.prototype.xd=function(){},Jl.prototype.T=function(){Kl(this,this.oa)},Jl.prototype.o=function(){var t=this.f,e=this.J,r=this.c;t.removeEventListener(t.A.za,this.T,!1,this),t.startInteraction===this.lc&&(t.startInteraction=xk.prototype.lc),t.interaction===this.cc&&(t.interaction=xk.prototype.cc),t.endInteraction===this.wb&&(t.endInteraction=xk.prototype.wb),e.removeEventListener(e.A.za,this.Kg,!1,this),e.startControl===this.kc&&(e.startControl=Ll.prototype.kc),e.control===this.control&&(e.control=Ll.prototype.control),e.endControl===this.vb&&(e.endControl=Ll.prototype.vb),r.removeEventListener(qj.prototype.A.za,this.Zf,!1,this),r.removeEventListener(r.A.he,this.Me,!1,this),r.removeEventListener(r.A.je,this.Ne,!1,this),r.removeEventListener(r.A.ke,this.Yf,!1,this)},Jl.prototype.mi=function(t){this.me=t},Jl.prototype.setAnimationCallback=Jl.prototype.mi,Jl.prototype.hi=function(){this.me=void 0},Jl.prototype.resetAnimationCallback=Jl.prototype.hi,Jl.prototype.control=function(){},Jl.prototype.capture=function(){return $b(Error("not implemented"))};var Nl={ZOOM:1,HEADING:2,TILT:4,INCLINE:8,COORD:16};function Ql(t,e){return e.tilt=Rl(t,e.tilt),e.heading=Sl(t,e.heading),e.incline=t.getCapabilities().lookAt.incline.min,e}function Pl(t,e){var r=t.getCapabilities().lookAt.zoom;return ae(e,zd(r.min,t.Eg),yd(r.max,t.Dg))}function Rl(t,e){return ae(e,(t=t.getCapabilities().lookAt.tilt).min,t.max)}function Sl(t,e){return ae((e%360+360)%360,(t=t.getCapabilities().lookAt.heading).min,t.max)}function Ol(t,e,r){(r=r?e.addEventListener:e.removeEventListener).call(e,e.A.Ti,t.Yh,!1,t),r.call(e,e.A.Si,t.Yh,!1,t)}Jl.InteractionModifiers=Nl,p=Jl.prototype,p.A={Vi:"render"},p.Zf=function(t){this.nk(t),this.ha()},p.Me=function(t){this.Pe(t.idx,t.added)},p.Ne=function(t){this.Xh(t.idx,t.removed,t.type===this.c.A.ke)},p.Yf=function(t){t.removed&&this.Ne(t),this.Me(t)},p.nk=ld,p.Pe=function(t,e){this.th(t,e),0===t&&this.Eb(),C(e,qj)&&Ol(this,e,!0),this.ce(),this.ha()},p.Eb=function(){var t=this.c.La();if(0<t.length){var e=t[0].max;this.Eg=t[0].min,this.Dg=e}else e=(t=this.getCapabilities().lookAt.zoom).max,this.Eg=t.min,this.Dg=e;(t=Pl(this,this.zoom))!==this.zoom&&(this.zoom=t,this.b.Oa(t),this.$a())},p.$a=function(t){this.P=this.jb(),t&&(this.P.position=t),this.P.zoom=this.zoom-this.fb,this.P.position.alt=0},p.dl=0,p.heading=180,p.jb=function(){return Ql(this,{position:this.b.projection.dg(this.s),zoom:this.zoom,tilt:this.dl,heading:this.heading})},p.th=ld,p.Xh=ld,p.xo=function(t,e){this.D={before:t,after:e}},Jl.prototype.setOnRenderCallbacks=Jl.prototype.xo;var Tl={P2D:0,WEBGL:1,HARP:2};Jl.EngineType=Tl;var Ul={lookAt:{zoom:{min:-8,max:24},tilt:{min:0,max:85},incline:{min:0,max:0},heading:{min:0,max:360}},interaction:{ZOOM:Nl.ZOOM,COORD:Nl.COORD},capture:!0};function Vl(t){var e,r=this,i=x.H.gl;Vl.j.constructor.call(this),this.a=e=i.Scene.create(x.URL.createObjectURL(pf(JSON.stringify(Wl))),{viewport:t.viewport,container:t.Zb,disableRenderLoop:!0,devicePixelRatio:t.devicePixelRatio,logLevel:"error"}),t.ao&&e.subscribe({load:t.ao}),e.subscribe({view_complete:function(){r.ji=!0,t.qk()}});var n=e.requestRedraw;e.requestRedraw=function(){n.apply(e),t.qk()},this.ki=A(this.ki,this),this.jg=A(this.jg,this),this.f=0,this.c={},this.b={}}function Xl(t){var e;for(e in t=t.a.sources){var r=t[e];if(r.hasPendingCommands&&r.hasPendingCommands())return!0}return x.H.gl.Task.hasPendingTasks()}function Yl(t){t.ji=!1,t.a.resetViewComplete()}function Zl(t){return t.a.view}function $l(t,e){function r(){var r,n,o,a,s,l=e.La(),c={},u={},h=++t.f;for($h(u,Wl),n=0;n<l.length;n++){var p=l[n];if(r=p.ca()){var f=r.Ya();if(f.getState()===Xh.READY){var d=f.qc();if(!Va(d)){for(o in delete d.cameras,delete d.camera,c[n]=d=li(d,n),!C(p,tl)&&d.sources&&mi(d,r.uid),d.sources){var y=d.sources[o];y.max_zoom=yd(r.max,Ul.lookAt.zoom.max),y.max_display_zoom=p.max,y.min_display_zoom=p.min,(s=r.tileSize)&&(2<=i&&256<s&&r instanceof Ek&&(s/=2),y.tile_size=s)}(a=f.Ib())&&ni(d,a),$h(u,d)}}}}return $h(u.layers.skybox.draw.skybox.color,u.scene.sky),t.a.config=u,t.a.updateConfig().then((function(){var e,r,i={};if(h!==t.f)return!1;for(r in t.f=0,c){p=l[+r];var n=c[r].sources;for(e in n)(n=t.a.sources[e])&&(i[e]=n,n.initialize&&p.getProvider()&&n.initialize(p.getProvider(),t.ki,t.a.getWorkers().length,n.tiled?B:t.a.tile_manager.getWorkerForTile(z,n)))}for(e in t.c)!i[e]&&t.c[e].dispose&&t.c[e].dispose();return t.c=i,!0}))}var i=t.a.pixelRatio();t.a.initialized?r():t.a.load(z,{blocking:!1}).then(r)}function am(t,e){var r=t.a.tile_manager;r.removeTiles(t.jg),r.updateTilesForView(),e&&r.removeCachedTiles(t.jg),Yl(t),t.b={}}function bm(t,e,r,i){t.a.getFeatureAt(e,r,i),t.a.update()}function cm(t){return t.a.screenshot(void 0).then((function(t){return new Rb((function(e,r){new Rj(URL.createObjectURL(t.blob),(function(t,i){1===t?e(i.getData()):r()}),!1)}))}))}t("H.map.render.webgl.capabilities",Ul),u(Vl,qd),p=Vl.prototype,p.ji=!1,p.W=function(){var t=x.H.gl.Task;return this.a.immediateRedraw(),t.setState({user_moving_view:this.a.view.user_input_active}),t.processAll(),this.ji&&!this.a.dirty&&!this.a.building&&!Xl(this)&&!Object.keys(this.b).length},p.ki=function(t,e,r){var i=this,n=this.a.sources[t],o=r&&r.isReload;e?!0!==this.b[t]&&(this.b[t]||(this.b[t]={cl:{},aj:[]}),C(e,Xk)?this.b[t].cl[e.x+"/"+e.y+"/"+e.z]=!0:(e=e.boundingBox,this.b[t].aj.push(new K(e[0],e[1],e[2],e[3])))):this.b[t]=!0,n&&n.has_volatile_data?am(this,o):(x.clearTimeout(this.g),this.g=x.setTimeout((function(){return am(i,o)}),100))},p.jg=function(t){var e=!1,r=this.b[t.source.name],i=x.H.gl;if(r)if(!0===r)e=!0;else{var n=i.Tile.coord(i.Geo.wrapTile(t.coords));if(!(e=!!r.cl[n.key])){var o=i.Geo.getTileBoundingBox(n,t.source.tile_size,wh.MAX_LINE_WIDTH/2);o=sg(o.getTopLeft(),o.getBottomRight()),e=r.aj.some((function(t){return t.nd(o,!0)||o.gd(t.bb(),!0)}))}}return e},p.qc=function(){return this.a.config},p.Xa=function(){return this.a.pixelRatio()},p.o=function(){var t=this.c;Vl.j.o.call(this),this.a.destroy(),this.b={},t&&Object.keys(t).forEach((function(e){t[e].dispose()})),x.clearTimeout(this.g),delete this.c,delete this.a},Vl.prototype.disposeInternal=Vl.prototype.o;var Wl={scene:{background:{color:"#FFFFFF"},sky:{zenith:"#347BC0",horizon:"#EDF2F9",fog:"#FFFFFF"}},lights:{default_light:{type:"directional",name:"default_light",visible:!0}},camera:{type:"perspective"},styles:{},fonts:{},sources:{skybox:{type:"SkyBox"}},layers:{skybox:{data:{source:"skybox"},draw:{skybox:{color:{}}}}},global:{}},nk={FEATURE:1,SOURCE:2,PROVIDER:3};function dm(t){return t}function em(t){return-t*(t-2)}function fm(t){return 1-Math.sqrt(1-t*t)}function gm(t){return Fd(2*t-t*t)}function hm(t){return 1-Math.cos(t*Math.PI/2)}function im(t){return Math.sin(t*Math.PI/2)}function jm(t,e){this.a={tilt:km(t.tilt,e.tilt),heading:km(t.heading,e.heading),zoom:e.zoom-t.zoom};var r=this.b=ng(t.position),i=e.position;t=i.lat*Ud;var n=r.lat*Ud;i=i.lng*Ud-r.lng*Ud,r=Id(i)*Kd(t),t=Kd(n)*Id(t)-Id(n)*Kd(t)*Kd(i),t=Math.atan2(r,t),this.i=(0<=t?t:Sd+t)*Vd,this.c=this.b.Wa(e.position),e=this.a.zoom,this.g=0===e?lm:Object.assign({},lm,{zoom:0>e?gm:fm,position:0>e?hm:im}),this.f=Object.assign({},{tilt:0,heading:0,zoom:0})}function km(t,e){return-180<(t=e-t)&&180>=t?t:180<t?t-360:t+360}t("H.map.provider.PickingMode",nk),t("H.util.animation.ease.LINEAR",dm),t("H.util.animation.ease.EASE_IN_QUAD",(function(t){return t*t})),t("H.util.animation.ease.EASE_OUT_QUAD",em),t("H.util.animation.ease.EASE_IN_OUT_QUINT",(function(t){return 1>(t*=2)?Gd(t,5)/2:Gd(t-=2,5)/2+1})),t("H.util.animation.ease.EASE_OUT_CIRC",gm);var lm={tilt:dm,heading:dm,zoom:dm,position:dm};function mm(t,e){if(E(this.x=+t))throw new D(mm,0,t);if(E(this.y=+e))throw new D(mm,1,e)}function nm(t){return Fd(t.a(t))}function om(t){t=t||jf,this.mb=vc(t.Wn)?t.Wn:3,this.U=vc(t.Un)?t.Un:300,this.u=vc(t.No)?t.No:3,this.J=vc(t.Io)?t.Io:50,this.c=[],this.clear()}function rm(t,e){t.g^=t.g&e}mm.prototype.add=function(t){return new mm(this.x+t.x,this.y+t.y)},mm.prototype.a=function(t){if(!C(t,mm))throw new D(this.a,0,t);return(t=this.b(t)).x+t.y},mm.prototype.b=function(t){if(!C(t,mm))throw new D(this.b,0,t);return new mm(this.x*t.x,this.y*t.y)},mm.prototype.Oa=function(t){return new mm(this.x*t,this.y*t)},t("H.map.render.InteractionUtils",om),om.prototype.tn=function(){return this.b},om.prototype.isGestureDetected=om.prototype.tn,om.prototype.start=function(t,e){var r=Nl.HEADING,i=Nl.TILT;this.s&&this.clear(),this.g=t,this.l=!!e,this.s=!0,this.b=!(t&(r|i))||t===r||t===i},om.prototype.start=om.prototype.start,om.prototype.store=function(t,e,r,i,n){var o=!1;if(this.s){if(o=(t=new pm(t,e,r,i,n)).c,this.m=this.a,this.a=t,this.f){if(this.i=!0,o){e=this.g;var a=this.b;if(!a&&this.i){n=Nl.HEADING;var s=Nl.TILT;r=Nl.COORD,i=Nl.ZOOM;var l=e&(r|s)?this.Nd(!0):qm,c=e&i?this.Cf(!0):1,u=e&n?Dd(this.bh(!0)):0,h=Dd(l.x),p=Dd(l.y);l=10<h||10<p,h=10<p&&p>3*h,c=.8>c||1.2<c,u=7<u,e&s&&(u||c||l&&!h?rm(this,s):h&&(rm(this,~s>>>0),a=!0)),!a&&e&n&&e&(r|i)&&(c||l?(rm(this,n),a=!0):u&&(rm(this,s),a=!0)),this.b=a}}}else this.f=t,o||(this.b=!0);this.l&&this.c.push(t)}return o},om.prototype.store=om.prototype.store,om.prototype.clear=function(){this.c.length=0,this.s=this.l=this.i=this.b=!1,this.f=this.m=this.a=void 0},om.prototype.clear=om.prototype.clear,om.prototype.Ac=function(t){return 0<(this.g&t)},om.prototype.isModifierEnabled=om.prototype.Ac,om.prototype.sa=function(){return this.s},om.prototype.isRunning=om.prototype.sa;var qm=qc(new mm(0,0));function pm(t,e,r,i,n){this.a=new J(t,e),r!==B&&(this.b=new J(r,i),this.c=!0),this.timestamp=n!==B?n:Lk()}function tm(t){var e=t.a;return(t=t.b)?new J(e.x-(e.x-t.x)/2,e.y-(e.y-t.y)/2):B}function vm(t,e){var r=t.a;return(t=t.b)&&t.Wa(e)<r.Wa(e)?t:r}function sm(t,e){var r=t.b,i=e.b;return i&&r?(e=tm(e),t=tm(t)):r?t=vm(t,e=e.a):i?e=vm(e,t=t.a):(e=e.a,t=t.a),new mm(e.x-t.x,e.y-t.y)}function um(t){var e=t.b;return e?t.a.Wa(e):0}function wm(){F.call(this),this.reset()}function ym(t){ym.j.constructor.call(this,wm.prototype.A.Cg),this.b=t}function zm(t){return x.Object.create(t.f)}function xm(t,e,r,i,n,o){this.a=t,this.b=e,this.c=r,this.f=i,this.g=n,this.i=o}function Am(t,e,r,i){Am.j.constructor.call(this),this.Zb=t,this.oa=i,this.a=t.appendChild(this.createElement(t.ownerDocument)),this.cf(e,r)}function Bm(t,e,r,i,n,o){var a=n||"2d";Bm.j.constructor.apply(this,arguments),this.b=this.a.getContext(a,o),this.c="2d"===a,this.g=a,this.In=o}function Cm(t){this.eb=t}function Dm(t){var e="dom";Dm.j.constructor.call(this,t),C(this.eb,Em)&&(e="2d"===t.Id()?"2d":"webgl"),this.a=e}function Fm(t,e,r,i,n){if(!Da(t.mi)||!Da(t.hi))throw new D(Fm,0,t);if(this.b=t,!Da(this.l=e))throw new D(Fm,1,e);if(E(this.i=+r))throw new D(Fm,2,r);if(!Da(this.g=i)&&null!=i)throw new D(Fm,3,i);if(!Da(this.c=n)&&null!=n)throw new D(Fm,4,n);this.id=(new cf).next(),this.a=!1}function Gm(t,e){Gm.j.constructor.call(this,t),this.oc=!(!e||!e.oc),this.f={}}om.prototype.rc=function(){var t;if(this.l){var e=this.c,r=e.length,i=0;for(t=new mm(0,0);--r&&i<this.u;)t=t.add(sm(e[r-1],e[r])),i++}else t=this.Nd();return 0!==(r=nm(e=t))?new mm(e.x/r,e.y/r):e},om.prototype.getDirection=om.prototype.rc,om.prototype.zb=function(t){var e,r;if(t=t||Lk(),this.l){var i=this.c,n=this.c.length,o=this.c[n-1];for(r=e=0;--n&&e<this.u;)r+=nm(sm(i[n],i[n-1])),e++;i=r/e}else o=this.a,i=nm(this.Nd());return i>=this.mb&&t-o.timestamp<=this.J?i>this.U?this.U:i:0},om.prototype.getSpeed=om.prototype.zb,om.prototype.Bf=function(){return this.a?tm(this.a):B},om.prototype.getBifocalCenter=om.prototype.Bf,om.prototype.Nd=function(t){return(t=t?this.f:this.m)?sm(t,this.a):new mm(0,0)},om.prototype.getMoveVector=om.prototype.Nd,om.prototype.Cf=function(t){var e=1;if(this.i){var r=this.a;(t=um(t=t?this.f:this.m))&&(r=um(r))&&(e=r/t)}return e},om.prototype.getBifocalScaling=om.prototype.Cf,om.prototype.bh=function(t){if(this.i){var e=t?this.f:this.m,r=this.a;t=e.b;var i=r.b,n=0;t&&i&&(e=e.a,r=r.a,n-=Nd(i.y-r.y,i.x-r.x)*Vd-Nd(t.y-e.y,t.x-e.x)*Vd),t=n}else t=0;return t},om.prototype.getBifocalRotation=om.prototype.bh,pm.prototype.c=!1,u(wm,F),wm.prototype.start=function(t,e){this.c&&this.reset(),E(t-e)||(this.a=+t,this.b=+e),this.c=!0},wm.prototype.reset=function(){this.c=!1,this.a=this.b=B,this.f=new xm(0,0,0,0,0,0)},wm.prototype.sa=function(){return this.c},wm.prototype.A={Cg:"animationupdate"},u(ym,ud),wm.prototype.set=function(t,e,r,i,n,o){var a=this.f;this.c&&(t=new xm(t/1e3,e/1e3,r/1e3,i/1e3,n/1e3,o/1e3),a.ia(t)||(this.f=t,this.dispatchEvent(new ym(zm(this)))))},wm.prototype.zb=function(){return zm(this).zb()},wm.prototype.rc=function(){var t=zm(this),e=this.zb()||1;return new xm(t.a/e,t.b/e,t.c/e,t.f,t.g,t.i)},wm.prototype.o=function(){this.reset(),wm.j.o.call(this)},xm.prototype.zb=function(){return Fd(this.a*this.a+this.b*this.b+this.c*this.c)},xm.prototype.rc=function(){var t=this.zb()||1;return new xm(this.a/t,this.b/t,this.c/t,this.f,this.g,this.i)},xm.prototype.ia=function(t){var e=t===this;return!e&&(e=C(t,xm))&&(e=this.a===t.a&&this.b===t.b&&this.c===t.c&&this.f===t.f&&this.g===t.g&&this.i===t.i),e},u(Am,qd),Am.prototype.N=function(){return this.a},Am.prototype.cf=function(t,e){this.size?(this.size.w=t,this.size.h=e):this.size=new Wi(t,e),this.Uk(this.a,this.a.style,t,e,this.oa)},Am.prototype.setSize=Am.prototype.cf,p=Am.prototype,p.yb=function(){return this.size},p.Xa=function(){return this.oa},p.Vj=!0,p.qb=function(t){t!==this.Vj&&(this.a.style.display=t?"block":"none",this.Vj=t)},p.Ih=1,p.ic=function(t){this.Ih!==t&&(this.Yj(t),this.Ih=t)},p.Tc=function(){return this.Ih},p.fe=function(t){this.a.style.zIndex=t},Am.prototype.setZIndex=Am.prototype.fe,Am.prototype.Ij=function(){return+this.a.style.zIndex},Am.prototype.Oc=function(){},Am.prototype.clear=function(){},Am.prototype.o=function(){this.clear(),this.Zb.removeChild(this.a),this.cf(0,0),delete this.a,delete this.Zb,Am.j.o.call(this)},Am.prototype.disposeInternal=Am.prototype.o,Am.prototype.f=0,Am.prototype.pg=function(){++this.f},Am.prototype.release=function(){--this.f||this.F()},u(Bm,Am),p=Bm.prototype,p.createElement=function(t){var e=(t=t.createElement("canvas")).style;return e.position="absolute",e.top=e.left="0",t},p.Uk=function(t,e,r,i,n){t.width=zd(r,1),t.height=zd(i,1),e.width=Ad(r/n)+"px",e.height=Ad(i/n)+"px"},p.Yj=function(t){this.b.globalAlpha=t},p.Oc=function(t,e,r,i,n){this.c&&this.b.drawImage(t,e,r,i,n)},p.Id=function(){return this.g},p.clear=function(t){var e,r;this.c&&(t?this.b.clearRect(e=t.left,r=t.top,t.right-e,t.bottom-r):this.a.width=this.size.w)},p.o=function(){var t=this.a;t.width=t.height=0,delete this.b,Bm.j.o.call(this)},Bm.prototype.disposeInternal=Bm.prototype.o,u(Cm,qd),Cm.prototype.ob=function(){return this.eb},Cm.prototype.getLayer=Cm.prototype.ob,Cm.prototype.Ym=function(){return this.lb},Cm.prototype.getSurface=Cm.prototype.Ym,Cm.prototype.ad=function(t){var e=this.lb;t!==e&&(this.lb=t,t.pg(),e&&e.release())},Cm.prototype.setSurface=Cm.prototype.ad,Cm.prototype.o=function(){this.lb.release()},Cm.prototype.disposeInternal=Cm.prototype.o,Cm.prototype.Rd=function(){},Cm.prototype.render=Cm.prototype.W,u(Dm,Cm),Dm.prototype.W=function(t,e,r,i,n,o,a,s){a=this.eb;var l=this.lb,c=!(C(l,Bm)&&"2d"===l.Id());return i>=a.min&&i<=a.max?(c&&l.qb(!0),a.W(l.N(),{boundingBox:t,zoom:i,screenCenter:e,priorityCenter:o,projection:r,cacheOnly:n,size:l.yb(),pixelRatio:l.Xa(),cameraMatrix:s})):(c&&l.qb(!1),wk.DONE)},Dm.prototype.Rd=function(){return this.a},t("H.util.animation.Animation",Fm),Fm.prototype.start=function(){var t=this;this.f=Lk(),this.a=!0;var e=this.f;this.b.mi((function(){if(t.a){var r=Lk(),i=r-t.f,n=i/t.i,o=!1;1<=n&&(n=1,o=!0),t.l(t.c?t.c(n):n,i,r-e,r),e=r,o&&t.stop()}else t.stop()}))},Fm.prototype.start=Fm.prototype.start,Fm.prototype.stop=function(t){this.a=!1,this.b.hi(),t||this.g&&this.g(this)},Fm.prototype.stop=Fm.prototype.stop,Fm.prototype.sa=function(){return this.a},Fm.prototype.isRunning=Fm.prototype.sa,u(Gm,Cm),Gm.prototype.ad=function(t){Gm.j.ad.call(this,t),this.l=t.Zb.ownerDocument},Gm.prototype.setSurface=Gm.prototype.ad;var Hm=function(t,e){return C(e=e.ga(),gh)?e.la:(t[0]=e,t)}.bind(null,[]);function Im(t,e){var r=t[1].Uc(),i=e[1].Uc();return oh(r,i,!0)||t[5]-e[5]||oh(r,i,!1)}function Jm(t,e){Jm.j.constructor.apply(this,arguments),this.c=0,this.a=[],this.b=A(this.b,this)}Gm.prototype.W=function(t,e,r,i,n,o,a){var s,l,c,u,h=this.eb;if(this.s=e=this.f,this.f=r={},i>=h.min&&i<=h.max){var p=this.rj(t,i,n,o),f=p.markers;if(t=f.length){for(i=[],n=this.lb,o=0;o<t;o++){h=f[o];var d=Hm(h);for(s=d.length;s--;)(l=a(d[s]))&&((u=e[c=h.cb()+"_"+s])?delete e[c]:u={ik:h},r[c]=u,i.push([u,h,h.xb(),n,l.x,l.y]))}for(i.sort(Im),t=i.length,o=0;o<t;o++)this.Ek.apply(this,i[o])}}return!p||p.requested&&p.requested===p.total||!p.requested&&f.length===p.total?wk.DONE:wk.PENDING},Gm.prototype.render=Gm.prototype.W,Gm.prototype.Ea=function(){},Gm.prototype.getObjectsAt=Gm.prototype.Ea,u(Jm,Gm),t("H.map.render.dom.MarkerRenderer",Jm),Jm.prototype.rj=function(){return this.eb.Dc.apply(this.eb,arguments)},Jm.prototype.W=function(t,e,r,i,n,o,a){this.b(),this.i=0;var s,l=Jm.j.W.apply(this,arguments),c=this.lb,u=this.s;for(s in u)Km(this,c,u[s]);return 0===this.a.length&&l?wk.DONE:wk.PENDING},Jm.prototype.render=Jm.prototype.W,Jm.prototype.ad=function(t){Jm.j.ad.call(this,t),this.g=t.Xa()},Jm.prototype.setSurface=Jm.prototype.ad,Jm.prototype.b=function(){for(var t,e,r,i=this.a.length;i--;)(e=(t=(r=this.a[i]).Ag).xb()).Vh(r,e,t);this.a.length=0},Jm.prototype.Ek=function(t,e,r,i,n,o){var a,s=i.Xa(),l=e.Kb();n*=s,o*=s,this.oc||(n=Ad(n),o=Ad(o)),t.detail&&(l.Vd(t.qn)?Km(this,i,t):a=t.detail),a||(t.detail=a=r.uj(this.l),this.c++,Da(r.Vh)&&this.a.push(a)),t.qn=l.a,a.style.zIndex=this.i++,a.Ag=e,i.Oc(a,n,o,0,0)};var Lm,Mm="pointer-events",Nm,Om;function Km(t,e,r){e.clear(e=r.detail),delete e.Ag,t.c--,(r=(t=r.ik).xb()).b&&r.b(e,r,t)}function Em(t,e){var r=e||{},i=r.contextType;if(r=r.contextAttributes,Em.j.constructor.call(this,e),zc(t,"Function",Em,0,"invalid render callback"),i){if(-1===Pm.indexOf(i))throw new D(Em,1,"invalid context type");this.b=i}r&&(this.c=r),this.f=t}$e&&($e&&bd!==z&&(bd=(Om=/(MSIE\s+|rv:)([^\);]+)(\)|;)/.exec(navigator.userAgent))?+Om[2]:z),Nm=bd,9===Nm?Mm="display":10===Nm&&(Mm="visibility")),Lm=Mm,Jm.prototype.Ea=function(t,e,r){var i,n,o,a,s,l=this.g,c=hf;if(this.c){t/=l,e/=l;var u=(l=this.lb.Zb.getRootNode()).documentElement,h=this.lb.N(),p=h.getBoundingClientRect();for(t+=p.left,e+=p.top;(n=o=l.elementFromPoint(t,e))&&n!==h&&n!==u&&n!==l.host&&o!==f;){for(;(a=n.parentNode)&&(!Da(a.contains)||!a.contains(h));)n=a;if(a===h&&(n!==o||"svg"!==n.nodeName)&&0>c.indexOf(s=n.Ag)&&(c===hf&&(c=[]),c.push(s),r))break;i||(i=[]);var f=n.style;i.push({fj:f.getPropertyValue(Lm),pn:f.getPropertyPriority(Lm),style:f}),f.setProperty(Lm,"visibility"===Lm?"hidden":"none","important"),f=o}if(i)for(e=i.length;e--;)(t=i[e]).style.removeProperty(Lm),Cc(t.fj)&&t.style.setProperty(Lm,t.fj,t.pn)}return c},Jm.prototype.getObjectsAt=Jm.prototype.Ea,Jm.prototype.Rd=function(){return"dom"},Jm.prototype.o=function(){this.a.length=0;var t,e=this.lb,r=this.f;for(t in r)Km(this,e,r[t]);this.lb.F(),Jm.j.o.call(this)},Jm.prototype.disposeInternal=Jm.prototype.o,u(Em,qj),t("H.map.layer.CanvasLayer",Em);var Pm=["2d","webgl","webgl2","experimental-webgl"];function Qm(t,e){Qm.j.constructor.call(this,e),zc(t,"Function",Qm,0,"invalid render callback"),this.a=t}function Rm(t,e){if(E(this.b=+t))throw new D(Rm,0,t);this.a=0,e&&this.Qk(e)}function Sm(t,e,r,i){Sm.j.constructor.apply(this,arguments)}function Tm(t,e){this.a=t,this.b=e}function Um(t,e,r){var i=[],n={Zb:t.a,width:e.w,height:e.h,oa:t.b};for(t=0;t<r.length;t++){var o=(e=r[t]).Rd(),a={};Ya(a,n);var s=e.lb;switch(o){case"2d":if(C(e.ob(),Em)&&(a.Rg=e.ob().c),o=u&&"2d"===u.Id()){o=a.Rg;var l=u.In;o=!(l!==o&&(l&&!o?l.alpha||l.willReadFrequently:o&&!l?o.alpha||o.willReadFrequently:!o.alpha!=!o.alpha||!l.willReadFrequently!=!o.willReadFrequently))}if(o)var c=!1;else if(s&&!c){var u=s;c=!1}else u=new Bm(a.Zb,a.width,a.height,a.oa,"2d",a.Rg),c=!0;break;case"dom":u=s||new Sm(a.Zb,a.width,a.height,a.oa),c=!s;break;default:u=s||new Bm(a.Zb,a.width,a.height,a.oa,e.ob().Id(),a.Rg),c=!s}i[i.length-1]!==u&&(u.fe(i.length),i.push(u)),e.ad(u)}return i}function Ll(){Ll.j.constructor.call(this),this.b={},this.a={position:new kg(0,0),zoom:0,heading:180,incline:0,tilt:0,bounds:new O(ch([90,-180,90,0,90,180,-90,180,-90,-180]))}}Em.prototype.b="2d",Em.prototype.Id=function(){return this.b},Em.prototype.W=function(t,e){return this.a&&this.a.canvas===t||(this.a=t.getContext(this.b,this.c)),this.f(this.a,e)},Em.prototype.o=function(){Em.j.o.call(this),delete this.a},u(Qm,qj),t("H.map.layer.DomLayer",Qm),Qm.prototype.W=function(t,e){return this.a(t,e)},t("H.util.kinetics.KineticMove",Rm),Rm.prototype.Qk=function(t){return this.a=t,this},Rm.prototype.setInitialSpeed=Rm.prototype.Qk,Rm.prototype.am=function(){return Math.abs(this.a/this.b)},Rm.prototype.getDuration=Rm.prototype.am,Rm.prototype.De=function(t){return this.a+this.b*t},Rm.prototype.getCurrentSpeed=Rm.prototype.De,Rm.prototype.Wl=function(t){return this.a*t+this.b*t*t/2},Rm.prototype.getCurrentPath=Rm.prototype.Wl,u(Sm,Am),t("H.map.render.dom.Surface",Sm),p=Sm.prototype,p.Id=function(){return"dom"},p.createElement=function(t){return(t=t.createElement("DIV")).style.position="absolute",t.style.pointerEvents="none",t},p.Uk=function(t,e,r,i){e.width=r+"px",e.height=i+"px"},p.Yj=function(t){this.a.style.opacity=t},p.Oc=function(t,e,r){var i=this.oa,n=t.style;n[Af("transform")]="matrix(1,0,0,1,"+e/i+","+r/i+")",t.parentNode!==this.a&&(n.position="absolute",this.a.appendChild(t),this.a.style.pointerEvents="auto","auto"===getComputedStyle(t).pointerEvents&&(t.style.pointerEvents="all"),this.a.style.pointerEvents="none")},p.clear=function(t){t?this.a.removeChild(t):this.a.innerHTML=""},u(Ll,F),t("H.map.ViewModel",Ll),Ll.prototype.A={za:"update",le:"sync"},Ll.prototype.Wb=function(t,e){if(!t)throw new D(this.Wb,0,t);var r=t[Vm];if(vc(r)&&!lg(r))throw new D(this.Wb,0,Vm);if(vc(r=t[Wm])&&E(+r))throw new D(this.Wb,0,Wm);if(vc(r=t[Xm])&&!C(r,jg))throw new D(this.Wb,0,Xm);return r=Ym(t=x.Object.assign({},t),this.b,this.a),Zm(this,this.b,t),this.dispatchEvent(new $m(this.b,r,e)),this},Ll.prototype.setLookAtData=Ll.prototype.Wb,Ll.prototype.jb=function(){var t={};return t[Vm]=ng(this.a[Vm]),Zm(this,t,this.a,!0),t},Ll.prototype.getLookAtData=Ll.prototype.jb;var Vm="position",Wm="zoom",Xm="bounds",an={Ui:Vm,Xi:Wm,Oi:"heading",Wi:"tilt",Pi:"incline",Mi:Xm},bn=Object.keys(an).map((function(t){return an[t]}));function Zm(t,e,r,i){t.g={},t.f={},t.c=[];for(var n,o,a,s=t.l,l=t.i,c=bn.length;c--;)if(a=r[n=bn[c]],null==(o=e[n])||!i)if(null!=a){vc(s)&&s.call(t,n,o,a);var u,h=n;if((u="position"!==n)||(u=!(!(u=a)||E(u.lat)||E(u.lng))),e[h]=u?a:ng(a),vc(l)){switch(n){case"position":o=a&&o&&(a.lat!==o.lat||a.lng!==o.lng);break;case"bounds":o=a&&o&&!a.ia(o);break;default:o=a!==o}o&&l.call(t,n)}}else delete e[n]}Ll.prototype.l=function(t,e,r){this.g[t]=e,this.f[t]=r},Ll.prototype.i=function(t){this.c.push(cn[t])};var cn=bn.reduce((function(t,e){return t[e]=ej[e.toUpperCase()],t}),{});function Ym(t,e,r){var i=0;return["tilt","incline","heading",Wm].forEach((function(n){if(E(t[n])){var o=E(e[n])?r[n]:e[n];t[n]=o}else i|=cn[n]})),[Vm,Xm].forEach((function(n){t[n]?i|=cn[n]:t[n]=e[n]||r[n]})),i}function dn(t,e){return t|e}function $m(t,e,r){$m.j.constructor.call(this,Ll.prototype.A.za,t,null,e),this.b=this.animate=Fc(r)&&0<r&&1/0>r?r:!!r}function T(t,e,r,i){if(T.j.constructor.call(this,t,e,r,i),this.qa=new Rk(100),this.R=new J(0,0),this.Af=!!i.enableSubpixelRendering,this.ab=en,this.m=new om,this.g=i=new wm,this.sb=A(this.sb,this),i.addEventListener(i.A.Cg,this.sb),i=t.element,this.L=t=i.ownerDocument.createElement("div"),t.style.position="absolute",t.style.width=t.style.height="100%",t.style.zIndex=0,i.insertBefore(t,i.firstChild),this.Ad=new Tm(this.L,this.oa),this.ta=e.jb().position,!(e=x.H.gl))throw new $c(T,'"H-webgl" module is missing');for(this.a=new Vl({viewport:this.f,Zb:this.L,devicePixelRatio:this.oa,qk:A(this.ha,this)}),e.WorkerBroker.addTarget("model",sj),t=0,i=(e=this.c.La()).length,this.l={Nc:[],ja:[]},this.xa=e;t<i;t++){var n=e[t];this.Pe(t,n),Ol(this,n,!0)}this.Eb(),this.fd=A(this.fd,this),this.Kh=A(this.Kh,this),this.Da=A(this.Da,this),r.addEventListener(qj.prototype.A.ie,this.fd),this.C=fn,this.zoom=Pl(this,this.J.pb()),this.Eb(),this.T()}Ll.prototype.$a=function(t){var e={},r={};Zm(this,this.a,t),this.b={},e.lookAt=this.f,r.lookAt=this.g,t=(t=this.c).length?t.reduce(dn):0,this.dispatchEvent(new dj(this.A.le,e,r,t))},Ll.prototype.synchronize=Ll.prototype.$a,Ll.prototype.df=function(t,e){if(E(t=+t))throw new D(this.df,0,Wm);this.Wb({zoom:t},e)},Ll.prototype.pb=function(){return this.a.zoom},Ll.prototype.kc=Qc,Ll.prototype.startControl=Ll.prototype.kc,Ll.prototype.control=Qc,Ll.prototype.control=Ll.prototype.control,Ll.prototype.vb=Qc,Ll.prototype.endControl=Ll.prototype.vb,u($m,dj),u(T,Jl),t("H.map.render.webgl.RenderEngine",T),T.prototype.jb=function(){var t=this.ta;return Ql(this,{position:{An:t.An,Fn:t.Fn},zoom:this.zoom,tilt:this.dl,heading:this.heading})},T.prototype.fd=function(t){((t=(t=t.target.ca())&&t.Ya())&&t.getState())===Xh.INIT?t.load():(Yl(this.a),$l(this.a,this.c),this.ha())},T.prototype.type=Tl.WEBGL;var fn=2;function gn(t,e,r){return(e=r-e)<(t=Gd(2,8+t.zoom))/2?e:e-t*r/Dd(r)}function hn(t,e,r){function i(t){return n[t]+km(n[t],e[t])/2}if(!(r&ej.POSITION||r&ej.BOUNDS))return null;var n=Zl(t.a).getLookAtData();r=n.position;var o=e.position,a=e.bounds;return Fi(n.bounds,o.lat,o.lng,!1)||a&&Fi(a,r.lat,r.lng,!1)?null:((r=jn(t,{tilt:i("tilt"),heading:i("heading"),incline:0,bounds:tg([r,o])})).zoom=Pl(t,r.zoom-.5),delete r.bounds,r)}function kn(t,e,r,i){return t=(t=t.getCapabilities().lookAt[i]).max-t.min,Dd("zoom"===i?r[i]-e[i]:km(e[i],r[i]))/t||0}function ln(t,e,r){return ae(3e3*(t=zd(8*kn(t,e,r,"zoom"),kn(t,e,r,"heading"),kn(t,e,r,"tilt")/2)),300,4e3)}function jn(t,e){return pn(e),Zl(t.a).getBestLookAtData(e)}function pn(t){var e=t.bounds;!e||e instanceof O||(t.bounds=Ci(e.K()))}function rn(t,e,r){Zl(t.a).setLookAtData(e),Yl(t.a),qn(t),t.ha(),r&&setTimeout(r,0)}function on(t,e,r,i){var n=Zl(t.a).getLookAtData(),o=new jm(n,e);0!==o.a.tilt+o.a.heading+o.a.zoom+o.c?sn(t,(function(e){for(var r in o.a)if(0!==o.a[r]){var i=o.g[r](e);n[r]+=o.a[r]*(i-o.f[r]),o.f[r]=i}return 0!==o.c&&(n.position=o.b.zg(o.i,o.c*o.g.position(e),!0)),rn(t,n)}),r,(function(){return rn(t,e,i)})):rn(t,e,i)}function tn(t,e){t.qa.na((function(t,r){return r.Mb()===e}))}function un(t){return!(C(t,Qm)||C(t,Em))}function nn(t,e){var r=e.position;return Ql(t,{zoom:Pl(t,e.zoom),position:new kg(r.lat,r.lng),tilt:e.tilt,heading:e.heading,bounds:e.bounds})}function qn(t){var e=Zl(t.a).getLookAtData();t.zoom=e.zoom,t.ta=e.position}function wn(t,e){return new J((t=Zl(t.a).geoToMeters(e)).x/40075016.68557849+.5,1-(t.y/40075016.68557849+.5))}function xn(t,e){return e.sub(wn(t,t.ta)).scale(Gd(2,8+t.zoom))}function yn(t,e,r,i,n,o,a,s){var l,c,u,h=0,p=function(){0==--h&&o(n)};if(s&&s.features)for(h=c=s.features.length,u=0;u<c;u++){var f=s.features[u],d=f.id;if(l=t.a.a.sources[f.source_name]){var y=l.provider,g=y.Ej();if(g===nk.SOURCE){var v=f.source_layer;if("overlays"===v)zn(t,e,r,i,n,l,f.properties.overlays_config);else if(l=l.getMapObjectById(d))if("markers"!==v)n.push(l);else if(An(t,e,r,l))n.push(l);else if(i&&!a){var m=!0;bm(t.a,{x:e,y:r},{radius:3.5,top_most_only:!1},(function(a){yn(t,e,r,i,n,o,!0,a)}))}h--}else g===nk.FEATURE?(v=f.tile.coords,(m=y.getFeatureProxy(f.properties,v,(function(t){t&&(t.Tk(y),n.push(t)),p()})))||((l=t.qa.get(d))||((l=new lh(f)).ka(y),t.qa.add(d,l,1)),n.push(l),h--)):g===nk.PROVIDER&&(m=!0,y.Fk(f,!1).then((function(t){t&&(!(t instanceof rh)||An(this,e,r,t))&&n.push(t),p()}),(function(){p()}),t))}}g&&(m||0!==h)||o(n)}function zn(t,e,r,i,n,o,a){var s;for(t=t.Pa(e,r),e=a.length;e--&&(!(s=o.getMapObjectById(a[e].id))||0<=n.indexOf(s)||!s.ga().gd(t)||(n.push(s),!i)););}function An(t,e,r,i){var n,o=i.xb(),a=o.c,s=!a;if(a)if(e+=(o=o.kd()).x,r+=o.y,C(o=i.ga(),Vi))for(n=(i=o.la).length;n--&&!s;)o=t.Da(i[n]),s=a.Of(e-o.x,r-o.y,0)!==de.NONE;else o=t.Da(o),s=a.Of(e-o.x,r-o.y,0)!==de.NONE;return s}function Bn(t,e,r,i,n){for(var o,a=e.length;a--&&!((o=e[a])&&o.Ea&&(t=t.concat(o.Ea(r,i,n)),t.length&&n)););return t}function vn(t){return{w:(t=t.wa[2]).right-t.left,h:t.bottom-t.top}}function Cn(t){t.i&&t.i.sa()||(Xl(t.a)||Lk()-t.ve<t.ab)&&!t.ea?t.Vf||(t.Vf=Jk(t.Kh)):(t.ea&&(t.ce(),Dn(t)),t.C=fn)}function Dn(t,e){t.dd||setTimeout(A(t.dispatchEvent,t,{type:t.A.Vi,target:e||t}),1)}function Fn(t,e,r){Zl(t.a).applyPxOffset([e,r]),qn(t),t.R.set(0,0),Yl(t.a),t.ha()}function Gn(t,e,r,i){Zl(t.a).setLookAtData({zoom:e},Fc(r)&&Fc(r)?[r,i]:B),qn(t),Yl(t.a),t.ha()}function mn(t){En(t),t.g.sa()&&t.vb(!0),t.m.sa()&&t.wb(!0)}function Hn(t,e){if(e){var r={};r.Te=e.power,r.we=e.ease,r.duration=e.duration,t.u=r}}function Jn(t,e){var r=xn(t,wn(t,e.position)),i=r.y;r=r.x;var n=e.zoom,o=xn(t,wn(t,t.ta));e=o.y;var a=o.x;o=t.zoom;var s=t.g.zb(),l=t.g.a,c=t.g.b,u=0;if(r=gn(t,a,r),e=Fd((r-=a)*r+(i-=e)*i+(o=n-o)*o),0!==s&&0!==e){var h=r/e,p=i/e,f=o/e,d=s*s/(2*e);sn(t,(function(e,r){var i;1!==e?((i=f*(r=(e=s*r-d*r*r/2)-u))&&(i=Pl(t,t.zoom+i),Gn(t,i,l,c)),Fn(t,Ad(h*r),Ad(p*r)),u=e):(Gn(t,Pl(t,n),l,c),t.ha())}),2*e/s)}}function In(t,e,r){r=r||0;var i=t.g,n=Zl(t.a),o=n.getLookAtData();e.c&&Gn(t,Pl(t,o.zoom+e.c*r),i.a,i.b),n.setLookAtData({heading:Sl(t,o.heading+e.g*r),tilt:Rl(t,o.tilt+e.f*r)}),qn(t),Fn(t,e.a*r,e.b*r)}function sn(t,e,r,i,n){t.i&&t.i.sa()&&t.i.stop(!0),t.i=new Fm(t,e,r,i,n),t.i.start()}function En(t){t.i&&t.i.sa()&&t.i.stop(!0)}T.prototype.getState=function(){return this.C},T.prototype.getState=T.prototype.getState,T.prototype.dd=!1,T.prototype.Kg=function(t){var e=this,r=t.newValue,i=t.modifiers,n=Zl(this.a);mn(this),this.R.set(0,0);var o=nn(this,r);if(bn.forEach((function(e){i&t[e.toUpperCase()]||delete o[e]})),t.b){n=Zl(this.a).getLookAtData();var a=jn(this,o);r=hn(this,a,i);var s=1;Fc(t.b)&&(s=1/t.b);var l=function(){return e.dd=!1};if(delete a.bounds,this.dd=!0,r){n=ln(this,n,r);var c=ln(this,r,a);on(this,r,n*s,(function(){return on(e,a,c*s,l)}))}else r=ln(this,n,a),on(this,a,r*s,l)}else pn(o),n.setLookAtData(o);qn(this),Yl(this.a),this.ha()},T.prototype.rg=function(){},T.prototype.setAnimationDuration=T.prototype.rg,T.prototype.$g=function(){},T.prototype.getAnimationDuration=T.prototype.$g,T.prototype.sg=function(){},T.prototype.setAnimationEase=T.prototype.sg,T.prototype.ah=function(){},T.prototype.getAnimationEase=T.prototype.ah,T.prototype.ng=function(){},T.prototype.resetAnimationDefaults=T.prototype.ng,p=T.prototype,p.nk=function(t){tn(this,t.target.ca()),Yl(this.a),this.ha()},p.Pe=function(t,e){T.j.Pe.call(this,t,e),un(e)&&(Yl(this.a),(t=(t=e.ca())&&t.Ya())&&t.getState()===Xh.INIT&&t.load())},p.Xh=function(t,e,r){var i;if(this.ve=Lk(),tn(this,e.ca()),e.requestDomMarkers||C(e,Em)||C(e,Qm)){var n=this.l.ja;for(i=n.length;i--;){var o=n[i];if(o.ob()===e){n.splice(i,1),o.F();break}}}un(e)&&$l(this.a,this.c),this.xa=this.c.La(),0===t&&(Ol(this,e,!1),this.Eb()),Um(this.Ad,vn(this),this.l.ja.filter(vc)),this.ce(),r||this.ha()},p.Yh=function(){this.Eb()},p.Eb=function(){T.j.Eb.call(this);var t=this.getCapabilities().lookAt.zoom;Zl(this.a).setZoomConstraints(zd(t.min,this.Eg),yd(t.max,this.Dg))},p.th=function(t,e){var r;if(e){if(t={oc:this.Af,fb:this.fb},e.W?(C(e,Em)||C(e,Qm))&&(r=new Dm(e)):e.requestDomMarkers&&(r=new Jm(e,t)),r){this.l.ja.push(r);var i=this.c.La();this.l.ja.sort((function(t,e){return i.indexOf(t.eb)-i.indexOf(e.eb)})),Um(this.Ad,vn(this),this.l.ja.filter(vc))}un(e)&&$l(this.a,this.c)}this.xa=this.c.La()},p.Da=function(t){return Zl(this.a).geoToPixel(t)},T.prototype.geoToScreen=T.prototype.Da,T.prototype.Pa=function(t,e){return Zl(this.a).xyToGeo(t,e)},T.prototype.screenToGeo=T.prototype.Pa,T.prototype.qg=function(t,e){return t=this.Pa(t,e),(e=this.J.jb()).position=t,e},T.prototype.Ea=function(t,e,r,i){var n=this,o=[];o=Bn(o,this.l.ja,t*this.oa,e*this.oa,r),r&&o.length?i(o):this.a.a.initialized?bm(this.a,{x:t,y:e},{radius:3.5,top_most_only:r},(function(a){yn(n,t,e,r,o,i,!1,a)})):i(o)},T.prototype.getObjectsAt=T.prototype.Ea,T.prototype.aa=z,T.prototype.T=function(){var t=this.l.ja.length;Kl(this,this.oa),this.R.set(0,0);var e=vn(this),r=e.w,i=e.h;for(this.a.a.handleViewportUpdate();t--;){var n=(e=this.l.ja[t].lb).yb();n.w===r&&n.h===i||e.cf(r,i)}this.aa=new Wi(r,i),Yl(this.a),this.ha()},T.prototype.getCapabilities=function(){return Ul},T.prototype.getCapabilities=T.prototype.getCapabilities,p=T.prototype,p.Vf=0,p.ce=function(){this.l.Nc.length=0},p.Kh=function(){this.Vf=0,this.D&&this.D.before();var t=Zl(this.a),e=t.getLookAtData(!1),r=t.getLookAtData(!0);t=this.f.center.clone(),r=r.bounds.K();var i=this.zoom,n=this.R,o=this.xa,a=o.length;for(this.ab=en;a--;){var s=o[a];C(s,qj)&&s.ca()&&s.ca().Ue(r,i)}this.ea=this.a.W(),this.J.$a(e),o=(e=this.l).ja.length;var l,c=!0;for(l=0;l<o;l++){a=e.ja[l];var u=e.Nc;a&&((s=a.W(r,t,void 0,i,!1,n,this.Da,this.a.a.getCameraMatrix()))===wk.ACTIVE&&(this.ab=1/0),s!==wk.DONE||u[l]||(Dn(this,a.ob()),u[l]=!0),u[l]||(c=!1))}this.ea=c&&this.ea,this.aa&&(this.f.$a(this.aa),this.aa=z),this.i&&this.i.sa()&&this.me(),this.D&&this.D.after(),Cn(this)},p.o=function(){var t=this.c.La()[0],e=this.f;Kk(this.Vf),En(this),t&&Ol(this,t,!1),this.l.ja.filter(vc).forEach((function(t){t.F()})),e.element&&e.element.removeChild(this.L),delete this.L,this.C=3,this.a.F(),T.j.o.call(this)},p.ha=function(){this.ve=Lk(),this.C===fn&&(this.ea=!1,this.C=1,Cn(this))},p.xd=function(t,e,r){Gn(this,t=Pl(this,Pl(this,t)),e,r)},T.prototype.zoomAt=T.prototype.xd,T.prototype.lc=function(t,e){var r=!!(e||t&(Nl.HEADING|Nl.TILT));mn(this),Hn(this,e),this.m.start(t,r),Zl(this.a).setPanning(!0)},T.prototype.startInteraction=T.prototype.lc,T.prototype.cc=function(t,e,r,i,n){var o=this.m,a=!1;if(o.sa()){var s=Zl(this.a),l=s.getLookAtData(),c=this.f.center;c=[c.x,c.y],e=o.store(t,e,r,i,n),r=o.Bf(),t=o.Nd(),n=this.m.Cf(),i=this.m.bh(),o.b&&(o.Ac(Nl.TILT)&&(s.setLookAtData({tilt:Rl(this,l.tilt+t.y/this.f.height*-180)},c),a=!0),e&&1!==n&&o.Ac(Nl.ZOOM)&&(a=o.Bf(),Gn(this,Pl(this,n=Ed(Gd(2,this.zoom)*n)/Od),a.x,a.y),a=!0),o.Ac(Nl.COORD)&&0<nm(t)&&(Fn(this,-t.x,-t.y),a=!0),o.Ac(Nl.HEADING)&&(e?s.setLookAtData({heading:l.heading+Sl(this,i)},[r.x,r.y]):t.x&&s.setLookAtData({heading:Sl(this,l.heading+t.x/this.f.width*360)},c),a=!0),a&&(Yl(this.a),this.ha()))}},T.prototype.interaction=T.prototype.cc,T.prototype.wb=function(t){var e=this;if(this.m.sa()&&!t){if(this.u){t=this.m.zb();var r=this.m.rc(),i=this.u.duration,n=(this.u.Te||1)*t,o=new Rm(-n/(0<i?i:1),n);!E(r.x)&&!E(r.y)&&0<n&&e.m.Ac(Nl.COORD)&&sn(this,(function(t){n=o.De(t*i),E(n)||Fn(e,Ad(-r.x*n),Ad(-r.y*n))}),i,void 0,this.u.we)}delete this.u,this.m.clear()}Zl(this.a).setPanning(!1),this.ha()},T.prototype.endInteraction=T.prototype.wb,T.prototype.kc=function(t,e,r){mn(this),this.g.start(e,r),Hn(this,t),Zl(this.a).setPanning(!0)},T.prototype.startControl=T.prototype.kc,T.prototype.control=function(t,e,r,i,n,o){for(var a,s=0;s<arguments.length;s++)if((a=+arguments[s])!=a)throw new D(this.control,s,a);this.g.sa()&&this.g.set(t,e,r,i,n,o)},T.prototype.control=T.prototype.control,T.prototype.vb=function(t,e){var r,i=this;if(this.g.sa()){En(this);var n=Lk(),o=n-this.Ed;if(1<=o&&In(this,zm(this.g),o),!this.u||t||e)"function"==typeof e&&(e(t=(t=Zl(this.a)).getLookAtData()),Jn(this,t));else{e=this.g.zb();var a=this.g.rc(),s=this.u.duration,l=(this.u.Te||1)*e,c=new Rm(-l/(0<s?s:1),l);!E(a.a)&&!E(a.b)&&0<l&&sn(this,(function(t,e,o,u){n&&(o=u-n,n=0),l=c.De(t*s)*o,E(l)||((r=a.c*l)&&Gn(i,Pl(i,i.zoom+r),i.g.a,i.g.b),Fn(i,Ad(a.a*l),Ad(a.b*l)))}),s,void 0,this.u.we)}this.g.reset(),Zl(this.a).setPanning(!1),this.ha()}},T.prototype.endControl=T.prototype.vb,T.prototype.sb=function(t){var e=this,r=t.b;this.R.set(0,0),r.a||r.b||r.c||r.f||r.g||r.i?(this.Ed=Lk(),sn(this,(function(t,i,n,o){e.Ed=o,In(e,r,n)}),Wd),this.ha()):En(this)},T.prototype.Wg=function(){},T.prototype.enter=T.prototype.Wg,T.prototype.Xg=function(t){Ml(this.L,t)},T.prototype.exit=T.prototype.Xg,T.prototype.capture=function(t,e,r,i){var n=this;return cm(n.a).then((function(o){var a=n.L.ownerDocument.createElement("canvas"),s=n.oa,l=a.getContext("2d"),c=n.a.Xa()/s,u=(r-t)*s;return s*=i-e,a.width=u,a.height=s,l.drawImage(o,t*c,e*c,u*c,s*c,0,0,u,s),a}))},T.prototype.Il=function(t){return Zl(this.a).geoToMeters(t)},T.prototype.geoToMeters=T.prototype.Il,T.prototype.Vn=function(t){return Zl(this.a).metersToGeo(t)},T.prototype.metersToGeo=T.prototype.Vn;var en=5e3;function U(t,e,r){var i={};if(!(t instanceof HTMLElement))throw new D(U,0);if(U.j.constructor.call(this),this.i=Kn(r,U),this.c=r=new Ll,this.D=!1,r.addEventListener(r.A.le,this.R,!1,this),!C(t,Element))throw new D(U,0,t);var n=(r=this.S=t.ownerDocument.createElement("div")).style;if(n.position="relative",n.height=r.style.width="100%",n.overflow="hidden",n.webkitTapHighlightColor="transparent","transparent"!==n.webkitTapHighlightColor&&(n.webkitTapHighlightColor="rgba(0,0,0,0)"),t.appendChild(r),this.b=new xk(this.S,this.i),this.b.addEventListener(this.b.A.le,this.R,!1,this),(t=this.a=new sj(this.i.layers)).addEventListener(t.A.ke,this.P,!1,this),t.addEventListener(t.A.he,this.P,!1,this),t.addEventListener(t.A.je,this.P,!1,this),!this.l&&Ln(this),this.g=null,this.a.add(e,0),this.f=this.u(null!=this.i.engineType?this.i.engineType:jk,this.i),this.J=A(this.J,this),(e=this.i.imprint)!==B&&"object"!=typeof e)throw new D(U,1,"imprint");Mn&&(e||(e={}),e.mark=e.mark||"GS (2022) 5659"),this.s=null===e?e:new Bj(this,e),e=this.i.autoColor,this.L=e===B||!!e,Nn(this),(e=this.i.zoom)&&(i.zoom=e),(e=this.i.bounds)&&(i.bounds=e),(e=this.i.center)&&(i.position=e),this.c.Wb(i)}function Kn(t,e){if(t){var r=t.pixelRatio;if(r===B)t.pixelRatio=Ue();else if(!(0<r))throw new D(e,0,"pixelRatio: "+r)}else(t={}).pixelRatio=Ue();return t.renderBaseBackground||(t.renderBaseBackground={lower:3,higher:2}),t}function Nn(t){t.s&&t.L&&t.s.vi({invert:t.g&&t.g.yl})}function On(t,e,r){t.dispatchEvent(r?new dj(t.A.Qi,r.newValue,r.oldValue,r.modifiers):t.A.Qi+e)}function Pn(t){xj.call(this,t)}function Ln(t){t.m=new N({max:24,engineType:t.i.engineType}),t.l=new tl(t.m,t.i),t.a.add(t.l)}u(U,F),t("H.Map",U),U.prototype.draggable=!1,U.prototype.o=function(){this.L=!1,this.s&&this.s.F(),this.f.dispose(),this.c.F(),this.b.F(),this.l.F(),this.m.F(),this.a.F();var t=this.S;t.parentNode.removeChild(t),delete this.S,F.prototype.o.call(this)},U.prototype.N=function(){return this.S},U.prototype.getElement=U.prototype.N,U.prototype.Xa=function(){return this.i.pixelRatio},U.prototype.getPixelRatio=U.prototype.Xa,U.prototype.P=function(t){var e=t.added,r=t.removed;e&&e.ca()&&e.ca().ka(this),r&&r.ca()&&r.ca().ka(null),r===this.l&&(delete this.l,delete this.m),r===this.g&&(this.g=null),0===t.idx&&(this.dispatchEvent(new cj(this.A.lf,this.g=t.type!==this.a.A.je?e:0<this.a.a.length?this.a.get(0):z,t.type!==this.a.A.he?r:1<this.a.a.length?this.a.get(1):z)),Nn(this))},U.prototype.R=function(t){t.modifiers&&(this.D||(On(this,"start"),this.D=!0),On(this,"",t),this.T&&x.clearTimeout(this.T),this.T=x.setTimeout(this.J,333))},U.prototype.J=function(){On(this,"end"),this.D=!1},U.prototype.tg=function(t,e){return this.f.getCapabilities().lookAt&&this.c.Wb({position:t},!!e),this},U.prototype.setCenter=U.prototype.tg,U.prototype.bb=function(){var t=this.c.jb();return t?t.position:z},U.prototype.getCenter=U.prototype.bb,U.prototype.df=function(t,e){return this.c.df(t,!!e),this},U.prototype.setZoom=U.prototype.df,U.prototype.pb=function(){return this.c.pb()},U.prototype.getZoom=U.prototype.pb,U.prototype.xd=function(t,e,r){this.f.zoomAt(t,e,r)},U.prototype.zoomAt=U.prototype.xd,U.prototype.hn=function(){return this.b},U.prototype.getViewPort=U.prototype.hn,U.prototype.gn=function(){return this.c},U.prototype.getViewModel=U.prototype.gn,U.prototype.wm=function(){return this.a},U.prototype.getLayers=U.prototype.wm,U.prototype.qm=function(){return this.s},U.prototype.getImprint=U.prototype.qm,U.prototype.capture=function(t,e,r,i,n,o){function a(t,e){d?t.cancel():(c.save(),e.capture(l,p,(function(e){c.restore(),t.done(e)}),(function(e){t.done(null,e),s(null)})))}function s(e){d||(d=!0,t(e))}var l,c,u=this.f,h=u.getCapabilities(),p=this.i.pixelRatio,f=this.b,d=!1,y=this;if(!Da(t))throw new D(this.capture,0,t);r=r||0,i=i||0,n=n||f.width,o=o||f.height;var g=zd(0,yd(r,n)),v=zd(0,yd(i,o));r=yd(f.width,zd(r,n)),i=yd(f.height,zd(i,o)),h.capture?u.capture(g,v,r,i).then((function(t){var r=y.s,i=e||[];c=(l=t).getContext("2d"),l.style.width=l.width/p+"px",l.style.height=l.height/p+"px";var n=new Mk(10,a);(i=i.concat(r).filter((function(t){return Da(t&&t.capture)}))).length?(t=i.pop(),i.forEach((function(t){n.push(t,ld)})),n.push(t,A(s,y,l)),Fk(n)):s(l)}),(function(){s(z)})):t(null)},U.prototype.capture=U.prototype.capture,U.prototype.cm=function(){return this.f},U.prototype.getEngine=U.prototype.cm,U.prototype.u=function(t,e){if(e=e?Kn(e,this.u):this.i,Nn(this),t===kk.P2D)return new x.H.map.render.p2d.RenderEngine(this.b,this.c,this.a,e);if(t===kk.WEBGL)return new T(this.b,this.c,this.a,e);if(t===kk.HARP)return new x.H.map.render.harp.RenderEngine(this.b,this.c,this.a,e);throw new D(this.u,0,t)},U.prototype.gf=function(t,e,r,i,n){if(e=vc(e)?C(e,K,this.gf,1,e)&&e:this.c.jb().bounds.K(),!C(n=n||this.g,pl))throw new D(this.gf,4);var o=n.ca(),a=this.Xa(),s=n.tileSize;if(2<=a&&256<s&&o instanceof Ek&&(s/=2),a=this.pb(),s=Math.log2(s)-8,!((r=vc(r)?+r:a)<=(i=vc(i)?+i:a)))throw new D(this.gf,B,"!(min <= max)");a=o.min;var l=o.max,c=this.f.type===kk.WEBGL?Bd:Ad;if(r=ae(c(r)-s,a,l),i=ae(c(i)-s,a,l),!(o&&C(o,S)&&od()&&o.l()))throw new $c(this.gf,"Storing is not supported");return new Ak(n,o,e,r,i,t)},U.prototype.storeContent=U.prototype.gf,u(Pn,xj),Pn.prototype.f=function(){zj(this,2)},Pn.prototype.c=function(){zj(this,4)},U.prototype.xl=function(t){return t=new Pn(t),nd().clear(A(t.f,t),A(t.c,t)),t},U.prototype.clearContent=U.prototype.xl,U.prototype.nf=function(t,e){var r=this.a,i=r.indexOf(t),n=e!==+e;return e=n?r.a.length-1:e,0>i?r.add(t,e):i-e&&(r.hc(i),r.add(t,n?e-1:e)),this},U.prototype.addLayer=U.prototype.nf,U.prototype.ae=function(t){var e=this.a.indexOf(t);return t!==this.g&&t!==this.l&&-1!==e&&this.a.hc(e),this},U.prototype.removeLayer=U.prototype.ae,U.prototype.ud=function(t){return this.g!==t&&(this.a.a.length&&this.a.get(0)!==this.l?this.a.set(0,t):this.a.add(t,0),this.g=t),this},U.prototype.setBaseLayer=U.prototype.ud,U.prototype.Ol=function(){return this.g},U.prototype.getBaseLayer=U.prototype.Ol,U.prototype.Da=function(t){if(!lg(t))throw new D(this.Da,0,t);return(t=this.f.geoToScreen(t))?zf(t):z},U.prototype.geoToScreen=U.prototype.Da,U.prototype.Pa=function(t,e){var r;if(r=+E(t)||2*+E(e))throw new D(this.Pa,r-1,arguments[r-1]);return(r=this.f.screenToGeo(t,e))?ng(r):z},U.prototype.screenToGeo=U.prototype.Pa,U.prototype.qg=function(t,e){return this.f.screenToLookAtData(t,e)},U.prototype.screenToLookAtData=U.prototype.qg,U.prototype.fa=function(t){if(!C(t,M))throw new D(this.fa,0,t);return!this.l&&Ln(this),this.m.bc().fa(t),t},U.prototype.addObject=U.prototype.fa,U.prototype.Ga=function(t){if(!C(t,M))throw new D(this.Ga,0,t);return!this.l&&Ln(this),this.m.bc().Ga(t),t},U.prototype.removeObject=U.prototype.Ga,U.prototype.Ua=function(t){return!this.l&&Ln(this),this.m.bc().Ua(t)},U.prototype.getObjects=U.prototype.Ua,U.prototype.Xb=function(t){var e;Bc(t,this.Xb,0,t),!this.l&&Ln(this);var r=t.length;for(e=0;e<r;e++)this.fa(t[e]);return this},U.prototype.addObjects=U.prototype.Xb,U.prototype.rd=function(t){var e;Bc(t,this.rd,0,t),!this.l&&Ln(this);var r=t.length;for(e=0;e<r;e++)this.Ga(t[e]);return this},U.prototype.removeObjects=U.prototype.rd,U.prototype.Od=function(t,e,r){var i;if(i=+E(t)||2*+E(e))throw new D(this.Od,i-1,arguments[i-1]);this.f.getObjectsAt(t,e,!0,(function(t){r(t[0])}))},U.prototype.getObjectAt=U.prototype.Od,U.prototype.Ea=function(t,e,r,i){var n;if(n=+E(t)||2*+E(e))throw new D(this.Od,n-1,arguments[n-1]);this.f.getObjectsAt(t,e,!1,r,!!i)},U.prototype.getObjectsAt=U.prototype.Ea,U.prototype.ld=function(t,e,r){var i=(r=r||{}).zoom;r.zoom=vc(i)?i:this.c.pb(),this.m.ld(t,e,r)},U.prototype.getObjectsWithin=U.prototype.ld;var Qn=Tl.HARP,kk={P2D:Tl.P2D,WEBGL:Tl.WEBGL,HARP:Qn};function Rn(t,e){Rn.j.constructor.call(this,t,e)}function sh(t,e,r){var i="anonymous",n=1;this.c=A(this.c,this),M.call(this,r),this.da(t),r&&((t="crossOrigin")in r&&(i=r[t]),(t="opacity")in r&&(n=r[t])),this.Ok(e,i),this.ic(n)}function Sn(t,e){Sn.j.constructor.call(this,t,e)}U.EngineType=kk,U.prototype.A={Wo:"mapviewchangestart",Qi:"mapviewchange",Ri:"mapviewchangeend",lf:"baselayerchange"},u(Rn,rh),t("H.map.Marker",Rn),Rn.prototype.type=nh.MARKER,Rn.prototype.T=1,Rn.prototype.ra=function(t){if(t!==kh.VISUAL||1===this.zk||1===this.icon.getState())var e=Rn.j.ra.call(this,t);return e||!1},Rn.prototype.invalidate=Rn.prototype.ra,p=Rn.prototype,p.zk=0,p.Uj=function(t){return C(t,Wj)},p.xh=!1,p.mk=function(){this.ra(kh.VISUAL)},p.Ic=function(t){var e=this.icon;return this.xh&&(e.removeEventListener("statechange",this.mk,!1,this),delete this.xh),e&&(this.zk=e.getState()),Rn.j.Ic.call(this,t),0===t.getState()&&(this.xh=!0,Fe(t,"statechange",this.mk,!1,this)),this},Rn.prototype.setIcon=Rn.prototype.Ic,Rn.prototype.b=function(t){return new Wj(t.svg,t)},Rn.prototype.Y=function(){var t=this.getIcon(),e=t.Fo||0,r=Rn.j.forWorkerMessage.call(this),i=r.properties.icon;return i&&0<e&&Ya(i,{stick_color:t.Eo,stick_height:e}),r},Rn.prototype.forWorkerMessage=Rn.prototype.Y,u(sh,M),t("H.map.Overlay",sh),sh.prototype.type=nh.OVERLAY,sh.prototype.K=function(){return this.a},sh.prototype.getBoundingBox=sh.prototype.K,sh.prototype.de=function(t){return C(t,K,this.de,0,t),this.da(t)},sh.prototype.setBoundingBox=sh.prototype.de,sh.prototype.ga=function(){return this.a},sh.prototype.getGeometry=sh.prototype.ga,sh.prototype.da=function(t){var e=this.a,r=!e;return C(t,K,this.da,0,t),!r&&e.ia(t)||(this.a=t,r||this.ra(kh.SPATIAL)),this},sh.prototype.setGeometry=sh.prototype.da,sh.prototype.Qc=function(){return this.b.getData()},sh.prototype.getBitmap=sh.prototype.Qc,sh.prototype.Ok=function(t,e){var r=this.b;return r&&1!==r.getState()&&r.cancel(),this.b=new Rj(t,this.c,!0,B,e),this},sh.prototype.setBitmap=sh.prototype.Ok,sh.prototype.c=function(t,e){this.b=e,1===t&&this.ra(kh.VISUAL)},sh.prototype.Tc=function(){return this.f},sh.prototype.getOpacity=sh.prototype.Tc,sh.prototype.ic=function(t){var e=this.f,r=2>e;if(!(0<=t&&1>=t))throw new D(this.ic,0);return t!==e&&(this.f=t,r&&this.ra(kh.VISUAL)),this},sh.prototype.setOpacity=sh.prototype.ic,sh.prototype.Y=function(){var t=sh.j.Y.call(this);return t.geometry=Ci(this.a).Y(),t.properties.overlay=!0,t},sh.prototype.forWorkerMessage=sh.prototype.Y,u(Sn,pl),t("H.map.layer.MarkerTileLayer",Sn);var Tn={markers:[],total:0,requested:0};function Un(t,e,r,i,n){var o,a=Bd(r);for(t.pixelProjection.Oa(a),e=t.Sd(t.Ae(e),a),r=t.Ke(e,e.left>e.right,~~r,i,n),t=r.tiles,r=r.total,i=t.length,n=[],o=0;o<i;o++)for(a=(e=t[o]).data.length;a--;)n.push(e.data[a]);return{markers:n,total:t.length,requested:r}}function Vn(t,e,r){var i,n=6;if(e){for(i=' expected close to: "'+e;n--;)-1!==(e=t.a.next())&&(i+=String.fromCharCode(e));i+='"'}throw new D(Wn,0,"- Malformed WKT: "+(i?r+i:"unexpected end of stream"))}function Xn(t,e){var r=t.next();r!==(e=e?")":"(")&&Vn(t,r,'"'+e+'"')}function Yn(t){return","===Zn(t)&&(t.next(),!0)}function $n(t,e,r,i,n){var o,a,s=2+e+r;for(a=1;a<=s;a++)(r=t.next())?(o=+r)!==o?Vn(t,r,"number"):1===a?i[n+1]=o:2===a?i[n]=o:3===a&&(i[n+2]=o):Vn(t,r);e||(i[n+2]=0)}Sn.prototype.Ec=function(t,e,r,i){return this.ma.providesDomMarkers()?Tn:Un(this,t,e,r,i)},Sn.prototype.requestMarkers=Sn.prototype.Ec,Sn.prototype.Dc=function(t,e,r,i){return this.ma.providesDomMarkers()?Un(this,t,e,r,i):Tn},Sn.prototype.requestDomMarkers=Sn.prototype.Dc;var ao=[];function bo(t,e,r,i){return i||Xn(t,0),$n(t,e,r,ao,0),i||Xn(t,1),new kg(ao[0],ao[1],e?ao[2]:B)}function co(t,e,r){var i=[];Xn(t,0);do{$n(t,e,r,i,i.length)}while(Yn(t));return Xn(t,1),new L(i)}function eo(t,e,r){Xn(t,0);var i=co(t,e,r);if(Yn(t)){var n=[];do{n.push(co(t,e,r))}while(Yn(t))}return Xn(t,1),new O(i,n)}var fo=[],go=[eo],ho=[bo],io={POINT:ho,LINESTRING:[co],POLYGON:go,MULTIPOINT:[bo,Vi],MULTILINESTRING:[co,ih],MULTIPOLYGON:[eo,Ji],GEOMETRY:fo,GEOMETRYCOLLECTION:fo,CIRCULARSTRING:fo,COMPOUNDCURVE:fo,CURVEPOLYGON:fo,MULTICURVE:fo,MULTISURFACE:fo,CURVE:fo,SURFACE:fo,POLYHEDRALSURFACE:fo,TIN:fo,TRIANGLE:fo},jo={Z:1,M:2,ZM:3};function Wn(t){var e,r=(t=new ko(t)).next();if((e=io[r.toUpperCase()])||Vn(t,r,"type name"),e!==fo){r=Zn(t);var i=1&(r=jo[r.toUpperCase()]),n=r>>1;if(i|n&&t.next(),"EMPTY"===(r=Zn(t)))if(t.next(),i=e[1])var o=new i([]);else e!==ho&&(o=new L([]),e===go&&(o=new O(o)));else if("("===r){if(o=e[0],e=e[1]){var a=[];if(Xn(t,0),o===bo){var s="("!==Zn(t);do{a.push(o(t,i,n,s))}while(Yn(t))}else do{a.push(o(t,i,n))}while(Yn(t));Xn(t,1),i=new e(a)}else i=o(t,i,n);o=i}else Vn(t,r,'"Z", "M", "ZM", "(" or "EMPTY"');t.next()&&Vn(t,r,"end of stream")}return o||z}function ko(t){this.a=t}function Zn(t){var e=t.b;if(e===B){for(e=t.a;e.Pb()===lo;)e.next();if(mo[e.Pb()])e=(e=e.next())===no?"":String.fromCharCode(e);else{e.ge();do{e.next()}while(!mo[e.Pb()]);e=String.fromCharCode.apply(null,e.Gd())}t.b=e}return e}ko.prototype.next=function(){var t=Zn(this);return""!==t&&delete this.b,t};var lo=32,no=-1,oo={$o:lo,Uo:40,Zo:41,Ro:44,So:no},mo=Object.keys(oo).reduce((function(t,e){return t[oo[e]]=!0,t}),oc());function po(){}function qo(t){this.c=String(t),this.f=0,this.a=[],this.b=!1}function ro(t,e){ro.j.constructor.call(this,Ki,e),this.de(t)}function so(){return Hf("H-core","1.51.0","a104c13",{region:"row"})}t("H.util.ICharStream",po),po.prototype.next=function(){},po.prototype.ge=function(){},po.prototype.Gd=function(){},po.prototype.Pb=function(){},t("H.util.CharStream",qo),qo.prototype.next=function(){var t=this.c.charCodeAt(this.f++);return t=isNaN(t)?-1:t,this.b&&this.a.push(t),t},qo.prototype.ge=function(){this.b=!0,this.a=[]},qo.prototype.Gd=function(){var t=this.a.slice();return this.b=!1,this.a=[],t},qo.prototype.Pb=function(){var t=this.c.charCodeAt(this.f);return isNaN(t)?-1:t},t("H.util.wkt.toGeometry",(function(t){return Wn(new qo(t))})),u(ro,uh),t("H.map.Rect",ro),ro.prototype.de=function(t){if(!C(t,K))throw new D(this.de,0,t);t.ia(this.aa)||(this.aa=this.D=t,this.a!==z&&ro.j.da.call(this,Ci(t)))},ro.prototype.setBoundingBox=ro.prototype.de,ro.prototype.K=function(){return this.D},ro.prototype.getBoundingBox=ro.prototype.K,ro.prototype.da=function(){return this},ro.prototype.setGeometry=ro.prototype.da,ro.prototype.ga=function(){return this.a===Ki&&ro.j.da.call(this,Ci(this.aa)),this.a},ro.prototype.getGeometry=ro.prototype.ga,t("H.buildInfo",so);var Mn="cn"===so().region,jk=kk[Mn?"HARP":"WEBGL"],to,uo="maps".concat("js-"),vo,wo,xo,yo,zo;if(vo=x.document.querySelector('script[src*="'+uo+'"]'),!vo)for(wo=x.document.getElementsByTagName("script"),yo=new RegExp("^.*"+uo),zo=0,xo=wo.length;zo<xo;zo++)if(yo.test(wo[zo].src)){vo=wo[zo];break}function Ao(){var t=decodeURIComponent(to);if(t){t="/"===t[t.length-1]?t.substring(0,t.length-1):t;var e=x.document,r="";e?((e=e.createElement("a")).href=t,r=e.href):/[\w]+:\/\//.test(t)&&(r=t),(t=new URL(r)).pathname+="/"===t.pathname[t.pathname.length-1]?"styles":"/styles",t=t.toString()}else t="https://js.api.here.com/v3/3.1.51.0/styles";return t}function Bo(t){var e=t.ownerDocument;e=e.documentElement||e.body.parentNode||e.body;try{var r=t.getBoundingClientRect()}catch(t){r={top:0,right:0,bottom:0,left:0,height:0,width:0}}return{x:r.left+("number"==typeof window.pageXOffset?window.pageXOffset:e.scrollLeft),y:r.top+("number"==typeof window.pageYOffset?window.pageYOffset:e.scrollTop)}}to=vo?vo.src.replace(/\/[^\/]*$/,"/"):"",t("H.getScriptPath",(function(){return to})),t("H.getStylePath",Ao);var Co=function(){return this}.apply(null);function Do(t,e,r,i,n,o){if(isNaN(t))throw Error("x needs to be a number");if(isNaN(e))throw Error("y needs to be a number");if(isNaN(r))throw Error("pointer must have an id");this.viewportX=t,this.viewportY=e,this.target=null,this.id=r,this.type=i,this.dragTarget=null,this.button=vc(n)?n:-1,this.buttons=vc(o)?o:0,this.a=this.button}function Eo(t,e,r){if(isNaN(e))throw Error("x needs to be a number");if(isNaN(r))throw Error("y needs to be a number");t.viewportX=e,t.viewportY=r}function Fo(t,e){t.a=e,t.buttons|=Go[+e]||0}function Ho(t,e){t.a=e,t.buttons&=~(Go[+e]||0)}t("H.mapevents.Pointer",Do),Do.prototype.tm=function(){return this.a},Do.prototype.getLastChangedButton=Do.prototype.tm;var Go=[1,4,2],Io={NONE:-1,LEFT:0,MIDDLE:1,RIGHT:2};function Jo(t,e,r,i,n,o,a){Jo.j.constructor.call(this,t),this.pointers=e,this.changedPointers=r,this.targetPointers=i,this.currentPointer=n,this.originalEvent=a,this.target=o}function Ko(t){this.a=t instanceof Array?t.slice(0):[]}function Lo(t,e){return-1!==(e=t.indexOf(e))?t.a[e]:null}function Mo(t,e){for(var r=t.a.length,i=[];r--;)t.a[r].type!==e&&i.push(t.a[r]);t.a=i}function No(t,e){for(var r=t.a.length;r--;)if(t.a[r].dragTarget===e)return!0;return!1}function Oo(t,e,r){if(r=r||{},!(t instanceof U))throw Error("events: map instance required");if(!(e instanceof Array))throw Error("events: map array required");qd.call(this),this.Tg=r.Tg||300,this.gj=r.gj||50,this.Zk=r.Zk||50,this.$k=r.$k||500,this.Ch=r.Ch||900,this.Bh=r.Bh||8,this.map=t,this.m=this.map.b,this.f=this.m.element,this.D=e,this.a=new Ko,this.b=new Ko,this.l={},this.c=null,this.u=!0,this.U={},this.g={},this.s=null,this.te=A(this.te,this),this.P={pointerdown:this.Bl,pointermove:this.Cl,pointerup:this.Dl,pointercancel:this.Al},Po(this)}function Po(t,e){var r,i=t.D.length;for(r=0;r<i;r++){var n=t.D[r],o=n.listener;"function"==typeof o&&(e?(n.target||t.f).removeEventListener(n.Sa,o):(n.target||t.f).addEventListener(n.Sa,o))}}function Qo(t,e,r){var i;if("function"==typeof t.P[e]){"pointermove"!==e&&(t.u=!0);var n=0;for(i=t.b.length();n<i;n++){var o=t.b.a[n]||null;t.f.contains(r.composedPath()[0])?Ro(t,o,t.nj.bind(t,r,e,o)):t.nj(r,e,o,null)}}t.b.clear()}function Ro(t,e,r){if(t.c===e)r(e.target);else{var i=t.m,n=e.viewportX;if(e=e.viewportY,0>n||0>e||n>=i.width||e>=i.height)r(z);else{var o=t.map;o.Od(n,e,(function(t){r(t||o)}))}}}function To(t,e,r){e===t.c&&(Uo(t,e.dragTarget,"dragend",r,e),t.c=null,So(e.id,t.U)),e.dragTarget=null}function So(t,e){e[t]&&(e[t].timeout?clearTimeout(e[t].timeout):clearTimeout(e[t]),delete e[t])}function Vo(t,e,r){var i=e.target,n=new J(e.viewportX,e.viewportY),o=e.id;So(o,t.g);var a=setTimeout((function(){i&&i===e.target&&n.Wa({x:e.viewportX,y:e.viewportY})<t.Bh&&(Uo(t,i,"longpress",r,e),delete t.l[e.id])}),t.Ch);t.g[o]={timeout:a,Se:n}}function Uo(t,e,r,i,n){if(e&&"function"==typeof e.dispatchEvent){var o,a=Jo,s=t.a.La(),l=t.b.La(),c=(t=t.a).a.length,u=[];for(o=0;o<c;o++)t.a[o].target===e&&u.push(t.a[o]);a=new a(r,s,l,u,n,e,i),n.button=/^(?:longpress|(?:dbl)?tap|pointer(?:down|up))$/.test(r)?n.a:Io.NONE,e.dispatchEvent(a)}return a}function Wo(t){this.i=A(this.i,this),Oo.call(this,t,[{Sa:"touchstart",listener:this.i},{Sa:"touchmove",listener:this.i},{Sa:"touchend",listener:this.i},{Sa:"touchcancel",listener:this.i}]),this.L={touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",touchcancel:"pointercancel"},this.J=(t=(t=t.s)?t.N():null)?Array.prototype.slice.call(t.querySelectorAll("a"),0):[]}function Xo(t){var e=Yo(this);(window.PointerEvent||window.MSPointerEvent)&&e.push({Sa:"MSHoldVisual",listener:"prevent"}),Oo.call(this,t,e)}function Yo(t){var e,r,i=!!window.PointerEvent,n=[];return t.i=A(t.i,t),"MSPointerDown MSPointerMove MSPointerUp MSPointerCancel MSPointerOut MSPointerOver".split(" ").forEach((function(o){e=o.toLowerCase().replace(/ms/g,""),r=i?e:o,n.push({Sa:r,listener:t.i,target:/^pointer(up|move)$/.test(e)?window:null})})),n}Do.Button=Io,u(Jo,ud),t("H.mapevents.Event",Jo),p=Ko.prototype,p.clear=function(){this.a.splice(0,this.a.length)},p.length=function(){return this.a.length},p.indexOf=function(t){for(var e=this.a.length;e--;)if(this.a[e].id===t)return e;return-1},p.remove=function(t){return-1!==(t=this.indexOf(t))?this.a.splice(t,1)[0]:null},p.push=function(t){if(t instanceof Do)return this.a.push(t);throw Error("list needs a pointer")},p.La=function(){return this.a},p.clone=function(){return new Ko(this.a)},u(Oo,qd),p=Oo.prototype,p.nj=function(t,e,r,i){So(r.id,this.U),this.P[e].call(this,r,i,t)},p.Dl=function(t,e,r){var i=t.id;t.target=e,To(this,t,r),Uo(this,e,"pointerup",r,t),"mouse"!==t.type&&Uo(this,e,"pointerleave",r,t),e=this.l[t.id];var n={x:t.viewportX,y:t.viewportY},o=r.timeStamp,a=t.target,s=this.s;e&&e.target===a&&e.Se.Wa(n)<this.Zk&&o-e.Hi<this.$k?(Uo(this,a,"tap",r,t),s&&s.target===a&&o-s.Hi<this.Tg?s.Se.Wa({x:t.viewportX,y:t.viewportY})<this.gj&&(Uo(this,a,"dbltap",r,t),this.s=null):this.s={target:a,Se:new J(t.viewportX,t.viewportY),Hi:r.timeStamp}):this.s=null,this.l={},So(i,this.g)},p.te=function(t,e){var r=this;Uo(this,t.dragTarget,"drag",e,t),So(t.id,this.U),this.U[t.id]=setTimeout((function(){r.te(t,e)}),150)},p.Cl=function(t,e,r){var i=t.dragTarget,n=t.id,o=t.target;t.target=e,o!==e&&(Uo(this,o,"pointerleave",r,t),Uo(this,e,"pointerenter",r,t)),i?this.c?(this.te(t,r),this.g[n]&&this.g[n].Se.Wa({x:t.viewportX,y:t.viewportY})>this.Bh&&So(n,this.g)):this.u?this.u=!1:(this.c=t,Uo(this,i,"dragstart",r,t),this.te(t,r),delete this.l[n],this.u=!0):(!this.c||this.c&&this.c.dragTarget!==e&&this.c.dragTarget!==this.map)&&Uo(this,e,"pointermove",r,t)},p.Bl=function(t,e,r){var i=!(/^(?:mouse|pen)$/.test(t.type)&&0!==r.button);if(e){t.target=e,this.l[t.id]={Se:new J(t.viewportX,t.viewportY),target:t.target,Hi:r.timeStamp},"mouse"!==t.type&&Uo(this,e,"pointerenter",r,t);var n=Uo(this,e,"pointerdown",r,t);!this.c&&i&&(e.draggable&&!No(this.a,e)?t.dragTarget=e:!this.map.draggable||n.defaultPrevented||No(this.a,this.map)||(t.dragTarget=this.map)),Vo(this,t,r)}},p.Al=function(t,e,r){var i=t.id;t.target=null,e?(Uo(this,e,"pointerleave",r,t),Uo(this,e,"pointercancel",r,t)):Uo(this,this.map,"pointercancel",r,t),To(this,t,r),this.l={},So(i,this.g)},p.o=function(){Po(this,!0),this.a.clear(),this.b.clear();var t,e=this.U;for(t in e)So(t,e);for(var r in e=this.g)So(r,e);delete this.f,delete this.D,delete this.a,delete this.b,delete this.map,this.s=null,delete this.l,this.c=null,qd.prototype.o.call(this)},u(Wo,Oo),Wo.prototype.i=function(t){var e,r=t.touches,i=this.a.length();if("touchstart"===t.type&&i>=r.length){for(i=this.a.clone(),e=r.length;e--;)i.remove(r[e].identifier);for(e=i.length();e--;)this.a.remove((i.a[e]||null).id);this.b=i,Qo(this,"pointercancel",t),this.b.clear()}if(this.L[t.type]){r=Bo(this.m.element),i=t.type;var n,o=(e=t.changedTouches).length;for(this.b.clear(),n=0;n<o;n++){var a=e[n],s=Lo(this.a,a.identifier),l=a.pageX-r.x,c=a.pageY-r.y;if(s)if("touchmove"===i){a=Math.abs(s.viewportX-l);var u=Math.abs(s.viewportY-c);(1<a||1<u||1===a&&1===u)&&(Eo(s,l,c),this.b.push(s))}else"touchend"===i&&(this.a.remove(s.id),this.b.push(s),Ho(s,Io.LEFT));else s=new Do(l,c,a.identifier,"touch",Io.LEFT,1),this.a.push(s),this.b.push(s)}Qo(this,this.L[t.type],t),-1===this.J.indexOf(t.target)&&t.preventDefault()}},Wo.prototype.o=function(){this.J=null,Oo.prototype.o.call(this)},u(Xo,Oo);var Zo={2:"touch",3:"pen",4:"mouse"};function $o(t,e,r,i){$o.j.constructor.call(this,"contextmenu"),this.items=[],this.viewportX=t,this.viewportY=e,this.target=r,this.originalEvent=i}function ap(t){this.ph=A(this.ph,this),this.rh=A(this.rh,this),this.qh=A(this.qh,this),this.J=!1,this.i=-1,this.L=0,ap.j.constructor.call(this,t,[{Sa:"contextmenu",listener:this.ph},{target:t,Sa:"longpress",listener:this.rh},{target:t,Sa:"dbltap",listener:this.qh}])}function bp(t,e,r,i,n){var o=t.map,a=Date.now()-t.L;n?!t.J&&a>t.Ch&&(t.J=!0,n.dispatchEvent(new $o(e,r,n,i)),Fe(o.N(),cp,t.mj,!1,t)):o.Od(e,r,t.Jn.bind(t,e,r,i))}Xo.prototype.i=function(t){var e=window.PointerEvent?t.type:t.type.toLowerCase().replace(/ms/g,""),r=Bo(this.f),i=Lo(this.a,t.pointerId),n=t.pageX-r.x;r=t.pageY-r.y;var o=Zo[t.pointerType]||t.pointerType;if(cd&&"rtl"===x.getComputedStyle(this.m.element).direction&&(n-=(x.devicePixelRatio-1)*this.m.width),!(i||/^pointer(up|out|cancel)$/.test(e)||"touch"===o&&"pointerdown"!==e)){i={x:n,y:r};var a=t.pointerType;"number"==typeof a&&(a=Zo[a]),i=new Do(i.x,i.y,t.pointerId,a,t.button,t.buttons),this.a.push(i)}i&&(/^pointer(up|cancel)$/.test(e)?("touch"===o&&this.a.remove(i.id),Ho(i,t.button)):"pointerdown"===e&&("touch"===t.pointerType&&(Mo(this.a,"mouse"),Mo(this.a,"pen")),Fo(i,t.button)),this.b.push(i),"pointermove"!==e?(Eo(i,n,r),Qo(this,/^pointer(over|out)$/.test(e)?"pointermove":e,t)):i.viewportX===n&&i.viewportY===r||(Eo(i,n,r),Qo(this,e,t))),this.b.clear()},u($o,ud),t("H.mapevents.ContextMenuEvent",$o),u(ap,Oo),p=ap.prototype,p.rh=function(t){var e=t.currentPointer;"touch"===e.type&&1===t.pointers.length&&bp(this,e.viewportX,e.viewportY,t.originalEvent,t.target)},p.qh=function(t){"touch"===t.currentPointer.type&&(this.L=Date.now())},p.ph=function(t){var e=this;-1===this.i?this.i=setTimeout((function(){var r=Bo(e.f),i=t.pageX-r.x;r=t.pageY-r.y,e.i=-1,bp(e,i,r,t)}),this.Tg):(clearInterval(this.i),this.i=-1),t.preventDefault()},p.Jn=function(t,e,r,i){bp(this,t,e,r,i=i&&Da(i.dispatchEvent)?i:this.map)},p.mj=function(){this.J&&(this.J=!1,this.map.dispatchEvent(new ud("contextmenuclose",this.map)))},p.o=function(){var t=this.map.N();clearInterval(this.i),t&&Me(t,cp,this.mj,!1,this),Oo.prototype.o.call(this)};var cp=["mousedown","touchstart","pointerdown","wheel"];function dp(t,e,r,i,n){dp.j.constructor.call(this,"wheel"),this.delta=t,this.viewportX=e,this.viewportY=r,this.target=i,this.originalEvent=n}function ep(t){var e="onwheel"in document;this.T=e,this.L=(e?"d":"wheelD")+"elta",this.i=A(this.i,this),ep.j.constructor.call(this,t,[{Sa:(e?"":"mouse")+"wheel",listener:this.i}]),this.J=this.map.b}function fp(t){this.i=A(this.i,this),Oo.call(this,t,[{Sa:"mousedown",listener:this.i},{Sa:"mousemove",listener:this.i,target:window},{Sa:"mouseup",listener:this.i,target:window},{Sa:"mouseover",listener:this.i},{Sa:"mouseout",listener:this.i},{Sa:"dragstart",listener:this.J}])}function gp(t){var e=t.b.element.style;if(-1!==hp.indexOf(t))throw Error("InvalidArgument: map is already in use");this.a=t,hp.push(t),e.msTouchAction=e.touchAction="none",dd||!window.PointerEvent&&!window.MSPointerEvent?(this.c=new Wo(this.a),this.b=new fp(this.a)):this.c=new Xo(this.a),this.g=new ep(this.a),this.f=new ap(this.a),this.a.tb(this.F,this),qd.call(this)}u(dp,ud),t("H.mapevents.WheelEvent",dp),u(ep,Oo),ep.prototype.i=function(t){if(!t.kl){var e=Bo(this.f),r=t.pageX-e.x;e=t.pageY-e.y;var i,n=this.L,o=t[n+(n+"Y"in t?"Y":"")];if(cd&&"rtl"===x.getComputedStyle(this.J.element).direction&&(r-=(x.devicePixelRatio-1)*this.J.width),o){var a=Math.abs,s=a(o);o=(!(i=t[n+"X"])||3<=s/a(i))&&(!(i=t[n+"Z"])||3<=s/a(i))?(+(0<o)-+(0>o))*(this.T?1:-1):0}(r=new dp(o,r,e,null,t)).delta&&(t.stopImmediatePropagation(),t.preventDefault(),this.map.Od(r.viewportX,r.viewportY,this.R.bind(this,r)))}},ep.prototype.R=function(t,e){var r,i,n=t.target=e||this.map;setTimeout((function(){n.dispatchEvent(t),t.c||(r=t.originalEvent,(i=new x.WheelEvent("wheel",r)).kl=!0,r.target.dispatchEvent(i))}),0)},u(fp,Oo),fp.prototype.i=function(t){var e,r=t.type,i=Bo(this.f);i={x:t.pageX-i.x,y:t.pageY-i.y},(e=this.a.a[0]||null)||(e=new Do(i.x,i.y,1,"mouse"),this.a.push(e)),this.b.push(e),Eo(e,i.x,i.y),/^mouse(?:move|over|out)$/.test(r)?Qo(this,"pointermove",t):(/^mouse(down|up)$/.test(r)&&(i=t.which-1,"up"===Co.RegExp.$1?Ho(e,i):Fo(e,i)),Qo(this,r.replace("mouse","pointer"),t)),this.b.clear()},fp.prototype.J=function(t){t.preventDefault()},u(gp,qd),t("H.mapevents.MapEvents",gp);var hp=[];function ip(t,e){var r;if(e=void 0===e?{}:e,ip.j.constructor.call(this),-1!==jp.indexOf(t))throw new D(ip,0,"events are already used");this.b=r=t.a,this.l=t,jp.push(t),r.draggable=!0,this.i=e.kinetics||{duration:600,ease:em},this.s=e.modifierKey||"Alt",this.enable(e.enabled),this.c=r.b,this.f=this.c.element,this.g=0,r.addEventListener("dragstart",this.Mh,!1,this),r.addEventListener("drag",this.bk,!1,this),r.addEventListener("dragend",this.Lh,!0,this),r.addEventListener("wheel",this.rk,!1,this),r.addEventListener("dbltap",this.lk,!1,this),r.addEventListener("pointermove",this.ck,!1,this),Ee(this.f,"contextmenu",this.ak,!1,this),t.tb(this.F,this)}Ic(hp),gp.prototype.F=function(){delete this.a,this.c.F(),this.g.F(),this.f.F(),this.b&&this.b.F(),hp.splice(hp.indexOf(this.a),1),qd.prototype.F.call(this)},gp.prototype.dispose=gp.prototype.F,gp.prototype.Nl=function(){return this.a},gp.prototype.getAttachedMap=gp.prototype.Nl,u(ip,qd),t("H.mapevents.Behavior",ip);var jp=[];Ic(jp),ip.prototype.a=0;var kp={PANNING:1,PINCH_ZOOM:2,WHEEL_ZOOM:4,DBL_TAP_ZOOM:8,FRACTIONAL_ZOOM:16,TILT:32,HEADING:64};ip.Feature=kp;var lp=kp.PANNING,mp=kp.PINCH_ZOOM,np=kp.WHEEL_ZOOM,op=kp.DBL_TAP_ZOOM,pp=kp.FRACTIONAL_ZOOM,qp=kp.TILT,rp=kp.HEADING,sp=lp|mp|np|op|pp|qp|rp;function tp(t,e){if(t!==+t||t%1||0>t||2147483647<t)throw new D(e,0,"integer in range [0...0x7FFFFFFF] required")}function up(t,e,r){var i,n="touch"===e.currentPointer.type,o=0;if(i=!n){i=t.s;var a,s=e.originalEvent;a=s.getModifierState?s.getModifierState(i):!!s[i.replace(/^Control$/,"ctrl").toLowerCase()+"Key"],i=a}return i?o|=qp|rp:(o|=lp,n&&2===(e=e.pointers).length&&(o|=mp|rp,r?55>Dd(e[0].viewportY-e[1].viewportY)&&(o|=qp):t.uh&Nl.TILT&&(o|=qp))),((o&=t.a)&qp?Nl.TILT:0)|(o&rp?Nl.HEADING:0)|(o&mp?Nl.ZOOM:0)|(o&lp?Nl.COORD:0)}function vp(t){var e=t.pointers;return t=e[0],e=e[1],t=[t.viewportX,t.viewportY],e&&t.push(e.viewportX,e.viewportY),t}function wp(t,e,r,i,n){var o=+r-+e;if(t=t.b.c,isNaN(+e))throw Error("start zoom needs to be a number");if(isNaN(+r))throw Error("to zoom needs to be a number");0!==o&&(t.startControl(null,i,n),t.control(0,0,6,0,0,0),t.endControl(!0,(function(t){t.zoom=r})))}function xp(t){return t=t.uc("_#-;,:","_#-;,:","_#-;,:"),new RegExp("^"+t.replace(/[.*+?^${}()|[\]\\\/]/g,"\\$&").replace(/_#-;,:/g,"\\d+")+"$")}function yp(t,e){return Ya.apply(null,arguments),t}function zp(t,e){var r=x.console;r&&r.warn&&(t=yc(t)+" is deprecated and will be removed soon. ",e&&(t+=e),r.warn(t))}ip.DRAGGING=lp,ip.WHEELZOOM=np,ip.DBLTAPZOOM=op,ip.FRACTIONALZOOM=pp,ip.prototype.disable=function(t){var e=this.a;t!==B?(tp(t,this.disable),e^=e&t):e=0,this.c.endInteraction(!0),this.a=e,this.b.draggable=0<(e&(lp|qp|rp|mp))},ip.prototype.disable=ip.prototype.disable,ip.prototype.enable=function(t){var e=this.a;t!==B?(tp(t,this.enable),e|=t&sp):e=sp,this.a=e,this.b.draggable=0<(e&(lp|qp|rp|mp))},ip.prototype.enable=ip.prototype.enable,ip.prototype.isEnabled=function(t){return tp(t,this.isEnabled),t===(this.a&t)},ip.prototype.isEnabled=ip.prototype.isEnabled,p=ip.prototype,p.uh=0,p.Mh=function(t){var e=up(this,t,!0);if(this.uh=e){var r=this.c;if(t=vp(t),r.startInteraction(e,this.i),r.interaction.apply(r,t),this.a&np&&!(this.a&pp)&&(e=t[0],r=t[1],this.g)){t=this.b.pb();var i=(0>this.g?Cd:Bd)(t);t!==i&&(this.g=0,wp(this,t,i,e,r))}}},p.bk=function(t){var e=up(this,t,!1);if(e!==this.uh)"pointerout"!==t.originalEvent.type&&"pointerover"!==t.originalEvent.type&&(this.Lh(t),this.Mh(t));else if(e){e=this.c;var r=vp(t);e.interaction.apply(e,r),t.originalEvent.preventDefault()}},p.Lh=function(t){up(this,t,!1)&&this.c.endInteraction(!this.i)},p.rk=function(t){if(!t.defaultPrevented&&this.a&np){var e=t.delta,r=this.b.pb(),i=this.b,n=i.f.type;i=this.a&pp?r-e:(0>-e?Cd:Bd)(r)-e,n!==kk.P2D&&n!==kk.WEBGL&&n!==kk.HARP||(wp(this,r,i,t.viewportX,t.viewportY),this.g=e),t.preventDefault()}},p.ck=function(){},p.lk=function(t){var e=t.currentPointer,r=this.b.pb(),i=t.currentPointer.type,n=this.b.f.type;(n===kk.P2D||n===kk.WEBGL||n===kk.HARP)&&this.a&op&&(t="mouse"===i?0===t.originalEvent.button?-1:1:0<t.pointers.length?1:-1,wp(this,r,t=this.a&pp?r-t:(0>-t?Cd:Bd)(r)-t,e.viewportX,e.viewportY))},p.ak=function(t){return!(this.a&op&&(t.preventDefault(),1))},p.F=function(){var t=this.b;t&&(t.draggable=!1,t.removeEventListener("dragstart",this.Mh,!1,this),t.removeEventListener("drag",this.bk,!1,this),t.removeEventListener("dragend",this.Lh,!0,this),t.removeEventListener("wheel",this.rk,!1,this),t.removeEventListener("dbltap",this.lk,!1,this),t.removeEventListener("pointermove",this.ck,!1,this),delete this.b),this.f&&(this.f.style.msTouchAction="",Me(this.f,"contextmenu",this.ak,!1,this),delete this.f),delete this.c,delete this.i,jp.splice(jp.indexOf(this.l),1),delete this.l,qd.prototype.F.call(this)},ip.prototype.dispose=ip.prototype.F,t("H.mapevents.buildInfo",(function(){return Hf("H-mapevents","1.51.0","a104c13",{region:"row"})})),S.prototype.J=ca(3,(function(t){var e=this.getCache(),r=this;if(t!==z){C(t,Rk,S.prototype.J,0);var i=t}else i=yl;i!==e&&e.na((function(t,e,n){return!!r.ub(t)&&(i.add(t,e,n),!0)})),this.P=i})),ti.prototype.a=ca(2,(function(t){this.f=t,(t=this.getState())!==Xh.INIT&&t!==Xh.LOADING&&Ai(this)}));var Ap=globalThis;function Bp(){}tc("monospace serif"),Bp.prototype.pop=function(t){return this[t]||(this[t]=[]),this[t].pop()||document.createElement("canvas")},Bp.prototype.push=function(t,e){this[e]||(this[e]=[]),this[e].push(t)};var Cp=new Bp;function W(t,e,r,i,n,o){if(!t||!e)throw new D(W,B,'Parameters "scheme" and "host" must be specified');this.Bi(t),this.af(e),this.wd(r),this.xi(n),this.Lk(o),this.bf(i)}function Dp(t,e){var r,i,n,o=x.document,a="";if(o){if(a=o.createElement("a"),e){var s=(r=o.getElementsByTagName("base")[0])&&r.href,l=o.head,c=r||l.appendChild(o.createElement("base"));c.href=e}a.href=t,a=a.href,e&&(r?r.href=s:l.removeChild(c))}else/[\w]+:\/\//.test(t)&&(a=t);if(t=(s=/(?:(\w+):\/\/)?(?:([^:]+):([^@/]*)@)?([^/:]+)?(?:[:]{1}([0-9]+))?(\/[^?#]*)?(\?[^#]+)?(#.*)?/.exec(a))[1],l=s[4],e=s[5],c=s[6],o=s[7],r=s[8],!s[2]&&l&&/@/.test(l)&&(l=l.split("@")[1]),s=W,c=c&&0<c.length?c.substr(1):"",a={},o)for(i=/([?&]?([^=&+]+))(=([^&]+))?/g;n=i.exec(o);)a[decodeURIComponent(n[2])]=n[4]?decodeURIComponent(n[4]):void 0;return new s(t,l,c,a,isNaN(+e)?void 0:+e,r&&0<r.length?r.substr(1):"")}function Gp(t){return encodeURIComponent(t).replace(/[!'()*]/g,(function(t){return"%"+t.charCodeAt(0).toString(16)}))}function Fp(t){var e,r=[],i=t.a,n={};for(e in i){if(i.hasOwnProperty(e)&&"function"!=typeof i[e]){var o=t.a[e];n.yd=Gp(e),C(o,Hp)?o.a.forEach(function(t){return function(e){r.push(t.yd+"="+Gp(e))}}(n)):C(o,Ip)?r.push(n.yd+"="+o.b.map((function(t){return Gp(t)})).join(o.a)):r.push(void 0===o?n.yd:n.yd+"="+Gp(o))}n={yd:n.yd}}return 0<r.length?"?"+r.join("&"):""}function Jp(t){var e=Hf("H-service","1.51.0","a104c13",{region:"row"});return t.a.xnlp="CL_JSMv3."+e.version,t}function Ep(t){var e,r=0;for(e in t.a)if(t.a.hasOwnProperty(e)&&"function"!=typeof t.a[e]&&0<++r)break;return!r}function Kp(t,e){if(Bc(t))for(var r=0;r<t.length;r++){var i=t[r];if(!Cc(i)&&!Fc(i)){var n="The Array does not contain only strings and numbers";break}}else n="Not an Array";if(n)throw new D(e,0,t);return t}function Hp(t){this.a=Kp(t,Hp)}function Ip(t,e){if(this.b=Kp(t,Ip),!/^[!\$\(\)\*\+,;]$/.test(e))throw new D(Ip,1,'Invalid delimiter "'+e+'"');this.a=e}function Lp(t,e){C(t,Mp,Lp,0);var r={};Object.assign(r,e),r.min=r.min||0,r.max=r.max||20,r.tileSize=r.tileSize||512,r.getURL=function(e,i,n){return t.v().clone().G(t.b.og+"/"+t.b.eg+"/"+n+"/"+e+"/"+i+"/"+t.b.format).I(t.f).clone().I({size:r.tileSize})},Ek.call(this,r),this.i=t}function X(t){var e=(t=yp({},this.b,t)).apikey||t.apiKey,r=t.baseUrl;if(r=e?r?0:"baseUrl":"apikey")throw new D(X,0,'"'+r+'" must be specified');this.Nk(t.baseUrl),this.a=e,this.Yb.I({apikey:e}),this.c=t.headers||{},this.f=Wa(t.servicesConfig||{})}function Op(t,e){if(e=void 0===e?{}:e,!t.Qf)throw new $c(t);Op.j.constructor.call(this);var r=Pp(this,e);if(!r.baseUrl&&!r.platformBaseUrl)throw new D(t,0,'either "baseUrl" or "platformBaseUrl" must be specified');this.i=(r.baseUrl?r.baseUrl:r.platformBaseUrl).clone(),(t=r.baseUrl?e:r).host&&this.i.af(t.host),t.subDomain&&this.i.Ba(t.subDomain),t.path&&this.i.wd(t.path),Jp(this.i),this.g=r.headers||{}}function Pp(t,e){return t=t.Aa(),e?yp({},t,e):t}function Qp(t,e,r){return function(i){return"function"!=typeof i.json?Promise.reject(r(Rp(e,i))):i.json().then((function(e){return r(t.a(e))}),(function(){return r(Rp(e,i))}))}}function Rp(t,e){return Error((e.statusText?"["+e.statusText+"] ":"")+t+" request failed")}function Sp(t){Sp.j.constructor.call(this,Sp,t)}function Tp(t){if(!t||!Da(t.requestData))throw new D(Tp,0,"options.requestData");Tp.j.constructor.call(this,t),this.L=t.requestData,this.D=!!t.providesDomMarkers}function Up(){this.a={}}t("H.service.util.eval",(function(a){return eval(a)})),t("H.service.Url",W),W.parse=Dp,W.prototype.clone=function(){var t,e={};for(t in this.a)e[t]=this.a[t];return new W(this.i,this.c,this.b,e,this.g,this.f)},W.prototype.clone=W.prototype.clone,W.prototype.Bi=function(t){if(!t||"string"!=typeof t)throw new D(this.Bi,0,'The "scheme" parameter must be a non-empty string.');return this.i=t,this},W.prototype.setScheme=W.prototype.Bi,W.prototype.Vm=function(){return this.i},W.prototype.getScheme=W.prototype.Vm,W.prototype.af=function(t){if(!t||"string"!=typeof t||"-"===t.charAt(0)||"."===t.charAt(0)||"."===t.charAt(t.length-1))throw new D(this.af,0,'The "host" parameter is not a valid host name.');return this.c=t,this},W.prototype.setHost=W.prototype.af,W.prototype.om=function(){return this.c},W.prototype.getHost=W.prototype.om,W.prototype.wd=function(t){return this.b=t||void 0,this},W.prototype.setPath=W.prototype.wd,W.prototype.Hm=function(){return this.b},W.prototype.getPath=W.prototype.Hm,W.prototype.bf=function(t){if(t){if("object"!=typeof t)throw new D(this.bf,0,'Parameter "params" must be an object.');this.a=t}else this.a={};return this},W.prototype.setQuery=W.prototype.bf,W.prototype.Mj=function(){return!Ep(this)},W.prototype.hasQuery=W.prototype.Mj,W.prototype.getQuery=function(){return this.a},W.prototype.getQuery=W.prototype.getQuery,W.prototype.xi=function(t){if(void 0===t)this.g=t;else{var e=ae(+t<<0,0,65535);if(e!=t)throw new D(this.xi,0,'Parameter "port" must be an integer in range [0...65535]');this.g=e}return this},W.prototype.setPort=W.prototype.xi,W.prototype.Mm=function(){return this.g},W.prototype.getPort=W.prototype.Mm,W.prototype.Lk=function(t){return this.f=t||void 0,this},W.prototype.setAnchor=W.prototype.Lk,W.prototype.kd=function(){return this.f},W.prototype.getAnchor=W.prototype.kd,W.prototype.I=function(t){if("object"!=typeof t)throw new D(this.I,0,'Parameter "other" must be an object.');var e,r=this.a;for(e in t)t.hasOwnProperty(e)&&"function"!=typeof t[e]&&(r[e]=t[e]);return this},W.prototype.mergeQuery=W.prototype.I,W.prototype.Ba=function(t){if(!t||"string"!=typeof t)throw new D(this.Ba,0,'Parameter "subDomain" must be a non-empty string');return"."===t.substr(t.length-1)&&(t=t.substr(0,t.length-1)),this.af(t+"."+this.c)},W.prototype.addSubDomain=W.prototype.Ba,W.prototype.G=function(t){if(!t||"string"!=typeof t)throw new D(this.G,0,'Parameter "subPath" must be a non-empty string');return this.wd((this.b?this.b+"/":"")+t)},W.prototype.addSubPath=W.prototype.G,W.prototype.toString=function(){return[this.i+"://",this.c,this.g?":"+this.g:"",this.b||!Ep(this)||this.f?"/":"",this.b?encodeURI(this.b):"",Fp(this),this.f?"#"+encodeURIComponent(this.f):""].join("")},W.prototype.toString=W.prototype.toString,W.MultiValueQueryParameter=Hp,Hp.prototype.fn=function(){return this.a},Hp.prototype.getValues=Hp.prototype.fn,W.DelimitedQuerySubValues=Ip,u(Lp,Ek),t("H.service.rasterTile.Provider",Lp),Lp.prototype.ba=function(t,e){var r=this.i;return Np(r.ba(),r.b.og+"."+r.V(),e,t)},Lp.prototype.getCopyrights=Lp.prototype.ba,Lp.prototype.l=function(){return od()},Lp.prototype.c=function(){return od()?nd():Lp.j.c.call(this)},t("H.service.Platform",X),X.prototype.b={apikey:null,baseUrl:new W("https","hereapi"+(Mn?".cn":".com"))},X.prototype.Nk=function(t){this.Yb=Jp(t.clone()),this.a=t=this.a,this.Yb.I({apikey:t})},X.prototype.setBaseUrl=X.prototype.Nk,X.prototype.Ib=function(){return this.Yb},X.prototype.getBaseUrl=X.prototype.Ib,X.prototype.Ma=function(t,e){try{return t.Qf=!0,new t(yp({platformBaseUrl:this.Ib(),headers:this.c},this.f[t.CONFIG_KEY]||{},e||{}))}finally{t.Qf=!1}},X.prototype.createService=X.prototype.Ma,X.prototype.xf=function(t,e,r){var i=this;if(!H.map.render.harp)throw Error("HARP engine module not found");if(!Ea(t)&&!Cc(t))throw new D(this.xf,0,"is invalid: must be either a configuration object or a URL");if(!Da(e))throw new D(this.xf,1,"is invalid: must be a Function");if(!Da(r))throw new D(this.xf,2,"is invalid: must be a Function");var n=new H.map.render.harp.Style(t);n.addEventListener("change",(function(){var t=n.getState();if(-1===t)r(Error("H.service.platform#createHybridLayers method failed to load style configuration"));else if(2===t){t={dark:!0};var o=i.lh({resource:"background",queryParams:{style:"satellite.day"}}),a=n.qc(),s={styles:[{technique:"raster",attr:{gamma:1,brightness:1}}]};a.definitions&&(void 0!==a.definitions["Satellite.Texture.Gamma"]&&(s.styles[0].attr.gamma=a.definitions["Satellite.Texture.Gamma"]),void 0!==a.definitions["Satellite.Texture.Brightness"]&&(s.styles[0].attr.brightness=a.definitions["Satellite.Texture.Brightness"])),o=new Lp(o,{engineType:Qn,style:new H.map.render.harp.Style(s)}),e({raster:new sl(o,t),vector:i.He().$b(n,{engineType:Qn},t),traffic:i.oh().$b(n,{engineType:Qn},t)})}})),n.load()},X.prototype.createHybridLayers=X.prototype.xf,X.prototype.wf=function(t,e,r,i,n,o){function a(t,e,n){e=t.f(e),e=f?new ti(e):new H.map.render.harp.Style(e);var a,s={engineType:c};return h&&h.politicalView&&(s.politicalView=h.politicalView),r&&(s.lg=r),i&&(s.lg2=i),o&&(s.pois=o),n&&(a={dark:n}),t.$b(e,s,a)}function s(t,e,r,i,n){return t.nc(e,r,d,i,y,1,n,u)}var l=this,c=jk,u={crossOrigin:"anonymous"};if(Ea(t)){var h=t;"crossOrigin"in h&&(u.crossOrigin=h.crossOrigin),t=h.tileSize,e=h.ppi,r=h.lg,i=h.lg2,n=h.style,o=h.pois,void 0!==h.engineType&&(c=h.engineType,u.engineType=c)}var p=c===kk.HARP,f=c===kk.WEBGL,d=t||512,y={};if(0>[72,250,320,500].indexOf(+e)){if(e!==B)throw new D(this.wf,1,e)}else y.ppi=+e;if(r&&(y.lg=r),i&&(y.lg2=i),n&&(y.style=n),o&&(y.pois=!!o),p&&!H.map.render.harp)throw new D(this.wf,0,"HARP engine is not supported, module not found");if(t={},Mn)yp(t,{vector:{normal:{map:a(this.He(),"harp/oslo/normal.day.json")}}});else{n=this.ih();var g=this.ih({type:"aerial"}),v=this.nh(),m=v.ej(y.lg?{lg:y.lg,i18n:!0,engineType:c}:{engineType:c});if(yp(t,{raster:{normal:{xbase:s(n,"xbasetile","normal.day","png8",!1),xbasenight:s(n,"xbasetile","normal.night","png8",!0),base:s(n,"basetile","normal.day","png8",!1),basenight:s(n,"basetile","normal.night","png8",!0),map:s(n,"maptile","normal.day","png8",!1),mapnight:s(n,"maptile","normal.night","png8",!0),trafficincidents:m,transit:s(n,"maptile","normal.day.transit","png8",!1),labels:s(n,"labeltile","normal.day","png",!1)},satellite:{xbase:s(g,"xbasetile","hybrid.day","jpg",!0),base:s(g,"basetile","hybrid.day","jpg",!0),map:s(g,"maptile","hybrid.day","jpg",!0),labels:s(g,"labeltile","hybrid.day","png",!0)},terrain:{xbase:s(g,"xbasetile","terrain.day","jpg",!1),base:s(g,"basetile","terrain.day","jpg",!1),map:s(g,"maptile","terrain.day","jpg",!1),labels:s(g,"labeltile","terrain.day","png",!1)}}}),p||f){if(yp(t,{vector:{normal:{traffic:v.dj(void 0,c),trafficincidents:m}}}),n=this.He(),f?(t.vector.normal.map=a(n,"omv/miami/normal.day.yaml"),t.vector.normal.truck=a(n,"omv/miami/truck.day.yaml")):p&&(t.vector.normal.map=a(n,"harp/oslo/normal.day.json"),t.vector.normal.truck=a(n,"harp/oslo/normal.day.json")),n=this.oh(),p){var _={ppi:72<e?400:100,size:256<d?512:256,features:"pois:"+(!0===o||Cc(o)&&/[^0]/.test(o)?"all":"disabled")};r&&(_.lang=r),i&&(_.lang2=i),h&&h.politicalView&&(_.pview=h.politicalView),e={dark:!0},g=function(t,e,r,i,n){var o=yp({},_);return/^explore\./.test(r)||delete o.features,new sl(n=new Lp(t=l.lh({format:e,resource:t,queryParams:yp({style:r},o)}),{engineType:c,style:n}),i)},yp(t.raster.normal,{base:g("background","png8","explore.day"),basenight:g("background","png8","explore.night",e),map:g("base","png8","explore.day"),mapnight:g("base","png8","explore.night",e),labels:g("label","png","explore.day")}),yp(t.raster.satellite,{xbase:g("background","jpeg","satellite.day",e),base:g("background","jpeg","explore.satellite.day",e),map:g("base","jpeg","explore.satellite.day",e),labels:g("label","png","explore.satellite.day")}),v=this.He(),yp(t.vector.normal,{mapnight:a(v,"harp/oslo/normal.night.json",!0),lite:a(v,"harp/oslo/lite.day.json"),litenight:a(v,"harp/oslo/lite.night.json",!0),ism:a(v,"harp/oslo/road.network.day.json"),ismnight:a(v,"harp/oslo/road.network.night.json",!0),roadnetwork:a(v,"harp/oslo/road.network.day.json"),roadnetworknight:a(v,"harp/oslo/road.network.night.json",!0)}),m={styles:[{technique:"raster",attr:{gamma:["interpolate",["linear"],["zoom"],0,1,13,1.2,17,1.3],brightness:["interpolate",["linear"],["zoom"],0,.7,13,.9,17,1]}}]};for(var b=[],w=0;4>w;w++){var x=new H.map.render.harp.Style(JSON.parse(JSON.stringify(m)));x=g("background","jpeg","satellite.day",e,x),b.push(x)}t.hybrid={day:{raster:b[0],vector:a(v,"harp/oslo/hybrid.day.json",!0),traffic:a(n,"harp/oslo/hybrid.day.json",!0)},night:{raster:b[1],vector:a(v,"harp/oslo/hybrid.night.json",!0),traffic:a(n,"harp/oslo/hybrid.night.json",!0)},liteday:{raster:b[2],vector:a(v,"harp/oslo/lite.hybrid.day.json",!0),traffic:a(n,"harp/oslo/lite.hybrid.day.json",!0)},litenight:{raster:b[3],vector:a(v,"harp/oslo/lite.hybrid.night.json",!0),traffic:a(n,"harp/oslo/lite.hybrid.night.json",!0)}}}(e={traffic:{}}).traffic.map=a(n,f?"traffic/vector.tile.yaml":"harp/oslo/normal.day.json"),p&&(e.traffic.mapnight=a(n,"harp/oslo/normal.night.json"),e.traffic.lite=a(n,"harp/oslo/lite.day.json"),e.traffic.litenight=a(n,"harp/oslo/lite.night.json")),yp(t.vector,e)}}return t},X.prototype.createDefaultLayers=X.prototype.wf,u(Op,F),t("H.service.Service",Op),Op.prototype.Aa=function(){return{}},Op.prototype.v=function(){return this.i},Op.prototype.getUrl=Op.prototype.v,Op.prototype.B=function(t,e,r,i){return(i=new tf(void 0===i?"application/json":i,t.toString(),je,{headers:this.g})).then(e,Qp(this,t,r)),i},Op.prototype.a=function(t){return Error(t.message)},u(Sp,Op),t("H.service.traffic.Service7",Sp),Sp.prototype.Aa=function(){return{subDomain:"data.traffic",path:"v7"}},Sp.CONFIG_KEY="traffic_v7",Sp.prototype.qo=function(t,e,r,i){return t=this.v().clone().G(["incidents",t].join("/")).I(e||{}),this.B(t,r,i)},Sp.prototype.requestIncidentById=Sp.prototype.qo,Sp.prototype.oo=function(t,e,r){return t=this.v().clone().G("flow").I(t||{}),this.B(t,e,r)},Sp.prototype.requestFlowByArea=Sp.prototype.oo,Sp.prototype.so=function(t,e,r){return t=this.v().clone().G("incidents").I(t||{}),this.B(t,e,r)},Sp.prototype.requestIncidentsByArea=Sp.prototype.so,u(Tp,S),t("H.map.provider.MarkerTileProvider",Tp),Tp.prototype.B=function(t,e,r,i,n){var o=this;return this.L(t,e,r,(function(n){for(var a,s,l=[],c=n.length;c--;)(s=n[c]).Ho=o.getTileKey(t,e,r),s.ka(o),a=s.xb(),(C(s,bj)||1===a.getState())&&l.push(n[c]);i(l)}),n)},Tp.prototype.requestInternal=Tp.prototype.B,Tp.prototype.Td=function(t,e){e===kh.VISUAL&&(t=this.nb().get(t.Ho))&&(t.valid=!1,this.Va(t))},Tp.prototype.invalidateObject=Tp.prototype.Td,Tp.prototype.Qb=function(){return this.D},Tp.prototype.providesDomMarkers=Tp.prototype.Qb,Tp.prototype.Rb=ff,Tp.prototype.providesMarkers=Tp.prototype.Rb,Up.prototype.xb=function(t,e){var r,i=t+e;return(r=this.a[i])?r:(t=(t=Vp.MARKER.replace("{{icon}}",Wp[t]||Wp.OTHER)).replace("{{color}}",Xp[e]||Xp.BLOCKING),e={size:{w:26,h:33},anchor:{x:13,y:30},hitArea:new Xi(Yi.POLYGON,Yp.MARKER)},this.a[i]=new Wj(t,e))};var Vp={MARKER:'<svg width="26" height="33" enable-background="new 0 0 26 33" viewBox="0 0 26 33" xmlns="http://www.w3.org/2000/svg"><path d="m26 33h-26v-33h26z" fill="#8c8c8c" opacity="0"/><path d="m17 29.566c0 1.116-1.791 2.022-4 2.022s-4-.906-4-2.022c0-1.118 1.791-2.026 4-2.026s4 .908 4 2.026" fill="#878787" opacity=".6"/><path d="m1.795 17.971c-1.562-1.555-1.574-3.828-.028-5.655l8.343-10.021c.769-.895 1.795-1.384 2.894-1.384 1.117 0 2.197.521 2.889 1.394l8.338 10.014c1.588 1.854 1.578 4.022-.029 5.65l-11.202 11.202z" fill="{{color}}"/>{{icon}}</svg>'},Wp={CONGESTION:'<path style="fill:#FFFFFF;" d="M12.966,1.177c0.965,0,1.894,0.442,2.496,1.204l8.378,10.258c1.362,1.592,1.482,3.477,0,4.979L12.994,28.464L2.143,17.618c-1.381-1.375-1.38-3.348,0-4.979l8.314-10.258C11.174,1.547,12.085,1.177,12.966,1.177 M12.967,0.177L12.967,0.177c-1.247,0-2.408,0.551-3.269,1.552l-8.332,10.28c-1.711,2.022-1.688,4.567,0.07,6.317l10.85,10.845l0.707,0.707l0.707-0.707l10.847-10.846c1.784-1.807,1.803-4.292,0.053-6.337L16.237,1.748C15.462,0.769,14.236,0.177,12.967,0.177L12.967,0.177z M16.645,10.405l-2.025-2.22c-0.48-0.51-1.15-0.8-1.84-0.8H9.53c-0.69,0-1.36,0.29-1.84,0.8l-1.94,2.22c-0.39,0.63-0.59,1.35-0.59,2.09v1.64c0,0.69,0.56,1.25,1.25,1.25h1.44l0.255-0.539c0.204-0.431,0.456-0.837,0.753-1.21l0.962-1.211l0.83-0.9c0.32-0.35,0.72-0.63,1.15-0.82H8.23c-0.28,0-0.55-0.07-0.79-0.22l-0.28-0.17l1.27-1.45c0.28-0.31,0.68-0.48,1.1-0.48h3.25c0.42,0,0.82,0.17,1.1,0.48l1.354,1.54H16.645z M18.31,12.205c-0.35-0.37-0.81-0.63-1.3-0.74c-0.18-0.04-0.36-0.06-0.54-0.06h-3.24c-0.7,0-1.37,0.29-1.84,0.8l-1.13,1.22l-0.82,1c-0.38,0.63-0.59,1.35-0.59,2.09v1.64c0,0.69,0.56,1.25,1.25,1.25h1.75v-1h5.99v1h1.75c0.69,0,1.25-0.56,1.25-1.25v-1.64c0-0.74-0.2-1.46-0.59-2.09L18.31,12.205z M12.1,17.105h-1c-0.138,0-0.25-0.112-0.25-0.25v-1c0-0.138,0.112-0.25,0.25-0.25h1c0.138,0,0.25,0.112,0.25,0.25v1C12.35,16.993,12.238,17.105,12.1,17.105z M18.59,17.105h-1c-0.138,0-0.25-0.112-0.25-0.25v-1c0-0.138,0.112-0.25,0.25-0.25h1c0.138,0,0.25,0.112,0.25,0.25v1C18.84,16.993,18.728,17.105,18.59,17.105z M18.56,14.505c-0.24,0.15-0.51,0.22-0.79,0.22h-5.85c-0.28,0-0.55-0.07-0.78-0.22l-0.29-0.17l1.27-1.45c0.15-0.16,0.33-0.28,0.53-0.37c0.18-0.07,0.38-0.11,0.58-0.11h3.24c0.24,0,0.48,0.06,0.68,0.16c0.16,0.08,0.3,0.19,0.42,0.32l1.27,1.45L18.56,14.505z M8.42,13.03h-1c-0.138,0-0.25-0.112-0.25-0.25v-1c0-0.138,0.112-0.25,0.25-0.25h1c0.138,0,0.25,0.112,0.25,0.25v1C8.67,12.918,8.559,13.03,8.42,13.03z"/>',ROADWORKS:'<path d="m13.004 1.411c.964 0 1.894.441 2.496 1.204l8.346 10.023c1.363 1.592 1.482 3.477 0 4.979l-10.846 10.847-10.852-10.846c-1.381-1.375-1.379-3.348 0-4.979l8.346-10.023c.717-.835 1.628-1.205 2.51-1.205m0-1c-1.248 0-2.408.551-3.268 1.552l-8.356 10.035c-1.718 2.033-1.695 4.578.064 6.328l10.85 10.845.706.707.707-.707 10.846-10.846c1.784-1.808 1.803-4.293.053-6.337l-8.337-10.012c-.769-.973-1.996-1.565-3.265-1.565zm-.575 15.264c.018-.332-.13-.651-.394-.851l-2.945-2.235-.21.36c-.22.39-.41.78-.58 1.19l-.677 2.129-1.364 3.051h1.314l2.109-4.672 1.317 1.212.138 3.46h1.092zm6.16-1.327c-.401-.54-1.209-.539-1.609.001l-1.17 1.58-2.29-1.74-.139-4.054c-.011-.276-.134-.535-.342-.716l-.7-.61c-.185-.161-.422-.25-.667-.25h-1.885c-.335 0-.648.168-.833.447l-1.144 1.723 7.58 5.76-1.86 2.51c-.098.132-.004.32.161.32h6.648l1.142-1.077zm-8.79-2.989-.876-.665.841-1.018.965.043zm1.63 1.24.969-1.781.118 2.61zm2.76-5.79c-.64 0-1.16.52-1.16 1.16 0 .65.52 1.17 1.16 1.17s1.16-.52 1.16-1.17c0-.64-.52-1.16-1.16-1.16z" fill="#fff"/>',ACCIDENT:'<path style="fill:#FFFFFF;" d="M12.998,1.091c0.964,0,1.894,0.442,2.496,1.204l8.346,10.344c1.363,1.592,1.482,3.477,0,4.979L12.994,28.465L2.143,17.618c-1.381-1.375-1.379-3.348,0-4.979l8.346-10.344C11.205,1.462,12.115,1.091,12.998,1.091 M12.998,0.091L12.998,0.091c-1.248,0-2.408,0.551-3.269,1.552L1.364,12.011c-1.708,2.021-1.685,4.566,0.073,6.316l10.85,10.845l0.707,0.707l0.707-0.707l10.846-10.846c1.784-1.808,1.803-4.293,0.053-6.337l-8.327-10.32C15.494,0.684,14.268,0.091,12.998,0.091L12.998,0.091z M7.83,18.982l-3.309-1.855l0.945,1.855H7.83z M16.111,19h3.942l1.596-2L16.111,19z M10.512,20.064l1.021-1.021l1.632,0.076c0.329,0.018,0.651-0.022,0.963-0.123c0.626-0.206,1.122-0.76,1.288-1.44l0.264-1.089l2.066-0.93c0.373-0.17,0.673-0.42,0.861-0.731c0.275-0.449,0.405-0.97,0.369-1.498L18.9,11.676l1.021-1.021l-0.724-0.724l-0.427,0.427l-0.121-0.364c-0.201-0.603-0.54-1.151-0.989-1.6l-1.159-1.159c-0.5-0.5-1.31-0.5-1.809,0l-1.267,1.267l0.724,0.724l-5.066,5.066l-0.724-0.724l-1.267,1.267c-0.5,0.5-0.5,1.31,0,1.809l1.159,1.159c0.449,0.449,0.997,0.788,1.6,0.989l0.364,0.121l-0.427,0.427L10.512,20.064z M14.901,10.349l0.732-0.732c0.098-0.098,0.256-0.098,0.354,0l0.732,0.732c0.098,0.098,0.098,0.256,0,0.354l-0.732,0.732c-0.098,0.098-0.256,0.098-0.354,0l-0.732-0.732C14.803,10.604,14.803,10.446,14.901,10.349z M9.472,15.777l0.732-0.732c0.098-0.098,0.256-0.098,0.354,0l0.732,0.732c0.098,0.098,0.098,0.256,0,0.354l-0.732,0.732c-0.098,0.098-0.256,0.098-0.354,0L9.472,16.13C9.375,16.033,9.375,15.874,9.472,15.777z M11.391,17.615c0.069-0.271,0.206-0.518,0.405-0.717l4.961-4.961c0.195-0.195,0.445-0.337,0.717-0.405l0.344-0.083l0.137,1.925c0.022,0.318-0.058,0.63-0.221,0.901c-0.101,0.166-0.279,0.271-0.409,0.329L14.8,15.74l-0.38,1.574c-0.083,0.344-0.318,0.615-0.612,0.713c-0.188,0.058-0.38,0.083-0.579,0.072l-1.925-0.138L11.391,17.615z"/>',OTHER:'<path style="fill:#FFFFFF;" d="M13.004,1.411c0.964,0,1.894,0.441,2.496,1.204l8.346,10.023c1.363,1.592,1.482,3.477,0,4.979L13,28.465L2.148,17.618c-1.381-1.375-1.379-3.348,0-4.979l8.346-10.023C11.211,1.781,12.122,1.411,13.004,1.411 M13.004,0.411L13.004,0.411c-1.248,0-2.408,0.551-3.268,1.552L1.38,11.998c-1.718,2.033-1.694,4.579,0.064,6.328l10.85,10.845L13,29.878l0.707-0.707l10.846-10.846c1.784-1.808,1.803-4.293,0.053-6.337L16.269,1.976C15.5,1.003,14.273,0.411,13.004,0.411L13.004,0.411z M14.716,20.139c0,0.947-0.758,1.724-1.724,1.724c-0.947,0-1.704-0.777-1.704-1.724c0-0.928,0.757-1.704,1.704-1.704C13.958,18.435,14.716,19.211,14.716,20.139z M14.204,16.33H11.78l-0.537-8.533h3.5L14.204,16.33z"/>'},Xp={BLOCKING:"#323232",VERYHIGH:"#d5232f",HIGH:"#ffa100"},Yp={MARKER:[24.1,17.8,14.2,28.42,16.8,29.4,12.8,31.4,8.79,29.4,11.23,28.42,1.7,17.8,1.7,12.1,10,1.9,12.9,.498,15.8,1.9,24.1,12.1,24.1,17.8]};function Zp(t,e,r){(r=r||{}).criticality||(r.criticality="major,critical"),C(t,$p,Zp,0),Tp.call(this,{max:20,min:8,requestData:A(this.T,this),engineType:r.engineType}),this.f=new Up,this.u=t,this.i=r,this.reload=A(this.reload,this),this.m=setInterval(this.reload,e||18e4)}u(Zp,Tp),t("H.service.traffic.incidents.Provider",Zp);var aq={minor:"HIGH","low impact":"HIGH",major:"VERYHIGH",critical:"BLOCKING"};Zp.prototype.T=function(t,e,r,i,n){var o=this,a=this.f;return this.u.requestIncidentsByTile(t,e,r,(function(t){var e,r=[];if(t=t.TRAFFIC_ITEMS)for(e=(t=t.TRAFFIC_ITEM).length;e--;){var n=t[e],s=n.TRAFFIC_ITEM_TYPE_DESC;switch(s){case"ACCIDENT":case"CONGESTION":var l=s;break;case"CONSTRUCTION":l="ROADWORKS";break;default:l="OTHER"}l=a.xb(l,aq[n.CRITICALITY.DESCRIPTION]),(s=new Rn({lat:(s=n.LOCATION.GEOLOC.ORIGIN).LATITUDE,lng:s.LONGITUDE},{provider:o,icon:l})).setData(n),r.push(s)}i(r)}),n,this.i)},Zp.prototype.F=function(){Tp.prototype.F.call(this),clearInterval(this.m)},Zp.prototype.dispose=Zp.prototype.F;var bq="A21 A22 F01 F02 F08 F04 F05 F07 F03 F06 A2F F13 A25 A2C F12 D1B F1B A27 E12 A3A A24 A3D A3F F1F F25 F2C E32 A33 F29 D26 D36 F26 D0F F0F F2B E0C D3A A45 D23 D11 F2E F19 F14 F39 A4A A4B A5C D38 F2A F1A D0A F1C A48 D25 D1D F32 A46 A3E D24 E1C E32 A5F D2E D22 D0A".split(" ");function cq(t,e,r,i){cq.j.constructor.call(this,{min:10,max:21,engineType:i}),C(t,$p,cq,0),this.m=t,this.f=r||dq,this.f.responseattributes="sh,fc",this.i=setInterval(A(this.reload,this),e||18e4),this.b===kk.WEBGL?this.Qa(new ti(Ao()+"/traffic/flow.yaml"),!0):this.Qa(new H.map.render.harp.Style({styles:[{when:["==",["geometry-type"],"LineString"],technique:"solid-line",renderOrder:10002,attr:{color:["case",[">=",["get","JF"],10],"black",[">=",["get","JF"],8],"red",[">=",["get","JF"],4],"yellow","green"],lineWidth:3,metricUnit:"Pixel"}}]}))}u(cq,S),t("H.service.traffic.flow.Provider",cq),cq.prototype.ei=ff,cq.prototype.providesGeoJSON=cq.prototype.ei,cq.prototype.V=function(){return this.Ya()},cq.prototype.getStyle=cq.prototype.V,cq.prototype.gb=function(t){t.a&&t.a("GeoJSONTileSource"),this.Qa(t)},cq.prototype.setStyle=cq.prototype.gb;var dq={locationreferences:"tmc,shp"};cq.prototype.o=function(){cq.j.o.call(this),clearInterval(this.i)},cq.prototype.B=function(t,e,r,i,n){return this.m.requestFlowByTile(t,e,r,(function(t){t.type&&-1!==t.type.indexOf("Error")?n(t.Details):i(t)}),n,this.f)},cq.prototype.requestInternal=cq.prototype.B,cq.prototype.ac=function(t,e,r,i,n){var o,a,s,l,c,u={type:"FeatureCollection",features:[]},h=i.RWS.length;for(o=0;o<h;o++){var p=i.RWS[o],f=p.RW,d=f.length,y=-1!==bq.indexOf(p.EXTENDED_COUNTRY_CODE+p.EBU_COUNTRY_CODE);for(p=0;p<d;p++){var g=f[p].FIS,v=g.length;for(g=0;g<v;g++){var m=f[p].FIS[g].FI,_=m.length;for(a=0;a<_;a++){var b=m[a],w=[],x=b.CF[0],E=!!x.SSS,T={type:"Feature",properties:x,geometry:{type:"MultiLineString",coordinates:w}};for(T.properties.LHT=y,b.SHP.length&&(T.properties.FC=b.SHP[0].FC),E&&(c=[]),x=0;x<b.SHP.length;x++){var A=b.SHP[x].value,S=A.length;for(s=0;s<S;s++){var k=E?c:void 0,O=new qo(A[s].trim()),L=[],P={};for(O.ge();-1!==(l=O.Pb());)l===eq?(P.lat=+String.fromCharCode.apply(cq,O.Gd()),O.next(),O.ge()):l===fq?(P.lng=+String.fromCharCode.apply(cq,O.Gd()),L.push([P.lng,P.lat]),k&&k.push(ng(P)),P=[],O.next(),O.ge()):O.next();P.lng=+String.fromCharCode.apply(cq,O.Gd()),L.push([P.lng,P.lat]),k&&k.push(ng(P)),l=L,w.push(l)}}u.features.push(T)}}}}return cq.j.ac.call(this,t,e,r,u,n)},cq.prototype.createTileInternal=cq.prototype.ac;var fq=32,eq=44;function gq(t){function e(e){i.contains(n)&&i.removeChild(n),c&&clearTimeout(c),delete gq.a[o],e&&t.pj&&t.pj.call(l,e)}if(!t.url||!t.Og)throw Error('Parameter "options" must specify at least a URL and a callback.');if("function"!=typeof t.Og)throw Error("Parameters options.callback must be a function");var r=t.cp||document,i=r.getElementsByTagName("head")[0],n=r.createElement("script");r=t.url instanceof W?t.url:Dp(t.url,t.bp);var o=gq.b++,a=t.vl||"callback",s=t.Og,l={},c=null;return l.id=o,l.cancel=function(){e("cancelled")},0!==t.timeout&&(c=x.setTimeout((function(){e("timeout")}),t.timeout||3e4)),gq.a[o]=function(t){e(),s.call(l,t)},n.type="text/javascript",n.src=r.toString()+(r.Mj()?"&":"?")+a+"="+(t.ep?"H.service.jsonp.handleResponse("+o+")":encodeURI("H.service.jsonp.handleResponse("+o+")")),i.appendChild(n),l}function $p(t){$p.j.constructor.call(this,$p,t),this.c=Pp(this,t).callbackKey,this.b=!1}function hq(t,e,r,i){return t.b||(zp($p,"Use HERE Traffic API v7 instead."),t.b=!0),gq({url:e,Og:r,pj:function(t){i(Error("["+t+"] "+e+" request failed"))},vl:t.c})}function iq(t){iq.j.constructor.call(this,iq,t),this.b=Pp(this,t).reverseSubDomain,zp(iq,"Use HERE Geocoding and Search API v7 instead.")}function jq(t){zp(jq,"Use HERE Geocoding and Search API v7 instead."),jq.j.constructor.call(this,jq,t)}function kq(t,e,r,i,n){return e=t.v().clone().G(e).I(r||{}),t.B(e,i,n)}function lq(){this.a={}}function mq(t,e){for(var r in e)if(e.hasOwnProperty(r)){var i,n=e[r],o=t.a[r]||(t.a[r]=[]),a=n.length;for(i=0;i<a;i++)o.push(new nq(n[i]))}}function Np(t,e,r,i){var n=(t=t.a[e])?t.length:0,o=[];for(e=0;e<n;e++)t[e].nd(r,i)&&o.push(t[e]);return o}function nq(t){var e,r=t.boxes;if(this.label=t.label,this.min=t.minLevel,this.max=t.maxLevel,this.b=[],r&&(e=r.length)){var i=r[0],n=new K(i[0],i[1],i[2],i[3]);for(this.b.push(n),this.a=new K(i[0],i[1],i[2],i[3]),t=1;t<e;t++)n=new K((i=r[t])[0],i[1],i[2],i[3]),this.b.push(n),this.a.ec(n,!1,this.a)}}function oq(t,e,r){var i,n=this,o=r||{},a=+o.min,s=+o.max;o.tileSize=o.tileSize||512,o.min=a?ae(a,1,17):1,o.min+=Pk(o.tileSize,1),o.max=s?ae(s,1,17):17,oq.j.constructor.call(this,o),C(t,pq,oq,0),C(e,Wh,oq,1),this.i=t,e.a&&e.a("OMV"),this.Qa(e,!0),this.m=!1,r&&(r.politicalView&&(this.u=r.politicalView),qq(this,r.lg,r.lg2),this.m=!!r.pois),this.aa=function(){n.T=xp(n),n.reload(!1)},t.addEventListener("versionupdate",this.aa),this.T=xp(this),oq.prototype.qa=(i=/^v2\/vectortiles\/(.+)\/mc$/.exec(t.v().b))?i[1]:B+""}function qq(t,e,r){var i=Cc(e),n=Cc(r);i&&(t.R=e),n&&(t.L=r),(i||n)&&(t.f=[],(n=(i=/^([a-zA-Z]{2})(-|$)/).exec(e))&&("zh"===n[1]?t.f.push(e):t.f.push(n[1])),(n=i.exec(r))&&("zh"===n[1]?t.f.push(r):t.f.push(n[1])),t.D=!0)}t("H.service.jsonp",gq),gq.mn=function(t){return(t=gq.a[t])?t:function(){}},gq.handleResponse=gq.mn,gq.b=0,gq.a={},u($p,Op),t("H.service.traffic.Service",$p),$p.prototype.Aa=function(){return{subDomain:"traffic.ls",path:"traffic/6.1",callbackKey:"jsoncallback"}},$p.CONFIG_KEY="traffic",$p.prototype.dj=function(t,e){return new sl(new cq(this,void 0,t,e),{max:22})},$p.prototype.createFlowLayer=$p.prototype.dj,$p.prototype.ej=function(t){return new Sn(new Zp(this,void 0,t))},$p.prototype.createIncidentsLayer=$p.prototype.ej,$p.prototype.ro=function(t,e,r){return hq(this,t=this.v().clone().G("incidents.json").I(t),e,r)},$p.prototype.requestIncidents=$p.prototype.ro,$p.prototype.po=function(t,e,r,i,n,o){return hq(this,t=this.v().clone().G(["flow/json",r,t,e].join("/")).I(o||{}),i,n)},$p.prototype.requestFlowByTile=$p.prototype.po,$p.prototype.to=function(t,e,r,i,n,o){return hq(this,t=this.v().clone().G(["incidents/json",r,t,e].join("/")).I(o||{}),i,n)},$p.prototype.requestIncidentsByTile=$p.prototype.to,X.prototype.nh=function(t,e){if(6===(e=e||6))e=$p;else{if(7!==e)throw new D(this.nh,1,"allowed values are 6 and 7");e=Sp}return this.Ma(e,t)},X.prototype.getTrafficService=X.prototype.nh,u(iq,Op),t("H.service.GeocodingService",iq),iq.prototype.Aa=function(){return{subDomain:"geocoder.ls",reverseSubDomain:"reverse",path:"6.2"}},iq.CONFIG_KEY="geocoding",iq.prototype.a=function(t){return Error(t.Details||t.message||t.error)},iq.prototype.Zg=function(t,e,r){return t=this.v().clone().G("geocode.json").I(t),this.B(t,e,r)},iq.prototype.geocode=iq.prototype.Zg,iq.prototype.ii=function(t,e,r){return t=this.v().clone().G("reversegeocode.json").I(t),this.b&&t.Ba(this.b),this.B(t,e,r)},iq.prototype.reverseGeocode=iq.prototype.ii,iq.prototype.search=function(t,e,r){return t=this.v().clone().G("search.json").I(t),this.B(t,e,r)},iq.prototype.search=iq.prototype.search,X.prototype.km=function(t){return this.Ma(iq,t)},X.prototype.getGeocodingService=X.prototype.km,u(jq,Op),t("H.service.PlacesService",jq),jq.prototype.Aa=function(){return{subDomain:"places.ls",path:"places/v1"}},jq.CONFIG_KEY="places",jq.EntryPoint={SEARCH:"discover/search",SUGGEST:"suggest",EXPLORE:"discover/explore",AROUND:"discover/around",HERE:"discover/here",CATEGORIES:"categories/places"},jq.prototype.request=function(t,e,r,i){return kq(this,t,e,r,i)},jq.prototype.request=jq.prototype.request,jq.prototype.search=function(t,e,r){return kq(this,"discover/search",t,e,r)},jq.prototype.search=jq.prototype.search,jq.prototype.Go=function(t,e,r){return kq(this,"suggest",t,e,r)},jq.prototype.suggest=jq.prototype.Go,jq.prototype.Fl=function(t,e,r){return kq(this,"discover/explore",t,e,r)},jq.prototype.explore=jq.prototype.Fl,jq.prototype.rl=function(t,e,r){return kq(this,"discover/around",t,e,r)},jq.prototype.around=jq.prototype.rl,jq.prototype.on=function(t,e,r){return kq(this,"discover/here",t,e,r)},jq.prototype.here=jq.prototype.on,jq.prototype.wl=function(t,e,r){return kq(this,"categories/places",t,e,r)},jq.prototype.categories=jq.prototype.wl,jq.prototype.Gl=function(t,e,r,i){return t=Dp(t).I(this.v().getQuery()).I(i||{}),this.B(t,e,r)},jq.prototype.follow=jq.prototype.Gl,X.prototype.Im=function(t){return this.Ma(jq,t)},X.prototype.getPlacesService=X.prototype.Im,nq.prototype.nd=function(t,e){if(t>=this.min&&t<=this.max){if(!(t=this.b.length)||!this.a)return!0;if(this.a.nd(e))for(;t--;)if(this.b[t].nd(e))return!0}return!1},u(oq,S),t("H.service.omv.Provider",oq),oq.prototype.Sb=ff,oq.prototype.providesOMV=oq.prototype.Sb,oq.prototype.ub=function(t){return this.T.test(t)},oq.prototype.cacheFilter=oq.prototype.ub,oq.prototype.uc=function(t,e,r){return rq(this.i,t,e,r).toString()},oq.prototype.getTileKey=oq.prototype.uc,oq.prototype.nb=function(){return this.xa},oq.prototype.getCache=oq.prototype.nb,oq.prototype.Lm=function(){return this.u},oq.prototype.getPoliticalView=oq.prototype.Lm,oq.prototype.yo=function(t){var e=this.u;this.u=t,this.dispatchEvent(new cj("politicalviewchange",this.u,e))},oq.prototype.setPoliticalView=oq.prototype.yo,oq.prototype.MAX_STORE_TIME=2592e6,oq.prototype.l=function(){return od()},oq.prototype.c=function(){return od()?nd():oq.j.c.call(this)},oq.prototype.s=function(){return this.i},oq.prototype.B=function(t,e,r,i,n){return this.i.Ha(t,e,r,i,n)},oq.prototype.requestInternal=oq.prototype.B,oq.prototype.gb=function(t){t.a&&t.a("OMV"),this.Qa(t)},oq.prototype.setStyle=oq.prototype.gb,oq.prototype.V=function(){return oq.j.Ya.apply(this)},oq.prototype.getStyle=oq.prototype.V,oq.prototype.Ya=function(){var t=oq.j.Ya.apply(this),e=t.getState()===Xh.READY,r=t.qc();return e&&r&&r.global&&(this.D&&(this.R&&(r.global.ux_language=this.R),this.L&&(r.global.ux_language_fallback=this.L)),this.m&&r.global.poi&&r.global.poi.default&&(r.global.poi.default.visible=this.m),this.D||this.m)&&(t=new ti(r,t.Ib())),t},oq.prototype.getStyleInternal=oq.prototype.Ya,oq.prototype.D=!1;var sq=["en"];function pq(t){pq.j.constructor.call(this,pq,t);var e=Pp(this,t).mapVersion;this.l=t.queryParams||{},this.b=vc(e)?e:tq[this.v().toString()],vc(this.b)||uq(this)}oq.prototype.hh=function(){return this.f||sq},oq.prototype.getLanguages=oq.prototype.hh,oq.prototype.o=function(){oq.j.o.call(this),this.i.removeEventListener("versionupdate",this.aa)},oq.prototype.xa=new Rk(256),oq.prototype.ba=function(t,e){return Np(this.i.ba(),this.qa,e,t)},oq.prototype.getCopyrights=oq.prototype.ba,u(pq,Op),t("H.service.omv.Service",pq),pq.prototype.Aa=function(){return{subDomain:"vector",path:"v2/vectortiles/base/mc"}},pq.CONFIG_KEY="omv";var tq={};function uq(t){t.B(t.v().clone().G("../../info"),(function(e){e=e.mapVersion;var r=t.v().toString();t.b=e,e!==tq[r]&&(tq[r]=e,t.dispatchEvent("versionupdate"))}),(function(){}))}function rq(t,e,r,i){return e=t.v().clone().G(i+"/"+e+"/"+r+"/omv"),vc(t.b)&&e.I({mv:t.b}).I(t.l),e}function vq(t){vq.j.constructor.call(this,vq,t),this.b=t.getToken}function Fq(t,e,r,i){return t.v().clone().G(e+"/layers/"+r+"/features").I(i||{})}function Cq(t,e,r,i,n){return Fq(t,r,i,e=Object.assign({},n,{id:new Hp(e)}))}function Aq(t,e,r,i,n){return t.v().clone().G(r+"/layers/"+i+"/features/"+e).I(n||{})}function yq(t,e,r,i,n,o,a){return a=void 0===a?"application/json":a,r={method:r,headers:Object.assign({},o?{"Content-Type":"application/geo+json"}:void 0,"function"==typeof t.b?{Authorization:"Bearer "+t.b()}:void 0,t.g)},o&&(r.data=JSON.stringify(o)),(o=new tf(a,e.toString(),je,r)).then(i,Qp(t,e,n)),o}function wq(t,e,r,i){zc(r,"String",t,e,"must be a string"),zc(i,"String",t,e+1,"must be a string")}function zq(t,e){zc(e,"String",t,0,"must be a string")}function Bq(t,e){if(!Array.isArray(e)||0===e.length||e.some((function(t){return"string"!=typeof t})))throw new D(t,0,"must be a non-empty array of strings")}function Dq(t,e,r){if(!Ea(r))throw new D(t,e,"must be a GeoJSON object")}function xq(t,e,r,i){if(!Da(r))throw new D(t,e,"must be a function");if(!Da(i))throw new D(t,e+1,"must be a function")}function Gq(t,e,r,i){if(Gq.j.constructor.call(this,i?{min:i.min,max:i.max,engineType:i.engineType}:void 0),C(t,vq,Gq,0),!Cc(e))throw new D(Gq,1,'"catalogHrn" must be a string');if(!Cc(r))throw new D(Gq,2,'"layerId" must be a string');this.u=t,this.f=e,this.i=r,this.m=Ea(i)&&Ea(i.parameters)?i.parameters:{},this.Qa(this.b===kk.WEBGL?new ti({sources:{iml:{type:"MVT"}},layers:{iml:{data:{source:"iml",layer:this.f+":"+this.i},points:{filter:{$geometry:"point"},draw:{points:{collide:!1,order:200,color:"#92CF48",size:[[10,"8px"],[14,"12px"],[18,"16px"]]}}},polygons:{filter:{$geometry:"polygon"},draw:{polygons:{order:201,color:"#E39E3C"},lines:{order:202,color:"#755DA5",width:"1px"}}},lines:{filter:{$geometry:"line"},draw:{lines:{order:203,color:"#0258AE",width:"2px",join:"round",cap:"round"}}}}}}):new H.map.render.harp.Style({styles:[{layer:this.f+":"+this.i,when:["==",["geometry-type"],"Point"],technique:"circles",renderOrder:200,color:"#92CF48",size:["interpolate",["linear"],["zoom"],10,8,14,12,18,16]},{layer:this.f+":"+this.i,when:["==",["geometry-type"],"Polygon"],technique:"fill",color:"#E39E3C",renderOrder:201},{layer:this.f+":"+this.i,when:["==",["geometry-type"],"Polygon"],technique:"solid-line",color:"#755DA5",lineWidth:"1px",renderOrder:202},{layer:this.f+":"+this.i,when:["==",["geometry-type"],"LineString"],technique:"solid-line",color:"#0258AE",lineWidth:"2px",renderOrder:203}]}))}function Mp(t){t=void 0===t?{}:t,Mp.j.constructor.call(this,Mp,t),this.b={og:t.resource||"base",eg:t.projection||"mc",format:t.format||"png8"},this.f=t.queryParams||{}}function Hq(t,e,r,i,n,o,a){var s=this;a=a||{},o=o||{};var l=t.v().clone().G(e+"/"+t.vc()+"/"+r).I(o),c=t.c;this.D=t,this.R=l,Ek.call(this,{tileSize:i,max:512===i?19:20,min:512===i?2:0,getURL:function(t,e,r){var o=s.R.clone();return c&&o.Ba(c[(r+e+t)%c.length]),o.G(r+"/"+t+"/"+e+"/"+i+"/"+n),o.toString()},crossOrigin:a.crossOrigin,headers:a.headers,uri:l.toString().replace(/_/g,"")+i,engineType:a.engineType}),this.me=e,this.ab=r,this.xa=o,this.qa=r.split(".")[0],this.i=A(this.i,this),this.getCopyrights=this.ba,this.L=!1,t.addEventListener("versionupdate",this.i)}function Iq(t){Iq.j.constructor.call(this,Iq,t),t=Pp(this,t),this.c=t.shards,(this.f=t.ignoreTypes?null:t.type)&&this.v().Ba(this.f),this.b=t.version,this.s=new lq,this.m={},this.l=0,"newest"===this.b&&Jq(this)}function Kq(t,e){for(var r={},i=t[e+"s"][e],n=i.length;n--;)r[i[n].id]=i[n];t[e+"s"]=r}function Jq(t){var e=t.v().clone().G("info").I({output:"json"});t.c&&e.Ba(t.c[0]),t.B(e,(function(e){var r;if(Kq(e=e.response,"map"),Kq(e,"scheme"),Kq(e,"tiletype"),Kq(e,"format"),Kq(e,"resolution"),Kq(e,"language"),"newest"===t.b&&"traffic"!==t.f)for(r in e.maps)e.maps[r].hash&&e.maps[r].newest&&(t.b=e.maps[r].hash,t.dispatchEvent("versionupdate"));t.u=e,t.dispatchEvent("infoupdate")}),(function(t){throw t}))}function Lq(t){var e=t.v().clone().G("copyright").G(t.vc()).I({output:"json"});t.c&&e.Ba(t.c[0]),t.l=1,t.B(e,(function(e){t.l=2,mq(t.s,e),t.dispatchEvent("copyrightupdate")}),(function(e){throw t.l=-1,e}))}function Mq(t){Mq.j.constructor.call(this,Mq,t)}function Nq(t){Nq.j.constructor.call(this,Nq,t),zp(Nq,"Use HERE Routing API v8 instead.")}function Oq(t){Oq.j.constructor.call(this,Oq,t)}function Pq(){}function Qq(){}function Rq(t,e){this.a=t,this.b=e}function Sq(){}function Tq(t,e){this.b=t,this.a=e}function Uq(t,e,r){var i;if(e=e||(t&&t.length?Object.keys(t[0]):B),this.Cb=t,e)for(this.Dd=e,this.Pg=t=oc(),i=e.length;i--;)t[e[i]]=!0;r!==B&&(this.Sh=r)}function Vq(t,e){return t.Cb?t.Cb.push(e):t.Cb=[e],t.Cb.length-1}function Wq(t){var e=Xq;if(!t||!Cc(af(t.layerId,t.layer))||!Fc(t.level)||vc(t.rowFilter)&&!Da(t.rowFilter)||vc(t.rowFilterContext)&&!Ea(t.rowFilterContext))throw new D(e,1,vc("invalid layer config")?"invalid layer config":t)}function Yq(t,e,r,i){i=i||Zq,this.a={},i.provider=t,this.invalidate=gf,Yq.j.constructor.call(this,e,i),delete this.invalidate,r&&(this.b=r),this.ra(kh.ADD)}Ic(tq),pq.prototype.Am=function(){return this.b},pq.prototype.getMapVersion=pq.prototype.Am,pq.prototype.$b=function(t,e,r){e=e||{};var i={min:0,max:22};return Ea(r)&&yp(i,r),Mn&&(e.min=i.min=4),new sl(new oq(this,t,e),i)},pq.prototype.createLayer=pq.prototype.$b,pq.prototype.Ha=function(t,e,r,i,n){return this.B(rq(this,t,e,r),(function(t){return t.arrayBuffer().then(i,n)}),n,"arraybuffer")},pq.prototype.f=function(t){return Ao()+"/"+t},pq.prototype.Je=function(t,e){if(!Da(t))throw new D(this.Je,0,'"onResult" must be a function');if(!Da(e))throw new D(this.Je,1,'"onError" must be a function');return this.B(this.v().clone().wd("v2/vectortiles/pviews"),t,e)},pq.prototype.getPoliticalViews=pq.prototype.Je,X.prototype.He=function(t){return this.Ma(pq,t)},X.prototype.getOMVService=X.prototype.He,pq.prototype.s=function(t){mq(this.c,t),this.dispatchEvent("copyrightupdate")},pq.prototype.ba=function(){return this.c||(this.c=new lq,this.B(this.v().clone().G("../../copyrights"),A(this.s,this),ld)),this.c},pq.prototype.getCopyrights=pq.prototype.ba,u(vq,Op),t("H.service.iml.Service",vq),vq.prototype.Aa=function(){return{host:"interactive.data.api.platform.here.com",path:"interactive/v1/catalogs"}},vq.prototype.a=function(t){var e=[{keys:["code","title","cause","action"],format:function(){return t.code+": "+t.title+"; cause: "+t.cause+"; action: "+t.action}},{keys:["error","error_description"],format:function(){return t.error+": "+t.error_description}},{keys:["error","errorMessage"],format:function(){return t.error+": "+t.errorMessage}}];return Error(Ea(t)?function(){for(var r=ea(e),i=r.next();!i.done;i=r.next()){var n=(i=i.value).format;if(i.keys.every((function(e){return t[e]})))return n()}return JSON.stringify(t)}():t)},vq.prototype.Qd=function(t,e,r,i,n){var o=this.Qd;return wq(o,0,t,e),xq(o,2,r,i),yq(this,t=this.v().clone().G(t+"/layers/"+e+"/statistics").I(n||{}),"GET",r,i)},vq.prototype.getStatistics=vq.prototype.Qd,vq.prototype.Ff=function(t,e,r,i,n,o,a,s,l){var c=l?"":".mvtf";return yq(this,t=this.v().clone().G(i+"/layers/"+n+"/tile/web/"+r+"_"+t+"_"+e+c).I(Object.assign({clip:!0},s)),"GET",l?o:function(t){return t.arrayBuffer().then(o)},a,void 0,l?"application/json":"arraybuffer")},vq.prototype.getFeaturesByTile=vq.prototype.Ff,vq.prototype.wj=function(t,e,r,i,n,o){var a=this.wj;return zq(a,t),wq(a,1,e,r),xq(a,3,i,n),yq(this,t=Aq(this,t,e,r,o),"GET",i,n)},vq.prototype.getFeatureById=vq.prototype.wj,vq.prototype.Sc=function(t,e,r,i,n,o){var a=this.Sc;return Bq(a,t),wq(a,1,e,r),xq(a,3,i,n),yq(this,t=Cq(this,t,e,r,o),"GET",i,n)},vq.prototype.getFeaturesById=vq.prototype.Sc,vq.prototype.Jd=function(t,e,r,i,n){var o=this.Jd;if(!Ea(t)||!(t.bbox||t.north&&t.east&&t.south&&t.west))throw new D(o,0,'must be an object with either "bbox" or a full set of "north", "east", "south" and "west"');return wq(o,1,e,r),xq(o,3,i,n),yq(this,t=this.v().clone().G(e+"/layers/"+r+"/bbox").I(t),"GET",i,n)},vq.prototype.getFeaturesByBoundingBox=vq.prototype.Jd,vq.prototype.yj=function(t,e,r,i,n){var o=this.yj;if(!(Ea(t)&&t.radius&&(t.lat&&(t.lng||t.lon)||t.refCatalogHrn&&t.refLayerId&&t.refFeatureId)))throw new D(o,0,'must be an object with "radius" and a combination of either "lat"+"lng" or "refCatalogHrn"+"refLayerId"+"refFeatureId"');return wq(o,1,e,r),xq(o,3,i,n),yq(this,t=this.v().clone().G(e+"/layers/"+r+"/spatial").I(t),"GET",i,n)},vq.prototype.getFeaturesByPointAndRadius=vq.prototype.yj,vq.prototype.xj=function(t,e,r,i,n,o){var a=this.xj;if(!Ea(t)||!t.radius)throw new D(a,0,'must be an object with "radius"');return Dq(a,1,e),wq(a,2,r,i),xq(a,4,n,o),yq(this,t=this.v().clone().G(r+"/layers/"+i+"/spatial").I(t),"POST",n,o,e)},vq.prototype.getFeaturesByGeometryAndRadius=vq.prototype.xj,vq.prototype.Jk=function(t,e,r,i,n){var o=this.Jk;return wq(o,0,t,e),xq(o,2,r,i),yq(this,t=this.v().clone().G(t+"/layers/"+e+"/search").I(n||{}),"GET",r,i)},vq.prototype.searchFeatures=vq.prototype.Jk,vq.prototype.Wj=function(t,e,r,i,n){var o=this.Wj;return wq(o,0,t,e),xq(o,2,r,i),yq(this,t=this.v().clone().G(t+"/layers/"+e+"/iterate").I(n||{}),"GET",r,i)},vq.prototype.iterateFeatures=vq.prototype.Wj,vq.prototype.$c=function(t,e,r,i,n,o){var a=this.$c;return Dq(a,0,t),wq(a,1,e,r),xq(a,3,i,n),yq(this,e=Fq(this,e,r,o),"PUT",i,n,t)},vq.prototype.putFeatures=vq.prototype.$c,vq.prototype.Yc=function(t,e,r,i,n,o){var a=this.Yc;return Dq(a,0,t),wq(a,1,e,r),xq(a,3,i,n),yq(this,e=Fq(this,e,r,o),"POST",i,n,t)},vq.prototype.postFeatures=vq.prototype.Yc,vq.prototype.hd=function(t,e,r,i,n){var o=this.hd;return Bq(o,t),wq(o,1,e,r),xq(o,3,i,n),yq(this,t=Cq(this,t,e,r),"DELETE",i,n)},vq.prototype.deleteFeatures=vq.prototype.hd,vq.prototype.Ck=function(t,e,r,i,n,o,a){var s=this.Ck;return zq(s,t),Dq(s,1,e),wq(s,2,r,i),xq(s,4,n,o),yq(this,t=Aq(this,t,r,i,a),"PUT",n,o,e)},vq.prototype.putFeature=vq.prototype.Ck,vq.prototype.wk=function(t,e,r,i,n,o,a){var s=this.wk;return zq(s,t),Dq(s,1,e),wq(s,2,r,i),xq(s,4,n,o),yq(this,t=Aq(this,t,r,i,a),"PATCH",n,o,e)},vq.prototype.patchFeature=vq.prototype.wk,vq.prototype.ij=function(t,e,r,i,n){var o=this.ij;return zq(o,t),wq(o,1,e,r),xq(o,3,i,n),yq(this,t=Aq(this,t,e,r),"DELETE",i,n,void 0,"text/plain")},vq.prototype.deleteFeature=vq.prototype.ij,vq.CONFIG_KEY="iml",X.prototype.pm=function(t){return this.Ma(vq,t)},X.prototype.getIMLService=X.prototype.pm,u(Gq,S),t("H.service.iml.Provider",Gq),Gq.prototype.B=function(t,e,r,i,n){return this.u.Ff(t,e,r,this.f,this.i,i,n,this.m)},Gq.prototype.requestInternal=Gq.prototype.B,Gq.prototype.Sb=ff,Gq.prototype.providesOMV=Gq.prototype.Sb,Gq.prototype.V=function(){return this.Ya()},Gq.prototype.getStyle=Gq.prototype.V,Gq.prototype.gb=function(t){C(t,ti)&&t.a("MVT"),this.Qa(t)},Gq.prototype.setStyle=Gq.prototype.gb,u(Mp,Op),t("H.service.rasterTile.Service",Mp),p=Mp.prototype,p.V=function(){return this.f.style||"explore.day"},p.Aa=function(){return{subDomain:"maps",path:"v3"}},p.ba=function(){return this.c||(this.c=new lq,this.B(this.v().clone().G("copyright"),A(this.Kn,this),ld)),this.c},p.Kn=function(t){var e=t.copyrights;t=t.resources;var r={},i=this.b.og+"."+this.V();r[i]=[],t[this.b.og].styles[this.V()].forEach((function(t){e[t].forEach((function(t){var e=[];t.boundingBoxes.forEach((function(t){e.push([t.north,t.west,t.south,t.east])})),r[i].push({boxes:e,label:t.label,alt:t.alt,minLevel:t.minLevel,maxLevel:t.maxLevel})}))})),mq(this.c,r)},p.Fe=function(t,e){return this.B(this.v().clone().G("info"),t,e)},Mp.prototype.getInfo=Mp.prototype.Fe,Mp.prototype.Je=function(t,e){return this.B(this.v().clone().G("politicalViews"),t,e)},Mp.prototype.getPoliticalViews=Mp.prototype.Je,Mp.prototype.jm=function(t,e){return this.B(this.v().clone().G("features"),t,e)},Mp.prototype.getFeatures=Mp.prototype.jm,Mp.prototype.hh=function(t,e){return this.B(this.v().clone().G("languages"),t,e)},Mp.prototype.getLanguages=Mp.prototype.hh,Mp.CONFIG_KEY="rasterTile",X.prototype.lh=function(t){return this.Ma(Mp,t)},X.prototype.getRasterTileService=X.prototype.lh,u(Hq,Ek),Hq.prototype.MAX_STORE_TIME=2592e6,Hq.prototype.B=function(t,e,r,i,n,o){return this.L||(zp(Iq,"Use HERE Vector Tile API or Raster Tile API v3 instead."),this.L=!0),Hq.j.B.call(this,t,e,r,i,n,o)},Hq.prototype.requestInternal=Hq.prototype.B,Hq.prototype.o=function(){Ek.prototype.o.call(this),this.D.removeEventListener("versionupdate",this.i)},Hq.prototype.ba=function(t,e){return Np(this.D.ba(),this.qa,e,t)},Hq.prototype.getCopyrights=Hq.prototype.ba,Hq.prototype.i=function(){var t=this.D;this.R=t.v().clone().G(this.me+"/"+t.vc()+"/"+this.ab).I(this.xa),this.reload(!1)},Hq.prototype.l=function(){return od()},Hq.prototype.c=function(){return od()?nd():Hq.j.c.call(this)},u(Iq,Op),t("H.service.MapTileService",Iq),Iq.prototype.Aa=function(){return{subDomain:"maps.ls",path:"maptile/2.1",type:"base",version:"newest",shards:["1","2","3","4"]}},Iq.CONFIG_KEY="maptile",Iq.prototype.Hj=function(){return this.f},Iq.prototype.getType=Iq.prototype.Hj,Iq.prototype.vc=function(){return this.b},Iq.prototype.getVersion=Iq.prototype.vc,Iq.prototype.ba=function(){return this.l||(this.b&&"newest"!==this.b||"traffic"===this.f)&&Lq(this),this.s},Iq.prototype.getCopyrights=Iq.prototype.ba,Iq.prototype.Fe=function(){return this.u},Iq.prototype.getInfo=Iq.prototype.Fe,Iq.prototype.ue=function(t,e,r,i,n,o){var a,s=this.v().clone().G(t+"/"+this.vc()+"/"+e+"/"+r+"/"+i).I(n||{}).toString(),l=0,c=s.length;if(0!==c)for(a=0;a<c;a++)l=(l<<5)-l+s.charCodeAt(a),l|=0;return s=l,(l=this.m[s])||(l=new Hq(this,t,e,r,i,n,yp({headers:this.g},o||{})),this.m[s]=l),l},Iq.prototype.createTileProvider=Iq.prototype.ue,Iq.prototype.nc=function(t,e,r,i,n,o,a,s){return new sl(t=this.ue(t,e,r,i,n,s),{opacity:o,dark:!!a})},Iq.prototype.createTileLayer=Iq.prototype.nc,X.prototype.ih=function(t){return this.Ma(Iq,t)},X.prototype.getMapTileService=X.prototype.ih,u(Mq,Op),t("H.service.publicTransit.Service",Mq),Mq.prototype.Aa=function(){return{subDomain:"transit.router",path:"v8"}},Mq.CONFIG_KEY="publicTransit",Mq.prototype.Tm=function(t,e,r){return t=this.v().clone().G("routes").I(t),this.B(t,e,r)},Mq.prototype.getRoutes=Mq.prototype.Tm,Mq.prototype.$l=function(t,e,r){return t=this.v().clone().G("departures").I(t),this.B(t,e,r)},Mq.prototype.getDepartures=Mq.prototype.$l,Mq.prototype.Xm=function(t,e,r){return t=this.v().clone().G("stations").I(t),this.B(t,e,r)},Mq.prototype.getStations=Mq.prototype.Xm,Mq.prototype.a=function(t){return Error(JSON.stringify(t))},X.prototype.Pm=function(t){return this.Ma(Mq,t)},X.prototype.getPublicTransitService=X.prototype.Pm,u(Nq,Op),t("H.service.RoutingService",Nq),Nq.prototype.Aa=function(){return{subDomain:"route.ls",path:"routing/7.2"}},Nq.prototype.a=function(t){return Error(t.details)},Nq.CONFIG_KEY="routing",Nq.prototype.Cd=function(t,e,r){return t=this.v().clone().G("calculateroute.json").I(t),this.B(t,e,r)},Nq.prototype.calculateRoute=Nq.prototype.Cd,Nq.prototype.Ng=function(t,e,r){return t=this.v().clone().Ba("isoline").G("calculateisoline.json").I(t),this.B(t,e,r)},Nq.prototype.calculateIsoline=Nq.prototype.Ng,u(Oq,Op),t("H.service.RoutingService8",Oq),Oq.CONFIG_KEY="routing_v8",Oq.prototype.Aa=function(){return{subDomain:"router",path:"v8/routes"}},Oq.prototype.a=function(t){return Error(401===(t&&void 0===t.status?401:t.status)?t.error_description:t.title,{cause:t})},Oq.prototype.Cd=function(t,e,r){return t=this.v().clone().I(t),this.B(t,e,r)},Oq.prototype.calculateRoute=Oq.prototype.Cd,Oq.prototype.Ng=function(t,e,r){return t=this.v().clone().Ba("isoline").wd("v8/isolines").I(t),this.B(t,e,r)},Oq.prototype.calculateIsoline=Oq.prototype.Ng,X.prototype.Fj=function(t,e){if(7===(e=Mn?8:+e||7))e=Nq;else{if(8!==e)throw new D(this.Fj,1,"allowed values are 7 and 8");e=Oq}return this.Ma(e,t)},X.prototype.getRoutingService=X.prototype.Fj,t("H.service.extension.dataView.ITable",Pq),Pq.prototype.Md=function(){},Pq.prototype.getMeta=Pq.prototype.Md,Pq.prototype.Pd=function(){},Pq.prototype.getRowCount=Pq.prototype.Pd,Pq.prototype.tc=function(){},Pq.prototype.getRow=Pq.prototype.tc,Pq.prototype.Ta=function(){},Pq.prototype.getColumnNames=Pq.prototype.Ta,Pq.prototype.Be=function(){},Pq.prototype.getColumn=Pq.prototype.Be,Pq.prototype.ua=function(){},Pq.prototype.getCell=Pq.prototype.ua,Pq.prototype.concat=function(){},Pq.prototype.concat=Pq.prototype.concat,t("H.service.extension.dataView.IRow",Qq),Qq.prototype.Ta=function(){},Qq.prototype.getColumnNames=Qq.prototype.Ta,Qq.prototype.ua=function(){},Qq.prototype.getCell=Qq.prototype.ua,Qq.prototype.md=function(){},Qq.prototype.getTable=Qq.prototype.md,t("H.service.extension.dataView.ObjRow",Rq),Rq.prototype.Ta=function(){return this.a.Ta()},Rq.prototype.getColumnNames=Rq.prototype.Ta,Rq.prototype.ua=function(t){return this.a.ua(this.b,t)},Rq.prototype.getCell=Rq.prototype.ua,Rq.prototype.md=function(){return this.a},Rq.prototype.getTable=Rq.prototype.md,t("H.service.extension.dataView.IColumn",Sq),Sq.prototype.ua=function(){},Sq.prototype.getCell=Sq.prototype.ua,t("H.service.extension.dataView.ObjColumn",Tq),Tq.prototype.ua=function(t){return this.b.ua(t,this.a)},Tq.prototype.getCell=Tq.prototype.ua,t("H.service.extension.dataView.ObjTable",Uq),p=Uq.prototype,p.Sh=B,p.Cb=B,p.Dd=B,p.Pg=B,p.Md=function(){return this.Sh},Uq.prototype.getMeta=Uq.prototype.Md,Uq.prototype.Pd=function(){return this.Cb?this.Cb.length:0},Uq.prototype.getRowCount=Uq.prototype.Pd,Uq.prototype.tc=function(t){var e=this.Cb;return e&&e[t]?new Rq(this,t):B},Uq.prototype.getRow=Uq.prototype.tc,Uq.prototype.Ta=function(){return this.Dd||hf},Uq.prototype.getColumnNames=Uq.prototype.Ta,Uq.prototype.Be=function(t){return this.Pg[t]?new Tq(this,t):B},Uq.prototype.getColumn=Uq.prototype.Be,Uq.prototype.ua=function(t,e){var r=this.Cb;return(t=r&&this.Pg[e]&&r[t])&&t[e]},Uq.prototype.getCell=Uq.prototype.ua,Uq.prototype.concat=function(){var t,e=arguments.length,r=this.Dd,i=""+this.Dd,n=(this.Cb||[]).slice();for(t=0;t<e;t++){var o=arguments[t];if(!(o instanceof Uq))throw new D(this.concat,t);if(o.Cb){if(r&&""+o.Dd!==i)throw new D(this.concat,t,"Incompatible columns!");n=n.concat(o.Cb)}}return new Uq(n,this.Dd,this.Sh)},Uq.prototype.concat=Uq.prototype.concat,u(Yq,Hh),t("H.service.remote.Spatial",Yq);var Zq={};function $q(t,e){this.a=t,e&&(this.b=e)}Yq.prototype.cb=function(){return this.b||Hh.prototype.cb.call(this)},Yq.prototype.getId=Yq.prototype.cb,Yq.prototype.pg=ld,Yq.prototype.retain=Yq.prototype.pg,Yq.prototype.release=ff,Yq.prototype.release=Yq.prototype.release;var ar=new $q(hf);function br(t,e,r){t.a[e.key]=new $q(r,void 0)}function cr(t,e,r,i){if(!Da(r))throw new D(t,e,"has invalid type");if(!Da(i))throw new D(t,e+1,"has invalid type")}function dr(t,e,r){var i=8===t;this.b=e,this.c=r||ld,(this.a=4===t||i)?this.l=i:this.g=1===t,this.f=this.a?"$HProjGeometry":"geometry"}function er(t,e,r,i,n){var o=[],a=n.paths,s=a.length,l=0,c=t.b&&t.b(i);for(t=new Yq(e,t.l,B,{style:c||t.i,data:i});l!==s;)o.push(gr(a[l++]));return br(t,r,[new Ph(o,n.interiorsIndex,n.outlinesIndex)]),t}function fr(t,e,r,i){i=new kg(i[0],i[1]);var n=t.b&&t.b(r);return t=t.g?new Rn(i,t={icon:n,data:r,provider:e}):new bj(i,t={icon:n,data:r,provider:e})}function gr(t){for(var e=0,r=t.length,i=[];e<r;)i.push(new J(t[e++],t[e++]));return i}function hr(t,e){var r={};this.c=t,Ya(r,e||r),ok.call(this,r),this.ig={},(t=this.Kb(nh.SPATIAL)).update(t.a+1,kh.ADD)}function ir(t){return t.wc(!0)}function jr(t,e,r){var i,n=e.l&&e.l[r];return!n&&(i=e.s)&&(delete e.s,(e.l=t=t.c.parse(t,e,i))&&(n=t[r])),n||hf}Yq.prototype.Kd=function(t){return(this.a[t.key]||ar).a},Yq.prototype.getGeometriesForTile=Yq.prototype.Kd,Yq.prototype.gh=function(t){return(this.a[t.key]||ar).b},Yq.prototype.getLabels=Yq.prototype.gh,dr.prototype.parse=function(t,e,r){var i,n,o,a,s={},l=[],c=0;for(o=r.length;c<o;c++){var u=r[c],h=u.Rows;if(u=h.length){var p=Object.keys(h[0]).filter((function(t){return"geometry"!==t&&"$HProjGeometry"!==t}));for(p=new Uq(h,p),a=0;a<u;a++){var f=h[a];if(n=f[this.f]){if(delete f[this.f],f=p.tc(a))try{(i=this.a?er(this,t,e,f,n):fr(this,t,f,n.path)).ka(t),l.push(i)}catch(t){this.c(t.message)}}else this.c("Layer must contain geometries")}}}return s[this.a?"spatials":this.g?"markers":"domMarkers"]=l,s},u(hr,ok),t("H.service.remote.ObjectProvider",hr),hr.prototype.F=function(){ok.prototype.F.call(this)},hr.prototype.dispose=hr.prototype.F,hr.prototype.Ec=function(){return hf},hr.prototype.requestMarkers=hr.prototype.Ec,hr.prototype.Dc=function(){return hf},hr.prototype.requestDomMarkers=hr.prototype.Dc,hr.prototype.sd=function(){return hf},hr.prototype.requestOverlays=hr.prototype.sd,hr.prototype.Rb=ff,hr.prototype.providesMarkers=hr.prototype.Rb,hr.prototype.Qb=ff,hr.prototype.providesDomMarkers=hr.prototype.Qb,hr.prototype.Cc=ff,hr.prototype.providesSpatials=hr.prototype.Cc,hr.prototype.kg=function(){return hf},hr.prototype.requestSpatials=hr.prototype.kg,hr.prototype.mg=function(t,e){return t=jr(this,t,kr),e&&(t=t.filter(ir)),t},hr.prototype.requestSpatialsByTile=hr.prototype.mg,hr.prototype.fa=function(t){var e=t.cb();if(this.ig[e])throw new $c(this.fa,"Remote object "+e+" already added");return this.ig[e]=t},hr.prototype.Ga=function(t){delete this.ig[t.cb()]};var kr="spatials";function lr(t){var e=(t=t||{}).tileCacheSize||1024,r=t.resultType,i=t.styleCallback;if(vc(t.min)||(t.min=12),lr.j.constructor.call(this,t),-1===mr.indexOf(r))throw new D(lr,2,"invalid resultType");if(this.f=r,i&&!Da(i))throw new D(lr,2,"invalid style callback");this.aa=i,this.R=t.pixelRatio||Ue(),this.Gb=A(this.Gb,this),this.J(new Rk(e,A(this.ab,this))),this.createTileInternal=A(4===r||8===r?this.T:this.L,this)}function nr(t){var e=t.qa;return e||(t.u||(t.u=t.m(t.f,t.aa,t.Gb)),(e=t.qa=new hr(t.u)).ka(t),e.addEventListener(t.A.za,A(t.xa,t)),e.qa=!0),e}u(lr,S),t("H.service.extension.TileProvider",lr),lr.prototype.i=!1,lr.prototype.getCapabilities=function(){return lr.j.getCapabilities.call(this)|Qj.CROP_LINES_BY_TILE|Qj.CROP_POLYGONS_BY_TILE},lr.prototype.Ha=function(t,e,r,i){return this.i?lr.j.Ha.call(this,t,e,r,i):B},lr.prototype.requestTile=lr.prototype.Ha,lr.prototype.Gb=function(t){this.dispatchEvent(new wd("error",Cc(t)?t:t+"",this))},lr.prototype.Rb=function(){return 1===this.f},lr.prototype.providesMarkers=lr.prototype.Rb,lr.prototype.Qb=function(){return 2===this.f},lr.prototype.providesDomMarkers=lr.prototype.Qb,lr.prototype.Cc=function(){return 4===this.f||8===this.f},lr.prototype.providesSpatials=lr.prototype.Cc,lr.prototype.L=function(t,e,r,i){var n=this.getTileKey(t,e,r);n=this.nb().get(n);var o=2==this.f,a=[],s=nr(this);for(n?n.valid=!0:(delete(t=n=new Xk(t,e,r,z)).l,t.s=i),e=(i=jr(s,n,o?"domMarkers":"markers")).length;e--;)(t=i[e]).Ii=n,(o||1===t.xb().getState())&&a.push(t);return n.data=a,n},lr.prototype.xa=function(t){(t=t.target.Ii)&&(t.valid=!1)},lr.prototype.Ao=function(t){this.D=!!t},lr.prototype.setTileCanvasRendering=lr.prototype.Ao,lr.prototype.D=!0,lr.prototype.T=function(t,e,r,i){var n=nr(this),o=this.getTileKey(t,e,r),a=this.tileSize,s=this.nb().get(o);return s||(delete(t=s=new al(o,t,e,r,a,this.R,r,n)).l,t.s=i),this.D?(i=Cp.pop(a),s.W(i)||Cp.push(i,a)):gl(s),s},lr.prototype.ab=function(t,e){var r;if(4===this.f||8===this.f){for(r=(t=e.Ua()).length;r--;)delete t[r].a[e.key];(t=e.gg())&&(Cp.push(t,this.tileSize),e.hg())}else for(r=(t=e.data).length;r--;)delete t[r].Ii},lr.prototype.o=function(){lr.j.o.call(this),nr(this).F()};var or={MARKER:1,DOM_MARKER:2,POLYLINE:4,POLYGON:8};lr.ResultType=or;var mr=[1,2,4,8];function Xq(t,e,r){var i=this,n=e&&e.rowFilter,o=r.resultType;Xq.j.constructor.call(this,r),C(t,pr,Xq,0),Wq(e),n?(r=Wa(e)).rowFilter=n.toString():r=Wa(e),delete r.layer,r.layerId=af(e.layerId,e.layer),(new Pf).a("pde","H.service.extension.worker.processor"),t=t.v().clone().G(qr+"."+rr).I({meta:1}),new Sf("pde",{message:[this.uid,0,{tileSize:this.tileSize,projected:!0,onlyOutline:4===o,serverUrl:t.toString(),layerConfigs:[r],horizontalMargin:1}]}).then((function(){i.i=!0,i.Va()}),this.Gb)}u(Xq,lr),t("H.service.extension.platformData.TileProvider",Xq),Xq.prototype.m=function(t,e,r){return(t=new dr(t,e,r)).i=sr,t};var sr=new wh({strokeColor:"transparent",fillColor:"transparent",lineWidth:0,lineJoin:"round",lineCap:"round"});function tr(t,e,r,i,n,o){cr(tr,1,e,r),cr(tr,2,i,n),(this.f=t.length)?(this.U=t,this.m=e,this.i=r,this.b=0,this.c=A(this.c,this),this.s=i,this.l=n,this.a=oc(),Ya(this.a,ur,o||{}),this.g={},x.setTimeout(this.c,0)):e(hf,!0)}Xq.prototype.B=function(t,e,r,i,n){var o,a=this,s=this.getTileKey(t,e,r);s=this.nb().get(s);var l={cancel:ld},c=!0,u=this.f;if(s&&(4===u||8===u?s.Ud()||(i(Cp.pop(this.tileSize),null),c=!1):(i(z),c=!1)),c){var h=Ap.setTimeout((function(){(o=new Sf("pde",{message:[a.uid,1,[t,e,r]]})).then(i,n)}),500);l.cancel=function(){o?o.cancel():Ap.clearTimeout(h)}}return l},Xq.prototype.requestInternal=Xq.prototype.B,Xq.prototype.o=function(){Xq.j.o.call(this),new Sf("pde",{message:[this.uid,3]})},Xq.ResultType=or;var ur={duration:100,Kl:"geometry",Jl:"WKT",uo:"searchAttributes",hj:B};function vr(t){this.a=t}function pr(t){pr.j.constructor.call(this,pr,t),zp(pr)}tr.prototype.c=function(){for(var t,e=[],r=!1,i=Lk();this.b<this.f;){var n=this.U[this.b];if(r=n.attributes,t=n.layerId||this.a.hj,n.distance&&(r[this.a.uo]={nearest:new kg(n.nearestLat,n.nearestLon),distance:n.distance}),n=n[this.a.Kl]){try{var o=Wn(new qo(n))}catch(t){this.i(new x.Error(t.message)),r=!0;break}r[this.a.Jl]=o}if((n=this.g[t])||(n=this.g[t]=this.s({layerId:t,columnNames:Object.keys(r)})),r=this.l(n,r),e.push(r),this.b++,(r=this.b===this.f)||Lk()-i>=this.a.duration){this.m(e,r);break}}r?this.g={}:this.u=x.setTimeout(this.c,0)},tr.prototype.cancel=function(){x.clearTimeout(this.u),this.b<this.f&&this.i(new x.Error("parsing canceled"))},tr.prototype.cancel=tr.prototype.cancel,vr.prototype.cancel=function(){for(var t=this.a,e=t.length;e--;)t[e].cancel();t.length=0},vr.prototype.cancel=vr.prototype.cancel,u(pr,Op),t("H.service.extension.platformData.Service",pr),pr.prototype.Aa=function(){return{subDomain:"s.fleet.ls",path:"1"}},pr.CONFIG_KEY="platformData",pr.prototype.request=function(t,e,r,i,n){var o="text/plain";if(!t)throw new D(this.request,0,t);if(!e)throw new D(this.request,1,e);if(!i)throw new D(this.request,3,i);if(!n)throw new D(this.request,4,n);return t=this.v().clone().G(t+"."+e).I(r),e===wr.JSON&&(o="application/json"),this.B(t,i,n,o)},pr.prototype.request=pr.prototype.request;var qr="tiles";pr.EntryPoint={DOC_ATTRIBUTES:"doc/attributes",DOC_LAYER:"doc/layer",DOC_LAYERS:"doc/layers",DOC_MAPS:"doc/maps",DOC_INDEXES:"doc/indexes",SEARCH_BBOX:"search/bbox",SEARCH_CORRIDOR:"search/corridor",SEARCH_PROXIMITY:"search/proximity",SEARCH_QUADKEY:"search/quadkey",SERVICE_CONFIGURATION:"serviceconfiguration",STATIC:"static",TILE:"tile",TILES:qr,FILE:"file",INDEX:"index"};var rr="json",wr={TXT:"txt",JSON:rr,HTML:"html",BIN:"bin"};function xr(t,e,r,i,n){var o,a=[],s=r.layer_id||r.layer_ids;return t=t.request(e,rr,r,(function(t){o=new tr(t.geometries,i,n,(function(t){return new Uq([],t.columnNames,t)}),(function(t,e){return t.tc(Vq(t,e))}),{hj:s}),a.push(o)}),(function(t){n(new x.Error(t))})),a.push(t),new vr(a)}function yr(t,e,r){if(!Bc(t))throw new D(r,0,"has invalid type");if(!Bc(e))throw new D(r,1,"has invalid type");if(t.length!==e.length||!t.length)throw new D(r,1,"specify one key attribute for each given layer id in the same order")}function zr(t){zr.j.constructor.call(this,zr,t),zp(zr)}function Ar(t){var e=Br;if(!t||!Cc(t.layerId)||vc(t.rowFilter)&&!Da(t.rowFilter)||vc(t.rowFilterContext)&&!Ea(t.rowFilterContext))throw new D(e,1,vc("invalid layer config")?"invalid layer config":t)}function Cr(t){return Cc(t)&&/^[A-Z][A-Z0-9_]*$/.test(t)}function Dr(t){for(var e=t&&t.length,r=2<=e&&"WKT"===t[--e]&&"GEOMETRY_ID"===t[--e];r&&e--;)r=Cr(t[e]);return r}function Er(t,e){var r="",i=[];if(e){var n=t.geometries;if(n&&n.length){var o=Object.keys(n[0].attributes);for(r=r+"Meta:\t"+e+"\n"+o.join("\t"),r+="\tWKT\n",t=0;t<n.length;t++){var a=n[t].attributes,s=n[t].geometry;for(e=0;e<o.length;e++)i.push(a[o[e]]);r+=i.join("\t"),r+="\t"+s+"\n",i=[]}}}else{if(s={},i=[],t.geometries)for(n=0;n<t.geometries.length;n++)s[(e=t.geometries[n]).layerId]||(s[e.layerId]=[]),s[e.layerId].push(e);for(o in s)i.push({layerId:o,geometries:s[o]});for(t=0;t<i.length;t++)r+=Er(i[t],i[t].layerId)}return r}function Br(t,e,r){var i,n=this,o=e&&e.rowFilter;Br.j.constructor.call(this,r),C(t,Fr,Br,0);var a=r.resultType;if(Ar(e),o){var s=Wa(e);s.rowFilter=o.toString()}else s=e;(new Pf).a("cle","H.service.extension.worker.processor");var l=e.layerId;t.request(Gr,Hr,{detail_level:"all",layer_id:l},(function(e){var r;for(e=e.layers,r=0;r<e.length;r++)if(e[r].layerId===l){s.level=e[r].level;break}i=t.v().clone().G(Ir+"."+Hr).I({meta:1}),new Sf("cle",{message:[n.uid,0,{tileSize:n.tileSize,projected:!0,onlyOutline:4===a,serverUrl:i.toString(),layerConfigs:[s],batchTiles:!1,horizontalMargin:1}]}).then((function(){n.i=!0,n.Va()}),n.Gb)}),(function(t){n.Gb(t.message)}))}function Jr(){if(Kr)throw new $c(Jr)}pr.EntryPointType=wr,pr.prototype.nc=function(t,e){var r=e&&e.resultType;return t=new Xq(this,t,e),1==r||2===r?new Sn(t):new sl(t)},pr.prototype.createTileLayer=pr.prototype.nc,pr.prototype.Fc=function(t,e,r,i,n,o){function a(t,e){e&&s--,i(t,!s)}var s,l=[];for(yr(t,e,this.Fc),cr(this.Fc,3,i,n),C(r,K,this.Fc,2),r={bbox:r.c+","+r.a+";"+r.f+","+r.b},o&&Ya(r,o),t=r.layer_id?[r.layer_id]:t,o=0,s=t.length;o<s;o++)r.layer_id=t[o],r.key_attribute=e[o],l.push(xr(this,"search/bbox",r,a,n));return new vr(l)},pr.prototype.searchByBoundingBox=pr.prototype.Fc,pr.prototype.Ub=function(t,e,r,i,n,o,a){if(yr(t,e,this.Ub),C(r,kg,this.Ub,2,"has invalid type"),!Fc(i))throw new D(this.Ub,3,"has invalid type");return cr(this.Ub,4,n,o),t={layer_ids:t.join(","),key_attributes:e.join(","),proximity:r.lat+","+r.lng+","+i},a&&Ya(t,a),xr(this,"search/proximity",t,n,o)},pr.prototype.searchByProximity=pr.prototype.Ub,pr.prototype.Tb=function(t,e,r,i,n,o,a){var s="";if(yr(t,e,this.Tb),!Cc(r)&&!C(r,L))throw new D(this.Tb,1,"has invalid type");if(!Fc(i))throw new D(this.Tb,2,"has invalid type");if(cr(this.Tb,4,n,o),t={layer_ids:t.join(","),key_attributes:e.join(","),radius:i},Cc(r))t.route_id=r;else{for(i=r.$,r=0,e=i.length;r<e;r+=3)s+=i[r]+","+i[r+1],r<e-3&&(s+=";");t.corridor=s}return a&&Ya(t,a),xr(this,"search/corridor",t,n,o)},pr.prototype.searchByCorridor=pr.prototype.Tb,X.prototype.Jm=function(t){return this.Ma(pr,t)},X.prototype.getPlatformDataService=X.prototype.Jm,u(zr,Op),t("H.service.extension.geofencing.Service",zr),zr.prototype.Aa=function(){return{subDomain:"fleet.ls",path:"2"}},zr.CONFIG_KEY="geofencing",zr.prototype.request=function(t,e,r,i){if(!t)throw new D(this.request,0,t);if(!Da(r))throw new TypeError("onResult must be a function");if(!Da(i))throw new TypeError("onError must be a function");return t=this.v().clone().G(t+".json").I(e),this.B(t,r,i)},zr.prototype.request=zr.prototype.request,zr.prototype.a=function(t){return Error(t.issues&&t.issues.length?t.issues.map((function(t){return t.message})).join(". "):t.message||t.response_code)},zr.EntryPoint={SEARCH_PROXIMITY:"search/proximity"},X.prototype.lm=function(t){return this.Ma(zr,t)},X.prototype.getGeofencingService=X.prototype.lm,t("H.service.extension.customLocation.Permission",{READ:"read",WRITE:"write",EXPORT:"export"}),t("H.service.extension.customLocation.Storage",{READONLY:"readonly",UPDATABLE:"updatable"}),u(Br,lr),t("H.service.extension.customLocation.TileProvider",Br),Br.prototype.m=function(t,e,r){return new dr(t,e,r)},Br.prototype.B=function(t,e,r,i,n){var o,a=this,s=this.getTileKey(t,e,r);s=this.nb().get(s);var l={cancel:ld},c=!0,u=this.f;if(s&&(4===u||8===u?s.Ud()||(i(Cp.pop(this.tileSize),null),c=!1):(i(z),c=!1)),c){var h=Ap.setTimeout((function(){(o=new Sf("cle",{message:[a.uid,1,[t,e,r]]})).then(i,n)}),500);l.cancel=function(){o?o.cancel():Ap.clearTimeout(h)}}return l},Br.prototype.requestInternal=Br.prototype.B,Br.prototype.o=function(){Br.j.o.call(this),new Sf("cle",{message:[this.uid,3]})},t("H.service.extension.customLocation.Table",Jr);var Kr=!0;function Lr(t,e){var r;Kr=!1;var i=new Jr;Kr=!0,i.c=rc(x.JSON.parse(x.JSON.stringify(t))),t=t.columnNames;var n=oc();for(r=t.length;r--;)n[t[r]]=r;if(i.f=n,i.b=t.length,e){if(e.length%t.length)throw new D(Lr,1,"Invalid number of cells")}else e=[];return i.a=e,i}Jr.prototype.Md=function(){return this.c},Jr.prototype.getMeta=Jr.prototype.Md,Jr.prototype.Pd=function(){return this.a.length/this.b},Jr.prototype.getRowCount=Jr.prototype.Pd,Jr.prototype.tc=function(t){return t<this.a.length/this.b?new Mr(this,t):B},Jr.prototype.getRow=Jr.prototype.tc,Jr.prototype.Um=function(){var t,e=this.a.length/this.b,r=new x.Array(e);for(t=0;t<e;t++)r[t]=new Mr(this,t);return r},Jr.prototype.getRows=Jr.prototype.Um,Jr.prototype.Hg=function(t){var e=this.b,r=this.a,i=r.length/this.b;if(!t||t.length%e)throw new D(this.Hg,0,"Invalid number of cells");return this.a=r.concat(t),i},Jr.prototype.addCells=Jr.prototype.Hg,Jr.prototype.ol=function(){for(var t=this.b,e=this.a,r=this.a.length/this.b;t--;)e.push(z);return this.tc(r)},Jr.prototype.addRow=Jr.prototype.ol,Jr.prototype.Ta=function(){return this.c.columnNames},Jr.prototype.getColumnNames=Jr.prototype.Ta,Jr.prototype.Be=function(t){return this.f[t]===B?B:new Nr(this,t)},Jr.prototype.getColumn=Jr.prototype.Be,Jr.prototype.ua=function(t,e){return this.a[t*this.b+this.f[e]]},Jr.prototype.getCell=Jr.prototype.ua,Jr.prototype.Gc=function(t,e,r){if(e=this.f[e],t>=this.a.length/this.b)throw new D(this.Gc,0,"Row index out of bounds");if(e===B)throw new D(this.Gc,0,"Column unknown");this.a[t*this.b+e]=r},Jr.prototype.setCell=Jr.prototype.Gc,Jr.prototype.concat=function(t){var e,r=arguments.length,i=""+this.Ta(),n=this.a?this.a.slice():[];for(e=0;e<r;e++){var o=arguments[e];if(!(o instanceof Jr))throw new D(this.concat,e);if(""+o.Ta()!==i)throw new D(this.concat,e,"Incompatible columns!");o.a&&(n=n.concat(o.a))}return Lr(this.c,n)},Jr.prototype.concat=Jr.prototype.concat;var Or=/(\n|\t|\r|")/;function Pr(t,e,r,i,n,o,a,s){var l;for(l=0;l<a;l++){l&&e.push("\t");var c=r[i*n+o[l]];if(l!==s){if(c!==z){if(c=String(c),Or.test(c))throw new D(t.Gi,0,'Invalid character (\\n, \\r, \\t, or ") in row '+i+" column "+t.c.columnNames[o[l]]);e.push(c)}}else e.push(c)}}function Nr(t,e){this.b=t,this.a=e}function Mr(t,e){this.a=t,this.Nh=e}function Qr(t){if(t===B)t="\t";else if(!/^[^"\r\n]$/.test(t))throw new D(Qr,0);this.b=String(t).charCodeAt(0),this.Oh=A(this.Oh,this),this.C=Rr}Jr.prototype.Gi=function(t,e){var r,i=this.b,n=this.Ta(),o=[],a=[],s=this.a,l=-1;for(r=0;r<i;r++)t&&!t.test(n[r])||("WKT"===n[r]&&(l=o.length),o.push(r));if(!(t=o.length))throw new D(this.Gi,1,"No columns filtered");if(Pr(this,a,n,0,i,o,t,l),e){var c=e.length;for(r=0;r<c;r++)a.push("\n"),Pr(this,a,s,n=e[r],i,o,t,l)}else for(c=this.Pd(),n=0;n<c;n++)a.push("\n"),Pr(this,a,s,n,i,o,t,l);return a.join("")},Jr.Column=Nr,Nr.prototype.ua=function(t){return this.b.ua(t,this.a)},Nr.prototype.getCell=Nr.prototype.ua,Nr.prototype.Gc=function(t,e){this.b.Gc(t,this.a,e)},Nr.prototype.setCell=Nr.prototype.Gc,Jr.Row=Mr,Mr.prototype.Ta=function(){return this.a.Ta()},Mr.prototype.getColumnNames=Mr.prototype.Ta,Mr.prototype.ua=function(t){return this.a.ua(this.Nh,t)},Mr.prototype.getCell=Mr.prototype.ua,Mr.prototype.Gc=function(t,e){this.a.Gc(this.Nh,t,e)},Mr.prototype.setCell=Mr.prototype.Gc,Mr.prototype.md=function(){return this.a},Mr.prototype.getTable=Mr.prototype.md;var Rr=0;function Sr(t,e,r){var i=t.C;if(i!==e)throw 1===i&&(t.C=Rr),new $c(r,"Requires state: "+["READY","PARSE","PAUSE"][e]+" but found "+["READY","PARSE","PAUSE"][i])}function Tr(t,e){var r=[];return t.parse(e,(function(t,e,i){return 1>t&&(r[e]=i),0<t})),t.C=Rr,r}function Ur(t,e,r){this.c=new qo(t),this.s=e,this.g=!0,this.tf=this.l=this.b=0,Vr(this),this.a=r,this.f=[],this.i=!1}function Vr(t){var e=t.c.Pb();t.m=!1,(t.U=34===e)&&t.c.next()}function Wr(t,e){var r=t.c;switch(t.m=!0,e){case t.s:t.b++;break;case 13:r.next(),10!==r.Pb()&&t.a("CR without LF");case 10:t.b=0,t.l++;break;case-1:t.g=!1;break;default:t.a("End of field expected")}return r.next(),-1}function Xr(t,e,r,i){if(i=i||{},!e)throw new D(Xr,1,"has to be a function");if(!r)throw new D(Xr,2,"has to be a function");for(this.s=e,this.u=r,this.a=[],this.g={},this.f=[],this.b={},this.i={},this.l={},this.m={},this.U=i.duration||100,this.c=A(this.c,this),t=t.split("Meta:\t").slice(1),e=0;e<t.length;e++){r=(i=t[e].split("\n"))[0].split("\t")[0],i=i.slice(1).join("\n"),this.b[r]=new Qr,this.g[r]=Tr(this.b[r],i);var n={layerId:r,columnNames:this.g[r]};this.f.push(r),this.m[r]=Lr(n),this.i[r]=Lk(),Yr(this,i,r),this.c(r)}}function Yr(t,e,r){var i=[],n=t.g[r].length-1,o=t.m[r];try{t.b[r].parse(e,(function(e,a,s){var l=!1;return 0<e&&(i[a]=s,a===n&&(t.a.push(o.tc(o.Hg(i))),Lk()-t.i[r]>t.U&&(l=!0))),l}),(function(t,e,r){if(0<t&&e===n)return Wn(r)}))}catch(e){t.u(e)}}function Fr(t){Fr.j.constructor.call(this,Fr,t),zp(Fr)}function Zr(t,e,r,i){var n,o=e[t=t===$r?"changes":"file"],a=Cc(o),s=!a&&C(o,Blob);if(!a&&!s)throw new D(i,0,"Invalid "+t+" parameter");if(as)n=s?o:pf(o,"text/plain"),(i=new x.FormData).append(t,n,n.name||t+".wkt"),r.method="POST",r.data=i,delete e[t];else if(s)throw new D(i,0,"Sending Blob data is not supported by the browser")}p=Qr.prototype,p.getState=function(){return this.C},p.abort=function(){Sr(this,2,Qr.prototype.abort),this.C=Rr},p.Oh=function(t){throw this.C=Rr,new D(Qr.prototype.parse,0,"Malformed DSV at row "+this.a.l+" column "+this.a.b+": "+t)},p.parse=function(t,e,r){Sr(this,Rr,Qr.prototype.parse),t=t.trim(),this.a=new Ur(t,this.b,this.Oh),this.c=e,this.kk=r||gf,this.C=2,this.Ph()},p.kk=gf,p.Ph=function(){var t=this.a,e=[];Sr(this,2,Qr.prototype.Ph),this.C=1;do{if(!t.g){this.C=Rr;break}if(n>t.b){if(void 0!==r&&r!==n)return void this.a.a("The number of columns must be the same for all rows");var r=n}var i=t.l,n=t.b,o=t.tf,a=this.kk(i,n,t);if(t.tf>o)for(;-1!==t.next(););else{for(;-1!==(o=t.next());)e.push(o);a=String.fromCharCode.apply(z,e),e.length=0}Vr(t),this.c(i,n,a)&&(this.C=t.g?2:Rr)}while(1===this.C);2!=this.C&&void 0!==r&&0<n&&r!==n&&this.a.a("The number of columns must be the same for all rows")},p=Ur.prototype,p.tf=0,p.Pb=function(){if(this.m)var t=-1;else{var e=this.c;if(t=e.Pb(),this.U)switch(t){case 34:e.next(),34!==(t=e.Pb())&&(t=Wr(this,t));break;case-1:this.a("Closing quotation mark expected")}else switch(t){case 34:this.a("Unexpected quotation mark");case this.s:case 13:case 10:case-1:t=Wr(this,t)}}return t},p.ge=function(){this.i=!0,this.f=[]},p.Gd=function(){var t=this.f.slice();return this.i=!1,this.f=[],t},p.next=function(){var t=this.Pb();return-1!==t&&this.c.next(),this.i&&this.f.push(t),this.tf++,t},Xr.prototype.cancel=function(){for(var t in this.l)x.clearTimeout(this.l[t])},Xr.prototype.cancel=Xr.prototype.cancel,Xr.prototype.c=function(t){var e,r,i=this;this.l[t]=x.setTimeout((function(){if(2===i.b[t].getState())i.i[t]=Lk(),i.s(i.a,!1),i.a=[],i.b[t].Ph(),i.c(t);else{for(e=!0,r=0;r<i.f.length;r++)if(i.b[i.f[r]].getState()!==Rr){e=!1;break}e&&(0<i.a.length&&i.s(i.a,!0),i.a=[])}}),0)},u(Fr,Op),t("H.service.extension.customLocation.Service",Fr),Fr.prototype.Aa=function(){return{subDomain:"fleet.ls",path:"2"}},Fr.CONFIG_KEY="customLocation",Fr.prototype.nc=function(t,e){var r=e&&e.resultType;return t=new Br(this,t,e),1===r||2===r?new Sn(t):new sl(t)},Fr.prototype.createTileLayer=Fr.prototype.nc;var as=x.FormData&&!!x.FormData.prototype.append;function bs(t,e,r,i,n,o){var a="text/plain",s=e===cs.LAYERS_UPLOAD||e===cs.LAYERS_MODIFY||e===cs.LAYERS_IMPORT,l=i,c={data:B,method:"GET",headers:t.g};if(!e)throw new D(t.request,0,e);if(!r)throw new D(t.request,1,r);cr(t.request,3,n,o),s&&(C(i,Object,t.request,2,"Invalid request parameters"),Zr(e,l=Wa(i),c,t.request));var u=t.v().clone().G(e+"."+r).I(l);return r===ds.JSON&&(a="application/json"),(t=new tf(a,u.toString(),je,c)).then((function(t){var e=t.issues;e&&t.error_id&&t.response_code?o(Error(e[0].message)):n(t)}),(function(t){"error"===t.type||404===t.status?o(Error(t.statusText||"Unable to load data")):t.json().then((function(t){o(Error("["+t.issues[0].message+"] "+u+" request failed"))}),(function(){o(Error("["+t.statusText+"] "+u+" request failed"))}))})),t}Fr.prototype.request=function(t,e,r,i,n){return bs(this,t,e,r,i,n)},Fr.prototype.request=Fr.prototype.request;var Gr="layers/list",$r="layers/modify",Ir="tiled/tile",cs={LAYERS_DELETE:"layers/delete",LAYERS_GRANT:"layers/access/grant",LAYERS_LIST:Gr,LAYERS_MODIFY:$r,LAYERS_UPLOAD:"layers/upload",LAYERS_IMPORT:"layers/import",SEARCH_ALL:"search/all",SEARCH_BBOX:"search/bbox",SEARCH_CORRIDOR:"search/corridor",SEARCH_PROXIMITY:"search/proximity",SEARCH_QUADKEY:"search/quadkey",SEARCH_TILE:Ir};Fr.EntryPoint=cs;var Hr="json",ds={TXT:"txt",JSON:Hr};function es(t,e,r,i,n){var o,a=[];return t=t.request(e,Hr,r,(function(t){t.geometries.length?(t=Er(t,r.layer_id),o=new Xr(t,i,n),a.push(o)):i(hf,!0)}),n),a.push(t),new vr(a)}Fr.EntryPointType=ds,Fr.prototype.ob=function(t,e,r){var i=this;return this.request("search/all","txt",{filter:'WKT==""',layer_id:t},(function(n){var o=String(n).replace(/[\r\n]+$/g,"").split("\t");i.request(Gr,Hr,{layer_id:t,detail_level:"all"},(function(t){(t=t.layers[0]).columnNames=o,e(Lr(t))}),r)}),r)},Fr.prototype.getLayer=Fr.prototype.ob,Fr.prototype.Kj=function(t,e,r,i){var n=e&&e.length,o=-1,a=this;return function s(){return++o<n?a.request("layers/access/grant",Hr,{layer_id:t,granted_app_id:e[o].grantedAppId,permissions:e[o].permissions.join(",")},s,i):a.ob(t,r,i)}()},Fr.prototype.grantAccess=Fr.prototype.Kj,Fr.prototype.jj=function(t,e,r){return this.request("layers/delete",Hr,{layer_ids:t},e,r)},Fr.prototype.deleteLayer=Fr.prototype.jj,Fr.prototype.$b=function(t,e,r){function i(){setTimeout((function(){l.ob(a,(function(t){setTimeout(n.bind(null,t),u)}),(function(){64e3>c?(c+=u,i()):r(x.Error("Timeout"))}))}),u),u*=2}function n(i){var n=JSON.stringify(i.Ta()),o=t.grants;if(n!==JSON.stringify(s)){var c="Results into different column names on the backend: "+n;setTimeout((function(){l.jj(a,(function(){r(x.Error(c))}),(function(t){r(x.Error(c+". "+t.message))}))}),u)}else o&&o.length?l.Kj(a,o,e,r):e(i)}var o,a,s,l=this,c=0,u=1e3,h=!t||!Cr(a=t.layerId)&&(o="layerId")||!Dr(s=t.columnNames)&&(o="columnNames")?0:Da(e)?Da(r)?-1:2:1;if(0<=h)throw new D(l.$b,h,o||arguments[h]);return l.ob(a,(function(){r(x.Error("Layer exists already"))}),(function(){var e={layer_id:a,file:s.join("\t")},n=t.level,o=t.storage;n!==B&&(e.level=n),o!==B&&(e.storage=o),l.request("layers/upload",Hr,e,i,r)}))},Fr.prototype.createLayer=Fr.prototype.$b,Fr.prototype.Ub=function(t,e,r,i,n,o){if(!Bc(t))throw new D(this.Ub,0,"has invalid type");if(C(e,kg,this.Ub,1,"has invalid type"),!Fc(r))throw new D(this.Ub,2,"has invalid type");return cr(this.Ub,3,i,n),t={layer_ids:t.join(","),proximity:e.lat+","+e.lng+","+r},o&&Ya(t,o),es(this,"search/proximity",t,i,n)},Fr.prototype.searchByProximity=Fr.prototype.Ub,Fr.prototype.Tb=function(t,e,r,i,n,o){var a="";if(!Bc(t))throw new D(this.Tb,0,"has invalid type");if(!Cc(e)&&!C(e,L))throw new D(this.Tb,1,"has invalid type");if(!Fc(r))throw new D(this.Tb,2,"has invalid type");if(cr(this.Tb,3,i,n),t={layer_ids:t.join(","),radius:r},Cc(e))t.route_id=e;else{var s=e.$;for(e=0,r=s.length;e<r;e+=3)a+=s[e]+","+s[e+1],e<r-3&&(a+=",");t.corridor=a}return o&&Ya(t,o),es(this,"search/corridor",t,i,n)},Fr.prototype.searchByCorridor=Fr.prototype.Tb,Fr.prototype.Fc=function(t,e,r,i,n){function o(t,e){e&&a--,r(t,!a)}var a,s=[];if(!Bc(t))throw new D(this.Fc,0,"has invalid type");for(C(e,K,this.Fc,1,"has invalid type"),cr(this.Fc,2,r,i),e={bbox:e.c+","+e.a+";"+e.f+","+e.b},n&&Ya(e,n),t=e.layer_id?[e.layer_id]:t,n=0,a=t.length;n<a;n++)e.layer_id=t[n],s.push(es(this,"search/bbox",e,o,i));return new vr(s)},Fr.prototype.searchByBoundingBox=Fr.prototype.Fc,Fr.prototype.li=function(t,e,r,i){var n,o=[];if(!Cc(t))throw new D(this.li,0,"has invalid type");cr(this.li,1,e,r);var a={layer_id:t};return i&&Ya(a,i),i=this.request("search/all",Hr,a,(function(i){i.geometries.length?(i=Er(i,t),n=new Xr(i,e,r),o.push(n)):e(hf,!0)}),r),o.push(i),new vr(o)},Fr.prototype.searchAll=Fr.prototype.li;var fs={delete:/^GEOMETRY_ID$/,append:/^(?!GEOMETRY_ID$)/};function gs(t,e,r,i,n,o){function a(){d++,i(this,d===p)}function s(t){d++,n(t,this,d===p)}var l,c="append"!==e,u={},h=oc(),p=0,f=[],d=0;if(!Bc(r))throw new D(o,0,r);for(cr(o,1,i,n),l=r.length;l--;){var y=r[l];if(C(y,Mr)){var g=y.md().Md().layerId,v=y.ua("GEOMETRY_ID");if(c){if(v===z||""===String(v))var m='GEOMETRY_ID must not be null or ""';u[v=g+"_"+v]&&(m="same GEOMETRY_ID for multiple rows"),u[v]=y}else v!==z&&""!==String(v)&&(m='GEOMETRY_ID must be null or ""')}else m="Invalid type";if(m)throw new D(o,0,"- Invalid row at index "+l+", "+m);(v=h[g])||(v=h[g]=[],p++),v.push(y)}for(g in h){for(r=[],l=(v=h[g]).length;l--;)r.push(v[l].Nh);f.push(t.request($r,Hr,{layer_id:g,action:e,changes:v[0].md().Gi(fs[e]||null,r)},A(a,v),A(s,v)))}return new vr(f)}function hs(t){jq.j.constructor.call(this,hs,t),zp(hs)}function is(t,e,r){var i=+(r=r||{}).min,n=+r.max;r.min=i?ae(i,1,17):1,r.max=n?ae(n,1,17):17,is.j.constructor.call(this,r),C(t,js,is,0),C(e,Wh,is,1),this.f=t,e.a&&e.a("OMV"),this.Qa(e,!0),this.i=xp(this)}function js(t){js.j.constructor.call(this,js,t),this.b=(t||jf).layer||"traffic"}function ks(t,e,r,i){return t.v().clone().G("traffictiles/"+t.b+"/mc/"+i+"/"+e+"/"+r+"/omv")}function ls(t){ls.j.constructor.call(this,ls,t)}function ms(t){if(this.c=!!t.toBypassToken,!this.c&&!t.token)throw new D(ms,0,'"token" must be specified');zp(ms,"Use HERE IML service instead."),ms.j.constructor.call(this,ms,t),this.l=t.token,this.f={},this.b={}}function rs(t,e,r,i,n,o,a){return n={method:n,headers:Object.assign(t.c?{}:{authorization:"Bearer "+t.l},{"Content-Type":"application/geo+json"},t.g)},o&&(n.data=JSON.stringify(o)),(o=new tf("application/json",(e=os(t.v().clone().G(e+"/features").I(a||{}))).toString(),je,n)).then(r,Qp(t,e,i)),o}function qs(t,e){t.b[e]=ss,t.Kf(e,(function(r){t.b[e]=ts,t.f[e]=r.copyright,t.dispatchEvent("copyrightupdate")}),(function(r){throw t.b[e]=us,r}))}function ps(t,e){return t.c?e:os(e).I({access_token:t.l})}function os(t){var e=Object.assign({},t.getQuery());return delete e.apikey,t.bf(e)}Fr.prototype.$i=function(t,e,r){return gs(this,"append",t,e,r,this.$i)},Fr.prototype.appendRows=Fr.prototype.$i,Fr.prototype.il=function(t,e,r){return gs(this,"update",t,e,r,this.il)},Fr.prototype.updateRows=Fr.prototype.il,Fr.prototype.kj=function(t,e,r){return gs(this,"delete",t,e,r,this.kj)},Fr.prototype.deleteRows=Fr.prototype.kj,X.prototype.Yl=function(t){return this.Ma(Fr,t)},X.prototype.getCustomLocationService=X.prototype.Yl,u(hs,Op),t("H.service.extension.customRoute.Service",hs),hs.prototype.Aa=function(){return{subDomain:"s.fleet.ls",path:"2"}},hs.CONFIG_KEY="customRoute",hs.prototype.a=function(t){return Error(t.issues&&t.issues.length?t.issues.map((function(t){return t.message})).join(". "):t)},hs.prototype.Cd=function(t,e,r){return cr(this.Cd,1,e,r),t=this.v().clone().G("calculateroute.json").I(t),this.B(t,e,r)},hs.prototype.calculateRoute=hs.prototype.Cd,X.prototype.Zl=function(t){return this.Ma(hs,t)},X.prototype.getCustomRoutingService=X.prototype.Zl,u(is,S),t("H.service.trafficVectorTile.Provider",is),is.prototype.Sb=ff,is.prototype.providesOMV=is.prototype.Sb,is.prototype.ub=function(t){return this.i.test(t)},is.prototype.cacheFilter=is.prototype.ub,is.prototype.uc=function(t,e,r){return ks(this.f,t,e,r).toString()},is.prototype.getTileKey=is.prototype.uc,is.prototype.nb=function(){return this.m},is.prototype.getCache=is.prototype.nb,is.prototype.MAX_STORE_TIME=2592e6,is.prototype.l=function(){return od()},is.prototype.c=function(){return od()?nd():is.j.c.call(this)},is.prototype.s=function(){return this.f},is.prototype.B=function(t,e,r,i,n){return this.f.Ha(t,e,r,i,n)},is.prototype.requestInternal=is.prototype.B,is.prototype.gb=function(t){t.a&&t.a("OMV"),this.Qa(t)},is.prototype.setStyle=is.prototype.gb,is.prototype.V=function(){return is.j.Ya.apply(this)},is.prototype.getStyle=is.prototype.V,is.prototype.m=new Rk(256),is.prototype.ba=function(){return null},is.prototype.getCopyrights=is.prototype.ba,u(js,Op),t("H.service.trafficVectorTile.Service",js),js.prototype.Aa=function(){return{subDomain:"traffic.vector",path:"v2"}},js.CONFIG_KEY="trafficVectorTile",js.prototype.$b=function(t,e,r){e=e||{};var i={min:0,max:22};return Ea(r)&&yp(i,r),new sl(new is(this,t,e),i)},js.prototype.createLayer=js.prototype.$b,js.prototype.Ha=function(t,e,r,i,n){return this.B(ks(this,t,e,r),(function(t){return t.arrayBuffer().then(i,n)}),n,"arraybuffer")},js.prototype.f=function(t){return Ao()+"/"+t},js.prototype.vm=function(){return this.b},js.prototype.getLayerName=js.prototype.vm,X.prototype.oh=function(t){return this.Ma(js,t)},X.prototype.getTrafficVectorTileService=X.prototype.oh,u(ls,Op),t("H.service.SearchService",ls),ls.CONFIG_KEY="search",ls.prototype.Aa=function(){return{subDomain:"search",path:"v1"}},ls.prototype.a=function(t){return t=[t.title,t.action,t.cause].filter((function(t){return t})),Error(t.join(". "))},ls.prototype.Zg=function(t,e,r){return t=this.v().clone().Ba("geocode").G("geocode").I(t),this.B(t,e,r)},ls.prototype.geocode=ls.prototype.Zg,ls.prototype.ii=function(t,e,r){return t=this.v().clone().Ba("revgeocode").G("revgeocode").I(t),this.B(t,e,r)},ls.prototype.reverseGeocode=ls.prototype.ii,ls.prototype.sl=function(t,e,r){return t=this.v().clone().Ba("autosuggest").G("autosuggest").I(t),this.B(t,e,r)},ls.prototype.autosuggest=ls.prototype.sl,ls.prototype.zl=function(t,e,r){return t=this.v().clone().Ba("discover").G("discover").I(t),this.B(t,e,r)},ls.prototype.discover=ls.prototype.zl,ls.prototype.Gn=function(t,e,r){return t=this.v().clone().Ba("lookup").G("lookup").I(t),this.B(t,e,r)},ls.prototype.lookup=ls.prototype.Gn,ls.prototype.ul=function(t,e,r){return t=this.v().clone().Ba("browse").G("browse").I(t),this.B(t,e,r)},ls.prototype.browse=ls.prototype.ul,X.prototype.Wm=function(t){return this.Ma(ls,t)},X.prototype.getSearchService=X.prototype.Wm,u(ms,Op),t("H.service.xyz.Service",ms),ms.prototype.Aa=function(){return{host:"xyz.api.here.com",path:"hub/spaces"}},ms.prototype.a=function(t){return Error(t.errorMessage||t.message)},ms.prototype.jh=function(t,e,r){return zc(t,"String",this.jh,0,'"projectId" must be a string'),ns(this.jh,1,e,r),t=os(this.v().clone().wd("project-api/projects/"+t)),this.B(t,e,r)},ms.prototype.getProject=ms.prototype.jh,ms.prototype.Gj=function(t,e,r){return ns(this.Gj,0,t,e),r=ps(this,this.v().clone().I(r||{})),this.B(r,t,e)},ms.prototype.getSpaces=ms.prototype.Gj,ms.prototype.Kf=function(t,e,r){return zc(t,"String",this.Kf,0,'"spaceId" must be a string'),ns(this.Kf,1,e,r),t=ps(this,this.v().clone().G(t)),this.B(t,e,r)},ms.prototype.getSpace=ms.prototype.Kf,ms.prototype.Qd=function(t,e,r){return zc(t,"String",this.Qd,0,'"spaceId" must be a string'),ns(this.Qd,1,e,r),t=ps(this,this.v().clone().G(t+"/statistics")),this.B(t,e,r)},ms.prototype.getStatistics=ms.prototype.Qd,ms.prototype.Ff=function(t,e,r,i,n,o,a){return t=ps(this,this.v().clone().G(i+"/tile/web/"+r+"_"+t+"_"+e+".mvtf").I(Object.assign({clip:!0},a))),this.B(t,(function(t){return t.arrayBuffer().then(n)}),o,"arraybuffer")},ms.prototype.search=function(t,e,r,i){return zc(t,"String",this.search,0,'"spaceId" must be a string'),ns(this.search,1,e,r),t=ps(this,this.v().clone().G(t+"/search").I(i||{})),this.B(t,e,r)},ms.prototype.search=ms.prototype.search,ms.prototype.Sc=function(t,e,r,i){if(zc(t,"String",this.Sc,0,'"spaceId" must be a string'),!Ea(e))throw new D(this.Sc,1,'"params" must be an object');return ns(this.Sc,2,r,i),t=ps(this,this.v().clone().G(t+"/features").I(e)),this.B(t,r,i)},ms.prototype.getFeaturesById=ms.prototype.Sc,ms.prototype.Jd=function(t,e,r,i){if(zc(t,"String",this.Jd,0,'"spaceId" must be a string'),!Ea(e))throw new D(this.Sc,1,'"params" must be an object');return ns(this.Jd,2,r,i),t=ps(this,this.v().clone().G(t+"/bbox").I(e)),this.B(t,r,i)},ms.prototype.getFeaturesByBoundingBox=ms.prototype.Jd,ms.prototype.ba=function(t){return this.f[t]||(this.b[t]||qs(this,t),null)},ms.prototype.$c=function(t,e,r,i,n){if(zc(t,"String",this.$c,0,'"spaceId" must be a string'),!Ea(e))throw new D(this.$c,1,'"geojsonObject" must be an object');if(ns(this.$c,2,r,i),n&&!Ea(n))throw new D(this.$c,4,'"opt_params" must be an object');return rs(this,t,r,i,"PUT",e,n)},ms.prototype.putFeatures=ms.prototype.$c,ms.prototype.Yc=function(t,e,r,i,n){if(zc(t,"String",this.Yc,0,'"spaceId" must be a string'),!Ea(e))throw new D(this.Yc,1,'"featureCollection" must be an object');if(ns(this.Yc,2,r,i),n&&!Ea(n))throw new D(this.Yc,4,'"opt_params" must be an object');return rs(this,t,r,i,"POST",e,n)},ms.prototype.postFeatures=ms.prototype.Yc,ms.prototype.hd=function(t,e,r,i){if(zc(t,"String",this.hd,0,'"spaceId" must be a string'),!Ea(e))throw new D(this.hd,1,'"params" must be an object');return ns(this.hd,2,r,i),rs(this,t,r,i,"DELETE",B,e)},ms.prototype.deleteFeatures=ms.prototype.hd,ms.CONFIG_KEY="xyz";var ss=1,ts=2,us=-1;function ns(t,e,r,i){if(!Da(r))throw new D(t,e,'"onResult" must be a function');if(!Da(i))throw new D(t,e+1,'"onError" must be a function')}function vs(t,e,r){var i;if(vs.j.constructor.call(this,r?{min:r.min,max:r.max,engineType:r.engineType}:void 0),C(t,ms,vs,0),!Cc(e))throw new D(vs,1,'"spaceId" must be a string');if(this.m=t,this.f=e,this.i={},r&&(["limit","simplificationLevel","tags"].forEach((function(t){t in r&&(this.i[t]=r[t])}),this),t=r.parameters))for(i in t)this.i[i]=t[i];this.Qa(this.b===kk.WEBGL?new ti({sources:{xyz:{type:"MVT"}},layers:{xyz:{data:{source:"xyz",layer:this.f},points:{filter:{$geometry:"point"},draw:{points:{collide:!1,order:200,color:"#92CF48",size:[[10,"8px"],[14,"12px"],[18,"16px"]]}}},polygons:{filter:{$geometry:"polygon"},draw:{polygons:{order:201,color:"#E39E3C"},lines:{order:202,color:"#755DA5",width:"1px"}}},lines:{filter:{$geometry:"line"},draw:{lines:{order:203,color:"#000000",width:"2px",join:"round",cap:"round"}}}}}}):new H.map.render.harp.Style({styles:[{layer:this.f,when:["==",["geometry-type"],"Point"],technique:"circles",renderOrder:200,color:"#92CF48",size:["interpolate",["linear"],["zoom"],10,8,14,12,18,16]},{layer:this.f,when:["==",["geometry-type"],"Polygon"],technique:"fill",color:"#E39E3C",renderOrder:201},{layer:this.f,when:["==",["geometry-type"],"Polygon"],technique:"solid-line",color:"#755DA5",lineWidth:"1px",renderOrder:202},{layer:this.f,when:["==",["geometry-type"],"LineString"],technique:"solid-line",color:"#000000",lineWidth:"2px",renderOrder:203}]}))}function ws(t,e,r,i,n){1&n&&xs(t,t,e,r,i,0),2&n&&xs(t,t,e,r,i,1),4&n&&xs(t,t,e,r,i,2),8&n&&xs(t,t,e,r,i,3)}function xs(t,e,r,i,n,o){for(var a,s,l,c,u=(r+1)*(r+1),h=4*i,p=r+1,f=[{r:0,Hl:0,tl:0,Fg:0,next:null}],d=1,y=["r","g","b","a"][o],g=2*r+1;d<g;d++)f[d]={r:0,Hl:0,tl:0,Fg:0,next:null},f[d-1].next=f[d];f[2*r].next=f[0];var v=4*(i-1);for(a=0;a<n;a++){var m=a*h,_=t[m+o],b=_*p*(r+2)/2;for(g=_*p,d=0;d<=r;d++)f[d][y]=_;var w=0;for(d=1;d<=r;d++){var x=d<i?m+4*d:m+v;b+=(x=t[x+o])*(p-d),w+=x,f[r+d][y]=x}x=f[0],l=f[p],d=m,c=4*p;var E=m+v;for(_=0;_<i;_++){e[d+o]=b/u,b-=g;var T=_+p<i?d+c:E;if(b+=w+=T=t[T+o],g-=x[y],g+=l[y],w-=l[y],x[y]=T,x=x.next,l=l.next,d+=4,!b)for(;(s=4*(_+p))<h&&0===t[m+o+s];)_++,d+=4}}for(m=(n-1)*h,_=0;_<i;_++){for(b=(a=e[(t=4*_)+o])*p*(r+2)/2,g=a*p,d=0;d<=r;d++)f[d][y]=a;for(w=0,d=1;d<=r;d++)b+=(x=e[(x=d<n?t+d*h:t+m)+o])*(r-d+1),w+=x,f[r+d][y]=x;for(x=f[0],l=f[p],d=t,E=p*h,v=t+m,a=0;a<n;a++)if(e[d+o]=b/u,b-=g,b+=w+=T=e[(T=a+p<n?d+E:v)+o],g-=x[y],g+=l[y],w-=l[y],x[y]=T,x=x.next,l=l.next,d+=h,!b)for(;(s=a+p)<n&&0===e[s*h+o+t];)a++,d+=h}}function ys(t,e,r){this.f=e=t>>e,this.l=Math.log(e)*Math.LOG2E,this.i=t=document.createElement("CANVAS"),this.a=t.getContext("2d"),this.b=t.width=t.height=3*e;var i=document.createElement("canvas");t=r.a;var n,o=r.b;for(a in e=[],i.width=256,i.height=1,i=i.getContext("2d"),o)o.hasOwnProperty(a)&&e.push({stop:parseFloat(a),value:o[a]});o=e.length,e.sort(this.s),0<e[0].stop&&e.unshift({stop:0,value:e[0].value}),1>e[o-1].stop&&e.push({stop:1,value:e[o-1].value}),o=e.length;var a=i.createLinearGradient(0,0,256,0);for(n=0;n<o;n++){if(!t&&l){var s=l.stop+(e[n].stop-l.stop)/2;a.addColorStop(s,l.value),a.addColorStop(s,e[n].value)}a.addColorStop(e[n].stop,e[n].value);var l=e[n]}i.fillStyle=a,i.fillRect(0,0,256,1),this.c=i.getImageData(0,0,256,1).data,this.g=r.a}function zs(t,e){this.a=t,this.size=e}function As(t,e){var r,i=0;if(!Ea(t)||Va(t))throw new D(As,0,t);for(r in t){var n=+r;if(i++,!(Fc(n)&&0<=n&&1>=n&&Cc(t[r])))throw new D(As,0,t)}if(2>i)throw new D(As,0,"Specify at least 2 stops");this.b=t,this.a=!!e}X.prototype.jn=function(t){return this.Ma(ms,t)},X.prototype.getXYZService=X.prototype.jn,u(vs,S),t("H.service.xyz.Provider",vs),vs.prototype.B=function(t,e,r,i,n){return this.m.Ff(t,e,r,this.f,i,n,this.i)},vs.prototype.requestInternal=vs.prototype.B,vs.prototype.ba=function(){return this.m.ba(this.f)},vs.prototype.getCopyrights=vs.prototype.ba,vs.prototype.Sb=ff,vs.prototype.providesOMV=vs.prototype.Sb,vs.prototype.V=function(){return this.Ya()},vs.prototype.getStyle=vs.prototype.V,vs.prototype.gb=function(t){C(t,ti)&&t.a("MVT"),this.Qa(t)},vs.prototype.setStyle=vs.prototype.gb,t("H.service.buildInfo",(function(){return Hf("H-service","1.51.0","a104c13",{region:"row"})})),ys.prototype.s=function(t,e){return t.stop-e.stop},t("H.data.heatmap.Colors",As);var Bs=new As({0:"#008",.2:"#0b0",.5:"#ff0",.7:"#f00"},!0);function Cs(t,e,r){this.a=t=ae(t,0,30),this.u=e,this.i=r,this.s=[],this.b=[];do{this.b[t]=[],this.s[t]=new Ds}while(t--);e===Es?(this.m=Fs,this.l=Gs):(this.m=Hs,this.l=Is),this.c=1/0,this.f=-1/0}As.DEFAULT=Bs;var Js=Math.log(.5);function Gs(t){return this.g?Math.round((t-this.c)/this.g*255):127}function Is(t){return void 0===this.U?127:Math.round(255*Math.pow(t,this.U))}function Ks(t,e,r,i,n){var o,a,s=1<<e;return i=$d(i,s),!(s=0<=r&&r<s&&(o=t.b[e])&&(a=o[r])&&(s=a[i])||null)&&n&&0<=e&&(s=Ks(t,e-1,r>>1,i>>1,n)),s}function Ls(t,e,r,i,n,o){for(var a,s=[];r<=i;r++)for(a=n;a<=o;a++)s.push(Ks(t,e,r,a,!1));return s}function Ms(t,e){var r,i=0,n=0,o=Ks(t,0,0,0,!1);return e.f||(e.z===t.a?e.c=e.a:(Ns(t,e,(function(e){var a=Os(t,e),s=4-a.length;if(e.z!==t.a){for(r=0;r<a.length;r++)i+=a[r].a,n++;i+=s*o.a,n+=s}})),e.c=i/n),e.f=!0),e.c}function Ns(t,e,r){e=[e];for(var i,n;0<e.length;)i=Os(t,n=e.shift()),r(n),e.push.apply(e,i)}function Os(t,e){var r,i,n,o=[];for(i=0;1>=i;i++)for(n=0;1>=n;n++)(r=Ks(t,e.z+1,2*e.x+i,2*e.y+n,!1))&&o.push(r);return o}function Hs(t,e,r){this.x=t,this.y=e,this.z=r,this.a=this.b=this.g=0,this.f=!1,this.c=0}function Fs(t,e,r){this.x=t,this.y=e,this.z=r,this.a=this.b=this.g=0,this.f=!1,this.c=0}function Ds(){this.f=this.c=1/0,this.a=this.b=-1/0}function Ps(t){var e=t||{},r=+e.sampleDepth,i=e.pointSize;t=+e.coarseness;var n=e.colors,o={min:e.min,max:e.max,engineType:e.engineType},a=e.tileSize,s=+e.dataMax;if(e.tileSize&&(o.tileSize=a),S.call(this,o),lk(this,e.opacity),this.i="value"===e.type?Es:Qs,this.sampleDepth_=Fc(r)?ae(Math.round(r),1,8):4,this.L=this.i===Qs?Fc(i)?ae(Math.round(7-i),0,6):2:1,this.D=!!e.assumeValues,e=this.max,this.T=Fc(s)?ae(Math.round(s),this.min,e+this.sampleDepth_):e,t=Fc(t)?ae(Math.round(t),0,3):1,n&&!C(n,As))throw new D(Ps,0,"colors");this.f=new Cs(e+this.sampleDepth_+this.L,this.i,this.T),this.aa=new ys(this.tileSize,t,n||Bs),this.u=A(this.u,this),this.m=A(this.m,this),this.R=new Mk(20,this.u)}function Rs(t,e,r,i){var n=document.createElement("canvas"),o=t.tileSize,a=n.getContext("2d");n.width=n.height=o;var s,l,c=t.aa,u=t.f,h=t.D,p=t.i,f=t.L,d=c.f,y=c.a,g=p===Qs?void 0===f?2:f:1;f=g,t=Math.min(t.sampleDepth_+g,c.l),g=c.b;var v=u.a;if(h&&p===Es){for(l=-1;1>=l;l++)for(h=-1;1>=h;h++){var m=(m=Ks(u,i,r+l,e+h,!0))?u.l(Ms(u,m)):128;y.fillStyle="rgba("+m+",128,0,1)",y.fillRect((h+1)*d,(l+1)*d,d,d)}h=d-Math.floor(d/10),l=3,ws((m=y.getImageData(0,0,g,g)).data,h,g,g,l),y.putImageData(m,0,0)}else y.fillStyle=h?"#080":"#000",y.fillRect(0,0,g,g);for(;f<=t&&i+f<=v;f++){l=d-(h=d>>f);var _=p===Qs?127+Math.floor(128/(1<<t-f)):255;m=2+(1<<f);var b=1<<f,w=e<<f,x=r<<f;for(w=(b=Ls(u,i+f,x-1,x+b,w-1,w+b)).length;w--;){x=w%m;var E=w/m<<0;(s=b[w])&&(s=u.l(s.a),y.fillStyle="rgba("+s+","+_+",0,1)",y.fillRect(x*h+l,E*h+l,h,h))}m=y,_=h,b=l,w=d+2*h,h=d+2*h,x=x=3,ws((E=y.getImageData(b,l,w,h)).data,_,w,h,x),m.putImageData(E,b,l)}for(e=y.getImageData(0,0,g,g),r=c.c,i=c.g,t=0,g=(u=e.data).length;t<g;t+=4)p=u[t],f=u[t+1],4===r.length&&(p=0),u[t]=r[4*p],u[t+1]=r[4*p+1],u[t+2]=r[4*p+2],u[t+3]=r[4*p+3]*(i?f/255:10>f?0:1);return y.putImageData(e,0,0),d=(c=new zs(c.i,d)).size,a.drawImage(c.a,d,d,d,d,0,0,o,o),n}Cs.prototype.Db=function(t){var e,r,i=t.value;void 0===i&&(i=1),i>this.f&&(this.f=i,this.g=this.f-this.c),i<this.c&&(this.c=i,this.g=this.f-this.c);var n=mj.Pc(t).scale(1073741823).floor();i=this.a;var o=n.x>>30-i;for(n=n.y>>30-i,r=this.m;-1<i;){this.b[i][n]||(this.b[i][n]=[]),(e=this.b[i][n][o])||(e=this.b[i][n][o]=new r(o,n,i)),e.Db(t,i);var a=this.s[i];a.f>e.b&&(a.f=e.b),a.a<e.b&&(a.a=e.b),a.c>e.a&&(a.c=e.a),a.b<e.a&&(a.b=e.a),i--,o>>=1,n>>=1}},Cs.prototype.clear=function(){Cs.call(this,this.a,this.u,this.i)},Hs.prototype.Db=function(t,e){this.g++,this.b+=t.value||1,this.a=this.b/Math.pow(2,2*(30-e))},Fs.prototype.Db=function(t){t=t.value,this.b+=void 0!==t?t:1,this.a=this.b/++this.g,this.f=!1},u(Ps,S),t("H.data.heatmap.Provider",Ps),Ps.prototype.ic=function(t){lk(this,t)},Ps.prototype.setOpacity=Ps.prototype.ic,Ps.prototype.Tc=function(){return this.g},Ps.prototype.getOpacity=Ps.prototype.Tc,Ps.prototype.Ve=ff,Ps.prototype.providesRasters=Ps.prototype.Ve,Ps.prototype.B=function(t,e,r,i,n){var o,a,s=this.D;if(Ks(this.f,0,0,0,!1)){if(!s){var l=Ls(this.f,r,e-1,e+1,t-1,t+1);for(o=l.length;o--&&!s;)if(null!==l[o]){s=!0;break}}s&&(a=this.R.push([t,e,r,i,n],this.m))}return s||i(null),a||Hl},Ps.prototype.requestInternal=Ps.prototype.B,Ps.prototype.u=function(t,e){t.done(Rs(this,e[0],e[1],e[2]))},Ps.prototype.m=function(t,e,r){var i=t.data;t=i[3],i=i[4],r?i():t(e)},Ps.prototype.Zi=function(t,e){var r;if(!Bc(t))throw new D(this.Zi,0,t);if(r=t.length){for(;r--;)this.f.Db(t[r]);var i;r=(t=this.f).s;var n=t.a,o=0;if(t.u===Qs){var a=r[t.a].a;for(i=t.a;0<=i&&r[i].a===a;i--)o=i;for(a=r[0].a,i=0;i<=o&&a===r[i].a;i++)n=i;o>t.i&&(o=t.i),a=Math.round(n+(o-n)/2),t.U=Js/Math.log(r[a].b)}this.reload(!!e)}},Ps.prototype.addData=Ps.prototype.Zi,Ps.prototype.clear=function(){this.f.clear(),this.reload(!0)},Ps.prototype.clear=Ps.prototype.clear;var Qs=0,Es=1;function Ss(){}function Ts(t){for(var e,r=(t=t.attributes).length;r--;)switch(e=t[r],e.name){case"x":this.x=parseFloat(e.value);break;case"y":this.y=parseFloat(e.value);break;case"xunits":this.Vc="fraction"===Ss.prototype.Na(e);break;case"yunits":this.zc="fraction"===Ss.prototype.Na(e)}}function Us(t){var e=t.childNodes,r=new Ss;for(t=e.length;t--;){var i=e[t];"href"===i.nodeName&&(this.href=r.Na(i))}}function Vs(t){var e;if(t){var r=(t=t.childNodes).length;for(e=new Ss;r--;){var i=t[r];switch(i.nodeName){case"scale":this.scale=e.Gf(i);break;case"Icon":this.icon=i=new Us(i);break;case"hotSpot":this.a=i=new Ts(i)}}}}function Ws(){this.a={4:function(t){return["#",t.charAt(1),t.charAt(1),t.charAt(2),t.charAt(2),t.charAt(3),t.charAt(3),"ff"].join("")},5:function(t){return["#",t.charAt(1),t.charAt(1),t.charAt(2),t.charAt(2),t.charAt(3),t.charAt(3),t.charAt(4),t.charAt(4)].join("")},7:function(t){return t+"ff"},9:function(t){return t}},this.b={4:function(t){return[Xs(t.charAt(1)),Xs(t.charAt(2)),Xs(t.charAt(3)),255]},5:function(t){return[Xs(t.charAt(1)),Xs(t.charAt(2)),Xs(t.charAt(3)),Xs(t.charAt(4))]},7:function(t){return[(t=parseInt(t.substring(1),16))>>16&255,t>>8&255,255&t,255]},9:function(t){return[(t=parseInt(t.substring(1),16))>>24&255,t>>16&255,t>>8&255,255&t]}}}function Xs(t){return((t=parseInt(t,16))<<4)+t}function Ys(t){return 16>t?"0"+Math.round(t).toString(16):Math.round(t).toString(16)}function Zs(t,e,r){return/^(#|rgb).*/.test(e)?(r||(r="","#"===e.charAt(0)?r=t.a[e.length]?e:"":"rgb"===e.substr(0,3)&&(r=2<(r=(e=e.match(/\d+(\.\d+)?/g)).length)&&5>r?["#",Ys(+e[0]),Ys(+e[1]),Ys(+e[2]),3<r?Ys(255*+e[3]):"ff"].join(""):""),e=r),(t=t.b[e.length](e))[3]=Math.round(t[3]/255*100)/100,t):[0,0,0,255]}function $s(t){for(var e,r=(t=t.childNodes).length,i=new Ss,n=new Ws;r--;)switch(e=t[r],e.nodeName){case"color":this.a=i.Ef(e);break;case"colorMode":this.b=i.Na(e)}"random"===this.b&&(this.a="#"+n.el(this.a,!1))}function at(t){var e=t.childNodes,r=e.length,i=new Ss;for(this.a=this.fill=!0,this.b=new $s(t);r--;)switch(t=e[r],t.nodeName){case"fill":this.fill=i.Hd(t);break;case"outline":this.a=i.Hd(t)}}function bt(t){var e=t.childNodes,r=e.length,i=new Ss;for(this.a=new $s(t);r--;)"width"===(t=e[r]).nodeName&&(this.width=i.Gf(t))}function ct(t){for(var e,r=(t=t.childNodes).length,i=new Ss;r--;)switch(e=t[r],e.nodeName){case"bgColor":this.bgColor=i.Ef(e);break;case"textColor":this.textColor=i.Ef(e);break;case"text":this.text=i.Na(e);break;case"displayMode":this.displayMode=i.Na(e)}}function dt(t){var e=t.childNodes,r=e.length;for(this.id=t.getAttribute("id");r--;)switch(t=e[r],t.nodeName){case"IconStyle":this.Oj=t=new Vs(t);break;case"LineStyle":this.Wd=t=new bt(t);break;case"PolyStyle":this.yk=t=new at(t);break;case"BalloonStyle":this.pf=t=new ct(t)}}function et(t,e){var r=(t=t.childNodes).length,i=new Ss;for(this.b=e;r--;)switch(e=t[r],e.nodeName){case"key":this.key=i.Na(e);break;case"styleUrl":this.a=i.Na(e)}}function ft(t,e){var r=t.childNodes,i=r.length;for(this.b=e,this.id=t.getAttribute("id"),this.a=[];i--;)"Pair"===(t=r[i]).nodeName&&(t=new et(t,this.b),this.a.push(t))}function gt(){this.a={}}function ht(t){for(var e,r=(t=t.childNodes).length,i=null,n=new Ss;r--;)"coordinates"===(e=t[r]).nodeName&&(i=n.Na(e));this.a=null,i&&(this.a=n.$h(i)||null)}function it(t,e){var r=t&&t.childNodes||[],i=new Ss;if(!t||!e)throw Error("Node or stylesContainer is not defined");for(this.visibility=!0,this.f=t,t=r.length;t--;){var n=r[t];switch(n.nodeName){case"name":this.name=i.Na(n);break;case"description":this.description=i.Na(n);break;case"visibility":this.visibility=i.Hd(n);break;case"open":this.open=i.Hd(n);break;case"styleUrl":(this.b=i.Na(n))&&(n=this.b.substr(1),this.c=e.mh(n,!1));break;case"Style":this.a=n=new dt(n)}}}function jt(t){for(var e,r=(t=t.childNodes).length,i=new Ss;r--;)if("coordinates"===(e=t[r]).nodeName){var n=[],o=new Ss;try{n=o.vk(i.Na(e))}catch(t){n=[]}this.a=2>n.length?[]:n}}function kt(t){for(var e=new L,r=t.a?t.a.length:0;r--;)e.qd(t.a[r]);return e}function lt(){}function mt(t){var e=t.childNodes,r=e.length;for(this.a=new L,this.c=[];r--;){var i=e[r],n=i.nodeName;if("outerBoundaryIs"===n||"innerBoundaryIs"===n){var o=i.childNodes;for(i=o.length;i--;){var a=o[i];if("LinearRing"===a.nodeName){var s=new jt(a);if("outerBoundaryIs"===n){this.a=kt(s);var l=void 0,c=t,u=s.a;s=new Ss;var h=c.querySelector("altitudeMode");if(h&&h.parentNode===c&&!/^\s*clampTo/.test(s.Na(h))&&u){h=u.length;for(var p=0;p<h&&0!==l;p++){var f=u[p].alt;f?l?f!==l&&(l=0):l=f:l=0}(u=c.querySelector("*|altitudeOffset"))&&u.parentNode===a&&"http://www.google.com/kml/ext/2.2"===u.namespaceURI&&(a=s.Gf(u))&&(l+=a),l&&(l=yd(2047,l),(a=c.querySelector("extrude"))&&a.parentNode===c&&s.Hd(a)?this.b=l:this.f=l)}}else this.c.push(kt(s))}}}}}function nt(t,e){var r=document.createElement("CANVAS");r.width=1,r.height=1,this.g=t,this.b={},this.c={},this.f=new Wj(r),this.Yb=e||""}function ot(t,e,r){for(var i,n,o=(e=e.childNodes).length,a={};o--;){var s=e[o];switch(s.nodeName){case"Point":s=new ht(s),n=pt(t,"Marker"),(s=s.a)&&(i=new Rn(s,n),n.ai&&Fe(n.ai,"statechange",A(t.i,t,n.ai,i,n),!1));break;case"LineString":case"LinearRing":s=new jt(s),n=pt(t,"Polyline"),i=new th(kt(s),n);break;case"Polygon":s=new mt(s),(n=pt(t,"Polygon")).elevation=s.f,n.extrusion=s.b,i=new uh(new O(s.a,s.c),n);break;case"MultiGeometry":i=ot(t,s,new R)}i&&(t.a.name&&(a.name=t.a.name),t.a.description&&(a.description=t.a.description),n&&n.pf&&(a.balloonStyle=n.pf),a.kmlNode=t.a.f,i.setData(a),r&&r.fa(i))}return r||i}function pt(t,e){var r=t.a,i={visibility:r.visibility},n=new Ws,o=1,a={x:0,y:0,Vc:!1,zc:!1},s=qt(t,r.c);switch(r.a&&(s=qt(t,r.a,s)),e){case"Marker":if(s&&s.Oj){if((n=s.Oj).scale&&(o=n.scale),n.a){var l=n.a;a={x:l.x,y:l.y,Vc:l.Vc,zc:l.zc}}n.icon&&n.icon.href?(e=n.icon.href,rt.test(e)||(e=t.Yb+e),n=o+"_"+a.x+a.y+a.Vc+a.zc+"_"+e,(l=t.b[n]||t.c[n])||(l=new Wj(e),t.c[n]=l),0===l.getState()?(i.icon=t.f,i.ai=l,i.href=e,i.anchor=a,i.scale=o):1===l.getState()&&(i.icon=l)):1!==o&&(l||(a={x:14,y:4,Vc:!1,zc:!1}),o={size:new Wi((t={w:28*o,h:36*o}).w,t.h),anchor:new J(a.Vc?t.w*a.x:a.x*o,a.zc?t.h*(1-a.y):t.h-a.y*o),hitArea:new Xi(Yi.POLYGON,[0*o,16*o,0*o,7*o,8*o,0*o,18*o,0*o,26*o,7*o,26*o,16*o,18*o,34*o,8*o,34*o])},i.icon=new Wj('<svg xmlns="http://www.w3.org/2000/svg" width="28px" height="36px"><path d="M 19 31 C 19 32.7 16.3 34 13 34 C 9.7 34 7 32.7 7 31 C 7 29.3 9.7 28 13 28 C 16.3 28 19 29.3 19 31 Z" fill="#000" fill-opacity=".2"/><path d="M 13 0 C 9.5 0 6.3 1.3 3.8 3.8 C 1.4 7.8 0 9.4 0 12.8 C 0 16.3 1.4 19.5 3.8 21.9 L 13 31 L 22.2 21.9 C 24.6 19.5 25.9 16.3 25.9 12.8 C 25.9 9.4 24.6 6.1 22.1 3.8 C 19.7 1.3 16.5 0 13 0 Z" fill="#fff"/><path d="M 13 2.2 C 6 2.2 2.3 7.2 2.1 12.8 C 2.1 16.1 3.1 18.4 5.2 20.5 L 13 28.2 L 20.8 20.5 C 22.9 18.4 23.8 16.2 23.8 12.8 C 23.6 7.07 20 2.2 13 2.2 Z" fill="#18d"/></svg>',o))}break;case"Polyline":i.style={},s&&s.Wd&&(o=s.Wd,i.style.strokeColor="rgba("+Zs(n,o.a.a,!0)+")",0<=o.width&&(i.style.lineWidth=o.width));break;case"Polygon":i.style={},s&&(s.Wd&&(o=s.Wd,i.style.strokeColor="rgba("+Zs(n,o.a.a,!0)+")",0<=o.width&&(i.style.lineWidth=o.width)),s.yk&&(o=s.yk,i.style.fillColor=o.fill?"rgba("+Zs(n,o.b.a,!0)+")":"rgba(0,0,0,0)",o.a||(i.style.lineWidth=0)))}return i.pf=s.pf,i}function qt(t,e,r){for(var i in r=r||{},e)e.hasOwnProperty(i)&&(r[i]="object"==typeof e[i]?qt(t,e[i],r[i]):e[i]);return r}t("H.data.utils.Dom",Ss),Ss.prototype.Hd=function(t){return!!t&&/^\s*(1|true)\s*$/i.test(this.Na(t))},Ss.prototype.getBoolean=Ss.prototype.Hd,Ss.prototype.Na=function(t){var e;try{if(t.nodeType===Node.ATTRIBUTE_NODE)return t.value;var r="",i=0,n=t.childNodes;for(e=n.length;i<e;i++)n[i].nodeType!==Node.COMMENT_NODE&&(r+=n[i].nodeValue.replace(/^\s+|\s+$/g,""))}catch(t){}return r||""},Ss.prototype.getString=Ss.prototype.Na,Ss.prototype.Gf=function(t){return parseFloat(this.Na(t))||0},Ss.prototype.getFloat=Ss.prototype.Gf,Ss.prototype.vk=function(t){var e,r=t.split(/\s+/),i=r.length,n=!(r&&1==i),o=n?1:3,a=[];for(n||(i=(r=t.split(",")).length),e=0;e<i;e+=o){if(!(t=this.$h(n?r[e]:e+3>r.length?null:r.slice(e,e+3))))return[];a.push(t)}return a},Ss.prototype.parseCoords=Ss.prototype.vk,Ss.prototype.$h=function(t){if(!t)return null;var e=t instanceof Array&&0<t.length&&4>t.length?t:t.split(",");t=parseFloat(e[0]);var r=parseFloat(e[1]);return e=parseFloat(e[2]),isNaN(r)||isNaN(t)?null:new kg(r,t,isNaN(e)?void 0:e)},Ss.prototype.parseCoord=Ss.prototype.$h,Ss.prototype.Ef=function(t){return t=this.Na(t),/^[0-9a-fA-F]{8}$/.test(t)?"#"+t.substr(6,2)+t.substr(4,2)+t.substr(2,2)+t.substr(0,2):"#000000ff"},Ss.prototype.getColor=Ss.prototype.Ef,t("H.data.kml.HotSpot",Ts),t("H.data.kml.Icon",Us),t("H.data.kml.IconStyle",Vs),t("H.data.utils.ColorHelper",Ws),Ws.prototype.el=function(t,e){var r="";if(!/^(#|rgb).*/.test(t)){var i;for(r="",i=0;6>i;i++)r+="ABCDEF0123456789".charAt(Math.floor(16*Math.random()));return r+"ff"}for(t=Zs(this,t,e),e=0;4>e;e++)r+=Ys(i=3>e?Math.floor(Math.random()*(t[e]+1)):255*t[e]);return r},Ws.prototype.toRandomRGBA=Ws.prototype.el,t("H.data.kml.ColorStyle",$s),t("H.data.kml.PolyStyle",at),t("H.data.kml.LineStyle",bt),t("H.data.kml.BalloonStyle",ct),t("H.data.kml.Style",dt),t("H.data.kml.Pair",et),et.prototype.V=function(){if(this.a){var t="highlight"===this.key;t=this.b.mh(this.a.substr(1),t)}return t},et.prototype.getStyle=et.prototype.V,t("H.data.kml.StyleMap",ft),ft.prototype.V=function(t){var e=null;t=t?"highlight":"normal";for(var r=this.a.length;r--;)this.a[r].key===t&&(e=this.a[r].V());return e},ft.prototype.getStyle=ft.prototype.V,t("H.data.kml.StyleContainer",gt),gt.prototype.Ig=function(t){t&&t.id&&(this.a["style_"+t.id]=t)},gt.prototype.addStyle=gt.prototype.Ig,gt.prototype.mh=function(t,e){return(t=this.a["style_"+t])instanceof ft&&(t=t.V(e)),t},gt.prototype.getStyleById=gt.prototype.mh,t("H.data.kml.Point",ht),t("H.data.kml.Feature",it),t("H.data.kml.Line",jt),lt.prototype.f=0,lt.prototype.b=0,u(mt,lt),t("H.data.kml.Polygon",mt),nt.prototype.create=function(t){return this.a=new it(t,this.g),ot(this,t)},nt.prototype.i=function(t,e,r){var i=r.anchor,n=r.scale;r=n+"_"+i.x+i.y+i.Vc+i.zc+"_"+r.href;var o={};if(1===t.getState()){var a=this.b[r];if(!a){var s=i.x,l=i.y;(a=t.yb())&&(a={w:a.w*n,h:a.h*n},o.size=a),s=i.Vc&&a?a.w*s:s*n,l=i.zc&&a?a.h*(1-l):!i.zc&&a?a.h-l*n:l*n,o.anchor={x:s,y:l},a=new Wj(t.Qc(),o),this.b[r]=a}e.Ic(a)}delete this.c[r]};var rt=/^[^:\/]+:/;function st(t){xc(this,st),this.url=t,this.b=[],this.a=z,this.c=A(this.c,this),F.call(this)}u(st,F),t("H.data.AbstractReader",st);var tt={ERROR:-1,LOADING:0,VISIT:1,READY:2};function ut(t,e,r,i){ut.j.constructor.call(this,e,t),this.state=r,this.message=i}function vt(t){var e=t?t.lastIndexOf("/"):-1;this.g=[],st.call(this,t),0<=e&&(this.i=t.substr(0,e)+"/")}function xt(t,e,r){r?r.fa(e):(t.a&&t.a.bc().fa(e),t.b.push(e),t.O(tt.VISIT,e))}function wt(t,e){for(var r,i=t.length,n=[];i--;)(r=t[i]).nodeName===e&&n.push(r);return n}function yt(t,e){this.b=t,this.a=e}function zt(t){return new kg(t[1],t[0])}function Bt(t){for(var e,r=At(t[0]),i=[],n=1,o=t.length;n<o;n++)e=At(t[n]),i.push(e);return new O(r,i)}function At(t){for(var e=0,r=t.length,i=new L;e<r;e++)i.qd(zt(t[e]));return i}function Ct(t,e){e=e||{},this.i=e.style||this.Fd,(this.g=!!e.disableLegacyMode)||window.console.warn("H.data.geojson.Reader: Legacy parser is enabled in GeoJSON Reader. Features like Multi-Geometries, Polygon interiors and GeoJSON feature properties might not work as expected. To maximise compatibility with the remote services it is recommended to set the `disableLegacyMode` flag to true."),st.call(this,t)}function Et(t){var e={};if(t.geometry){var r=t.geometry;e.type=r.type,e.properties=t.properties,r.coordinates&&(e.coordinates=r.coordinates),r.geometries&&(e.geometries=r.geometries),t.id&&(e.id=t.id)}return e}function Dt(t,e){t.a&&t.a.bc().fa(e),t.b.push(e),t.O(tt.VISIT,e)}function Ft(t,e){this.a=t,this.b=e}function Gt(t,e,r){this.g=this.b=r,this.bi=[],this.a=0,this.f=sg(t,e,!0)}function Ht(t){var e;qd.call(this),this.a=[],t?Ya(e={},It,t):e=It,this.g=e,qd.call(this)}st.State=tt,st.prototype.f=tt.READY,st.prototype.A={ml:"statechange"},st.prototype.ob=function(){return this.a||(this.a=new N,this.a.bc().Xb(this.b)),new tl(this.a)},st.prototype.getLayer=st.prototype.ob,st.prototype.Gm=function(){return this.b.concat([])},st.prototype.getParsedObjects=st.prototype.Gm,st.prototype.v=function(){return this.url},st.prototype.getUrl=st.prototype.v,st.prototype.Co=function(t){if(this.f===tt.LOADING||this.f===tt.VISIT)throw Error("InvalidState: state "+this.f);return this.b=[],this.a=z,this.url=t,this},st.prototype.setUrl=st.prototype.Co,st.prototype.getState=function(){return this.f},st.prototype.getState=st.prototype.getState,st.prototype.O=function(t,e,r){this.f=t,this.dispatchEvent(new ut(e||this,this.A.ml,t,r||""))},st.prototype.parse=function(){var t=this;vc(this.url)?(this.O(tt.LOADING),new tf("text/plain",this.url).then((function(e){try{t.c(e)}catch(e){t.O(tt.ERROR,z,e.message)}}),(function(){t.O(tt.ERROR,z,"Error loading file")}))):t.O(tt.ERROR,z,"File url was not set")},st.prototype.parse=st.prototype.parse,u(ut,ud),st.Event=ut,u(vt,st),t("H.data.kml.Reader",vt),vt.prototype.c=function(t){var e,r=null;if(Cc(t)&&""!=t.trim()){try{var i=(new DOMParser).parseFromString(t,"text/xml")}catch(t){return void this.O(tt.ERROR,z,"Error parsing KML document")}if(i.getElementsByTagName("parsererror").length)this.O(tt.ERROR,z,"Error parsing KML document");else if((t=i.childNodes&&"kml"===i.childNodes[0].nodeName?i.childNodes[0]:void 0)&&(e=wt(t.childNodes,"Document")[0]),e=e||t){i=new gt;for(var n=wt(e.childNodes,"Style"),o=wt(e.childNodes,"StyleMap"),a=n.length;a--;)t=new dt(n[a]),i.Ig(t);for(a=o.length;a--;)t=new ft(o[a],i),i.Ig(t);for(this.l=new nt(i,this.i),e=(t=e.childNodes).length;e--;)i=r,"Placemark"===(n=t[e]).nodeName?(n=this.l.create(n))&&xt(this,n,i):"Folder"===n.nodeName&&(xt(this,(n={group:new R,node:n}).group,i),this.g.push(n)),!e&&(i=this.g.shift())&&(t=i.node.childNodes,r=i.group,e=t.length);this.O(tt.READY)}else this.O(tt.ERROR,z,"Invalid KML document")}else this.O(tt.ERROR,z,"Unable to create objects from the empty data")},yt.prototype.create=function(t,e){var r=t.coordinates;switch(t.type){case"Point":var i=new Rn(zt(r));break;case"LineString":i=new th(At(r));break;case"Polygon":i=new uh(Bt(r));break;case"MultiPoint":var n=0,o=r.length;if(i=[],this.a){for(;n<o;n++)i.push(zt(r[n]));r=new Rn(new Vi(i))}else{for(;n<o;n++)i.push(new Rn(zt(r[n])));(r=new R).Xb(i)}i=r,o="multiPoint";break;case"MultiLineString":if(n=0,o=r.length,i=[],this.a){for(;n<o;n++)i.push(At(r[n]));r=new th(new ih(i))}else{for(;n<o;n++)i.push(new th(At(r[n])));(r=new R).Xb(i)}i=r,o="multiLineString";break;case"MultiPolygon":if(i=[],n=0,o=r.length,this.a){for(;n<o;n++)i.push(Bt(r[n]));r=new uh(new Ji(i))}else{for(;n<o;n++)i.push(new uh(Bt(r[n])));(r=new R).Xb(i)}i=r,o="multiPolygon";break;case"GeometryCollection":r=i=new R,o=0;for(var a=(n=t.geometries).length;o<a;o++)this.create(n[o],r);o="geometryCollection"}return i&&(r=i,n=t.properties,t=t.id,a={},n&&(this.a?a=n:a.properties=n),o&&!this.a&&(a[o]=!0),t&&r.Ai(t),r.setData(a),this.b(i)),e&&i&&e.fa(i),i},yt.prototype.create=yt.prototype.create,u(Ct,st),t("H.data.geojson.Reader",Ct),Ct.prototype.c=function(t){var e,r;try{var i="string"==typeof t?JSON.parse(t):t;if("object"==typeof i){var n=new yt(this.i,this.g);switch(i.type){case"FeatureCollection":if(e=i.features){var o=new R;for(Dt(this,o),r=0;r<e.length;r++){var a=Et(e[r]);(a=n.create(a))&&o.fa(a)}}break;case"Feature":a=Et(i),(a=n.create(a))&&Dt(this,a);break;default:(a=n.create(i))&&Dt(this,a)}this.O(tt.READY)}else this.O(tt.ERROR,z,"Invalid syntax")}catch(t){this.O(tt.ERROR,z,"Parse error. "+t.message)}},Ct.prototype.io=function(t){this.O(tt.LOADING),this.c(t)},Ct.prototype.parseData=Ct.prototype.io,Ct.prototype.Fd=function(){},t("H.data.buildInfo",(function(){return Hf("H-data","1.51.0","a104c13",{region:"row"})})),wg.prototype.Lc=ca(1,(function(t,e){this.a.Lc(t,Fc(e)?e:this.c)})),Ag.prototype.Lc=ca(0,(function(t,e){var r,i=0;if(!t(this)&&e--)for(;3>=i;i++)(r=this[i])&&r.Lc(t,e)})),t("H.clustering.grid.NoisePoint",Ft),Ft.prototype.ya=function(){return ng(this.a)},Ft.prototype.getPosition=Ft.prototype.ya,Ft.prototype.xc=function(){return this.a.wt},Ft.prototype.getWeight=Ft.prototype.xc,Ft.prototype.od=gf,Ft.prototype.isCluster=Ft.prototype.od,Ft.prototype.sc=function(){return this.b},Ft.prototype.getMinZoom=Ft.prototype.sc,Ft.prototype.getData=function(){return this.a.data},Ft.prototype.getData=Ft.prototype.getData,t("H.clustering.grid.Cluster",Gt),Gt.prototype.ne=function(t){this.c||(this.c=ng(t)),this.a+=t.wt||1,this.bi.push(t)},Gt.prototype.ya=function(){return this.c},Gt.prototype.getPosition=Gt.prototype.ya,Gt.prototype.xc=function(){return this.a},Gt.prototype.getWeight=Gt.prototype.xc,Gt.prototype.od=ff,Gt.prototype.isCluster=Gt.prototype.od,Gt.prototype.sc=function(){return this.b},Gt.prototype.getMinZoom=Gt.prototype.sc,Gt.prototype.If=function(){return this.g},Gt.prototype.getMaxZoom=Gt.prototype.If,Gt.prototype.K=function(){return this.f},Gt.prototype.getBoundingBox=Gt.prototype.K,Gt.prototype.Yg=function(t){this.ze(t)},Gt.prototype.forEachEntry=Gt.prototype.Yg,Gt.prototype.ze=function(t){var e=this;if(!Da(t))throw new D(this.ze,0,t);this.bi.forEach((function(r){t(new Ft(r,e.b+1))}))},Gt.prototype.forEachDataPoint=Gt.prototype.ze,u(Ht,qd);var Jt={clusters:[],noisePoints:[]},It={projection:mj,min:0,max:22,eps:32,minWeight:2};function Kt(t){Ht.call(this,t)}function Lt(t){this.a=t;var e=(t=document.createElement("canvas")).getContext("2d"),r=this.a,i=14*r;t.width=i,t.height=i,e.scale(r,r),e.beginPath(),e.strokeStyle="#FFFFFF",e.fillStyle="#1080DD",e.arc(7,7,6,0,2*Math.PI,!1),e.fill(),e.lineWidth=1,e.stroke(),this.f=new Wj(t,{size:{w:14,h:14},anchor:{x:7,y:7}}),this.b={},this.c={}}function Mt(t,e,r){var i,n=document.createElement("canvas"),o=n.getContext("2d"),a=t.a,s=e*a;return n.width=s,n.height=s,o.scale(a,a),a=e+":"+r,(i=t.b[a])?o.putImageData(i,0,0):(e/=2,o.beginPath(),o.strokeStyle="rgba("+r+",0.2)",o.fillStyle="rgba("+r+",1)",o.arc(e,e,e/5*3,0,2*Math.PI,!1),o.fill(),o.lineWidth=e/5*4,o.stroke(),t.b[a]=o.getImageData(0,0,s,s)),n}function Nt(t){if(Ht.call(this,t),(t=this.g).projection!==mj)throw new D(Nt,0,"Other projection than mercator not supported yet");this.s=t.projection,this.f=t.eps,this.D=t.minWeight,this.m=new nj(this.s),(new Pf).a("cluster","H.clustering.dynamicgrid.worker"),this.i=A(this.i,this),this.l=A(this.l,this)}p=Ht.prototype,p.Hc=function(t){this.a=t,this.b=!0},p.Db=function(t){this.a.push(t),this.b=!0},p.mf=function(t){this.a=this.a.concat(t),this.b=!0},p.We=function(t){this.a=this.a.filter((function(e){return e!==t})),this.b=!0},p.o=function(){Ht.j.o.call(this),delete this.a},Ht.prototype.disposeInternal=Ht.prototype.o,Ht.prototype.U=ld,u(Kt,Ht),Kt.prototype.Ei=function(t){var e,r=this.g,i=r.min,n=r.max,o=[],a=[];if(this.b){for(e=this.a;i<=n;i++){for(var s,l,c,u,h,p,f,d,y=void 0,g=i,v=e,m=o,_=a,b=r.eps,w=r.projection,x=r.minWeight,E=v.length,T=Math.pow(2,g+8),A=[];d=v[--E];)if(!d.Ki){for(f=T,p=(c=w.Pc(d).scale(T).floor()).x,h=c.y,l=A.length;l--;)u=(s=A[l]).ya(),s.Ji||(s.Ji=w.Pc(u).scale(T).floor()),(u=(u=s.Ji).Wa(c))<f&&(f=u,y=s);y&&y.K().gd(d)||(y=new Gt(w.dg({x:(p-b)/T,y:(h-b)/T}),w.dg({x:(p+b)/T,y:(h+b)/T}),g),A.push(y)),y.ne(d),y=null}for(E=A.length;E--;)if((l=(s=A[E]).xc())<x)for(l=(s=s.bi).length;d=s[--l];)_.push(new Ft(d,g)),d.Ki=!0;else m.push(s)}for(i=0,n=e.length;i<n;i++)delete e[i].Ki;this.b=!1,t({clusters:o,noisePoints:a})}},t("H.clustering.theme.Circular",Lt),Lt.prototype.Sl=function(t){var e=t.xc(),r=this.c[e];if(!r){if(10>e){r=Mt(this,28,"118,209,0");var i={x:11,y:18}}else 25>e?(r=Mt(this,38,"255,105,0"),i={x:13,y:23}):50>e?(r=Mt(this,38,"240,60,0"),i={x:13,y:23}):100>e?(r=Mt(this,38,"181,0,21"),i={x:13,y:23}):1e3>e?(r=Mt(this,48,"181,0,21"),i={x:15,y:28}):(r=Mt(this,66,"181,0,21"),i={x:20,y:38});var n=r.getContext("2d");n.fillStyle="#FFFFFF",n.font="bold 11px Arial",n.fillText(String(e),i.x,i.y),r=new Wj(r,{size:{w:i=r.width/this.a,h:i},anchor:{x:i/2,y:i/2}}),this.c[e]=r}return(e=new Rn(t.ya(),{icon:r,min:t.sc(),max:t.If()})).setData(t),e},Lt.prototype.getClusterPresentation=Lt.prototype.Sl,Lt.prototype.Dm=function(t){var e=new Rn(t.ya(),{icon:this.f,min:t.sc()});return e.setData(t),e},Lt.prototype.getNoisePresentation=Lt.prototype.Dm,u(Nt,Ht),Nt.prototype.U=function(t,e){this.u=t,this.J=Bd(e)},Nt.prototype.Ei=function(t,e){var r=this.c,i=this.u,n=this.J||0,o=!r||!(r.zoom===n&&r.b.ia(i));if(i&&(this.b||o)){if(r&&3>r.Yd&&r.cancel(),this.b=!1,(r=this.f)>=128*Gd(2,n))var a=Ot;else{(o=this.m).Oa(n);var s=o.ib(i.Nb());a=o.ib(i.Jb()),s.y-=r,a.y+=r,s=o.Re(s);var l=o.Re(a);a=new K(s.lat,s.lng,l.lat,l.lng),r=o.Ra(r,0).lng+180,a=a.Bc(s.lat,s.lng-r,l.lat,s.lng).Bc(s.lat,l.lng,l.lat,l.lng+r)}for(r=a,a=[],o=(s=this.a).length;o--;)r.gd(s[o])&&a.push(s[o]);0<a.length?(this.c=new Pt(i,n,a,this.f,this.D,this.s!==mj,t,e),this.c.then(this.i,this.l)):t(Jt)}},Nt.prototype.i=function(t){Ca(t)||(t=new x.Uint32Array(t)),this.c.g(Qt(this,t))},Nt.prototype.l=function(t){Cc(t)&&this.c.f(t)};var Ot=new K(90,-180,-90,180);function Qt(t,e){for(var r=0,i=e[r++],n=Array(i),o=0,a=[],s=e.length,l=t.c.a,c=t.c.zoom;i--;)n[o++]=new Ft(l[e[r++]],c);for(;r<s;){i=e[r++],o=l[e[r]];var u=t.m,h=t.f;u.Oa(t.c.zoom);var p=u.ib(o);for(o=u.Ra(p.x-h,p.y-h),u=u.Ra(p.x+h,p.y+h),o=new Gt((o=new K(o.lat,o.lng,u.lat,u.lng)).Nb(),o.Jb(),c);i--;)o.ne(l[e[r++]]);a.push(o)}return{clusters:a,noisePoints:n}}function Pt(t,e,r,i,n,o,a,s){this.b=t,this.zoom=e,this.a=r,this.g=a,this.f=s,a=3*(t=r.length),s=new(x.Float64Array||Array)(a);for(var l;t--;)l=r[t],s[--a]=l.lat,s[--a]=l.lng,s[--a]=l.wt;ie.call(this,"cluster",{message:[s,i,n,e,o]},void 0)}function Rt(t,e,r){this.b=t,this.a=e,this.f=r}function St(t,e,r,i){this.b=t,this.a=e,this.l=r,this.U=i,this.f=Ka(this.f,this),this.c=Ka(this.c,this)}function Tt(t,e,r,i,n,o){this.g=e,t&&(this.parent=t,1&e?(r=t[8],n=t[5]):(r=t[7],n=t[8]),2&e?(i=t[9],o=t[6]):(i=t[4],o=t[9])),this[7]=r,this[5]=n,this[8]=(r+n)/2,this[4]=i,this[6]=o,this[9]=(i+o)/2}function Ut(t,e){return t[e]||(++t.Xd,t[e]=new Tt(t,e))}function Vt(t,e,r,i){var n,o;if(!e(t,i)&&r--)for(++i,n=0;4>n;n++)(o=t[n])&&Vt(o,e,r,i)}function Wt(t){this.b=t||10,Xt(this)}function Xt(t){t.head=t.a=new Tt(null,NaN,0,0,4294967296,4294967296)}function Yt(t,e){var r,i;for(r=0;4>r;r++)(i=e[r])&&(Yt(t,i),delete e[r]);delete e.parent,delete e.entries}function Zt(t,e){var r,i=t.head;if(e){var n=e;if(n!==i)for(i=n;n=n.parent;)(n.entries||1<n.Xd)&&(i=n)}else for(;!i.entries&&2>(r=i.Xd)&&r;)i=n;t.head=i}function $t(t,e,r,i,n,o,a){var s=e.entries;return o?e.Xd?s=$t(t,Ut(e,+(r>=e[8])|+(i>=e[9])<<1),r,i,n,o-1,a):s?((s=Ut(e,+((s=s[0])[1]>=e[8])|+(s[0]>=e[9])<<1)).entries=e.entries,s.qe=e.qe,s.re=e.re,s.Fb=e.Fb,s.a=e.a,s.f=e.f,s.b=e.b,s.c=e.c,delete e.entries,Zt(t,s),s=$t(t,Ut(e,+(r>=e[8])|+(i>=e[9])<<1),r,i,n,o-1,a)):(o=s=new au(r,i,n,a),(e.entries||(e.entries=[])).push(o),Zt(t,e)):(s||Zt(t,e),t=s=new au(r,i,n,a),(e.entries||(e.entries=[])).push(t)),e.qe+=r*n,e.re+=i*n,e.Fb+=n,e.a===B?(e.a=e.b=r,e.f=e.c=i):(r<e.a?e.a=r:r>e.b&&(e.b=r),i<e.f?e.f=i:i>e.c&&(e.c=i)),s}function au(t,e,r,i){this[0]=e,this[1]=t,this.a=r,this.data=i}function bu(t){Ht.call(this,t),t=this.g,this.l=t.projection,this.m=t.min,this.f=t.max,this.s=t.minWeight,this.c=7-Ad(Ed(zd(1,t.eps))/Od),this.i=new Wt(zd(this.m,this.f+this.c))}function cu(t,e,r,i,n,o,a){var s,l=e.Fb;if(a&&(a.node.Fb!==l?(o.clusters.push(new St(t,a.node,a.depth,r-1)),a=null):n++),a||(l>=t.s?(a={node:e,depth:r},n=r):du(t,e,n+1,o)),e.Xd&&i--)for(r++,l=0;4>l;l++)(s=e[l])&&(cu(t,s,r,i,n,o,a),a=null);a&&o.clusters.push(new St(t,a.node,a.depth,t.f+t.c))}function du(t,e,r,i){var n;if(e=e.entries){var o=e.length;for(i=i.noisePoints,n=0;n<o;n++)i.push(new Rt(t,e[n],r))}else for(n=0;4>n;n++)(o=t[n])&&du(t,o,r,i)}function eu(t,e){var r={},i=(e=e||{}).min||0;switch(i={min:i,max:zd(i,e.max||22)},eu.j.constructor.call(this,i),this.xa=e.pixelRatio||Ue(),Ya(r,It,i,e.clusteringOptions||{}),r.minWeight=zd(It.minWeight,r.minWeight),r.strategy){case fu.DYNAMICGRID:if(r.projection!==mj)throw new D(eu,1,"Unsupported projection");this.c=new Nt(r);break;case fu.GRID:this.c=new Kt(r);break;default:this.c=new bu(r)}this.c.Hc(t),this.D=e.theme||new Lt(this.xa),this.R=A(this.R,this),this.aa=A(this.aa,this),gu(this)}Nt.prototype.o=function(){Nt.j.o.call(this)},Nt.prototype.disposeInternal=Nt.prototype.o,u(Pt,Sf),t("H.clustering.fastgrid.NoisePoint",Rt),Rt.prototype.ya=function(){return this.c||(this.c=this.b.Ra(this.a[1],this.a[0],1)),this.c},Rt.prototype.getPosition=Rt.prototype.ya,Rt.prototype.xc=function(){return this.a.a},Rt.prototype.getWeight=Rt.prototype.xc,Rt.prototype.od=gf,Rt.prototype.isCluster=Rt.prototype.od,Rt.prototype.sc=function(){return this.f-this.b.c},Rt.prototype.getMinZoom=Rt.prototype.sc,Rt.prototype.getData=function(){return this.a.data},Rt.prototype.getData=Rt.prototype.getData,t("H.clustering.fastgrid.Cluster",St),St.prototype.ya=function(){return this.s||(this.s=this.b.Ra(this.a.qe,this.a.re,this.a.Fb)),this.s},St.prototype.getPosition=St.prototype.ya,St.prototype.xc=function(){return this.a.Fb},St.prototype.getWeight=St.prototype.xc,St.prototype.od=ff,St.prototype.isCluster=St.prototype.od,St.prototype.sc=function(){return this.l?this.l-this.b.c:-1/0},St.prototype.getMinZoom=St.prototype.sc,St.prototype.If=function(){return this.U-this.b.c},St.prototype.getMaxZoom=St.prototype.If,St.prototype.K=function(){return this.i||(this.i=sg(this.b.Ra(this.a.a,this.a.f,1),this.b.Ra(this.a.b,this.a.c,1),!0)),this.i},St.prototype.getBoundingBox=St.prototype.K,St.prototype.Yg=function(t){this.g=t,this.a.Lc(this.f,Wd)},St.prototype.forEachEntry=St.prototype.Yg,St.prototype.f=function(t,e){var r,i,n=!1;if(t.Fb>=this.b.s&&t!==this.a&&t.Fb!==this.a.Fb&&(this.g(new St(this.b,t,0,e)),n=!0),!n&&(r=t.entries))for(t=r.length,i=0;i<t;i++)this.g(new Rt(this.b,r[i],e));return n},St.prototype.ze=function(t){this.m=t,this.a.Lc(this.c,Wd)},St.prototype.forEachDataPoint=St.prototype.ze,St.prototype.c=function(t,e){var r;if(t=t.entries){var i=t.length;for(r=0;r<i;r++)this.m(new Rt(this.b,t[r],e))}return!1},p=Tt.prototype,p.Xd=0,p.removeChild=function(t){var e=t.g;this[e]===t&&(delete this[e],delete t.parent,--this.Xd)},p.Lc=function(t,e){for(var r=0,i=this;i=i.parent;)++r;Vt(this,t,e,r)},p.qe=0,p.re=0,p.Fb=0,Wt.prototype.yc=function(t,e,r,i){var n=this.a;if(!(t>=n[7]&&e>=n[4]&&t<=n[5]&&e<=n[6]))throw Error("Coordinates out of bounds");return $t(this,this.a,t,e,r,this.b,i)},Wt.prototype.Lc=function(t,e){Vt(this.a,t,e===+e?e:this.b,0)},u(bu,Ht),p=bu.prototype,p.Hc=function(t){var e,r=0,i=t.length,n=new J(0,0),o=this.l,a=this.i;for(bu.j.Hc.call(this,t),Yt(a,a.a),Xt(a);r<i;r++)o.Pc(e=t[r],n).scale(4294967296).floor(),a.yc(n.x,n.y,e.wt,e.data);this.b=!0},p.Db=function(t){bu.j.Db.call(this,t),this.Hc(this.a)},p.mf=function(t){for(var e=t.length,r=bu.j.Db;e--;)r.call(this,t[e]);this.Hc(this.a)},p.We=function(t){bu.j.We.call(this,t),this.Hc(this.a)},p.Ra=function(t,e,r,i){return this.l.Ra(t/r/4294967296,e/r/4294967296,i)},p.Ei=function(t){if(this.b){var e={clusters:[],noisePoints:[]};cu(this,this.i.a,0,this.f+this.c,-1/0,e,null),this.b=!1,t(e)}},p.o=function(){bu.j.o.call(this),this.i=null},bu.prototype.disposeInternal=bu.prototype.o,t("H.clustering.DataPoint",(function(t,e,r,i){this.lat=t,this.lng=e,this.wt=r===+r?r:1,this.data=i})),u(eu,N),t("H.clustering.Provider",eu),eu.prototype.o=function(){eu.j.o.call(this),this.f.na(),this.c.F(),delete this.c,delete this.L,delete this.D,x.clearTimeout(this.ea)};var fu={FASTGRID:0,GRID:1,DYNAMICGRID:2};function gu(t,e,r){t.ea&&x.clearTimeout(t.ea),e&&t.c.U(e,r),t.ea=x.setTimeout(t.R,150)}function hu(t){var e=t.L.clusters,r=t.L.noisePoints,i=e.length,n=r.length,o=0<i+n;for(t.f.na();n--;){var a=r[n];t.f.fa(t.D.getNoisePresentation(a))}for(;i--;)r=e[i],t.f.fa(t.D.getClusterPresentation(r));o&&t.Va()}function iu(t,e){t:{for(var r=t.length,i="string"==typeof t?t.split(""):t,n=0;n<r;n++)if(n in i&&e.call(void 0,i[n],n,t)){e=n;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}eu.Strategy=fu,eu.prototype.R=function(){this.dispatchEvent("start"),this.c.Ei(this.aa,ld)},eu.prototype.aa=function(t){this.L=t,hu(this),this.dispatchEvent("end")},eu.prototype.Hc=function(t){this.c.Hc(t),gu(this)},eu.prototype.setDataPoints=eu.prototype.Hc,eu.prototype.Db=function(t){this.c.Db(t),gu(this)},eu.prototype.addDataPoint=eu.prototype.Db,eu.prototype.mf=function(t){this.c.mf(t),gu(this)},eu.prototype.addDataPoints=eu.prototype.mf,eu.prototype.We=function(t){this.c.We(t),gu(this)},eu.prototype.removeDataPoint=eu.prototype.We,eu.prototype.Zm=function(){return this.D},eu.prototype.getTheme=eu.prototype.Zm,eu.prototype.zo=function(t){this.D=t,this.L&&(this.f.na(),hu(this))},eu.prototype.setTheme=eu.prototype.zo,eu.prototype.Qb=function(){return!0},eu.prototype.providesDomMarkers=eu.prototype.Qb,eu.prototype.Rb=function(){return!0},eu.prototype.providesMarkers=eu.prototype.Rb,eu.prototype.Cc=function(){return!0},eu.prototype.providesSpatials=eu.prototype.Cc,eu.prototype.Ue=function(t,e){gu(this,t,e)},eu.prototype.preprocessData=eu.prototype.Ue,t("H.clustering.buildInfo",(function(){return Hf("H-clustering","1.51.0","a104c13",{region:"row"})}));var ju={};function ku(t){var e=t.ownerDocument,r=e.documentElement;e=e.defaultView;var i=t.getBoundingClientRect();return t=i.left,i=i.top,isNaN(e.pageXOffset)?(t+=r.scrollLeft,i+=r.scrollTop):(t+=e.pageXOffset,i+=e.pageYOffset),new J(t,i)}function lu(t,e,r){e=Fc(e)?e+"px":e,r=Fc(r)?r+"px":r,t.style[Af("transform")]="translate("+e+","+r+")"}var mu,nu=navigator.userAgent,ou=-1<nu.indexOf("Android")&&-1<nu.indexOf("Mozilla/5.0")&&-1<nu.indexOf("AppleWebKit"),pu=/AppleWebKit\/([\d.]+)/,qu=null===pu.exec(nu)?null:parseFloat(pu.exec(nu)[1]);mu=ou&&null!==qu&&537>qu;var ru=globalThis,su=document.createElement("T");function tu(){this.a=this.lj()}tu.prototype.lj=function(){var t=navigator,e=[];return t&&(t.msPointerEnabled?e.push(uu):t.pointerEnabled&&e.push(vu)),1>e.length&&("TouchEvent"in ru&&e.push(wu),e.push(xu)),e},tu.prototype.detectEventSets=tu.prototype.lj,tu.prototype.addEventListener=function(t,e,r,i){for(var n,o=this.a,a=o.length,s=!1;a--;)(n=o[a][e])&&(s=!0,t.addEventListener(n,r,i||!1));s||t.addEventListener(e,r,i||!1)},tu.prototype.removeEventListener=function(t,e,r,i){for(var n,o=this.a,a=o.length,s=!1;a--;)(n=o[a][e])&&(s=!0,t.removeEventListener(n,r,i||!1));s||t.removeEventListener(e,r,i||!1)};var vu={start:"pointerdown",end:"pointerup",move:"pointermove",cancel:"pointercancel",over:"pointerover",out:"pointerout",hover:"pointerhover"},uu={start:"MSPointerDown",end:"MSPointerUp",move:"MSPointerMove",cancel:"MSPointerCancel",over:"MSPointerOver",out:"MSPointerOut",hover:"MSPointerHover"},wu={start:"touchstart",end:"touchend",move:"touchmove",cancel:"touchcancel"},xu={start:"mousedown",end:"mouseup",move:"mousemove",over:"mouseover",out:"mouseout",hover:"mousehover"};function yu(t,e,r,i){return t=t.createElement(e),r&&(t.className=r),i&&(t.innerHTML=i),t}function zu(t,e){for(var r=1,i=arguments.length;r<i;r++)t.appendChild(arguments[r])}var Au=new tu;function Bu(t,e,r){Au.addEventListener(t,e,r,void 0)}function Cu(t,e,r){Au.removeEventListener(t,e,r,void 0)}function Y(t,e){F.call(this),this.ab=t||"div",this.f=e?e.split(" "):[],this.L=!1,this.f.push("H_el")}function Du(t){(t=t.N())&&t.parentNode&&t.parentNode.removeChild(t)}function Eu(t){t=t||{},Y.call(this,"div","H_btn"),this.Jc(t.label||" "),this.jc(t.tooltip||""),this.setData(t.data),this.va(!!t.disabled),this.O(Fu.UP,!0),t.onStateChange&&this.addEventListener("statechange",t.onStateChange),this.b=A(this.b,this),this.a=A(this.a,this)}u(Y,F),t("H.ui.base.Element",Y),Y.prototype.W=function(t){if(!t)throw Error("Wrong document object");return this.S=yu(t,this.ab,this.f.join(" ")),this.renderInternal(this.S,t),this.va(this.dc(),!0),this.jc(this.aa),this.qb(this.R),this.S},Y.prototype.ta=function(){},Y.prototype.T=function(){},Y.prototype.X=function(){},Y.prototype.renderInternal=Y.prototype.X,Y.prototype.dc=function(){return this.L},Y.prototype.isDisabled=Y.prototype.dc,Y.prototype.va=function(t,e){return((t=!!t)!==this.L||e)&&((this.L=t)?this.Ka("H_disabled"):this.kb("H_disabled")),this},Y.prototype.setDisabled=Y.prototype.va,Y.prototype.J=null,Y.prototype.getData=function(){return this.J},Y.prototype.getData=Y.prototype.getData,Y.prototype.setData=function(t){this.J=t},Y.prototype.setData=Y.prototype.setData,Y.prototype.jc=function(t){var e=this.N();this.aa=t,e&&(t?e.setAttribute("title",t):e.removeAttribute("title"))},Y.prototype.setTooltip=Y.prototype.jc,Y.prototype.S=null,Y.prototype.N=function(){return this.S},Y.prototype.getElement=Y.prototype.N,Y.prototype.R=!0,Y.prototype.qb=function(t){var e=this.N();this.R=t,e&&(e.style.display=t?"":"none")},Y.prototype.setVisibility=Y.prototype.qb,Y.prototype.wc=function(){return this.R},Y.prototype.getVisibility=Y.prototype.wc,Y.prototype.Ka=function(t){var e=this.N();return 0>this.f.indexOf(t)&&this.f.push(t),e&&(e.className=this.f.join(" ")),this},Y.prototype.addClass=Y.prototype.Ka,Y.prototype.kb=function(t){t=this.f.indexOf(t);var e=this.N();return-1<t&&this.f.splice(t,1),e&&(e.className=this.f.join(" ")),this},Y.prototype.removeClass=Y.prototype.kb,Y.prototype.o=function(){Y.j.o.call(this),Du(this),this.J=this.S=null,delete this.aa},u(Eu,Y),t("H.ui.base.Button",Eu),Eu.prototype.va=function(t,e){return t&&this.kb("H_active"),Eu.j.va.call(this,t,e)},Eu.prototype.setDisabled=Eu.prototype.va,Eu.prototype.X=function(t){Bu(t,"start",this.b),Bu(t,"end",this.a),Bu(t,"out",this.a),this.Jc(this.Ge(),!0)},Eu.prototype.renderInternal=Eu.prototype.X,Eu.prototype.getState=function(){return this.C},Eu.prototype.getState=Eu.prototype.getState,Eu.prototype.O=function(t,e){return t!==this.C&&(this.C=t,t===Fu.DOWN?this.Ka("H_active"):this.kb("H_active"),e||this.dispatchEvent("statechange")),this},Eu.prototype.setState=Eu.prototype.O,Eu.prototype.Ge=function(){return this.c},Eu.prototype.getLabel=Eu.prototype.Ge,Eu.prototype.Jc=function(t,e){return(e||t!==this.c)&&(this.c=t,(e=this.N())&&(e.innerHTML=t)),this},Eu.prototype.setLabel=Eu.prototype.Jc,Eu.prototype.b=function(t){this.dc()||this.O(Fu.DOWN),t.preventDefault()},Eu.prototype.a=function(t){this.dc()||this.O(Fu.UP),t.preventDefault()},Eu.prototype.o=function(){var t=this.N();t&&(Cu(t,"start",this.b),Cu(t,"end",this.a),Cu(t,"out",this.a)),Y.prototype.o.call(this)};var Fu={UP:"up",DOWN:"down"};Eu.State=Fu;var Gu={in:'<svg version="1.1" class="H_icon" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px"viewBox="0 0 24 24" enable-background="new 0 0 24 24" xml:space="preserve"><g><path d="m5 10.6h5.6v-5.6h2.8v5.6h5.6v2.8h-5.6v5.6h-2.8v-5.6h-5.6v-2.8z"></path></g></svg>',out:'<svg version="1.1" class="H_icon" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px"viewBox="0 0 24 24" enable-background="new 0 0 24 24" xml:space="preserve"><path d="m5 10.6h14v2.8h-14z"/></svg>'};function Hu(t){var e;t=t||{},this.b=!!t.vertical,this.ea=t.length||"16em",this.a=Fc(e=t.min)?e:0,this.i=zd(this.a,Fc(e=t.max)?e:100),this.wa=E(e=t.step)?1:e,this.l=Iu(this,Fc(e=t.value)?e:(this.a+this.i)/2),this.ag=A(this.ag,this),this.Wf=A(this.Wf,this),this.cg=A(this.cg,this),this.bg=A(this.bg,this),this.s=t.pointerArea,Y.call(this,"div","H_slider"+(this.b?"":" H_l_horizontal"))}function Ju(t){if(!t.m){Bu(t.N(),"start",t.ag);var e=t.s;Bu(e,"move",t.Wf),Bu(e,"end",t.cg),Bu(e,"out",t.bg),t.m=!0}}function Ku(t){if(t.m){Cu(t.N(),"start",t.ag);var e=t.s;Cu(e,"move",t.Wf),Cu(e,"end",t.cg),Cu(e,"out",t.bg),t.m=!1}}function Iu(t,e){var r=t.wa;return e=ae(e,t.a,t.i),r?t.a+Ad((e-t.a)/r)*r:e}function Lu(t,e){var r=t.D,i=t.b;t.u||(t.u=r["offset"+(i?"Height":"Width")]),0>(e-=ku(r)[i?"y":"x"])&&(e=0),e=(t.i-t.a)*e/t.u,e=Iu(t,i?t.i-e:t.a+e),t.l!==e&&(t.wg(e,!0),t.dispatchEvent(new cj(t.A.ed,e,t.l)))}function Mu(t,e){return(e.touches?e.targetTouches[0]:e)["page"+(t.b?"Y":"X")]}function Nu(t){var e=!1,r=t.type;return-1!==r.indexOf("pointer")||-1!==r.indexOf("touch")?e=!0:C(t,MouseEvent)&&(e=1===t.which||1===t.buttons),e}function Ou(t){var e=t.touches;return e&&1===e.length||C(t,MouseEvent)}u(Hu,Y),t("H.ui.base.Slider",Hu),Hu.prototype.wg=function(t,e){var r=this.b,i=r?"top":"left";return this.c&&!e||(t=ae(t,this.a,this.i),this.g&&(r=(r?-1:1)*(e=100*(t-this.a)/(this.i-this.a)),this.g.style[i]=r+"%",this.qa.style[i]=100+r+"%"),this.l=Iu(this,t)),this.l},Hu.prototype.setValue=Hu.prototype.wg,Hu.prototype.en=function(){return this.l},Hu.prototype.getValue=Hu.prototype.en,p=Hu.prototype,p.ag=function(t){var e=this.b;if(Nu(t)&&Ou(t)){var r=Mu(this,t),i=t.target;i===this.g||i.parentElement===this.g?(this.P=r-ku(this.g)[e?"y":"x"]-this.g.offsetWidth/2,this.N().className="H_slider H_slider_active"+(this.b?"":" H_l_horizontal"),this.c=!0):Lu(this,r),t.preventDefault()}},p.cg=function(){this.c&&(this.N().className="H_slider "+(this.b?"":" H_l_horizontal"),this.c=!1)},p.bg=function(t){this.c&&t.target===this.s&&(this.c=!1)},p.Wf=function(t){this.c&&Ou(t)&&(Nu(t)?(Lu(this,Mu(this,t)-this.P),t.preventDefault()):this.c=!1)},p.A={ed:"change"},p.X=function(t,e){var r=yu(e,"div","H_slider_cont"),i=yu(e,"div","H_slider_knob_cont"),n=yu(e,"div","H_slider_knob"),o=yu(e,"div","H_slider_knob_halo"),a=yu(e,"div","H_slider_track");e=yu(e,"div","H_slider_track H_slider_track_active"),t.appendChild(r),r.appendChild(a),a.appendChild(e),r.appendChild(i),i.appendChild(n),i.appendChild(o),this.D=a,this.qa=e,this.g=i,this.s||(this.s=t.ownerDocument.body),r.style[this.b?"height":"width"]=this.ea,this.wg(this.l),Ju(this)},Hu.prototype.renderInternal=Hu.prototype.X,Hu.prototype.o=function(){Ku(this)},Hu.prototype.va=function(t,e){return t?Ku(this):this.D&&Ju(this),Y.prototype.va.call(this,t,e)},Hu.prototype.setDisabled=Hu.prototype.va;var Pu={TOP_LEFT:"top-left",TOP_CENTER:"top-center",TOP_RIGHT:"top-right",LEFT_TOP:"left-top",LEFT_MIDDLE:"left-middle",LEFT_BOTTOM:"left-bottom",RIGHT_TOP:"right-top",RIGHT_MIDDLE:"right-middle",RIGHT_BOTTOM:"right-bottom",BOTTOM_LEFT:"bottom-left",BOTTOM_CENTER:"bottom-center",BOTTOM_RIGHT:"bottom-right"};function Qu(t,e,r){Y.call(this,t,e),this.a=r?r.concat():[]}function Ru(){Qu.call(this,"div","H_ctl"),this.map=null,this.Mc="top-left"}function Su(t){var e=(t=t||{}).slider;Ru.call(this),this.s=A(this.s,this),this.g=A(this.g,this),this.b=A(this.b,this),e&&(this.u=A(this.u,this),this.D=e,this.wa=t.sliderSnaps,this.Ka("H_zoom_slider")),this.i=new Eu({label:Gu.in,onStateChange:this.s}),this.m=new Eu({label:Gu.out,onStateChange:this.s}),this.Ka("H_zoom"),this.Ka("H_grp"),this.ea=!1!==t.fractionalZoom,this.setZoomSpeed(t.zoomSpeed||4),this.Vb(t.alignment||"right-middle")}function Tu(t){t.removeChild(t.c),t.c=null,t.l&&(t.l.removeEventListener("minchange",t.b),t.l.removeEventListener("maxchange",t.b),t.l=null)}function Uu(t,e){var r={},i={};r["top-left"]=yu(e,"div",[Vu,Wu].join(" ")),r["top-center"]=yu(e,"div",[Vu,Xu,Yu,Wu].join(" ")),r["top-right"]=yu(e,"div",[Vu,Wu].join(" ")),r["left-top"]=yu(e,"div",[Vu,Zu].join(" ")),r["left-middle"]=yu(e,"div",[Vu,$u,av,Zu].join(" ")),r["left-bottom"]=yu(e,"div",[Vu,Zu].join(" ")),r["right-top"]=yu(e,"div",[Vu,Zu].join(" ")),r["right-middle"]=yu(e,"div",[Vu,bv,av,Zu].join(" ")),r["right-bottom"]=yu(e,"div",[Vu,Zu].join(" ")),r["bottom-left"]=yu(e,"div",[Vu,Wu].join(" ")),r["bottom-center"]=yu(e,"div",[Vu,cv,Yu,Wu].join(" ")),r["bottom-right"]=yu(e,"div",[Vu,Wu].join(" ")),i["top-left"]=yu(e,"div",[Xu,$u].join(" ")),i["top-right"]=yu(e,"div",[Xu,bv].join(" ")),i["bottom-left"]=yu(e,"div",[cv,$u].join(" ")),i["bottom-right"]=yu(e,"div",[cv,bv].join(" ")),zu(i["top-left"],r["top-left"],r["left-top"]),zu(i["top-right"],r["top-right"],r["right-top"]),zu(i["bottom-left"],r["left-bottom"],r["bottom-left"]),zu(i["bottom-right"],r["right-bottom"],r["bottom-right"]),zu(t,i["top-left"],i["top-right"],i["bottom-left"],i["bottom-right"],r["top-center"],r["left-middle"],r["right-middle"],r["bottom-center"]),this.a=r}t("H.ui.LayoutAlignment",Pu),u(Qu,Y),t("H.ui.base.Container",Qu),Qu.prototype.va=function(t,e){var r=this.a?this.a.length:0;for(Y.prototype.va.call(this,t,e);r--;)this.a[r].va(t,e);return this},Qu.prototype.setDisabled=Qu.prototype.va,Qu.prototype.Ja=function(t){var e=this.N();return this.a.push(t),e&&(t.W(e.ownerDocument),e.appendChild(t.N())),this},Qu.prototype.addChild=Qu.prototype.Ja,Qu.prototype.dh=function(){return this.a.concat()},Qu.prototype.getChildren=Qu.prototype.dh,Qu.prototype.removeChild=function(t){var e=this.a.indexOf(t),r=this.N();0<=e&&(this.a.splice(e,1),r&&r.removeChild(t.N()))},Qu.prototype.removeChild=Qu.prototype.removeChild,Qu.prototype.na=function(){var t=this.N();t&&this.a.forEach((function(e){t.removeChild(e.N())})),this.a=[]},Qu.prototype.X=function(t,e){for(var r=0,i=this.a.length;r<i;r++)t.appendChild(this.a[r].W(e))},Qu.prototype.renderInternal=Qu.prototype.X,Qu.prototype.o=function(){this.na(),this.a.forEach(this.qa,this),Y.prototype.o.call(this)},Qu.prototype.qa=function(t){t.F()},u(Ru,Qu),t("H.ui.Control",Ru),Ru.prototype.Ia=function(t){this.map=t},Ru.prototype.W=function(t){return Qu.prototype.W.call(this,t)},Ru.prototype.X=function(t,e){Qu.prototype.renderInternal.call(this,t,e),this.Vb(this.Mc)},Ru.prototype.renderInternal=Ru.prototype.X,Ru.prototype.Qe=function(){},Ru.prototype.onUnitSystemChange=Ru.prototype.Qe,Ru.prototype.Lb=function(){return this.map},Ru.prototype.getMap=Ru.prototype.Lb,Ru.prototype.pa=function(){return this.xa},Ru.prototype.getLocalization=Ru.prototype.pa,Ru.prototype.Ll=function(){return this.Mc},Ru.prototype.getAlignment=Ru.prototype.Ll,Ru.prototype.Vb=function(t){return"string"==typeof t&&Pu[t.replace("-","_").toUpperCase()]===t&&(this.Mc=t,this.dispatchEvent("alignmentchange")),this},Ru.prototype.setAlignment=Ru.prototype.Vb,u(Su,Ru),t("H.ui.ZoomControl",Su),Su.prototype.kn=function(){return this.P},Su.prototype.getZoomSpeed=Su.prototype.kn,Su.prototype.Do=function(t){this.P=t},Su.prototype.setZoomSpeed=Su.prototype.Do,Su.prototype.Ia=function(t){this.map!==t&&(this.map&&this.map.removeEventListener("mapviewchange",this.g),Tu(this)),Ru.prototype.Ia.apply(this,arguments),this.map&&(this.b(),t.addEventListener("mapviewchange",this.g),t.addEventListener("baselayerchange",this.b))},Su.prototype.setMap=Su.prototype.Ia,Su.prototype.o=function(){Ru.prototype.o.apply(this,arguments),this.map.removeEventListener("baselayerchange",this.b),Tu(this)},Su.prototype.X=function(t,e){Ru.prototype.renderInternal.call(this,t,e),this.i.jc(this.pa().translate("zoom.in")),this.m.jc(this.pa().translate("zoom.out"))},Su.prototype.renderInternal=Su.prototype.X,Su.prototype.Vb=function(t){var e=this.Mc;return Ru.prototype.Vb.call(this,t),e!==t&&this.b(),this},Su.prototype.setAlignment=Su.prototype.Vb,Su.prototype.g=function(){var t=this.map,e=t.pb(),r=t.Xa()-1;t=t.g||t.f.getCapabilities().lookAt.zoom,this.D&&this.c.wg(e),this.dc()||(this.i.va(e+r>=t.max),this.m.va(e<=t.min))},Su.prototype.va=function(t,e){return Su.j.va.call(this,t,e),this.g(),this},Su.prototype.setDisabled=Su.prototype.va,Su.prototype.s=function(t){var e,r=(t=t.target)===this.i?1:-1,i=0<r?Math.ceil:Math.floor,n=this.map,o=this;n&&("down"===t.getState()?(n.c.startControl(),n.c.control(0,0,r*this.P,0,0,0)):n.c.endControl(!0,(function(t){e=o.ea?t.zoom:i(t.zoom),t.zoom=e})))},Su.prototype.u=function(t){this.map&&this.map.df(t.newValue)},Su.prototype.b=function(){var t=this.Mc,e=this.Lb();if(/^top/g.test(t)||/^bottom/g.test(t)){var r=this.m;t=this.i;var i=!1}else r=this.i,t=this.m,i=!0;if(this.removeChild(r),this.removeChild(t),this.Ja(r),this.D&&e){Tu(this),e=i;var n=(i=(r=this.map)&&r.g)||r.f.getCapabilities().lookAt.zoom;(this.l=i)&&(i.addEventListener("minchange",this.b),i.addEventListener("maxchange",this.b)),this.c=new Hu({step:this.wa?1:0,vertical:e,min:n.min,max:n.max,value:r.pb(),pointerArea:r.N()}),this.c.addEventListener(this.c.A.ed,this.u),this.Ja(this.c)}this.Ja(t)};var Xu="H_l_top",cv="H_l_bottom",$u="H_l_left",bv="H_l_right",Yu="H_l_center",av="H_l_middle",Wu="H_l_horizontal",Zu="H_l_vertical",Vu="H_l_anchor";function dv(t,e){e?(e=t.offsetWidth,t.style.marginLeft=-Math.round(.5*e)+"px"):(e=t.offsetHeight,t.style.marginTop=-Math.round(.5*e)+"px")}Uu.prototype.update=function(){var t=this.a;dv(t["top-center"],!0),dv(t["bottom-center"],!0),dv(t["left-middle"],!1),dv(t["right-middle"],!1)},Uu.prototype.put=function(t,e){t=t?t.N():null;var r=e?this.a[e]:null;t&&r&&(t.parentElement&&t.parentElement.removeChild(t),r.insertBefore(t,/(bottom|right)$/.test(e)||/(center|middle)/.test(e)&&r.childNodes.length%2?r.firstChild:null)),this.update()};var ev={IMPERIAL:"imperial",METRIC:"metric"};t("H.ui.UnitSystem",ev);var fv={btn:'<svg class="H_icon" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><g fill-rule="evenodd"><g transform="translate(3 2)"><path d="m18 13v7h-18v-7h2v5h2v-2h2v2h2v-3h2v3h2v-2h2v2h2v-5z"></path><path d="m2.3.3c.7 0 1.3.1 1.8.4s.9.6 1.1 1 .4.9.4 1.4c0 .5-.1 1-.3 1.4s-.57 1-1 1.6-1.3 1.3-2.3 2.2h3.9l-.2 1.7h-6.16v-1.6c1.1-1.1 2-2 2.5-2.6s.9-1 1-1.4.3-.8.3-1.2c0-.4-.1-.7-.3-.9s-.5-.3-.9-.3c-.3 0-.6 0-.9.2s-.5.4-.8.7l-1.3-1c.4-.5.9-.9 1.4-1.2s1.2-.4 1.8-.4zm14.4 9.7h-2.3l-.2-3.8c 0-.9-.1-1.7-.1-2.4 0-.5 0-1 0-1.5l-1.5 6.7h-2.2l-1.6-6.7c.1.8.1 1.6.1 2.3 0 .5 0 1.1 0 1.7l-.2 3.8h-2.2l.7-9.7h2.9l1.5 6.6 1.4-6.6h2.9z"></path></g></g></svg>',point:'<svg height="22" viewBox="0 0 12 12" width="22" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="m6 12c3.3 0 6-2.7 6-6s-2.7-6-6-6-6 2.7-6 6 2.7 6 6 6z" fill="#fff"></path><path d="m6 10c2.2 0 4-1.8 4-4s-1.8-4-4-4-4 1.8-4 4 1.8 4 4 4z" fill="#2ed5c9" stroke="#272c36" stroke-width="2"></path></g></svg>'};function gv(t){Eu.call(this,t),this.i=function(t){t.preventDefault()},this.g=A((function(t){this.dc()||this.toggleState(),t.preventDefault()}),this)}function hv(t,e,r){bj.call(this,t,{icon:iv,visibility:r}),jv(this,e)}function jv(t,e){t.zn=e,t.S&&(t.S.textContent=e)}u(gv,Eu),t("H.ui.base.PushButton",gv),gv.prototype.X=function(t){Bu(t,"start",this.g),Bu(t,"end",this.i),this.Jc(this.Ge(),!0)},gv.prototype.renderInternal=gv.prototype.X,gv.prototype.Lo=function(){var t=Fu.DOWN;return this.O(this.getState()===t?Fu.UP:t),this},gv.prototype.toggleState=gv.prototype.Lo,gv.prototype.o=function(){var t=this.N();t&&Cu(t,"start",this.g),Eu.prototype.o.call(this)},u(hv,bj);var iv=new Ti(yu(ru.document,"span","H_dm_label"),{onAttach:function(t,e,r){r.S=t,jv(r,r.zn)},onDetach:function(t,e,r){delete r.S}});function kv(t,e){F.call(this),this.b=t,this.f=new hv(this.Jo,""),e.push(this.f),this.a=new R({objects:e,data:this}),this.ug=this.ug.bind(this)}function lv(t,e){e&&(t.nextSibling=e,e.previousSibling=t)}function mv(t,e,r,i){var n=new L,o=[];lv(t,this),lv(this,e),n.qd(t.ya()),n.qd(e.ya()),this.c=new th(n,{style:r.Wd}),this.i=new th(n,{style:{strokeColor:"transparent",lineWidth:Math.min(100,this.c.V().lineWidth+2*(i||5))}}),r.c&&(this.g=new th(n,{style:r.c}),o.push(this.g)),o.push(this.c,this.i),kv.call(this,r,o),this.s=this.l=-1,(t=this.a).addEventListener("pointermove",this.J,!0,this),t.addEventListener("pointerleave",this.u,!0,this)}function nv(t,e,r){var i=t.c.ga();i.ff(3*+r,3,[e.lat,e.lng,0]),t.g&&t.g.da(i),t.i.da(i),t.c.da(i)}function ov(t,e,r){r=e.b(r||0),this.c=new Rn(t,{icon:r,zIndex:0}),this.c.draggable=!0,kv.call(this,e,[this.c]),(t=this.a).addEventListener("dragstart",this.Qn,!0,this),t.addEventListener("drag",this.Rn,!0,this),t.addEventListener("dragend",this.Pn,!0,this)}function pv(t){var e=0;t.nextSibling&&t.previousSibling&&(t.nextSibling.Wc||t.previousSibling.Wc?t.nextSibling.Wc&&!t.previousSibling.Wc&&(e=2):e=1),e=t.b.b(e),t.c.Ic(e)}function qv(t,e){this.Ca=e,this.b=t,this.a={Wc:!0},rv(this,this.a),this.$f=A(this.$f,this)}function sv(t,e){for(var r=(t=t.a).nextSibling;r!==t;){var i=r,n=r.previousSibling!==t&&e;(i.m=n)?i.ug():(i.Rh&&x.clearTimeout(i.Rh),i.Rh=x.setTimeout(i.ug,100)),r=r.nextSibling}}function tv(t,e){var r=e||t.a.nextSibling,i=0,n=0;if(e&&!uv(t,e))throw new D(t.Xe,0,e);for(r instanceof ov?i=r.Ee():r instanceof mv&&(i=r.previousSibling.Ee()),e=r;e&&e!==t.a;e=e.nextSibling,n++)e.ni(i),1==n%2&&(i+=e.Ee())}function uv(t,e){for(var r=t.a.nextSibling,i=!1;r!==t.a;){if(r===e){i=!0;break}r=r.nextSibling}return i}function vv(t,e,r){e=new mv(e,r,t.Ca),t.b.fa(e.a)}function rv(t,e){t.a.nextSibling=e,e.previousSibling=t.a}function wv(t){var e,r=(t=t||{}).lineStyle;Ru.call(this),this.s=new gv({label:fv.btn,onStateChange:A(this.Nn,this)}),this.Ja(this.s),(e=t.distanceFormatter)&&(this.oj=e),r&&(this.Xj=r,this.sk=B),this.Vb(t.alignment||"right-bottom"),this.g={},this.g[0]=t.startIcon,this.g[2]=t.endIcon,this.g[1]=t.stopoverIcon,this.g[3]=t.splitIcon}function xv(t){var e,r=t.map,i={};t.c||(t.l=new N,t.m=new tl(t.l,{pixelRatio:t.map.Xa()}),t.u=e=t.l.bc(),t.u.Vk(!0),e.addEventListener("dragstart",t.Ln,!0,t),e.addEventListener("dragend",t.ef,!0,t),e.addEventListener("pointerenter",t.ef,!0,t),e.addEventListener("pointerleave",t.Mn,!0,t),e.addEventListener("tap",t.co,!0,t),t.i=yv(t),i.a=A(t.oj,t),i.b=A(t.dk,t),i.g=A(t.Dj,t),i.map=t.map,i.f=t.i,i.Wd=t.Xj,i.c=t.sk,t.b=new qv(t.u,i),t.c=!0),t.i&&t.u.fa(t.i),r.addEventListener("tap",t.pk,!0,t),r.a.add(t.m)}function zv(t){var e=t.map;t.c&&(e.removeEventListener("tap",t.pk,!0,t),e.ae(t.m),t.b.na())}function yv(t){function e(){var t=i.yb();return t={anchor:i.kd().clone().scale(o).floor(),size:new Wi(Bd(t.w*o),Bd(t.h*o)),hitArea:n},new Wj(i.Qc(),t)}var r,i=t.dk(3),n=new Xi(Yi.NONE,[]),o=i===t.D?.5:1;if(1===i.getState())var a=e();else a=new Wj("<svg/>",{hitArea:n}),i.addEventListener("statechange",(function(){1===i.getState()&&r.Ic(e())}));return r=new Rn(t.map.bb(),{visibility:!1,icon:a})}function Av(){this.C=Bv.CLOSED,Qu.call(this,"div","H_overlay")}u(kv,F),p=kv.prototype,p.Wc=!1,p.Jo={lat:0,lng:0},p.Jc=function(t,e){jv(this.f,t),this.f.da(e)},p.Rh=0,p.ug=function(){this.f.qb(this.m)},u(mv,kv),mv.prototype.Ee=function(){var t=this.c.ga();return t.ye(0).Wa(t.ye(1))},mv.prototype.J=function(t){var e=t.currentPointer;t=this.previousSibling.ya();var r=this.nextSibling.ya(),i=this.b.f,n=e.viewportX;e=e.viewportY,this.l===n&&this.s===e||(this.l=n,this.s=e,i.da(this.b.g(t,r,{x:n,y:e})),i.qb(!0))},mv.prototype.u=function(){this.b.f.qb()},mv.prototype.ni=function(){this.Jc(this.b.a(this.Ee()),this.c.K().bb())},u(ov,kv),p=ov.prototype,p.hk=0,p.A={ed:"change"},p.Ee=function(){return this.hk},p.ya=function(){return this.c.ga()},p.Rn=function(t){var e=t.currentPointer;t=e.viewportX,e=e.viewportY,this.i===t&&this.l===e||(this.i=t,this.l=e,this.c.da(this.b.map.Pa(t-this.g.x,e-this.g.y)),this.dispatchEvent(new ud(this.A.ed,this)))},p.Qn=function(t){var e=t.currentPointer,r=e.viewportX;e=e.viewportY;var i=this.b.map.Da(this.ya());this.c.fe(1),this.g={x:r-i.x,y:e-i.y},t.stopPropagation()},p.Pn=function(){this.c.fe(0)},p.ni=function(t){this.hk=t,this.Jc(this.b.a(t),this.ya())},t("H.ui.distanceMeasurement.Model",qv),p=qv.prototype,p.Rf=function(){return this.a.nextSibling===this.a},p.ne=function(t){var e=this.a.previousSibling,r=this.Rf();return t=new ov(t,this.Ca,r?0:2),this.b.fa(t.a),lv(t,this.a),t.addEventListener(t.A.ed,this.$f),r?rv(this,t):(vv(this,e,t),pv(e),tv(this,e)),t},p.insertBefore=function(t,e){var r,i=1;if(e){if(!uv(this,e))throw new D(this.insertBefore,1,e);(r=e.previousSibling.Wc)&&(i=0),(t=new ov(t,this.Ca,i)).addEventListener(t.A.ed,this.$f),this.b.fa(t.a),r?(vv(this,t,r=this.a.nextSibling),rv(this,t),e=t,pv(r)):(e=(r=e.previousSibling).previousSibling,i=r.nextSibling,this.b.Ga(r.a),vv(this,e,t),vv(this,t,i)),tv(this,e)}else t=this.ne(t);return t},p.na=function(){rv(this,this.a),this.b.na()},p.Xe=function(t){var e=this.a,r=t.previousSibling,i=t.nextSibling;if(!uv(this,t))throw new D(this.Xe,0,t);if(this.b.Ga(t.a),r===e){var n=i;n!==e?(rv(this,t=n.nextSibling),t.ni(0),pv(t),tv(this,t)):rv(this,this.a)}else i===e?(lv(t=(n=r).previousSibling,e),pv(t)):r&&i&&(vv(this,r.previousSibling,i.nextSibling),this.b.rd([i.a,r.a]),tv(this,r.previousSibling));n&&n!==e&&this.b.Ga(n.a)},p.$f=function(t){var e=(t=t.target).previousSibling,r=t.nextSibling,i=t.ya();if(!r.Wc){nv(r,i,!1);var n=t}e.Wc||(nv(e,i,!0),n=e.previousSibling),tv(this,n)},u(wv,Ru),t("H.ui.DistanceMeasurement",wv),p=wv.prototype,p.Qh=ev.METRIC,p.Xj={strokeColor:"rgb(39,44,54)",lineWidth:5},p.sk={strokeColor:"white",lineWidth:7},p.oj=function(t){var e="m",r=0;return"metric"===this.Qh?1e3<=t&&(t/=1e3,e="km",r=1):(e="ft",5280<=(t/=.3048)&&(t/=5280,e="mi",r=1)),t.toFixed(r)+" "+this.pa().translate("scale."+e)},p.Dj=function(t,e,r){var i=this.map.Da(t);return e=this.map.Da(e),r=new J(r.x,r.y).Cj(i,e),this.map.Pa(r.x,r.y)||ng(t)},p.X=function(t,e){var r=22*(this.map.f.type===kk.P2D?this.map.Xa():1),i=r/2;Ru.prototype.renderInternal.call(this,t,e),this.Qh=ev.METRIC,this.D=new Wj(fv.point,{anchor:{x:i,y:i},size:{w:r,h:r},hitArea:new Xi(Yi.CIRCLE,[i,i,i])}),this.s.jc(this.pa().translate("distance.measurement"))},wv.prototype.renderInternal=wv.prototype.X,p=wv.prototype,p.dk=function(t){return this.g[t]||this.D},p.ef=function(){sv(this.b,!0)},p.Ln=function(){sv(this.b)},p.Mn=function(t){"touch"!==t.currentPointer.type&&sv(this.b)},p.co=function(t){var e,r=t.currentPointer,i=t.target.Fa;i&&(i=i.getData())instanceof kv&&(e=i),i=e,t=(t=t.originalEvent).metaKey||t.altKey,i&&(t&&i instanceof ov?this.b.Xe(i):i instanceof mv&&(t=i.previousSibling.ya(),e=i.nextSibling.ya(),r={x:r.viewportX,y:r.viewportY},this.b.insertBefore(this.Dj(t,e,r),i.nextSibling),this.i.qb()),this.ef())},p.pk=function(t){var e=t.currentPointer;(t=t.target)!==this.map&&t.getProvider&&t.getProvider()===this.l||(this.b.ne(this.map.Pa(e.viewportX,e.viewportY)),this.i.qb(),this.ef())},p.Nn=function(t){"down"===t.target.getState()?xv(this):zv(this)},p.Qe=function(t){this.Qh=t,this.c&&(tv(this.b),this.ef())},wv.prototype.onUnitSystemChange=wv.prototype.Qe,wv.prototype.o=function(){zv(this),this.c&&(this.l.F(),this.m.F()),wv.j.o.call(this)},wv.prototype.Ia=function(t){t?this.s.getState()===Fu.DOWN&&(this.map=t,xv(this)):(zv(this),this.c=!1),Ru.prototype.Ia.apply(this,arguments)},wv.prototype.setMap=wv.prototype.Ia,u(Av,Qu),t("H.ui.base.OverlayPanel",Av),Av.prototype.O=function(t,e){return(t!==this.C||e)&&(this.C=t,t===Bv.OPEN?this.Ka("H_open"):this.kb("H_open")),this},Av.prototype.setState=Av.prototype.O,Av.prototype.getState=function(){return this.C},Av.prototype.getState=Av.prototype.getState,Av.prototype.xk=function(t){var e=t.Mc;t=t.N();var r=this.N(),i=r.style;if(this.kb("H_top"),this.kb("H_middle"),this.kb("H_bottom"),this.kb("H_left"),this.kb("H_center"),this.kb("H_right"),i.bottom=i.top=i.left=i.right=i.margin="",/top/g.test(e)){this.Ka("H_top"),i.top="0",i.margin="0 12px";var n=-1}else/bottom/g.test(e)?(this.Ka("H_bottom"),i.bottom="0",i.margin="0 12px",n=1):(this.Ka("H_middle"),i.top="50%",i.margin="0 12px",i.marginTop=-Math.round(.5*r.offsetHeight)+"px",n=0);/left/g.test(e)?(this.Ka("H_left"),i.left=t.offsetWidth+"px",i.marginLeft="12px"):/right/g.test(e)?(this.Ka("H_right"),i.right=t.offsetWidth+"px",i.marginRight="12px"):(this.Ka("H_center"),i.left="50%",0>n?(i.top=t.offsetHeight+"px",i.marginTop="12px"):0<n&&(i.bottom=t.offsetHeight+"px",i.marginBottom="12px"),i.marginLeft=-Math.round(.5*r.offsetWidth)+"px",t.appendChild(r))},Av.prototype.pointToControl=Av.prototype.xk;var Bv={OPEN:"open",CLOSED:"closed"};function Cv(t){t=t||{},Qu.call(this,"div","H_rdo"),this.g=new Y("div","H_rdo_title"),this.b=new Qu("div","H_rdo_buttons"),this.Ja(this.g),this.Ja(this.b),this.i=A((function(t){t.target.getState()===Fu.DOWN?(this.Kk(t.target,!0),this.dispatchEvent(Dv)):t.target.O(Fu.DOWN,!0)}),this),this.addEventListener("statechange",this.i),this.Ci(t.title||""),t.onActiveButtonChange&&this.addEventListener(Dv,t.onActiveButtonChange),t.buttonsOptions&&t.buttonsOptions.forEach((function(t){this.Gg(new gv(t))}),this)}Av.State=Bv,u(Cv,Qu),t("H.ui.base.RadioGroup",Cv);var Dv="activebuttonchange";function Ev(t){t=t||{},Ru.call(this),this.i=new Av,this.b=this.b.bind(this),this.s=this.s.bind(this),this.m=this.m.bind(this),this.Vb(t.alignment||"bottom-right"),Fv(this,t.baseLayers,t.layers)}function Gv(t,e){var r=[];return t.concat(e).forEach((function(t){r=r.concat(t.layer)})),r}function Hv(t,e,r){var i=t.Lb();if(i){t=Gv(t.c,t.g);var n=Gv(e,r);t.forEach((function(t){n.includes(t)||i.ae(t)}))}}function Fv(t,e,r){Hv(t,e,r),t.D=NaN,t.c=Bc(e)?e:[],t.g=Bc(r)?r:[],t.l&&(t.l.na(),t.u.na(),Iv(t))}function Iv(t){var e=t.pa();t.c.forEach((function(t,r){var i=t.layer;this.l.Gg(new gv({label:Jv(e,t.label),data:r,disabled:!i||Bc(i)&&!i.length}))}),t),t.g.forEach((function(t,r){var i=t.layer;this.u.Ja(new gv({label:Jv(e,t.label),onStateChange:this.sb.bind(this,t.layer),data:r,disabled:!i||Bc(i)&&!i.length}))}),t),t.ea.qb(!(!t.g.length||!t.c.length)),x.setTimeout(function(){this.map&&(this.b(),this.P.va(!(this.c&&this.c.length||this.g&&this.g.length)))}.bind(t))}function Mv(t,e){var r=window.H.service&&window.H.service.omv.Provider,i=e.ca();if(r&&e.ca()instanceof r&&i.V().xe){var n=i.V(),o=function(){var t=Nv.ground.filter((function(t){return!!n.kh("layers."+t)})),r=Nv.water.filter((function(t){return!!n.kh("layers."+t)}));if(t.concat(r).length){var a={};$h(a,n.xe(t)),$h(a,n.xe(r,!1,!0)),delete a.global,t=new ti(a,n.Ib()),(t=i.s().$b(t)).Bg=e,this.map.nf(t)}n.removeEventListener(Zh.CHANGE,o)}.bind(t);n.getState()!==Xh.READY?n.addEventListener(Zh.CHANGE,o):o()}}function Kv(t){return iu(t.map.a.La(),(function(t){return!!t.Bg}))}function Lv(t){t=t.map.a.La();var e=window.H.service&&window.H.service.traffic.flow.Provider;return!!e&&t.some((function(t){return t.ca()instanceof e}))}Cv.prototype.X=function(t,e){Qu.prototype.renderInternal.call(this,t,e),this.Ci(this.c,!0)},Cv.prototype.renderInternal=Cv.prototype.X,Cv.prototype.na=function(){this.b.na()},Cv.prototype.Ci=function(t,e){return(t!==this.c||e)&&(this.c=t,this.g.N()&&(this.g.N().innerHTML=this.c)),this},Cv.prototype.setTitle=Cv.prototype.Ci,Cv.prototype.an=function(){return this.c},Cv.prototype.getTitle=Cv.prototype.an,Cv.prototype.Gg=function(t){if(!(t instanceof gv))throw Error("PushButton expected");return t.ka(this),this.b.Ja(t),this},Cv.prototype.addButton=Cv.prototype.Gg,Cv.prototype.ko=function(t){return this.b.removeChild(t),t.ka(null),this},Cv.prototype.removeButton=Cv.prototype.ko,Cv.prototype.Df=function(){return this.b.dh()},Cv.prototype.getButtons=Cv.prototype.Df,Cv.prototype.Kk=function(t,e){for(var r=this.Df(),i=r.length;i--;)r[i].O(r[i]===t?Fu.DOWN:Fu.UP,e)},Cv.prototype.setActiveButton=Cv.prototype.Kk,Cv.prototype.o=function(){this.removeEventListener("statechange",this.i),this.na(),Qu.prototype.o.call(this)},u(Ev,Ru),t("H.ui.MapSettingsControl",Ev),Ev.prototype.ta=function(){var t=this.Lb();t&&(t.addEventListener("tap",this.s),(t=t.a).addEventListener("add",this.b),t.addEventListener("remove",this.b),t.addEventListener("set",this.b))},Ev.prototype.T=function(){var t=this.Lb();t&&(t.removeEventListener("tap",this.s),(t=t.a).removeEventListener("add",this.b),t.removeEventListener("remove",this.b),t.removeEventListener("set",this.b))},Ev.prototype.X=function(t,e){var r=this.pa().translate("layers.choose");Ru.prototype.renderInternal.call(this,t,e),this.ta(),this.P=new gv({tooltip:r,label:'<svg xmlns="http://www.w3.org/2000/svg" class="H_icon" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M6.7,14.6 L4.5,16 L12,20.6 L19.5,16 L17.3,14.6 L19.1,13.5 L23,16 L12,23 L1,16 L4.9,13.5 L6.7,14.6 Z M12,2 L23,9 L12,16 L1,9 L12,2 Z"></path></svg>',onStateChange:A((function(t){t.target.getState()===Fu.DOWN?(this.i.O(Bv.OPEN),this.i.xk(this)):this.i.O(Bv.CLOSED)}),this)}),Ev.prototype.wa=function(t){if(this.map.f.type===Qn){var e=H.map.render.harp.Style;t=[].concat(t);for(var r=0;!n&&r<t.length;r++){var i=t[r].ca();if(i.Sb()&&i.V)var n=(i=i.V()).getConfig()||i.getUrl()}if(n){var o=function(t){(t=t.ca()).Sb()&&t.V&&t.V()instanceof e&&t.gb(new e(n))};this.g.forEach((function(t){Bc(t=t.layer)?t.forEach(o):t&&o(t)}))}}},this.l=new Cv({title:r,onActiveButtonChange:function(){var t=this.D;t:{for(var e=this.l.Df(),r=e.length;r--;)if(e[r].getState()===Fu.DOWN){e=e[r];break t}e=null}if(e=e.getData(),r=Bc(e=this.c[e].layer),this.map.ud(r?e[0]:e),(t=this.c[t])&&Bc(t=t.layer))for(var i=t.length;1<i--;)this.map.ae(t[i]);if(r)for(t=e.length;1<t--;)this.map.nf(e[t],1);this.wa(e),this.m()}.bind(this)}),this.u=new Qu("div","H_grp"),this.ea=new Y("div","H_separator"),this.Ja(this.P),this.Ja(this.i),this.i.Ja(this.l),this.i.Ja(this.ea),this.i.Ja(this.u),Iv(this)},Ev.prototype.renderInternal=Ev.prototype.X,Ev.prototype.b=function(){var t=this.map.g,e=this.map.a;this.D=NaN,this.c.forEach((function(e,r){e=e.layer,e=t===(Bc(e)?e[0]:e),this.l.Df()[r].O(Fu[e?"DOWN":"UP"],!0),e&&(this.D=r)}),this),this.g.forEach((function(t,r){var i=Bc(t=t.layer);r=this.u.dh()[r],!t||i&&!t.length?r.va(!0):r.O(Fu[-1!==e.indexOf(i?t[0]:t)?"DOWN":"UP"],!0)}),this)},Ev.prototype.sb=function(t,e){t=Bc(t)?t:[t],e=e.target.getState()===Fu.DOWN;for(var r=0;r<t.length;r++)e?this.map.nf(t[r]):this.map.ae(t[r]);this.m()},Ev.prototype.m=function(){var t=Kv(this);t&&(t.Bg.ca().V().Oe(t.ca().V().qc()),this.map.ae(t),t.F(),delete t.Bg),Lv(this)&&Mv(this,this.map.g)};var Nv={water:["water.water-labels"],ground:"road_labels continent_label island_label roads.shields roads.directions truck-restriction.signs places landuse.label".split(" ")};function Jv(t,e){return/^layers?/.test(e)&&t.Nf(e)?t.translate(e):e}Ev.prototype.s=function(){this.P.O(Fu.UP)},Ev.prototype.o=function(){Ev.j.o.call(this),this.T()};var Ov=[];t("H.ui.i18n.defaultLocales",Ov);var Pv={},Qv=[];function Rv(t,e){Pv[t]=e,-1===Ov.indexOf(t)&&Ov.push(t),Qv.length?Sv(t,e):Qv=Object.keys(e)}function Sv(t,e){for(var r,i=Qv,n=i.length;n--;)if(!e[r=i[n]])throw Error("'"+r+"' key missing in translation map for "+t)}function Tv(t){t=t||{},Ru.call(this),this.c=new gv({label:'<svg xmlns="http://www.w3.org/2000/svg" class="H_icon" viewBox="0 0 24 24"><g transform="translate(1 3)"><path fill-rule="nonzero" d="M5,0 L5,2 L2,2 L2,16 L5,16 L5,18 L2,18 C0.9,18 0,17 0,15.75 L0,2.25 C0,1 0.9,0 2,0 L5,0 Z M17,0 L20,0 C21.1,0 22,1 22,2.25 L22,15.75 C22,17 21.1,18 20,18 L17,18 L17,16 L20,16 L20,2 L17,2 L17,0 Z"></path><rect width="10" height="2" x="6" y="8"></rect><rect width="2" height="10" x="10" y="4"></rect></g></svg>',onStateChange:A(this.On,this)}),this.Ja(this.c),this.Vb(t.alignment||"right-bottom")}function Uv(t,e){if(!Cc(t))throw new TypeError("string locale code required");if(Ea(e))Sv(t,e);else{if(-1===Ov.indexOf(t))throw Error("Default locale '"+t+"' does nto exist.");e=Pv[t]}this.b=e||{},this.a=t}function Vv(t){t=t||{},Ru.call(this),this.Ka("H_scalebar"),this.Vb(t.alignment||"right-bottom"),this.m=150,this.update=A(this.update,this),this.i=this.g=this.b=this.c=null}function Wv(t){C(t,Re,Wv,1),Y.call(this,"div","H_context_menu_item"),this.b=t,this.c=A(this.c,this),this.a=A(this.a,this),this.b.addEventListener("update",this.a)}function Xv(t){C(t,Array,Xv,1),Qu.call(this,"div","H_context_menu"),this.c=t,this.b=null}function Yv(t,e){e=e||{};var r=this;Y.call(this,"div","H_ib H_ib_top"),this.u=A((function(t){r.dc()||(r.close(),t.preventDefault())}),this),this.update=A(this.update,this),this.i=A(this.i,this),this.setPosition(t),this.$e(e.content),e.onStateChange&&this.addEventListener("statechange",e.onStateChange),this.O(Zv.OPEN)}u(Tv,Ru),t("H.ui.ZoomRectangle",Tv),p=Tv.prototype,p.On=function(t){var e=this.map,r=e.b.element;t.target.getState()===Fu.DOWN?(e.addEventListener("dragstart",this.fk,!0,this),e.addEventListener("drag",this.gk,!0,this),e.addEventListener("dragend",this.ek,!0,this),(t=r.ownerDocument.createElement("div")).className="H_zoom_lasso",r.appendChild(t),this.b=t):(e.removeEventListener("dragstart",this.fk,!0,this),e.removeEventListener("drag",this.gk,!0,this),e.removeEventListener("dragend",this.ek,!0,this),r.removeChild(this.b))},p.fk=function(t){var e=this.b.style,r=t.currentPointer,i=r.viewportX;r=r.viewportY,t.target===this.map&&(t.stopPropagation(),e.width="0px",e.height="0px",e.top=r+"px",e.left=i+"px",e.display="block",this.i=r,this.g=i)},p.gk=function(t){var e=t.currentPointer,r=e.viewportX,i=e.viewportY;e=this.g;var n=this.i,o=this.b.style;t.target===this.map&&(t.stopPropagation(),t=r-e,r=i-n,o.left=e+(0>t?t:0)+"px",o.top=n+(0>r?r:0)+"px",o.width=Math.abs(t)+"px",o.height=Math.abs(r)+"px")},p.ek=function(t){var e=this.map,r=t.currentPointer;t.target===this.map&&(t.stopPropagation(),this.b.style.display="none",e.c.Wb({bounds:tg([e.Pa(this.g,this.i),e.Pa(r.viewportX,r.viewportY)])},!0))},p.X=function(t,e){Ru.prototype.renderInternal.call(this,t,e),this.c.jc(this.pa().translate("zoom.rectangle"))},Tv.prototype.renderInternal=Tv.prototype.X,Rv("nl-NL",{"layers.normal":"Kaartweergave","layers.satellite":"Satelliet","layers.terrain":"Terrein","layer.transit":"Openbaar vervoer","layer.traffic":"Verkeerssituatie","layer.incidents":"Toon verkeersincidenten","layers.choose":"Weergave kiezen",minimap:"Minimap","scale.switchToImperial":"Overgaan naar mijlen","scale.switchToMetric":"Wijzigen naar km","scale.km":"km","scale.m":"m","scale.mi":"mi","scale.ft":"ft","zoom.out":"Uitzoomen","zoom.in":"Inzoomen","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"Openbaar vervoer","traffic.MISCELLANEOUS":"Diversen","traffic.ACCIDENT":"Ongeval","traffic.OTHER_NEWS":"Meer informatie","traffic.OTHER":"Meer informatie","traffic.PLANNED_EVENT":"Geplande afzetting","traffic.ROAD_HAZARD":"Gevaar op de weg","traffic.ROAD_CLOSURE":"Rijbaan afgesloten","traffic.WEATHER":"Weer","traffic.CONGESTION":"Verkeersopstopping","traffic.CONSTRUCTION":"Wegwerkzaamheden","traffic.DISABLED_VEHICLE":"Voertuig met pech","traffic.LANE_RESTRICTION":"Rijstrookbeperking","traffic.from":"Begintijd:","traffic.until":"Geschatte eindtijd:","distance.measurement":"Measure distance"}),Rv("pt-PT",{"layers.normal":"Vista do mapa","layers.satellite":"Satlite","layers.terrain":"Terreno","layer.transit":"Transportes pblicos","layer.traffic":"Condies de trnsito","layer.incidents":"Mostrar incidentes de trnsito","layers.choose":"Escolher vista",minimap:"Minimap","scale.switchToImperial":"Mudar para milhas","scale.switchToMetric":"Mudar para km","scale.km":"km","scale.m":"m","scale.mi":"mi","scale.ft":"ft","zoom.out":"Diminuir","zoom.in":"Aumentar","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"Transportes pblicos","traffic.MISCELLANEOUS":"Diversos","traffic.ACCIDENT":"Acidente","traffic.OTHER_NEWS":"Outras notcias","traffic.OTHER":"Outras notcias","traffic.PLANNED_EVENT":"Evento planeado","traffic.ROAD_HAZARD":"Perigo na estrada","traffic.ROAD_CLOSURE":"Estrada fechada","traffic.WEATHER":"Meteorologia","traffic.CONGESTION":"Congestionamento","traffic.CONSTRUCTION":"Construo","traffic.DISABLED_VEHICLE":"Veculo avariado","traffic.LANE_RESTRICTION":"Limitao da faixa de rodagem","traffic.from":"Hora de incio:","traffic.until":"Hora de fim prevista:","distance.measurement":"Measure distance"}),Rv("ru-RU",{"layers.normal":" ","layers.satellite":"","layers.terrain":"","layer.transit":" ","layer.traffic":" ","layer.incidents":"  ","layers.choose":" ",minimap:"Minimap","scale.switchToImperial":" ","scale.switchToMetric":" ","scale.km":"","scale.m":"","scale.mi":"","scale.ft":"","zoom.out":"","zoom.in":"","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":" ","traffic.MISCELLANEOUS":" ","traffic.ACCIDENT":"","traffic.OTHER_NEWS":" ","traffic.OTHER":" ","traffic.PLANNED_EVENT":" ","traffic.ROAD_HAZARD":" ","traffic.ROAD_CLOSURE":" ","traffic.WEATHER":"","traffic.CONGESTION":"","traffic.CONSTRUCTION":"","traffic.DISABLED_VEHICLE":" ","traffic.LANE_RESTRICTION":"  ","traffic.from":" :","traffic.until":"  :","distance.measurement":" "}),Rv("fi-FI",{"layers.normal":"Karttankym","layers.satellite":"Satelliitti","layers.terrain":"Maasto","layer.transit":"Julkinen liikenne","layer.traffic":"Liikenneolosuhteet","layer.incidents":"Nyt liikennetapahtumat","layers.choose":"Valitse nkym",minimap:"Minimap","scale.switchToImperial":"Vaihda maileihin","scale.switchToMetric":"Vaihda kilometreihin","scale.km":"km","scale.m":"m","scale.mi":"mi","scale.ft":"ft","zoom.out":"Loitonna","zoom.in":"Lhenn","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"Julkinen liikenne","traffic.MISCELLANEOUS":"Erittelemtn syy","traffic.ACCIDENT":"Onnettomuus","traffic.OTHER_NEWS":"Muu tapahtuma","traffic.OTHER":"Muu tapahtuma","traffic.PLANNED_EVENT":"Suunniteltu tapahtuma","traffic.ROAD_HAZARD":"Vaara tiell","traffic.ROAD_CLOSURE":"Tie suljettu","traffic.WEATHER":"S","traffic.CONGESTION":"Ruuhka","traffic.CONSTRUCTION":"Rakennusty","traffic.DISABLED_VEHICLE":"Pyshtynyt ajoneuvo","traffic.LANE_RESTRICTION":"Kaista rajoitus","traffic.from":"Alkamisaika:","traffic.until":"Arvioitu pttymisaika:","distance.measurement":"Measure distance"}),Rv("pt-BR",{"layers.normal":"Exibio do mapa","layers.satellite":"Satlite","layers.terrain":"Terreno","layer.transit":"Transporte pblico","layer.traffic":"Condies do trnsito","layer.incidents":"Mostrar incidentes no trnsito","layers.choose":"Escolher exibio",minimap:"Minimap","scale.switchToImperial":"Mudar para milhas","scale.switchToMetric":"Mudar para km","scale.km":"km","scale.m":"m","scale.mi":"milhas","scale.ft":"ps","zoom.out":"Menos zoom","zoom.in":"Mais zoom","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"Transporte pblico","traffic.MISCELLANEOUS":"Miscelnea","traffic.ACCIDENT":"Acidente","traffic.OTHER_NEWS":"Outras notcias","traffic.OTHER":"Outras notcias","traffic.PLANNED_EVENT":"Evento planejado","traffic.ROAD_HAZARD":"Risco na estrada","traffic.ROAD_CLOSURE":"Estrada fechada","traffic.WEATHER":"Clima","traffic.CONGESTION":"Congestionamento","traffic.CONSTRUCTION":"Construo","traffic.DISABLED_VEHICLE":"Veculo incapacitado","traffic.LANE_RESTRICTION":"Restrio de pista","traffic.from":"Hora de incio:","traffic.until":"Tempo final estimado:","distance.measurement":"Measure distance"}),Rv("zh-CN",{"layers.normal":"","layers.satellite":"","layers.terrain":"","layer.transit":"","layer.traffic":"","layer.incidents":"","layers.choose":"",minimap:"Minimap","scale.switchToImperial":"","scale.switchToMetric":"","scale.km":"","scale.m":"","scale.mi":"","scale.ft":"","zoom.out":"","zoom.in":"","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"","traffic.MISCELLANEOUS":"","traffic.ACCIDENT":"","traffic.OTHER_NEWS":"","traffic.OTHER":"","traffic.PLANNED_EVENT":"","traffic.ROAD_HAZARD":"","traffic.ROAD_CLOSURE":"","traffic.WEATHER":"","traffic.CONGESTION":"","traffic.CONSTRUCTION":"","traffic.DISABLED_VEHICLE":"","traffic.LANE_RESTRICTION":"","traffic.from":"","traffic.until":"","distance.measurement":"Measure distance"}),Rv("es-ES",{"layers.normal":"Mapa","layers.satellite":"Satlite","layers.terrain":"Terreno","layer.transit":"Transporte pblico","layer.traffic":"Estado del trfico","layer.incidents":"Mostrar incidentes de trfico","layers.choose":"Elija una vista",minimap:"Minimap","scale.switchToImperial":"Cambiar a millas","scale.switchToMetric":"Cambiar a km","scale.km":"km","scale.m":"m","scale.mi":"mi","scale.ft":"ft","zoom.out":"Alejar","zoom.in":"Acercar","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"Transporte pblico","traffic.MISCELLANEOUS":"Varios","traffic.ACCIDENT":"Accidente","traffic.OTHER_NEWS":"Ms noticias","traffic.OTHER":"Ms noticias","traffic.PLANNED_EVENT":"Acto programado","traffic.ROAD_HAZARD":"Riesgo en carretera","traffic.ROAD_CLOSURE":"Carretera cerrada","traffic.WEATHER":"Tiempo","traffic.CONGESTION":"Atasco","traffic.CONSTRUCTION":"Construccin","traffic.DISABLED_VEHICLE":"Vehculo averiado","traffic.LANE_RESTRICTION":"Restriccin de carril","traffic.from":"Inicio:","traffic.until":"Finalizacin estimada:","distance.measurement":"Measure distance"}),Rv("fr-FR",{"layers.normal":"Carte","layers.satellite":"Satellite","layers.terrain":"Terrain","layer.transit":"Transports publics","layer.traffic":"Conditions de circulation","layer.incidents":"Afficher les incidents de circulation","layers.choose":"Choisir la vue",minimap:"Minimap","scale.switchToImperial":"Passer en miles","scale.switchToMetric":"Passer en km","scale.km":"km","scale.m":"m","scale.mi":"mi","scale.ft":"ft","zoom.out":"Zoom arrire","zoom.in":"Zoom avant","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"Transports publics","traffic.MISCELLANEOUS":"Divers","traffic.ACCIDENT":"Accident","traffic.OTHER_NEWS":"Autre","traffic.OTHER":"Autre","traffic.PLANNED_EVENT":"vnement prvu","traffic.ROAD_HAZARD":"Danger routier","traffic.ROAD_CLOSURE":"Chausse ferme","traffic.WEATHER":"Mto","traffic.CONGESTION":"Embouteillage","traffic.CONSTRUCTION":"Travaux","traffic.DISABLED_VEHICLE":"Vhicule en panne","traffic.LANE_RESTRICTION":"Restriction de voie","traffic.from":"Date ou heure de dbut:","traffic.until":"Date et heure de fin estimes:","distance.measurement":"Measure distance"}),Rv("pl-PL",{"layers.normal":"Widok mapy","layers.satellite":"Satelita","layers.terrain":"Teren","layer.transit":"Transport publiczny","layer.traffic":"Warunki drogowe","layer.incidents":"Poka zdarzenia drogowe","layers.choose":"Wybierz widok",minimap:"Minimap","scale.switchToImperial":"Zmie na mile","scale.switchToMetric":"Zmie na km","scale.km":"km","scale.m":"m","scale.mi":"mi","scale.ft":"ft","zoom.out":"Oddal","zoom.in":"Przybli","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"Transport publiczny","traffic.MISCELLANEOUS":"Inne zdarzenie","traffic.ACCIDENT":"Wypadek","traffic.OTHER_NEWS":"Inne wiadomoci","traffic.OTHER":"Inne wiadomoci","traffic.PLANNED_EVENT":"Zdarzenie planowane","traffic.ROAD_HAZARD":"Niebezpieczestwo na drodze","traffic.ROAD_CLOSURE":"Jezdnia zamknita","traffic.WEATHER":"Pogoda","traffic.CONGESTION":"Korek","traffic.CONSTRUCTION":"Budowa","traffic.DISABLED_VEHICLE":"Uszkodzony pojazd","traffic.LANE_RESTRICTION":"Ograniczenie pasa ruchu","traffic.from":"Data rozpoczcia:","traffic.until":"Przybliona data zakoczenia:","distance.measurement":"Measure distance"}),Rv("de-DE",{"layers.normal":"Kartenansicht","layers.satellite":"Satellit","layers.terrain":"Gelnde","layer.transit":"ffentliche Verkehrsmittel","layer.traffic":"Verkehrslage","layer.incidents":"Verkehrsstrungen anzeigen","layers.choose":"Ansicht auswhlen",minimap:"Minimap","scale.switchToImperial":"Umrechnung in Meilen","scale.switchToMetric":"Umrechnung in Kilometer","scale.km":"km","scale.m":"m","scale.mi":"mi","scale.ft":"ft","zoom.out":"Verkleinern","zoom.in":"Vergrern","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"ffentliche Verkehrsmittel","traffic.MISCELLANEOUS":"Diverse","traffic.ACCIDENT":"Unfall","traffic.OTHER_NEWS":"Anderes Ereignis","traffic.OTHER":"Anderes Ereignis","traffic.PLANNED_EVENT":"Geplantes Ereignis","traffic.ROAD_HAZARD":"Verkehrshindernis","traffic.ROAD_CLOSURE":"Fahrbahn gesperrt","traffic.WEATHER":"Wetter","traffic.CONGESTION":"Verkehrsstau","traffic.CONSTRUCTION":"Baustelle","traffic.DISABLED_VEHICLE":"Liegengebliebenes Fahrzeug","traffic.LANE_RESTRICTION":"Fahrstreifensperrung","traffic.from":"Beginn:","traffic.until":"Voraussichtliches Ende:","distance.measurement":"Measure distance"}),Rv("tr-TR",{"layers.normal":"Harita grnm","layers.satellite":"Uydu","layers.terrain":"Arazi","layer.transit":"Toplu ulam","layer.traffic":"Trafik durumlar","layer.incidents":"Trafik olaylarn gster","layers.choose":"Grnm se",minimap:"Minimap","scale.switchToImperial":"Mile dntr","scale.switchToMetric":"Kilometreye dntr","scale.km":"km","scale.m":"m","scale.mi":"mil","scale.ft":"ft","zoom.out":"Uzaklatr","zoom.in":"Yaknlatr","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"Toplu ulam","traffic.MISCELLANEOUS":"eitli","traffic.ACCIDENT":"Kaza","traffic.OTHER_NEWS":"Dier haberler","traffic.OTHER":"Dier haberler","traffic.PLANNED_EVENT":"Planl etkinlik","traffic.ROAD_HAZARD":"Yol tehlikesi","traffic.ROAD_CLOSURE":"Yol kapal","traffic.WEATHER":"Hava durumu","traffic.CONGESTION":"Younluk","traffic.CONSTRUCTION":"Yol almas","traffic.DISABLED_VEHICLE":"Ara arzas","traffic.LANE_RESTRICTION":"erit kstlamas","traffic.from":"Balang zaman:","traffic.until":"Tahmini biti zaman:","distance.measurement":"Measure distance"}),Rv("it-IT",{"layers.normal":"Vista mappa","layers.satellite":"Satellite","layers.terrain":"Terreno","layer.transit":"Mezzi pubblici","layer.traffic":"Condizioni del traffico","layer.incidents":"Mostra incidenti stradali","layers.choose":"Scegli vista",minimap:"Minimap","scale.switchToImperial":"Passa a miglia","scale.switchToMetric":"Passa a km","scale.km":"km","scale.m":"m","scale.mi":"mi","scale.ft":"ft","zoom.out":"Zoom indietro","zoom.in":"Zoom avanti","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"Mezzi pubblici","traffic.MISCELLANEOUS":"Varie","traffic.ACCIDENT":"Incidente","traffic.OTHER_NEWS":"Altre notizie","traffic.OTHER":"Altre notizie","traffic.PLANNED_EVENT":"Evento pianificato","traffic.ROAD_HAZARD":"Strada dissestata","traffic.ROAD_CLOSURE":"Strada chiusa","traffic.WEATHER":"Maltempo","traffic.CONGESTION":"Ingorgo","traffic.CONSTRUCTION":"Lavori in corso","traffic.DISABLED_VEHICLE":"Veicolo in panne","traffic.LANE_RESTRICTION":"Restrizione di corsia","traffic.from":"Ora di inizio:","traffic.until":"Ora di fine stimata:","distance.measurement":"Measure distance"}),Rv("en-US",{"layers.normal":"Map view","layers.satellite":"Satellite","layers.terrain":"Terrain","layer.transit":"Public transport","layer.traffic":"Traffic conditions","layer.incidents":"Show traffic incidents","layers.choose":"Choose view",minimap:"Minimap","scale.switchToImperial":"Change to miles","scale.switchToMetric":"Change to km","scale.km":"km","scale.m":"m","scale.mi":"mi","scale.ft":"ft","zoom.out":"Zoom out","zoom.in":"Zoom in","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"Public transport","traffic.MISCELLANEOUS":"Miscellaneous","traffic.ACCIDENT":"Accident","traffic.OTHER_NEWS":"Other news","traffic.OTHER":"Other news","traffic.PLANNED_EVENT":"Planned event","traffic.ROAD_HAZARD":"Road hazard","traffic.ROAD_CLOSURE":"Roadway closed","traffic.WEATHER":"Weather","traffic.CONGESTION":"Congestion","traffic.CONSTRUCTION":"Construction","traffic.DISABLED_VEHICLE":"Disabled vehicle","traffic.LANE_RESTRICTION":"Lane restriction","traffic.from":"Start time:","traffic.until":"Estimated end time:","distance.measurement":"Measure distance"}),t("H.ui.i18n.Localization",Uv),Uv.prototype.zm=function(){return this.a},Uv.prototype.getLocale=Uv.prototype.zm,Uv.prototype.sm=function(){return Object.keys(this.b)},Uv.prototype.getKeys=Uv.prototype.sm,Uv.prototype.Nf=function(t){return!(!this.b||!this.b[t])},Uv.prototype.hasKey=Uv.prototype.Nf,Uv.prototype.translate=function(t){var e=this.b[t];if(!Cc(e))throw Error("Translation missing for key '"+t+"'.");return e},Uv.prototype.translate=Uv.prototype.translate,u(Vv,Ru),t("H.ui.ScaleBar",Vv),Vv.prototype.X=function(t,e){Ru.prototype.renderInternal.call(this,t,e),t.innerHTML='<svg height="12" version="1.1" xmlns="http://www.w3.org/2000/svg"><polyline style="fill:none; stroke:white; stroke-width:4" points="2,2 2,10 98,10 98,2"/><polyline style="fill:none; stroke:black; stroke-width:2" points="2,2 2,10 98,10 98,2"/></svg><div style="padding: 0 0 0 10px"></div>',t.style.direction="ltr",this.c=t.firstChild,e=this.c.childNodes,this.b=e[0],this.g=e[1],this.i=t.lastChild,this.l=ev.METRIC,this.s=A((function(t){this.dc()||(this.dispatchEvent("toggleunitsystem"),t.preventDefault())}),this),this.u=A((function(t){t.preventDefault()}),this),Bu(t,"start",this.u),Bu(t,"end",this.s),this.jc(this.pa().translate("scale.switchToImperial")),this.update()},Vv.prototype.renderInternal=Vv.prototype.X,Vv.prototype.Ia=function(t){this.map&&this.map.removeEventListener("mapviewchange",this.update),t&&t.addEventListener("mapviewchange",this.update),Ru.prototype.Ia.apply(this,arguments)},Vv.prototype.setMap=Vv.prototype.Ia,Vv.prototype.capture=function(t,e,r){var i=this.N(),n=i.ownerDocument,o=n.createElement("canvas"),a=o.getContext("2d"),s=n.createElementNS("http://www.w3.org/2000/svg","svg"),l=n.createElementNS("http://www.w3.org/2000/svg","foreignObject"),c=lf(i,n,!1);n=parseFloat(i.offsetWidth)+1;var u=parseFloat(i.offsetHeight),h=n*t;t*=u,o.width=h,o.height=t,s.setAttribute("xmlns","http://www.w3.org/2000/svg"),s.setAttribute("width",h),s.setAttribute("height",t),s.setAttribute("viewBox","0 0 "+n+" "+u),l.setAttribute("width","100%"),l.setAttribute("height","100%"),s.appendChild(l),c.setAttribute("width","100%"),c.setAttribute("height","100%"),c.setAttribute("xmlns","http://www.w3.org/1999/xhtml");var p=window.getComputedStyle(i);"box-shadow display align-items font font-family font-size height text-shadow direction".split(" ").forEach((function(t){c.style.setProperty(t,p.getPropertyValue(t))})),l.appendChild(c),new tf("image",i=bf(s.outerHTML)).then((function(t){a.drawImage(t,0,0),e(o)}),r)},Vv.prototype.capture=Vv.prototype.capture,Vv.prototype.Qe=function(t){this.l=t,this.jc("imperial"===t?this.pa().translate("scale.switchToMetric"):this.pa().translate("scale.switchToImperial")),this.update()},Vv.prototype.onUnitSystemChange=Vv.prototype.Qe,Vv.prototype.update=function(){var t;if(this.N()){this.c=this.c,this.b=this.b;var e=this.m,r=0,i=this.map;if(i){var n=Math.round(.5*i.b.width),o=Math.round(.5*i.b.height);(t=i.Pa(n,o))&&(i=i.Pa(n+1,o))&&(r=100*t.Wa(i))}r&&(this.l===ev.IMPERIAL?1609.344>r?(i=r/.3048006,t=this.pa().translate("scale.ft")):(i=r/1609.344,t=this.pa().translate("scale.mi")):1e3>r?(i=r,t=this.pa().translate("scale.m")):(i=r/1e3,t=this.pa().translate("scale.km")),(i=(r=Math.pow(10,Math.floor(Math.log(i)/Math.LN10)))/i*100)<e/5?(r*=5,i*=5):i<e/2?(r*=2,i*=2):i>e&&(r/=2,i/=2),i=Math.round(i),this.c.setAttribute("width",i),this.i.textContent=r+" "+t,this.b.points.getItem(2).x=this.g.points.getItem(2).x=this.b.points.getItem(3).x=this.g.points.getItem(3).x=i-2)}},u(Wv,Y),t("H.ui.context.Item",Wv),Wv.prototype.c=function(t){var e=this.b,r=e.callback;r&&!e.isDisabled()&&(this.dispatchEvent("click"),r(t))},Wv.prototype.X=function(){var t=this,e=this.N();Ee(e,"click",this.c),e.addEventListener("keyup",(function(e){13==e.keyCode&&t.c(e)})),this.a()},Wv.prototype.renderInternal=Wv.prototype.X,Wv.prototype.a=function(){var t=this.N(),e=this.b;e.callback?(this.Ka("clickable"),t.setAttribute("tabindex","0")):(this.kb("clickable"),t.removeAttribute("tabindex")),e.isDisabled()?this.Ka("disabled"):this.kb("disabled"),e=e.getLabel(),su.textContent=e,t.innerHTML=su.innerHTML.split("\n").join("<br/>")},Wv.prototype.o=function(){Y.prototype.o.call(this),this.b.removeEventListener("update",this.a)},u(Xv,Qu),t("H.ui.context.Menu",Xv),Xv.prototype.X=function(){Qu.prototype.X.apply(this,arguments),this.c.forEach((function(t){t===Se?t=new Y("div","H_context_menu_item_separator"):(t=new Wv(t)).addEventListener("click",this.g.bind(this)),this.Ja(t)}),this),Ee(this.N(),["mousedown","touchstart","pointerdown","wheel"],(function(t){t.stopPropagation()}))},Xv.prototype.renderInternal=Xv.prototype.X,Xv.prototype.setPosition=function(t,e){if(this.b){var r=this.N(),i=r.offsetWidth,n=r.offsetHeight,o=this.b,a=o.b.width;t+i>a&&t>a/2&&(t-=i),e+n>(o=o.b.height)&&e>o/2&&(e-=n),lu(r,t,e)}},Xv.prototype.setPosition=Xv.prototype.setPosition,Xv.prototype.g=function(){this.b&&this.b.dispatchEvent(new ud("contextmenuclose",this.b))},Xv.prototype.Ia=function(t){this.b=t},Xv.prototype.setMap=Xv.prototype.Ia,u(Yv,Y),t("H.ui.InfoBubble",Yv),Yv.prototype.a=null,Yv.prototype.ya=function(){return this.m},Yv.prototype.setPosition=function(t){this.m=ng(t),this.update()},Yv.prototype.setPosition=Yv.prototype.setPosition,Yv.prototype.Ia=function(t){this.a=t},Yv.prototype.X=function(t,e){this.l=yu(e,"div","H_ib_body"),this.tailEl_=yu(e,"div","H_ib_tail"),this.c=yu(e,"div","H_ib_close H_btn",'<svg version="1.1" class="H_icon" viewBox="0 0 12 12"><path d="m8.12 6 3.66-3.66c.29-.29.29-.76 0-1.05l-1.06-1.06c-.29-.29-.76-.29-1.05 0l-3.66 3.66-3.66-3.66c-.29-.29-.76-.29-1.05 0l-1.06 1.06c-.29.29-.3.76 0 1.05l3.66 3.66-3.66 3.66c-.29.29-.29.76 0 1.05l1.06 1.06c.29.29.76.29 1.05 0l3.66-3.66 3.66 3.66c.29.29.76.29 1.05 0l1.06-1.06c.29-.29.3-.76 0-1.05z"></path></svg>'),this.b=yu(e,"div","H_ib_content","&nbsp;"),this.l.appendChild(this.c),this.l.appendChild(this.b),Bu(this.c,"start",this.u),this.a.c.addEventListener("sync",this.update),this.a.b.addEventListener("sync",this.update),t.appendChild(this.l),t.appendChild(this.tailEl_),this.$e(this.g)},Yv.prototype.renderInternal=Yv.prototype.X,Yv.prototype.i=function(){this.s||(this.s=setTimeout(this.update,0))},Yv.prototype.update=function(){var t,e=this.N(),r=this.a,i="none";if(this.s=0,r&&e&&this.getState()===Zv.OPEN){if(t=r.Da(this.m)){var n=t.x;t=t.y,(n>=-(r=r.b.width)||n<=2*r||t>=-r||t<=2*r)&&(i="",mu?(e.style.left=n-r+"px",e.style.top=t+"px"):lu(e,n,t))}e.style.display=i,""===i&&(e.style.visibility="visible")}};var Zv={OPEN:"open",CLOSED:"closed"};function $v(t,e){this.a=t,this.b=null,this.f=0,this.c=22,this.i=e,this.Xf=A(this.Xf,this),this.Sg=A(this.Sg,this),(t=this.a.Lb()).addEventListener("mapviewchange",this.bo,!1,this),this.g=t.f.type,(t=t.a).addEventListener("add",this.Sn,!1,this),t.addEventListener("remove",this.Tn,!1,this)}function aw(t,e,r){var i=e.ca();i&&void 0!==r&&r&&i.removeEventListener("tap",t.Xf),e?(i.addEventListener("tap",t.Xf),t.f=i.min,t.c=i.max):(t.f=0,t.c=22)}function bw(t){return window.H.service&&(t.ca()instanceof window.H.service.traffic.incidents.Provider||t.ca()instanceof window.H.service.trafficVectorTile.Provider&&"incident"===t.ca().s().b)}function cw(t,e){try{return t.Qf=!0,new t(e)}finally{t.Qf=!1}}function dw(t,e){var r=t.N(),i=this;F.call(this),this.c=t,this.i=r.ownerDocument,this.f={},this.b=[],this.S=yu(this.i,"div","H_ui"),this.setDirection(),this.P=A((function(t){this.m.put(t.target,t.target.Mc)}),this),this.addEventListener("alignmentchange",this.P),this.L=A((function(){this.fl()}),this),this.addEventListener("toggleunitsystem",this.L),this.S.addEventListener("contextmenu",this.J,!1),this.S.addEventListener("MSHoldVisual",this.J,!1),this.c.addEventListener("contextmenu",this.D,!1,this),this.c.addEventListener("contextmenuclose",this.u,!1,this),this.c.tb(this.F.bind(this)),this.a=null,this.s=-1,this.m=new Uu(this.S,this.i),this.g=ev.METRIC,ew(this,"en-US"),e&&fw(this,e),r.appendChild(this.S),x.setTimeout((function(){i.m.update()}),1)}function ew(t,e){if(Cc(e))var r=e;else{if(!(e instanceof Uv))throw Error("The locale parameter must be a string or a H.ui.i18n.Localization object.");r=e.a;var i=e}if(!r)throw Error("No locale was defined.");if(i)t.l=i;else{if(!(0<=Ov.indexOf(r)))throw Error("Locale ["+r+"] is not supported.");t.l=new Uv(r)}}function fw(t,e){var r,i;e.unitSystem&&t.vg(e.unitSystem),(i=e.locale)&&ew(t,i),(r=e.zoom)&&t.Bd("zoom",new Su(Ea(r)?r:null)),(r=e.zoomrectangle)&&t.Bd("zoomrectangle",new Tv(Ea(r)?r:null)),(r=e.mapsettings)&&t.Bd("mapsettings",new Ev(Ea(r)?r:null)),(r=e.scalebar)&&t.Bd("scalebar",new Vv(Ea(r)?r:null)),(r=e.distancemeasurement)&&t.Bd("distancemeasurement",new wv(Ea(r)?r:null))}function hw(t,e,r,i){for(var n=t,o=0;n&&o<e.length;o++)n=n[e[o]];if(n&&n!==t)return t={label:r,layer:n},i.push(t),t}function gw(t,e,r){var i=[],n=[],o=e.raster;if(t===kk.P2D&&o){if(hw(e,["raster","normal","map"],"layers.normal",i),hw(e,["raster","satellite","map"],"layers.satellite",i),hw(e,["raster","terrain","map"],"layers.terrain",i),r)for(var a in o)if(o[a]&&o[a].map===r){var s=a;break}hw(e,["raster","normal","trafficincidents"],"layer.incidents",n),hw(e,["raster",s,"transit"],"layer.transit",n)}else hw(e,["vector","normal","map"],"layers.normal",i),t===kk.WEBGL?(hw(e,["raster","satellite","map"],"layers.satellite",i),hw(e,["vector","normal","traffic"],"layer.traffic",n),hw(e,["vector","normal","trafficincidents"],"layer.incidents",n)):(r=hw(e,["hybrid","day","vector"],"",[]),(o=hw(e,["hybrid","day","raster"],"layers.satellite",i)).layer=[o.layer,r.layer],window.H.service&&(r=e.vector.traffic.map.ca().s().v(),e=cw(window.H.service.trafficVectorTile.Service,{baseUrl:r,layer:"flow"}),r=cw(window.H.service.trafficVectorTile.Service,{baseUrl:r,layer:"incident"}),s=Ao()+"/harp/oslo/normal.day.json",o=new H.map.render.harp.Style(s),s=new H.map.render.harp.Style(s),e=e.createLayer(o,{engineType:t}),t=r.createLayer(s,{engineType:t}),n.push({label:"layer.traffic",layer:e},{label:"layer.incidents",layer:t})));return{alignment:"bottom-right",baseLayers:i,layers:n}}function iw(t,e){if(e=e||{},!(t&&t instanceof sl))throw Error("Base layer is mandatory for overview UI element");Ru.call(this),this.c=new gv({label:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="H_icon"><g fill-rule="evenodd" transform="translate(2 2)"><rect width="9" height="9" x="10" y="10"/><rect class="H_icon_stroke" width="18" height="18" x="1" y="1" fill="none" stroke="#000" stroke-width="2" rx="2"/></g></svg>',onStateChange:A(this.g,this)}),this.Ja(this.c),this.b=new jw(t,e.zoomDelta,e.scaleX,e.scaleY),this.Vb(e.alignment||"right-bottom"),this.Ja(this.b)}function jw(t,e,r,i){this.l=t,"number"==typeof e&&(this.jl=e),"number"==typeof r&&(this.tk=r),"number"==typeof i&&(this.uk=i),Qu.call(this,"div","H_overview")}function lw(t){!t.zd&&kw(t),t.kb("H_overview_active"),t.b.removeEventListener("mapviewchange",t.Fi,!1,t)}function kw(t,e){var r=t.b.b.element,i=t.N().style,n=r.offsetWidth/t.tk/10;r=r.offsetHeight/t.uk/10;var o=t.g.style;e?(i.width=n+"em",i.height=r+"em",o.width=n+"em",o.height=r+"em"):i.width=i.height="0em",t.c.b.resize()}function mw(t,e){if(!t)throw new D(mw,0,t);mw.j.constructor.call(this,t),this.b={},this.c=!(!e||!e.oc),this.f=nw++}Yv.State=Zv,Yv.prototype.C=Zv.OPEN,Yv.prototype.getState=function(){return this.C},Yv.prototype.getState=Yv.prototype.getState,Yv.prototype.O=function(t){t!==this.C&&(this.C=t,this.dispatchEvent("statechange")),(t=this.N())&&(this.C===Zv.OPEN?(t.style.display="block",t.style.visibility="hidden",this.i()):t.style.display="none")},Yv.prototype.setState=Yv.prototype.O,Yv.prototype.close=function(){this.O(Zv.CLOSED)},Yv.prototype.close=Yv.prototype.close,Yv.prototype.open=function(){this.O(Zv.OPEN)},Yv.prototype.open=Yv.prototype.open,Yv.prototype.Ul=function(){return this.b||null},Yv.prototype.getContentElement=Yv.prototype.Ul,Yv.prototype.$e=function(t){if(t){if("string"!=typeof t&&("number"!=typeof t.nodeType||"string"!=typeof t.nodeName))throw Error("InfoBubble content must be a string or HTML node.");this.g=t}else this.g="";this.N()&&(this.g?(this.b.innerHTML="","string"==typeof this.g?this.b.innerHTML=t:"number"==typeof t.nodeType&&"string"==typeof t.nodeName&&this.b.appendChild(t)):this.b.innerHTML="&nbsp;",this.i())},Yv.prototype.setContent=Yv.prototype.$e,Yv.prototype.o=function(){this.close(),this.$e(""),this.c&&Cu(this.c,"end",this.u),this.a&&(this.a.c.removeEventListener("sync",this.update),this.a.b.removeEventListener("sync",this.update)),Y.prototype.o.call(this)},p=$v.prototype,p.bo=function(t){var e=t.newValue.zoom;this.b&&t.modifiers&t.ZOOM&&(e<this.f||e>this.c)&&this.b.close()},p.Sn=function(t){bw(t=t.added)&&aw(this,t)},p.Tn=function(t){bw(t=t.removed)&&(this.b&&this.b.close(),aw(this,t,!0))},p.Xf=function(t){var e,r=this.g===kk.HARP;t.target&&(e=t.target.getData())&&0===t.currentPointer.button&&(r?(e=this.a.Lb().Pa(t.currentPointer.viewportX,t.currentPointer.viewportY),(r=t.target.getData()?t.target.getData().properties.id:null)&&this.i.requestIncidentById(r,{locationReferencing:"none",lang:this.a.pa().a,units:this.a.g===ev.METRIC?"metric":"imperial"},this.hl.bind(this,e),console.error)):(r=t.target.ga(),this.hl(r,e)),t.stopPropagation())},p.hl=function(t,e){if(this.g===kk.HARP){e=e.incidentDetails;var r=this.a.pa().a,i=e.type,n=i.split(/(?=[A-Z])/).join("_").toUpperCase();this.a.pa().Nf("traffic."+n)&&(i=this.a.pa().translate("traffic."+n)),t={position:t,title:i,description:e.description.value,startTime:new Date(e.startTime).toLocaleString(r).split(",").join(" "),endTime:new Date(e.endTime).toLocaleString(r).split(",").join(" ")}}else r=e.TRAFFIC_ITEM_TYPE_DESC.replace(" ","_"),t={position:t,title:r=this.a.pa().Nf("traffic."+r)?this.a.pa().translate("traffic."+r):e.TRAFFIC_ITEM_DESCRIPTION[e.TRAFFIC_ITEM_DESCRIPTION.length-1].value,description:e.TRAFFIC_ITEM_DESCRIPTION[0].value,startTime:e.START_TIME,endTime:e.END_TIME};this.Sg(t)},p.Sg=function(t){var e=t.position,r=t.title,i=t.description,n=t.startTime;t=t.endTime,this.b||(this.b=new Yv(e),this.b.Ka("H_tib"),this.a.Yi(this.b)),this.b.setPosition(e),this.b.$e('<div class="H_tib_content"><div class="H_rdo_title" dir="auto">{{title}}</div><div class="H_tib_desc" dir="auto"><span>{{desc}}</span><div class="H_tib_time"><span class="H_tib_left">{{traffic.from}}</span><span class="H_tib_right">{{from}}</span><br/><span class="H_tib_left">{{traffic.until}}</span><span class="H_tib_right">{{until}}</span></div></div>'.replace("{{title}}",r).replace("{{desc}}",i).replace("{{traffic.from}}",this.a.pa().translate("traffic.from")).replace("{{traffic.until}}",this.a.pa().translate("traffic.until")).replace("{{from}}",n).replace("{{until}}",t)),this.b.open()},u(dw,F),t("H.ui.UI",dw),dw.prototype.J=function(t){for(var e=t.target;e&&!/\bH_ib_content\b/.test(e.className);)e=e.parentNode;e||t.preventDefault()},dw.prototype.N=function(){return this.S},dw.prototype.getElement=dw.prototype.N,dw.prototype.Lb=function(){return this.c},dw.prototype.getMap=dw.prototype.Lb,dw.prototype.dn=function(){return this.g},dw.prototype.getUnitSystem=dw.prototype.dn,dw.prototype.vg=function(t){var e,r=this.f;if(t!==this.g)for(e in this.g=t,r)r[e]instanceof Ru&&r[e].onUnitSystemChange(this.g)},dw.prototype.setUnitSystem=dw.prototype.vg,dw.prototype.setDirection=function(t){this.S.setAttribute("dir",t||getComputedStyle(this.Lb().N()).direction)},dw.prototype.setDirection=dw.prototype.setDirection,dw.prototype.pa=function(){return this.l},dw.prototype.fl=function(){this.g===ev.METRIC?this.vg(ev.IMPERIAL):this.vg(ev.METRIC)},dw.prototype.toggleUnitSystem=dw.prototype.fl,dw.prototype.Yi=function(t){var e=this.b.length,r=this.S;if(0>this.b.indexOf(t)){t.ka(this),t.Ia(this.c);var i=t.W(this.i);e=0<e?this.b[e-1].N().nextSibling:this.S.firstChild,r.insertBefore(i,e),this.b.push(t)}},dw.prototype.addBubble=dw.prototype.Yi,dw.prototype.D=function(t){var e=t.items;this.a&&this.u(),clearTimeout(this.s),this.s=x.setTimeout(function(){e.length&&(this.a=new Xv(e),this.S.insertBefore(this.a.W(this.i),this.S.firstChild),this.a.ka(this),this.a.Ia(this.c),this.a.setPosition(t.viewportX,t.viewportY))}.bind(this),0)},dw.prototype.u=function(){this.a&&(this.a.F(),this.a=null)},dw.prototype.jo=function(t){var e=this.b.indexOf(t);-1<e&&(t.ka(null),t.Ia(null),this.b.splice(e,1),this.S.removeChild(t.N()))},dw.prototype.removeBubble=dw.prototype.jo,dw.prototype.Ql=function(){return this.b},dw.prototype.getBubbles=dw.prototype.Ql,dw.prototype.Bd=function(t,e){if(this.Ce(t))throw Error("A control with name ["+t+"] is already registered.");e.ka(this),e.Ia(this.c),e.xa=this.l,e.W(this.i),e.onUnitSystemChange(this.g),this.f[t]=e},dw.prototype.addControl=dw.prototype.Bd,dw.prototype.lo=function(t){var e=this.Ce(t);if(!e)throw Error("Control ["+t+"] not found in this UI's controls.");return e.T(),e.ka(null),e.Ia(null),Du(e),delete this.f[t],e},dw.prototype.removeControl=dw.prototype.lo,dw.prototype.Ce=function(t){return this.f[t]},dw.prototype.getControl=dw.prototype.Ce,dw.prototype.o=function(){for(var t in this.f)ju.hasOwnProperty.call(this.f,t)&&this.f[t].F();this.b.forEach((function(t){t.F()})),(t=this.S.parentNode)&&t.removeChild(this.S),F.prototype.o.call(this),delete this.S},dw.prototype.capture=function(t,e,r,i){var n=this.Ce("scalebar"),o=t.getContext("2d"),a=t.width,s=t.height,l=this.c.s,c=5+(l?l.N().childNodes[1].offsetHeight:0);n&&n.wc()?n.capture(e,(function(i){o.drawImage(i,a-i.width-5*e,s-i.height-c*e),r(t)}),i):r(t)},dw.prototype.capture=dw.prototype.capture,dw.createDefault=function(t,e,r){var i=t.f.type;if(r=new dw(t,{unitSystem:ev.METRIC,zoom:{alignment:"right-bottom"},mapsettings:gw(i,e,t.g),scalebar:{alignment:"bottom-right"},locale:r||"en-US"}),i===kk.P2D){var n=r.Ce("mapsettings"),o=function(){if(n.Lb()){var r=gw(i,e,t.g);Fv(n,r.baseLayers,r.layers)}};t.addEventListener(t.A.lf,o),r.tb((function(){t.removeEventListener(t.A.lf,o)})),n.tb((function(){t.removeEventListener(t.A.lf,o)}))}if(i===kk.HARP){if(window.H.service){var a=e.vector.traffic.map.ca().s().v(),s=new window.H.service.Url(a.i,a.c.split(".").slice(-2).join(".")),l=(s=cw(window.H.service.traffic.Service7,{platformBaseUrl:s})).v().getQuery();l.apikey=a.getQuery().apikey,s.v().bf(l),new $v(r,s)}}else new $v(r);return r},dw.prototype.Bo=function(){},dw.prototype.setTrafficIncidentsHandle=dw.prototype.Bo,u(iw,Ru),t("H.ui.Overview",iw),iw.prototype.ud=function(t){return this.b.ud(t),this},iw.prototype.setBaseLayer=iw.prototype.ud,iw.prototype.g=function(t){t.target.getState()===Fu.DOWN?(kw(t=this.b,!0),t.Fi(),t.Ka("H_overview_active"),t.b.addEventListener("mapviewchange",t.Fi,!1,t)):lw(this.b)},iw.prototype.X=function(t,e){Ru.prototype.renderInternal.call(this,t,e),this.c.N().style.float=this.Mc.match("right")?"right":"left",this.b.Ia(this.map),this.c.jc(this.pa().translate("minimap"))},iw.prototype.renderInternal=iw.prototype.X,iw.prototype.o=function(){this.b.F(),Y.prototype.o.call(this)},u(jw,Ru),jw.prototype.ud=function(t){this.c.ud(t)},jw.prototype.X=function(t,e){zu(t,e=yu(e,"div","H_overview_map")),this.g=e},jw.prototype.renderInternal=jw.prototype.X,jw.prototype.renderInternal=jw.prototype.X,p=jw.prototype,p.jl=3,p.tk=5,p.uk=5,p.Ia=function(t){this.b=t,this.c=new U(this.g,this.l,{pixelRatio:this.b.Xa(),engineType:this.b.f.type}),this.c.s.N().style.display="none",this.s=this.c.c,this.i=this.b.c},p.Fi=function(t){t&&t.modifiers&t.SIZE&&kw(this,!0),(t=this.i.jb()).zoom-=this.jl,this.s.Wb(t)},p.o=function(){jw.j.o.call(this),lw(this),this.c.F(),this.c=this.s=this.i=this.b=this.l=this.g=null},t("H.ui.buildInfo",(function(){return Hf("H-ui","1.51.0","a104c13",{region:"row"})})),u(mw,Cm);var nw=0;function ow(t,e){e=e||{},C(t,tl,ow,0),ow.j.constructor.call(this,t),this.oc=!!e.oc,this.c=e.fb||0,this.a=[],this.b={}}mw.prototype.W=function(t,e,r,i,n,o){var a=Ad(i),s=this.eb,l=a+(r.exp-s.pixelProjection.exp),c=s.min,u=s.max;i=s.tileSize;var h=s.ca().g,p=this.lb,f=p.Tc(),d=p.yb().w,y=r.w,g=r.x,v=r.y,m={};if(a<c||a>u)return wk.DONE;for(t=(n=s.requestTiles(t,l,n,o,this.f)).total,o=(n=n.tiles).length,this.g=r,this.l=e,this.a=l,f!==h&&p.ic(h),r=i=i*y/(Gd(2,l)*i),this.c||(i%1&&(g/=y=r/(i=Bd(i)),v/=y,y=Gd(2,l)*i),g=Bd(g),v=Bd(v)),this.i=r,l=-i,a=d+i,s=0;s<o;s++){if((c=(d=n[s]).data)&&c.tagName){for(r=e.x-(g-d.x*i),h=e.y-(v-d.y*i),p.Oc(c,r,h,i,i),f=r;(f-=y)>l;)p.Oc(c,f,h,i,i);for(f=r;(f+=y)<a;)p.Oc(c,f,h,i,i)}m[this.a+"_"+d.x+"_"+d.y]=d}return this.b=m,o===t?wk.DONE:wk.PENDING},mw.prototype.Ea=function(t,e,r){var i,n=this.i,o=n/this.eb.tileSize,a=this.g,s=this.l;if(vc(this.a)&&a){t=a.x+(t-s.x),e=a.y+(e-s.y);var l=Bd(a.w/n),c=a=Bd(t/n);s=Bd(e/n),Dd(c)>=l&&(c%=l),0>c&&(c=l+c),(l=this.b[this.a+"_"+c+"_"+s])&&l.Ea&&(i=l.Ea((t-n*a)/o,(e-n*s)/o,r))}return i||hf},mw.prototype.Rd=function(){return"2d"},u(ow,Cm),ow.prototype.W=function(t,e,r,i,n,o){var a,s,l=this.eb;i-=this.c,this.a.length=0;var c=this.b;if(this.b=a={},i>=l.min&&i<=l.max){var u=l.sd(t,i,n,o),h=u.overlays;if(t=h.length)for(h.sort(ph),i=this.lb,n=this.oc,o=0;o<t;o++){var p=(l=h[o]).K(),f=r.ib(p.Nb()),d=r.ib(p.Jb());p=r.w,f.x>=d.x&&(f.x-=p),p=-((f.x+d.x)/p>>1)*p,f.x+=p,f.add(e),d.x+=p,d.add(e),n||(f.round(),d.round()),(p=c[s=l.cb()])?delete c[s]:p={ho:l},a[s]=p;var y=f.x;f=f.y;var g=d.x,v=g-y,m=(d=d.y)-f;i.ic(l.Tc()),i.Oc(l.Qc(),y,f,v,m),p.Vg?p.Vg.set(y,f,g,d):p.Vg=new yk(y,f,g,d),this.a.push(p)}}return!u||u.requested&&u.requested===u.total||!u.requested&&h.length===u.total?wk.DONE:wk.PENDING},ow.prototype.Ea=function(t,e,r){for(var i,n,o=this.a,a=o.length;a--;)if((i=o[a]).Vg.vf(t,e))if(i=i.ho,n)n.push(i);else if(n=[i],r)break;return n||hf},ow.prototype.Rd=function(){return"2d"},ow.prototype.o=function(){delete this.a,ow.j.o.call(this)},ow.prototype.disposeInternal=ow.prototype.o;var pw={lookAt:{zoom:{min:-8,max:24},tilt:{min:0,max:0},incline:{min:0,max:0},heading:{min:180,max:180}},interaction:{ZOOM:Nl.ZOOM,COORD:Nl.COORD},capture:!0};function qw(t,e){this.a=[],qw.j.constructor.apply(this,arguments)}function Z(t,e,r,i){Z.j.constructor.call(this,t,e,r,i),this.L=new J(0,0),(r=i.renderBaseBackground)&&(this.Xn=r.lower,this.Hn=r.higher),this.yn=!!i.enableSubpixelRendering,this.fd=rw,this.Af=0,this.Ed=this.ve=!1,this.g=new om,this.a=i=new wm,this.dd=A(this.dd,this),i.addEventListener(i.A.Cg,this.dd),this.Da=A(this.Da,this),i=t.element,this.aa=t=i.ownerDocument.createElement("div"),t.style.position="absolute",t.style.width=t.style.height="100%",t.style.zIndex=0,i.insertBefore(t,i.firstChild),this.sj=new Tm(this.aa,this.oa),this.m=[],sw(this),this.Jh=A(Z.prototype.Jh,this),this.C=tw,this.ng(),this.zoom=uw(this,this.J.pb()+this.fb),this.Eb(),vw(this,e.jb().position,this.zoom),this.$a(),this.T()}t("H.map.render.p2d.capabilities",pw),u(qw,Gm),p=qw.prototype,p.rj=function(){return this.eb.Ec.apply(this.eb,arguments)},p.W=function(t,e,r,i,n,o,a){return this.a=[],qw.j.W.apply(this,arguments)},p.$j=1,p.Ek=function(t,e,r,i,n,o){var a=this.$j=i.Xa();n*=a,o*=a;var s=r.yb();e=s.w*a,s=s.h*a;var l=r.kd();this.oc?(n-=l.x*a,o-=l.y*a):(n=Ad(n-l.x*a),o=Ad(o-l.y*a)),i.Oc(r.Qc(),n,o,e,s),t.detail?t.detail.set(n,o,n+e,o+s):t.detail=new yk(n,o,n+e,o+s),this.a.push(t)},p.Ea=function(t,e,r){for(var i,n,o,a=this.a,s=a.length,l=hf,c=this.$j;s--&&!((n=(i=a[s]).detail).vf(t,e)&&(i=i.ik,(!(o=i.xb().c)||o.Of((t-n.left)/c,(e-n.top)/c,0))&&0>l.indexOf(i)&&(l===hf&&(l=[]),l.push(i),r))););return l},p.Rd=function(){return"2d"},p.o=function(){this.a=[],qw.j.o.call(this)},qw.prototype.disposeInternal=qw.prototype.o,u(Z,Jl),t("H.map.render.p2d.RenderEngine",Z),Z.prototype.type=Tl.P2D;var tw=2;function ww(t,e,r){return Dd(e=r-e)<t.b.w/2?e:e-t.b.w*r/Dd(r)}function sw(t){var e=t.c.La(),r=0,i=e.length;for([t.R={},t.u={},t.ta={},t.ea={}].forEach((function(t){t.Nc=[],t.ja=[]})),t.ab=t.c.La();r<i;r++)t.Pe(r,e[r]);t.Eb()}function Fw(t){var e=[];return(e=(e=(e=(e=e.concat(t.u.ja)).concat(t.R.ja)).concat(t.ta.ja)).concat(t.ea.ja)).filter(vc)}function zw(t,e){var r=Pl(t,Pl(t,e.zoom)+t.fb);return(t=Ql(t,e)).zoom=r,t}function vw(t,e,r){var i=t.b;i.Oa(r),t.s=i.projection.Pc(e),i.x=i.w*t.s.x,i.y=i.h*t.s.y}function Ew(t){return{w:(t=t.wa[2]).right-t.left,h:t.bottom-t.top}}function Gw(t){t.i&&t.i.sa()||Lk()-t.Nj<t.fd&&!t.Ad?t.Yn=Jk(t.Jh):(t.Ad&&(t.ce(),Hw(t)),t.C=tw)}function Hw(t,e){t.dispatchEvent({type:t.A.Vi,target:e||t})}function Lw(t,e,r){Bw(t,e*t.oa,r*t.oa),t.L.set(0,0),t.$a(),t.ha()}function Bw(t,e,r){var i=t.b;t=t.s,i.x=Zd(i.x+e,i.w),i.y=zd(0,yd(i.w,i.y+r)),t.x=i.x/i.w,t.y=i.y/i.h}function Cw(t,e,r,i){var n=t.oa,o=t.f.center;r===+r&&i===+i?(r=(r-o.x)*n,i=(i-o.y)*n,t.L.set(r,i),Bw(t,r,i),t.b.Oa(e),Bw(t,-r,-i)):(t.L.set(0,0),t.b.Oa(e)),t.zoom=e,t.$a(),t.ha()}function xw(t,e,r,i){var n=t.getCapabilities().lookAt.zoom.max,o=e.bb(),a=i||o;if(e.Rf()||r&&i)r=r===B?n:r;else{var s=new nj(t.b.projection);s.Oa(n);var l=s.ib(e.Nb()).round(),c=s.ib(e.Jb()).round();n=s.w,e.Bb()&&(l.x-=n),i?(o=s.ib(a),e=2*zd(o.x-l.x,c.x-o.x),l=2*zd(o.y-l.y,c.y-o.y)):(e=c.x-l.x,l=c.y-l.y,a=o),r===B&&(r=(o=t.wa[4]).right-o.left,o=o.bottom-o.top,r=Pl(t,r=-8+yd(Ed(r/e*n)/Od,Ed(o/l*n)/Od)-t.fb))}return{zoom:Bd(r),position:a}}function yw(t){Dw(t,!0),t.a.sa()&&t.vb(!0),t.g.sa()&&t.wb(!0),Dw(t,!0)}function Mw(t,e){if(e){var r={};r.Te=e.power,r.we=e.ease,r.duration=e.duration,t.l=r}}function uw(t,e){return Pl(t,Pl(t,e-t.fb)+t.fb)}function Ow(t,e){var r=t.s,i=t.b.projection.Pc(e.position),n=t.b.Zd(i),o=n.y;n=n.x;var a=e.zoom;e=(r=t.b.Zd(r)).y;var s=r.x;r=t.zoom;var l=t.a.zb(),c=t.a.a,u=t.a.b,h=0;if(n=ww(t,s,n),e=Fd((n-=s)*n+(o-=e)*o+(r=a-r)*r),0!==l&&0!==e){var p=n/e,f=o/e,d=r/e,y=l*l/(2*e);Aw(t,(function(e,r){var n;1!==e?((n=d*(r=(e=l*r-y*r*r/2)-h))&&(n=uw(t,t.zoom+n),Cw(t,uw(t,n),c,u)),Lw(t,Ad(p*r),Ad(f*r)),h=e):(t.s=i,Cw(t,uw(t,a),c,u),t.$a(),t.ha())}),2*e/l)}}function Nw(t,e,r){r=r||0,e.c&&Cw(t,uw(t,t.zoom+e.c*r),t.a.atX,t.a.atY),Lw(t,e.a*r,e.b*r)}function Aw(t,e,r,i,n){t.i&&t.i.sa()&&t.i.stop(!0),t.i=new Fm(t,e,r,i,n),t.i.start()}function Dw(t,e){t.i&&t.i.sa()&&t.i.stop(e)}Z.prototype.getState=function(){return this.C},Z.prototype.getState=Z.prototype.getState,Z.prototype.Kg=function(t){var e=this,r=t.b,i=t.newValue,n=t.modifiers;t=i.position;var o,a=i.bounds,s=this.zoom,l=this.s,c=0;if(n&ej.POSITION&&(o=e.b.ib(t)),n&ej.BOUNDS)i=xw(this,a.K(),n&ej.ZOOM?i.zoom:B,n&ej.POSITION?t:B),this.J.Wb(i,r);else{n&ej.POSITION||(o=e.b.ib(i.position));var u=o.x,h=o.y;yw(this),this.L.set(0,0);var p=(i=zw(this,i)).zoom,f=i.position;if(r){var d=p-s,y={x:l.x,y:l.y};r=this.b.Zd(y).x;var g=this.b.projection.Pc(t);g.x===this.s.x&&g.y===this.s.y&&p===this.zoom||(u=ww(this,r,u),Aw(this,(function(t){var r=t-c;if(p!==s){o=e.b.Zd(g);var i=e.b.Zd(y);u=ww(e,i.x,o.x),h=o.y-i.y}c=t,Bw(e,u*r,h*r),Cw(e,s+=d*r),e.$a(),e.ha()}),this.qa,(function(){vw(e,f,p),Cw(e,p),e.$a(f),e.ha()}),this.xa))}else Dw(this),vw(this,f,p),Cw(this,p),this.$a(f);this.ha()}},Z.prototype.qa=300,Z.prototype.rg=function(t){var e=Fc(t);if(!e||e&&0>t)throw new D(this.rg,1,"positive number required");this.qa=t},Z.prototype.setAnimationDuration=Z.prototype.rg,Z.prototype.$g=function(){return this.qa},Z.prototype.getAnimationDuration=Z.prototype.$g,Z.prototype.xa=em,Z.prototype.sg=function(t){if(!Da(t))throw new D(this.sg,1,"function required");this.xa=t},Z.prototype.setAnimationEase=Z.prototype.sg,Z.prototype.ah=function(){return this.xa},Z.prototype.getAnimationEase=Z.prototype.ah,Z.prototype.ng=function(){this.xa=em,this.qa=300},Z.prototype.resetAnimationDefaults=Z.prototype.ng,Z.prototype.Xh=function(t,e,r){var i;this.Nj=Lk(),(i=this.R.ja.splice(t,1)[0])&&i.F&&i.F(),(i=this.u.ja.splice(t,1)[0])&&i.F&&i.F(),(i=this.ta.ja.splice(t,1)[0])&&i.F&&i.F(),(i=this.ea.ja.splice(t,1)[0])&&i.F&&i.F(),this.ab=this.c.La(),0===t&&(Ol(this,e,!1),this.Eb()),this.m=Um(this.sj,Ew(this),Fw(this)),this.ce(),r||this.ha()},Z.prototype.Yh=function(){this.Eb(),this.ha()},Z.prototype.th=function(t,e,r){var i,n,o,a;if(e){var s={oc:this.yn,fb:this.fb};e.W?C(e,Em)?n=new Dm(e):C(e,Qm)&&(a=new Dm(e)):(e.requestOverlays&&(i=new ow(e,s)),e.requestTiles&&(n=new mw(e,s)),e.requestMarkers&&(o=new qw(e,s)),e.requestDomMarkers&&(a=new Jm(e,s)))}r=r||0,this.R.ja.splice(t,r,i),this.u.ja.splice(t,r,n),this.ta.ja.splice(t,r,o),this.ea.ja.splice(t,r,a),this.ab=this.c.La(),this.m=Um(this.sj,Ew(this),Fw(this))},Z.prototype.Pa=function(t,e){var r=this.f.center,i=this.oa;return this.b.Ra((t-r.x)*i,(e-r.y)*i)},Z.prototype.screenToGeo=Z.prototype.Pa,Z.prototype.qg=function(t,e){return t=this.Pa(t,e),(e=this.J.jb()).position=t,e},Z.prototype.Da=function(t){var e=this.oa,r=this.f.center,i=r.x*e;r=r.y*e,t=this.b.ib(t);var n=this.b.w;return new J(Ad((t.x-Ad(t.x/n)*n+i)/e),Ad((t.y+r)/e))},Z.prototype.geoToScreen=Z.prototype.Da,Z.prototype.K=function(t,e){var r=this.wa[t||4];t=this.b;var i=r.left-e,n=t.Ra(i,r.top-e),o=r.right+e;return e=t.Ra(o,r.bottom+e),o-i>=t.w&&(n.lng=-(e.lng=180)),sg(n,e)},Z.prototype.Ea=function(t,e,r,i){var n,o=[],a=this.oa;for(t*=a,e*=a,n=(a=[this.R,this.u,this.ta,this.ea]).length;n--&&(!r||!o.length);){for(var s=o,l=a[n].ja,c=t,u=e,h=r,p=l.length;p--&&!((o=l[p])&&o.Ea&&(s=s.concat(o.Ea(c,u,h)),s.length&&h)););o=s}i(o)},Z.prototype.getObjectsAt=Z.prototype.Ea,Z.prototype.sb=z,Z.prototype.T=function(){var t,e=this.m.length;Z.j.T.call(this);var r=Ew(this);this.L.set(0,0);var i=r.w;for(t=r.h;e--;){var n=(r=this.m[e]).yb();n.w===i&&n.h===t||r.cf(i,t)}this.sb=new Wi(i,t),this.ha()},Z.prototype.getCapabilities=function(){return pw},Z.prototype.getCapabilities=Z.prototype.getCapabilities,p=Z.prototype,p.ce=function(){this.R.Nc.length=0,this.u.Nc.length=0,this.ta.Nc.length=0,this.ea.Nc.length=0},p.Jh=function(){var t;this.D&&this.D.before();var e=this.u.ja,r=this.f.center.clone().scale(this.oa).round(),i=this.K(1,0),n=this.K(1,Iw),o=this.zoom,a=o-this.fb,s=this.b,l=this.Xn,c=this.Hn,u=e[0];e=this.L;var h=this.m.length,p=this.ab;for(t=p.length;h--;){var f=this.m[h];C(f,Bm)&&f.clear()}if(u){if(l)for(;l;)h=o-l,u.W(i,r,s,h,!0,e),--l;if(c&&this.Ed)for(f=1;f<=c&&(h=o+f,s.Oa(h),l=this.K(2,0),s.Oa(o),!u.W(l,r,s,h,!0,e));f++);}for(this.fd=rw;t--;)C(s=p[t],qj)&&s.ca()&&s.ca().Ue(n,a);i=this.Zj(i,r,o,!1,e,Jw,this.u,this.R),r=this.Zj(n,r,a,!1,e,Kw,this.ta,this.ea),this.Ad=i&&r,this.i&&this.i.sa()&&this.me(),this.P||(this.P=this.J.jb()),this.P.bounds=this.K(4,0),this.J.$a(this.P),this.P=null,this.sb&&(this.f.$a(this.sb),this.sb=z),o<this.Af?this.Ed=!0:this.ve&&(this.Ed=!1),this.Af=o,this.ve=i,this.D&&this.D.after(),Gw(this)},p.Zj=function(t,e,r,i,n,o,a){var s,l=Array.prototype.slice.call(arguments,6),c=l.length,u=l[0].ja.length,h=c*u,p=!!h;for(s=0;s<h;s++){if(o===Jw)var f=s%c,d=Math.floor(s/c);else f=Math.floor(s/u),d=s%u;var y=l[f].ja[d];f=l[f].Nc,y&&((y=y.W(t,e,this.b,r,i,n,this.Da))===wk.ACTIVE&&(this.fd=1/0),y!==wk.DONE||f[d]||(Hw(this,this.ab[d]),f[d]=!0),f[d]||(p=!1))}return p},p.o=function(){var t=this.c.La()[0],e=this.f;Kk(this.Yn),Dw(this,!0),t&&Ol(this,t,!1),Fw(this).forEach((function(t){t.F()})),e.element&&e.element.removeChild(this.aa),this.aa=null,this.C=3,Z.j.o.call(this)},p.ha=function(){this.Nj=Lk(),this.C===tw&&(this.Ad=!1,this.C=1,Gw(this))},p.xd=function(t,e,r){Cw(this,t=Pl(this,Pl(this,t)+this.fb),e,r)},Z.prototype.zoomAt=Z.prototype.xd,Z.prototype.lc=function(t,e){yw(this),Mw(this,e),this.g.start(t,!!e)},Z.prototype.startInteraction=Z.prototype.lc,Z.prototype.cc=function(t,e,r,i,n){var o=!1;this.g.sa()&&(e=this.g.store(t,e,r,i,n),this.g.Ac(Nl.COORD)&&0<nm(t=this.g.Nd())&&(Lw(this,-t.x,-t.y),o=!0),e&&this.g.Ac(Nl.ZOOM)&&(t=this.g.Bf(),e=this.g.Cf(),(e=Ed(Gd(2,this.zoom)*e)/Od)!==this.zoom&&(Cw(this,e=uw(this,e),t.x,t.y),o=!0)),o&&this.ha())},Z.prototype.interaction=Z.prototype.cc,Z.prototype.wb=function(t){var e=this;if(this.g.sa()&&!t){if(this.l){t=this.g.zb();var r=this.g.rc(),i=this.l.duration,n=(this.l.Te||1)*t,o=new Rm(-n/(0<i?i:1),n);!E(r.x)&&!E(r.y)&&0<n&&e.g.Ac(Nl.COORD)&&Aw(this,(function(t){n=o.De(t*i),E(n)||Lw(e,Ad(-r.x*n),Ad(-r.y*n))}),i,void 0,this.l.we)}this.l=null,this.g.clear()}},Z.prototype.endInteraction=Z.prototype.wb,Z.prototype.kc=function(t,e,r){yw(this),this.a.start(e,r),Mw(this,t)},Z.prototype.startControl=Z.prototype.kc,Z.prototype.control=function(t,e,r){if(E(+r))throw new D(this.control,2,r);if(E(t))throw new D(this.control,0,t);if(E(e))throw new D(this.control,1,e);this.a.sa()&&this.a.set(t,e,r,0,0,0)},Z.prototype.control=Z.prototype.control,Z.prototype.vb=function(t,e){var r,i=this;if(this.a.sa()){Dw(this,!0);var n=Lk(),o=n-this.Lj;if(1<=o&&Nw(this,zm(this.a),o),!this.l||t||e)"function"==typeof e&&((t=this.jb()).zoom=this.zoom-this.fb,e(t),t.zoom+=this.fb,Ow(this,t));else{e=this.a.zb();var a=this.a.rc(),s=this.l.duration,l=(this.l.Te||1)*e,c=new Rm(-l/(0<s?s:1),l);!E(a.a)&&!E(a.b)&&0<l&&Aw(this,(function(t,e,o,u){n&&(o=u-n,n=0),l=c.De(t*s)*o,E(l)||((r=a.c*l)&&Cw(i,uw(i,i.zoom+r),i.a.a,i.a.b),Lw(i,Ad(a.a*l),Ad(a.b*l)))}),s,void 0,this.l.we)}this.a.reset()}},Z.prototype.endControl=Z.prototype.vb,Z.prototype.dd=function(t){var e=this,r=t.b;this.L.set(0,0),r.a||r.b||r.c?(this.Lj=Lk(),Aw(this,(function(t,i,n,o){e.Lj=o,Nw(e,r,n)}),Number.POSITIVE_INFINITY),this.ha()):Dw(this,!0)},Z.prototype.Wg=function(){},Z.prototype.enter=Z.prototype.Wg,Z.prototype.Xg=function(t){Ml(this.aa,t)},Z.prototype.exit=Z.prototype.Xg,Z.prototype.capture=function(t,e,r,i){var n=this.aa.ownerDocument.createElement("canvas"),o=n.getContext("2d"),a=this.oa;for(n.width=(r-t)*a,n.height=(i-e)*a,r=0;r<this.m.length;r++)C(i=this.m[r],Bm)&&o.drawImage(i.N(),-t*a,-e*a);return Zb(n)};var Kw=0,Jw=1,rw=1e3,Iw=256;function Pw(t){var e;if(t)for(Qw={},e=t.length;e--;)Qw[t[e]]=!0;this.Yk={}}var Rw,Qw={};Pw.prototype.parse=function(t,e,r){var i,n,o,a,s;Rw=!1;try{r=JSON.parse(r)}catch(t){Rw=!0}if(r&&(i=r.metadata)){var l={spatials:[]};for(n in i)if((r=!Qw[n]&&(o=Sw[n]))&&((a=i[n])||(Rw=!0,a=void 0),r=a),r)for(r=a.length;r--;){var c;(c=a[r])||(Rw=!0,c=void 0),(s=c)&&o(e,t,this,n,s,l)}}else Rw=!0;return Rw?void 0:l},Pw.prototype.parse=Pw.prototype.parse;var Sw={"street labels":function(t,e,r,i,n,o){var a;if((a=n.vertices)||(Rw=!0,a=void 0),a){var s,l,c=a.length;if((l=0<c)||(Rw=!0,l=void 0),l)for(s=Array(c/2);c;){var u=a[--c];l=a[--c],s[c/2]=new J(l,u)}s=s?{a:[s]}:B,c=+n["font size"]/t.Xa(),(a=r.Yk[c])||(Tw.lineWidth=c,a=r.Yk[c]=r.Fd.vj(Tw)),Uw(t,e,s,!1,a,n,i,o)}delete n.vertices},"city center labels":function(t,e,r,i,n,o){Uw(t,e,Vw(n,new Ph([])),!0,r.Fd,n,i,o)},labels:function(t,e,r,i,n,o){var a;if((a=n["bounding boxes"])||(Rw=!0,a=void 0),a){for(var s,l=a.length,c=new Ph([]);l--;){var u;(u=a[l])||(Rw=!0,u=void 0),(s=u)&&Vw(s,c)}Uw(t,e,c,!0,r.Fd,n,i,o)}delete n["bounding boxes"]},buildings:function(t,e,r,i,n,o){var a,s,l,c,u=n.id,h=e.ig[u],p=[],f=[];(a=n)||(Rw=!0,a=void 0),a&&((s=a.vertices)||(Rw=!0,s=void 0),s)&&((c=a.polygons)||(Rw=!0,c=void 0),(l=c)&&p.push.apply(p,Ww(s,l)),(a=a.outlines)||(Rw=!0,a=void 0),(l=a)&&f.push.apply(f,Ww(s,l))),l=p.length,p.push.apply(p,f),f=new Ph(p,Wd,l),(p=p.length)||(Rw=!0,p=void 0),p&&(h?(br(h,t,[f]),o.spatials.push(h)):(h=Uw(t,e,f,!0,r.Fd,n,i,o,u),e.fa(h)))}};Sw["transit stops"]=Sw.POIs=Sw.labels;var Xw=["box 2","box 1","annotation box","icon box"];function Vw(t,e){for(var r,i,n=Xw.length;n--;)if(i=t[r=Xw[n]]){var o=i[0],a=i[1],s=i[2];i=i[3],e.a.push([new J(o,a),new J(o+s,a),new J(o+s,a+i),new J(o,a+i)]),delete t[r]}return e}function Ww(t,e){var r,i,n,o=e.length;if(0<o)for(i=Array(o);o--;)if((r=e[o])||(Rw=!0,r=void 0),r){var a=r.length;if(0<a)for(i[o]=n=Array(a);a--;){var s=2*r[a];n[a]=new J(t[s],t[s+1])}}return i||[]}var Yw={};function Uw(t,e,r,i,n,o,a,s,l){return Yw.style=n,i=new Yq(e,i,l,Yw),r&&br(i,t,[r]),Zw(o),o.category=a,i.setData(o),s.spatials.push(i),i.ka(e),i}Pw.prototype.Fd=new wh({strokeColor:"transparent",fillColor:"transparent",lineWidth:0});var Tw={};function Zw(t){var e,r=!1;switch(typeof t){case"object":if(t instanceof Array)for(e=t.length;e--;)Zw(t[e])?r=!0:delete t[e];else if(t)for(e in t)Zw(t[e])?r=!0:delete t[e];break;case"number":r=!0;break;default:r=!!t}return r}function $w(t,e,r){e=e||{};var i=(r=r||{}).tileType||"maptile",n=r.scheme||"normal.day";if(S.call(this,{min:0,max:20}),!0===e.pois&&(e.pois="!F"),this.L=e,!(t&&t instanceof ax))throw Error("InvalidArgument: service required");this.m=t,this.i=A(this.i,this),this.m.addEventListener("versionupdate",this.i),this.Yb=t.v().clone().G(i+"/"+t.vc()+"/"+n).I(bx).I(e),this.R=t.f||null,this.T=r.pixelRatio||r.pixelratio||Ue(),this.tileSize=r.tileSize||256,this.tileType=i,this.scheme=n,this.f=new hr(new Pw(r.categoryFilter)),this.f.ka(this),this.u=A(this.u,this),this.f.addEventListener("update",this.u),this.D=!1,S.call(this,{min:0,max:20}),this.J(new Rk(r.tileCacheSize||256,A(this.aa,this)))}u($w,S),t("H.service.metaInfo.TileProvider",$w),$w.prototype.aa=function(t,e){for(var r,i=(t=e.Ua()).length;i--;)delete(r=t[i]).a[e.key],r.release();e.data&&(Cp.push(e.gg(),this.tileSize),e.hg())},$w.prototype.u=function(){this.dispatchEvent("update")},$w.prototype.B=function(t,e,r,i,n){var o,a=this.Yb.clone(),s=this.R,l=this.tileSize,c=this.getTileKey(t,e,r);if((c=this.nb().get(c))&&!c.Ud()){i(Cp.pop(this.tileSize),null);var u={cancel:function(){}}}else{s&&a.Ba(s[(r+e+t)%s.length]),a.G(r+"/"+t+"/"+e+"/"+l+"/png8");var h=Ap.setTimeout((function(){(o=new tf("text/plain",a.toString())).then((function(t){i(null,t)}),n)}),500)}return this.D||(zp($w,"Use HERE Vector Tile API or Raster Tile API v3 instead."),this.D=!0),u||{cancel:function(){o?o.cancel():Ap.clearTimeout(h)}}},$w.prototype.requestInternal=$w.prototype.B,$w.prototype.ac=function(t,e,r,i,n){var o=this.f,a=i||Cp.pop(this.tileSize);if(i)(t=this.nb().get(this.getTileKey(t,e,r))).W(i);else if(delete(i=t=new al(this.uc(t,e,r),t,e,r,this.tileSize,this.T,r,o)).l,i.s=n,t.W(a))for(a=(n=t.Ua()).length;a--;)n[a].pg();else Cp.push(a,this.tileSize);return t},$w.prototype.createTileInternal=$w.prototype.ac,$w.prototype.F=function(){this.f.F(),this.m.removeEventListener("versionupdate",this.i),S.prototype.F.call(this)},$w.prototype.dispose=$w.prototype.F,$w.prototype.i=function(){var t=this.m;this.Yb=t.v().clone().G(this.tileType+"/"+t.vc()+"/"+this.scheme).I(bx).I(this.L),this.reload(!1)};var bx={metadata:"metaonly",mgen:"2"};function ax(t){ax.j.constructor.call(this,ax,t),t=Pp(this,t),this.f=t.shards,(this.b=t.ignoreTypes?null:t.type)&&this.v().Ba(this.b),this.c=t.version,this.l=new lq,"newest"===this.c&&cx(this)}function dx(t,e){for(var r={},i=t[e+"s"][e],n=i.length;n--;)r[i[n].id]=i[n];t[e+"s"]=r}function cx(t){var e=t.v().clone().G("info").I({output:"json"});t.f&&e.Ba(t.f[0]),t.B(e,(function(e){var r;if(dx(e=e.response,"map"),dx(e,"scheme"),dx(e,"tiletype"),dx(e,"format"),dx(e,"resolution"),dx(e,"language"),"newest"===t.c&&"traffic"!==t.b)for(r in e.maps)e.maps[r].hash&&e.maps[r].newest&&(t.c=e.maps[r].hash,t.dispatchEvent("versionupdate"));t.s=e,t.dispatchEvent("infoupdate")}),(function(t){throw t}))}u(ax,Op),t("H.service.metaInfo.Service",ax),ax.prototype.Aa=function(){return{type:"base",version:"newest",subDomain:"maps.ls",path:"maptile/2.1",shards:["1","2","3","4"]}},ax.CONFIG_KEY="metaInfo",ax.prototype.Hj=function(){return this.b},ax.prototype.vc=function(){return this.c},ax.prototype.getVersion=ax.prototype.vc,ax.prototype.ba=function(){return this.l},ax.prototype.getCopyrights=ax.prototype.ba,ax.prototype.Fe=function(){return this.s},ax.prototype.getInfo=ax.prototype.Fe,ax.prototype.ue=function(t,e,r,i,n,o){return new $w(this,i,{tileSize:t,pixelRatio:e,categoryFilter:r,tileType:n,scheme:o})},ax.prototype.createTileProvider=ax.prototype.ue,ax.prototype.nc=function(t,e,r,i,n,o){return new sl(this.ue(t,e,r,i,n,o))},ax.prototype.createTileLayer=ax.prototype.nc,X.prototype.Aj=function(t){return this.Ma(ax,t)},X.prototype.getMetaInfoService=X.prototype.Aj,function(){var t=X.prototype.createDefaultLayers;X.prototype.createDefaultLayers=function(e,r,i,n,o,a){var s=t.call(this,e,r,i,n,o,a),l={},c=this.Aj();"object"==typeof e&&(e=(a=e).tileSize,r=a.ppi,i=a.lg,n=a.lg2,o=a.style,a=a.pois),e=e||256;var u=320===r?2:1;if(0>[72,250,320,500].indexOf(+r)){if(r!==B)throw new D(this.wf,1,r)}else l.ppi=+r;return i&&(l.lg=i),n&&(l.lg2=n),o&&(l.style=o),a&&(l.pois=a),s.raster.normal.metaInfo=c.nc(e,u,["buildings"],l),s}}(),H.__bootstrap__='var l,aa="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)},ba="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global&&null!=global?global:this;function ca(a,b){if(b){var c=ba;a=a.split(".");for(var d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&aa(c,a,{configurable:!0,writable:!0,value:b})}}var ea;\nif("function"==typeof Object.setPrototypeOf)ea=Object.setPrototypeOf;else{var fa;a:{var ha={lb:!0},ja={};try{ja.__proto__=ha;fa=ja.lb;break a}catch(a){}fa=!1}ea=fa?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null}var ka=ea;ca("Object.setPrototypeOf",function(a){return a||ka});var p=this||self;\nfunction la(a,b,c){a=a.split(".");c=c||p;a[0]in c||"undefined"==typeof c.execScript||c.execScript("var "+a[0]);for(var d;a.length&&(d=a.shift());)a.length||void 0===b?c[d]&&c[d]!==Object.prototype[d]?c=c[d]:c=c[d]={}:c[d]=b}function ma(){}\nfunction na(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";\nelse if("function"==b&&"undefined"==typeof a.call)return"object";return b}function r(a){return"function"==na(a)}function oa(a){var b=typeof a;return"object"==b&&null!=a||"function"==b}var pa="closure_uid_"+(1E9*Math.random()>>>0),ra=0;function sa(a,b,c){return a.call.apply(a.bind,arguments)}\nfunction ta(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var e=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(e,d);return a.apply(b,e)}}return function(){return a.apply(b,arguments)}}function ua(a,b,c){Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ua=sa:ua=ta;return ua.apply(null,arguments)}\nfunction va(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var d=c.slice();d.push.apply(d,arguments);return a.apply(this,d)}}function t(a,b){la(a,b,void 0)}function wa(a,b){function c(){}c.prototype=b.prototype;a.U=b.prototype;a.prototype=new c;a.prototype.constructor=a};function v(){}t("H.util.ICache",v);v.prototype.add=function(){};v.prototype.add=v.prototype.add;v.prototype.get=function(){};v.prototype.get=v.prototype.get;v.prototype.sa=function(){};v.prototype.drop=v.prototype.sa;v.prototype.forEach=function(){};v.prototype.forEach=v.prototype.forEach;v.prototype.S=function(){};v.prototype.removeAll=v.prototype.S;v.prototype.aa=function(){};v.prototype.registerOnDrop=v.prototype.aa;v.prototype.qa=function(){};v.prototype.deRegisterOnDrop=v.prototype.qa;function xa(){var a=ya,b;for(b in a)return!1;return!0}function za(a){var b={},c;for(c in a)b[c]=a[c];return b}var Aa="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Ba(a,b){for(var c,d,e=1;e<arguments.length;e++){d=arguments[e];for(c in d)a[c]=d[c];for(var f=0;f<Aa.length;f++)c=Aa[f],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}};var Ca=this;function Da(a){if(Error.captureStackTrace)Error.captureStackTrace(this,Da);else{var b=Error().stack;b&&(this.stack=b)}a&&(this.message=String(a))}wa(Da,Error);Da.prototype.name="CustomError";var Ea=Array.prototype.indexOf?function(a,b){return Array.prototype.indexOf.call(a,b,void 0)}:function(a,b){if("string"===typeof a)return"string"!==typeof b||1!=b.length?-1:a.indexOf(b,0);for(var c=0;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1};var Fa=ua,Ga=String,Ha=Ca.Object.freeze||function(a){return a},x=[].pop(),Ia=/x/.exec("");function Ja(a){return Ga(a).split(","!==x?",":" ")}var Ma="prototype constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Na(a,b,c,d){if(!(b=a instanceof b)&&c)throw new y(c,d,void 0!==x?void 0:a);return b}function Oa(a,b,c,d){var e;if(!(e="Array"===Pa(a))&&b)throw new y(b,c,d!==x?d:a);return e}\nt("H.lang.isArray",function(a,b,c,d){return Oa(a,b,c,d)});function Qa(a){return"string"===typeof a}t("H.lang.isString",Qa);var Ra=isNaN;function Sa(a){return a===+a}t("H.lang.isNumber",Sa);t("H.lang.isInteger",Number.isInteger?Number.isInteger:function(a){return"number"===typeof a&&0===a%1});function Pa(a){var b=Object[Ma[0]][Ma[6]].call(a).match(/^\\[object (\\w+)\\]$/);return b?b[1]:typeof a}var Ta=[];0>Ta.indexOf(Ta)&&Ta.push(Ta);\nfunction Ua(a,b,c,d){var e="",f=2>arguments.length,g;f&&(b={H:Ca.H},c="",d=Ta.slice());Va(b,!0,function(h,k){try{if(g=h[k],k=Wa(h,g),!(oa(g)&&g.window===g&&g.self===g||oa(g)&&0<g.nodeType&&r(g.cloneNode))&&oa(g)){if(g===a)return e=c+"."+k,!0;if(0>d.indexOf(g)&&(d.push(g),e=Ua(a,g,c+"."+k,d)))return!0}}catch(m){}});f&&(e=e?e.substr(1).replace("."+Ma[0]+".","#"):"~"+(r(a)?Xa(a)+"()":Pa(a)));return e}\nfunction Wa(a,b){var c=[];Va(a,!1,function(d,e){d[e]===b&&c.push(e)});return c.sort(Ya)[0]}function Ya(a,b){return b.length-a.length}var Za=Object[Ma[0]][Ma[2]];function Va(a,b,c){var d;if(a){for(e in a)if((!b||Za.call(a,e))&&c(a,e,!0))return;for(d=Ma.length;d--;){var e=Ma[d];if((!b||Za.call(a,e))&&c(a,e,!1))break}}}function Xa(a){return(a=/^\\s*function ([^\\( ]+)/.exec(a))?a[1]:"anonymous"}function $a(a,b,c){c[b]="#"+b};function A(a,b,c){this.g=[];b&&this.aa(b);if(c&&!r(c))throw new y(A,2,c);this.b=0;this.filter=c;this.a={};this.f=this.c=null;this.Ha(a)}t("H.util.Cache",A);A.prototype.add=function(a,b,c){var d,e;c=+c;if(!Sa(c)||0>c)throw new y(this.add,2,c);a=String(a);if(e=this.filter?this.filter(a,b,c):!0)(d=this.a[a])?(d.data!==b&&ab(this,d),this.b+=c-d.size,d.size=c,d.data=b,eb(this,d)):this.a[a]=fb(this,{id:a,data:b,size:c,m:null,C:null},this.c),gb(this);return e};A.prototype.add=A.prototype.add;\nA.prototype.aa=function(a){if(!r(a))throw new y(this.aa,0,a);this.g.push(a)};A.prototype.registerOnDrop=A.prototype.aa;A.prototype.qa=function(a){this.g=this.g.filter(function(b){return b!==a})};A.prototype.deRegisterOnDrop=A.prototype.qa;A.prototype.get=function(a,b){return(a=b?this.a[a]:eb(this,this.a[a]))&&a.data};A.prototype.get=A.prototype.get;A.prototype.sa=function(a){var b;(b=this.a[a])&&hb(this,b,!0)};A.prototype.drop=A.prototype.sa;\nA.prototype.forEach=function(a,b,c){var d;for(d in this.a){var e=this.a[d];(c?c(d,e.data,e.size):1)&&a.call(b,d,e.data,e.size)}};A.prototype.forEach=A.prototype.forEach;A.prototype.S=function(a){var b;for(b in this.a){var c=this.a[b];(a?a(b,c.data,c.size):1)&&hb(this,this.a[b],!0)}};A.prototype.removeAll=A.prototype.S;A.prototype.Ha=function(a){if(!(0<+a))throw new y(A.prototype.Ha,0,a);this.i=+a;gb(this);return this};A.prototype.setMaxSize=A.prototype.Ha;A.prototype.Bb=function(){return this.i};\nA.prototype.getMaxSize=A.prototype.Bb;A.prototype.xb=function(){return this.b};A.prototype.getCurrentSize=A.prototype.xb;function eb(a,b){b&&(a.c=fb(a,b,a.c));return b}function gb(a){for(;a.b>a.i&&a.f;)hb(a,a.f,!0)}function fb(a,b,c){if(c!==b){(b.m||b.C)&&hb(a,b,!1);if(b.m=c)b.C=c.C,c.C=b;b.C||(a.c=b);b.m||(a.f=b);a.b+=b.size}return b}function hb(a,b,c){var d=b.C,e=b.m;if(d||e||b==a.c&&b==a.f)d?d.m=e:a.c=e,e?e.C=d:a.f=d,a.b-=b.size,c&&(delete a.a[b.id],ab(a,b));b.m=b.C=null}\nfunction ab(a,b){for(var c=a.g.length;c--;)a.g[c].call(a,b.id,b.data,b.size)};function B(){}t("H.service.extension.dataView.ITable",B);B.prototype.xa=function(){};B.prototype.getMeta=B.prototype.xa;B.prototype.ya=function(){};B.prototype.getRowCount=B.prototype.ya;B.prototype.ga=function(){};B.prototype.getRow=B.prototype.ga;B.prototype.A=function(){};B.prototype.getColumnNames=B.prototype.A;B.prototype.wa=function(){};B.prototype.getColumn=B.prototype.wa;B.prototype.l=function(){};B.prototype.getCell=B.prototype.l;B.prototype.concat=function(){};B.prototype.concat=B.prototype.concat;function ib(){}t("H.service.extension.dataView.IRow",ib);ib.prototype.A=function(){};ib.prototype.getColumnNames=ib.prototype.A;ib.prototype.l=function(){};ib.prototype.getCell=ib.prototype.l;ib.prototype.za=function(){};ib.prototype.getTable=ib.prototype.za;function jb(a,b){this.a=a;this.b=b}t("H.service.extension.dataView.ObjRow",jb);jb.prototype.A=function(){return this.a.A()};jb.prototype.getColumnNames=jb.prototype.A;jb.prototype.l=function(a){return this.a.l(this.b,a)};jb.prototype.getCell=jb.prototype.l;jb.prototype.za=function(){return this.a};jb.prototype.getTable=jb.prototype.za;function kb(){}t("H.service.extension.dataView.IColumn",kb);kb.prototype.l=function(){};kb.prototype.getCell=kb.prototype.l;function lb(a,b){this.b=a;this.a=b}t("H.service.extension.dataView.ObjColumn",lb);lb.prototype.l=function(a){return this.b.l(a,this.a)};lb.prototype.getCell=lb.prototype.l;function y(a,b,c){var d=arguments.length;b=b!==x?+b:b;if(b!==x){var e=(e=/^.*?\\(([^\\)]+)/.exec((""+a).replace(/(\\/\\*([\\s\\S]*?)\\*\\/)|(\\/\\/(.*)$)/gm,"")))?Ja(e[1].replace(/\\s+/g,"")):[];e.forEach($a);e=e[b]||"#"+b}var f=a?Ua(a):"";d=2<d?Ga(c):"";if(e||d)f+=" (Argument "+(e||"")+(d?" "+d:"")+")";d=Error(f);Object.setPrototypeOf(d,y.prototype);return d}wa(y,Error);t("H.lang.InvalidArgumentError",y);y.prototype.name="InvalidArgumentError";function C(a,b,c){var d;b=b||(a&&a.length?Object.keys(a[0]):x);this.D=a;if(b)for(this.M=b,this.pa=a=Object.create(Ia,void 0),d=b.length;d--;)a[b[d]]=!0;c!==x&&(this.Ca=c)}t("H.service.extension.dataView.ObjTable",C);l=C.prototype;l.Ca=x;l.D=x;l.M=x;l.pa=x;l.xa=function(){return this.Ca};C.prototype.getMeta=C.prototype.xa;C.prototype.ya=function(){return this.D?this.D.length:0};C.prototype.getRowCount=C.prototype.ya;C.prototype.ga=function(a){var b=this.D;return b&&b[a]?new jb(this,a):x};\nC.prototype.getRow=C.prototype.ga;C.prototype.A=function(){return this.M||mb};C.prototype.getColumnNames=C.prototype.A;C.prototype.wa=function(a){return this.pa[a]?new lb(this,a):x};C.prototype.getColumn=C.prototype.wa;C.prototype.l=function(a,b){var c=this.D;return(a=c&&this.pa[b]&&c[a])&&a[b]};C.prototype.getCell=C.prototype.l;\nC.prototype.concat=function(){var a=arguments.length,b,c=this.M,d=""+this.M,e=(this.D||[]).slice();for(b=0;b<a;b++){var f=arguments[b];if(!(f instanceof C))throw new y(this.concat,b);if(f.D){if(c&&""+f.M!==d)throw new y(this.concat,b,"Incompatible columns!");e=e.concat(f.D)}}return new C(e,this.M,this.Ca)};C.prototype.concat=C.prototype.concat;var D=Math,nb=D.min,ob=D.max,pb=D.round,qb=D.floor,rb=D.ceil,sb=D.abs,tb=D.log,ub=D.sqrt,vb=D.pow,wb=D.exp,xb=D.sin,yb=D.asin,zb=D.cos,Ab=D.tan,Bb=D.atan,Cb=D.atan2,Db=D.LN2,E=D.PI,Eb=E/2,Fb=E/4,Gb=2*E,Hb=3*E,Ib=E/180,Kb=180/E,Lb=1/0;vb(-2,53);function Mb(a,b){var c;return 0>(c=a%b)===0>b?c:c+b}t("H.math.normalize",function(a,b,c){b-=c=c||0;a-=c;return a-qb(a/b)*b+c});function Nb(a,b,c){return a>c?c:a<b?b:a}t("H.math.clamp",Nb);function Ob(a,b,c){return b<c?a>=b&&a<=c:a>=c&&a<=b}\nfunction Pb(a,b,c,d,e,f){return ub(vb((a-e)*(d-f)-(b-f)*(c-e),2)/(vb(c-e,2)+vb(d-f,2)))}var Qb={NONE:0,VERTEX:1,EDGE:2,SURFACE:3};t("H.math.CoverType",Qb);\nfunction Rb(a,b,c){for(var d=c.length,e=d,f,g,h,k,m=c[0],n=0,q=0,u=0;1!=n&&1<e;){g=c[--e];f=c[--e];k=c[e?e-1:(d+(e-1))%d];h=c[e?e-2:(d+(e-2))%d];if(f>=a&&f<=a&&g>=b&&g<=b||h>=a&&h<=a&&k>=b&&k<=b)n=1;else if(!n&&f===a)h===a&&(g<b&&k>b||g>b&&k<b)||(m<=a&&h>a||m>=a&&h<a)&&(g>=b?++q:++u),n=Ob(b,g,k)&&0>=Pb(a,b,f,g,h,k)?2:0;else if(!n&&Ob(a,f,h)){if(f<a&&h>a||f>a&&h<a)m=g+(a-f)/(h-f)*(k-g),q+=m>b,u+=m<b;n=Ob(b,g,k)&&0>=Pb(a,b,f,g,h,k)?2:0}m=f}!n&&0!==u&&0!==q%2&&(n=3);return n}\nfunction Sb(a,b){return Rb(a.x,a.y,b)!==Qb.NONE}t("H.math.isPointInsidePolygon",Sb);function Tb(a){for(var b=a.length,c=new Float64Array(2*b),d=b&&a[0].x!==x;b--;){var e=a[b],f=b<<1;c[f]=d?e.x:e[0];c[f+1]=d?e.y:e[1]}return c}t("H.math.flatten",Tb);function F(a,b){this.x=+a;this.y=+b}t("H.math.Point",F);F.prototype.set=F;F.prototype.set=F.prototype.set;F.prototype.clone=function(a){a?(a.x=this.x,a.y=this.y):a=new F(this.x,this.y);return a};F.prototype.clone=F.prototype.clone;F.prototype.add=function(a){this.x+=a.x;this.y+=a.y;return this};F.prototype.add=F.prototype.add;F.prototype.sub=function(a){this.x-=a.x;this.y-=a.y;return this};F.prototype.sub=F.prototype.sub;F.prototype.scale=function(a,b){this.x*=a;this.y*=void 0===b?a:b;return this};\nF.prototype.scale=F.prototype.scale;F.prototype.round=function(){this.x=pb(this.x);this.y=pb(this.y);return this};F.prototype.round=F.prototype.round;F.prototype.floor=function(){this.x=qb(this.x);this.y=qb(this.y);return this};F.prototype.floor=F.prototype.floor;F.prototype.ceil=function(){this.x=rb(this.x);this.y=rb(this.y);return this};F.prototype.ceil=F.prototype.ceil;F.prototype.F=function(a){return!(!a||this.x!==a.x||this.y!==a.y)};F.prototype.equals=F.prototype.F;\nF.prototype.Cb=function(a,b){var c=b.x-a.x,d=b.y-a.y,e=a;if(c||d){var f=((this.x-a.x)*c+(this.y-a.y)*d)/(c*c+d*d);0>=f?e=a:1<=f?e=b:e=new F(a.x+f*c,a.y+f*d)}return e};F.prototype.getNearest=F.prototype.Cb;F.prototype.ra=function(a){return ub(vb(this.x-a.x,2)+vb(this.y-a.y,2))};F.prototype.distance=F.prototype.ra;F.fromIPoint=function(a){if(!a)throw Error("invalid argument");return a instanceof F?a:new F(a.x,a.y)};function Ub(a,b,c,d,e,f){var g,h,k=a.length,m,n;if(k)for(g=[];k--;){var q=a[k];var u=q.length;var I=0;for(m=1;m<u;m++)if(n=Vb(q[m-1],q[m],c,b,d,e)){var L=n[0];var w=n[1];I&&I.F(L)?h.push(w):g.push(h=n);I=w;f&&(m=u,k=0)}}else g=a;return g}t("H.math.clipping.clipStrips",Ub);\nfunction Vb(a,b,c,d,e,f){var g=a.x;a=-a.y;var h=b.x;b=-b.y;c=-c;f=-f;if(g>h){if(h>e||g<d)return;var k=g;var m=a;g=h;a=b;h=k;b=m;k=1}else if(g>e||h<d)return;if(a>b){if(b>c||a<f)return;var n=1;a=-a;b=-b;m=f;f=-c;c=-m}else if(a>c||b<f)return;if(g<d){if((a+=(d-g)*(b-a)/(h-g))>c)return;g=d}if(a<f){if((g+=(f-a)*(h-g)/(b-a))>e)return;a=f}h>e&&(b=a+(e-g)*(b-a)/(h-g),h=e);b>c&&(h=g+(c-a)*(h-g)/(b-a),b=c);n&&(a=-a,b=-b);return k?[new F(h,-b),new F(g,-a)]:[new F(g,-a),new F(h,-b)]}\nfunction Wb(a,b,c){a=Xb(a,!0);b=Xb(b,!1);var d,e;var f={};var g=d=1;switch(~~(c||0)){case 1:g=d=0;break;case 2:d=0;g=1;break;case 3:d=1,g=0}c=d;var h=g;if(b&&a){b.W=new Yb(b.x,b.y,null,Zb(b));a.W=new Yb(a.x,a.y,null,Zb(a));for(g=b;g.next;g=g.next)if(!g.u)for(d=a;d.next;d=d.next)if(!d.u){var k=$b(g.next);var m=$b(d.next);if(e=ac(g,k,d,m,f)){e=f.mb;var n=f.nb;var q=f.ec;var u=f.fc;e=new Yb(q,u,null,null,null,null,!0,0,0,e);bc(e,g,k);k=new Yb(q,u,null,null,null,null,!0,0,0,n);bc(k,d,m);e.Da=k;k.Da=e}}f=\nSb(b,cc(a));c&&(f=!f);for(g=b;g;g=g.next)g.u&&(g.Aa=f,f=!f);f=Sb(a,cc(b));h&&(f=!f);for(d=a;d.next;d=d.next)d.u&&(d.Aa=f,f=!f);dc(b);for(dc(a);(a=ec(b))!=b;){for(c=null;!a.na;a=a.Da){for(f=a.Aa;;){c=new Yb(a.x,a.y,c);c.artificial=a.u||a.Wa;a.na=1;a=f?a.next:a.o;if(!a)break;if(a.u){a.na=1;break}}if(!a)break}c.Za=I||null;var I=c}return I}}t("H.math.clipping.clipPolygon",Wb);\nfunction Yb(a,b,c,d,e,f,g,h,k,m){this.x=a;this.y=b;this.next=c||null;this.o=d||null;this.Za=e||null;this.Da=f||null;this.u=!!g;this.Aa=!!h;this.na=k||0;this.alpha=m||0;d&&(d.next=this);c&&(c.o=this);this.Wa=!1;this.W=null}function $b(a){for(;a&&a.u;)a=a.next;return a}function Zb(a){if(a)for(;a.next;)a=a.next;return a}function ec(a){var b=a;if(b){do b=b.next;while(b!=a&&(!b.u||b.u&&b.na))}return b}function dc(a){var b=Zb(a);b.o.next=a;a.o=b.o}\nfunction ac(a,b,c,d,e){var f,g=b.x-a.x,h=b.y-a.y;var k=d.x-c.x;var m=d.y-c.y;var n=g*m-h*k;if(!n)return 0;k=((c.x-a.x)*m-(c.y-a.y)*k)/n;n=(h*(c.x-a.x)-g*(c.y-a.y))/n;if(0>k||1<k||0>n||1<n)return 0;0===k?f=a:1===k?f=b:0===n?f=c:1===n&&(f=d);if(f)return f.x+=2.480549651603763E-5,f.y+=7.321997314118067E-5,f.W&&(f.W.x=f.x,f.W.y=f.y),ac(a,b,c,d,e);e.ec=a.x+k*g;e.fc=a.y+k*h;e.mb=k;e.nb=n;return 1}function cc(a){for(var b=[];a;)b.push(a.x,a.y),a=a.next;return b}\nfunction bc(a,b,c){for(b=b.next;b!==c&&b.alpha<=a.alpha;)b=b.next;a.next=b;a.o=b.o;a.next.o=a;a.o.next=a}function Xb(a,b){for(var c,d=null,e=0,f=a.length;e<f;e++){c=new Yb(a[e].x,a[e].y,d);c.Wa=b;if(c.next=d)d.o=c;d=c}return d};function fc(a,b){var c=[];a&&c.push(Ua(a));1<arguments.length&&c.push(""+b);c=Error(c.join(" "));Object.setPrototypeOf(c,fc.prototype);return c}wa(fc,Error);t("H.lang.IllegalOperationError",fc);fc.prototype.name="IllegalOperationError";function gc(){this.constructor=this.constructor;if(!Qa("STATIC_DB"))throw new y(this.constructor,0);this.i=hc();if(!this.i)throw new fc(this.constructor,"This browser does not support IndexedDB");this.a=[];this.c=[];this.g=Fa(this.g,this)}var ic,jc;gc.prototype.get=function(a,b,c){var d;if(!Qa(a)&&!Sa(a))throw new y(this.get,0);if(!r(b))throw new y(this.get,1);kc(this,function(e){d=e.get(a);lc(d,b,c)},c);return{cancel:function(){d&&(d.onsuccess=mc)}}};\ngc.prototype.g=function(){var a=this.b.result;a.objectStoreNames.contains("data")||a.createObjectStore("data")};\nfunction nc(a,b,c){if(a.b)a.a?(a.a.push(b),c&&a.c.push(c)):a.f?c&&c(a.f):b(a.b.result);else{a.b=a.i.open("H_STATIC_DB",1);a.b.onupgradeneeded=a.g;var d=a.b.onerror=function(){clearTimeout(a.j);a.f=this.error;a.c.forEach(function(e){e(a.f)});delete a.a;delete a.c};a.j=setTimeout(function(){d.call({error:Error("DbOpenTimeoutError")})},500);a.b.onsuccess=function(){clearTimeout(a.j);a.a?(a.a.forEach(function(e){e(this.result)},this),delete a.a,delete a.c):(delete a.b,delete a.f,a.a=[],a.c=[])};\na.a.push(b);c&&a.c.push(c)}}function kc(a,b,c){nc(a,function(d){d=d.transaction(["data"],"readwrite");b(d.objectStore("data"))},c)}function lc(a,b,c){b&&(a.onsuccess=function(){b(this.result)});c&&(a.onerror=function(){c(this.error)})}t("H.util.IndexedDBStorage.getInstance",function(){ic||(ic=new gc);return ic});function hc(){return Ca.indexedDB||Ca.webkitIndexedDB||Ca.mozIndexedDB||Ca.msIndexedDB}\nt("H.util.IndexedDBStorage.isSupported",function(){var a="";if(jc===x)if("file:"===window.location.protocol&&-1<navigator.userAgent.toLowerCase().indexOf("firefox")&&128<=window.location.href.length)jc=!1;else{try{var b=hc();a="H_TEST_DB";var c=b&&b.open(a,1)}catch(d){}jc=!!c&&null===c.onupgradeneeded;c&&b.deleteDatabase&&b.deleteDatabase(a)}return jc});function J(){0!=oc&&(pc[this[pa]||(this[pa]=++ra)]=this);this.c=this.c;this.a=this.a}var oc=0,pc={};J.prototype.c=!1;J.prototype.s=function(){if(!this.c&&(this.c=!0,this.v(),0!=oc)){var a=this[pa]||(this[pa]=++ra);if(0!=oc&&this.a&&0<this.a.length)throw Error(this+" did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass\' method.");delete pc[a]}};\nJ.prototype.L=function(a,b){this.c?void 0!==b?a.call(b):a():(this.a||(this.a=[]),this.a.push(void 0!==b?ua(a,b):a))};J.prototype.v=function(){if(this.a)for(;this.a.length;)this.a.shift()()};function K(a,b){this.type=a;this.currentTarget=this.target=b;this.a=!1;this.ab=!0}K.prototype.stopPropagation=function(){this.a=!0};K.prototype.c=function(){this.ab=!1};t("H.util.Event",K);K.prototype.stopPropagation=K.prototype.stopPropagation;K.prototype.stopPropagation=K.prototype.stopPropagation;K.prototype.CAPTURING_PHASE=1;K.prototype.CAPTURING_PHASE=K.prototype.CAPTURING_PHASE;K.prototype.AT_TARGET=2;K.prototype.AT_TARGET=K.prototype.AT_TARGET;K.prototype.BUBBLING_PHASE=3;K.prototype.BUBBLING_PHASE=K.prototype.BUBBLING_PHASE;K.prototype.eventPhase=0;K.prototype.eventPhase=K.prototype.eventPhase;function qc(a,b,c){qc.U.constructor.call(this,a,c);this.data=b}wa(qc,K);t("H.util.DataEvent",qc);function rc(a,b,c){rc.U.constructor.call(this,a,c);this.message=b}wa(rc,K);t("H.util.ErrorEvent",rc);function sc(){}t("H.util.ICancelable",sc);sc.prototype.cancel=function(){};sc.prototype.cancel=sc.prototype.cancel;function tc(a,b){this.c=a;this.f=b;this.b=0;this.a=null}tc.prototype.get=function(){if(0<this.b){this.b--;var a=this.a;this.a=a.next;a.next=null}else a=this.c();return a};function uc(a,b){a.f(b);100>a.b&&(a.b++,b.next=a.a,a.a=b)};function vc(){this.b=this.a=null}var xc=new tc(function(){return new wc},function(a){a.reset()});vc.prototype.add=function(a,b){var c=xc.get();c.set(a,b);this.b?this.b.next=c:this.a=c;this.b=c};function yc(){var a=zc,b=null;a.a&&(b=a.a,a.a=a.a.next,a.a||(a.b=null),b.next=null);return b}function wc(){this.next=this.b=this.a=null}wc.prototype.set=function(a,b){this.a=a;this.b=b;this.next=null};wc.prototype.reset=function(){this.next=this.b=this.a=null};var Ac=String.prototype.trim?function(a){return a.trim()}:function(a){return/^[\\s\\xa0]*([\\s\\S]*?)[\\s\\xa0]*$/.exec(a)[1]};function Bc(a,b){return a<b?-1:a>b?1:0};var Cc;a:{var Dc=p.navigator;if(Dc){var Ec=Dc.userAgent;if(Ec){Cc=Ec;break a}}Cc=""}function M(a){return-1!=Cc.indexOf(a)};function Hc(a,b){this.b=a===Ic&&b||"";this.a=Jc}var Jc={},Ic={},Kc=new Hc(Ic,"");function Lc(a,b){this.b=a===Mc&&b||"";this.a=Nc}var Nc={},Mc={};function Oc(){this.a="";this.b=Pc}function Qc(){var a=Rc;if(a instanceof Oc&&a.constructor===Oc&&a.b===Pc)return a.a;na(a);return"type_error:SafeHtml"}var Pc={};function Sc(a){var b=new Oc;b.a=a;return b}Sc("<!DOCTYPE html>");var Rc=Sc("");Sc("<br>");function Tc(a){var b=new Lc(Mc,Kc instanceof Hc&&Kc.constructor===Hc&&Kc.a===Jc?Kc.b:"type_error:Const");b instanceof Lc&&b.constructor===Lc&&b.a===Nc?b=b.b:(na(b),b="type_error:TrustedResourceUrl");a.src=b.toString()};function Uc(a){Uc[" "](a);return a}Uc[" "]=ma;var Vc=M("Opera"),Wc=M("Trident")||M("MSIE"),Xc=M("Edge"),Yc=M("Gecko")&&!(-1!=Cc.toLowerCase().indexOf("webkit")&&!M("Edge"))&&!(M("Trident")||M("MSIE"))&&!M("Edge"),Zc=-1!=Cc.toLowerCase().indexOf("webkit")&&!M("Edge");function $c(){var a=p.document;return a?a.documentMode:void 0}var ad;\na:{var bd="",cd=function(){var a=Cc;if(Yc)return/rv:([^\\);]+)(\\)|;)/.exec(a);if(Xc)return/Edge\\/([\\d\\.]+)/.exec(a);if(Wc)return/\\b(?:MSIE|rv)[: ]([^\\);]+)(\\)|;)/.exec(a);if(Zc)return/WebKit\\/(\\S+)/.exec(a);if(Vc)return/(?:Version)[ \\/]?(\\S+)/.exec(a)}();cd&&(bd=cd?cd[1]:"");if(Wc){var dd=$c();if(null!=dd&&dd>parseFloat(bd)){ad=String(dd);break a}}ad=bd}var ed={},fd;fd=p.document&&Wc?$c():void 0;function gd(a){var b=document;a=String(a);"application/xhtml+xml"===b.contentType&&(a=a.toLowerCase());return b.createElement(a)};function hd(a){p.setTimeout(function(){throw a;},0)}var id;\nfunction jd(){var a=p.MessageChannel;"undefined"===typeof a&&"undefined"!==typeof window&&window.postMessage&&window.addEventListener&&!M("Presto")&&(a=function(){var e=gd("IFRAME");e.style.display="none";Tc(e);document.documentElement.appendChild(e);var f=e.contentWindow;e=f.document;e.open();e.write(Qc());e.close();var g="callImmediate"+Math.random(),h="file:"==f.location.protocol?"*":f.location.protocol+"//"+f.location.host;e=ua(function(k){if(("*"==h||k.origin==h)&&k.data==g)this.port1.onmessage()},\nthis);f.addEventListener("message",e,!1);this.port1={};this.port2={postMessage:function(){f.postMessage(g,h)}}});if("undefined"!==typeof a&&!M("Trident")&&!M("MSIE")){var b=new a,c={},d=c;b.port1.onmessage=function(){if(void 0!==c.next){c=c.next;var e=c.Pa;c.Pa=null;e()}};return function(e){d.next={Pa:e};d=d.next;b.port2.postMessage(0)}}return"undefined"!==typeof document&&"onreadystatechange"in gd("SCRIPT")?function(e){var f=gd("SCRIPT");f.onreadystatechange=function(){f.onreadystatechange=null;\nf.parentNode.removeChild(f);f=null;e();e=null};document.documentElement.appendChild(f)}:function(e){p.setTimeout(e,0)}};function kd(a,b){ld||md();nd||(ld(),nd=!0);zc.add(a,b)}var ld;function md(){if(p.Promise&&p.Promise.resolve){var a=p.Promise.resolve(void 0);ld=function(){a.then(od)}}else ld=function(){var b=od;!r(p.setImmediate)||p.Window&&p.Window.prototype&&!M("Edge")&&p.Window.prototype.setImmediate==p.setImmediate?(id||(id=jd()),id(b)):p.setImmediate(b)}}var nd=!1,zc=new vc;function od(){for(var a;a=yc();){try{a.a.call(a.b)}catch(b){hd(b)}uc(xc,a)}nd=!1};function pd(a){this.a=qd;this.j=void 0;this.f=this.b=this.c=null;this.g=this.i=!1;if(a!=ma)try{var b=this;a.call(void 0,function(c){rd(b,sd,c)},function(c){rd(b,td,c)})}catch(c){rd(this,td,c)}}var qd=0,sd=2,td=3;function ud(){this.next=this.c=this.b=this.f=this.a=null;this.g=!1}ud.prototype.reset=function(){this.c=this.b=this.f=this.a=null;this.g=!1};var vd=new tc(function(){return new ud},function(a){a.reset()});function wd(a,b,c){var d=vd.get();d.f=a;d.b=b;d.c=c;return d}\nfunction xd(a,b,c){yd(a,b,c,null)||kd(va(b,a))}function zd(a){return new pd(function(b,c){var d=a.length,e=[];if(d)for(var f=function(m,n){d--;e[m]=n;0==d&&b(e)},g=function(m){c(m)},h=0,k;h<a.length;h++)k=a[h],xd(k,va(f,h),g);else b(e)})}function Ad(){var a,b,c=new pd(function(d,e){a=d;b=e});return new Bd(c,a,b)}pd.prototype.then=function(a,b,c){return Cd(this,r(a)?a:null,r(b)?b:null,c)};pd.prototype.$goog_Thenable=!0;\npd.prototype.cancel=function(a){if(this.a==qd){var b=new Dd(a);kd(function(){Ed(this,b)},this)}};function Ed(a,b){if(a.a==qd)if(a.c){var c=a.c;if(c.b){for(var d=0,e=null,f=null,g=c.b;g&&(g.g||(d++,g.a==a&&(e=g),!(e&&1<d)));g=g.next)e||(f=g);e&&(c.a==qd&&1==d?Ed(c,b):(f?(d=f,d.next==c.f&&(c.f=d),d.next=d.next.next):Fd(c),Gd(c,e,td,b)))}a.c=null}else rd(a,td,b)}function Hd(a,b){a.b||a.a!=sd&&a.a!=td||Id(a);a.f?a.f.next=b:a.b=b;a.f=b}\nfunction Cd(a,b,c,d){var e=wd(null,null,null);e.a=new pd(function(f,g){e.f=b?function(h){try{var k=b.call(d,h);f(k)}catch(m){g(m)}}:f;e.b=c?function(h){try{var k=c.call(d,h);void 0===k&&h instanceof Dd?g(h):f(k)}catch(m){g(m)}}:g});e.a.c=a;Hd(a,e);return e.a}pd.prototype.Ea=function(a){this.a=qd;rd(this,sd,a)};pd.prototype.Ga=function(a){this.a=qd;rd(this,td,a)};\nfunction rd(a,b,c){a.a==qd&&(a===c&&(b=td,c=new TypeError("Promise cannot resolve to itself")),a.a=1,yd(c,a.Ea,a.Ga,a)||(a.j=c,a.a=b,a.c=null,Id(a),b!=td||c instanceof Dd||Jd(a,c)))}function yd(a,b,c,d){if(a instanceof pd)return Hd(a,wd(b||ma,c||null,d)),!0;if(a)try{var e=!!a.$goog_Thenable}catch(g){e=!1}else e=!1;if(e)return a.then(b,c,d),!0;if(oa(a))try{var f=a.then;if(r(f))return Kd(a,f,b,c,d),!0}catch(g){return c.call(d,g),!0}return!1}\nfunction Kd(a,b,c,d,e){function f(k){h||(h=!0,d.call(e,k))}function g(k){h||(h=!0,c.call(e,k))}var h=!1;try{b.call(a,g,f)}catch(k){f(k)}}function Id(a){a.i||(a.i=!0,kd(a.P,a))}function Fd(a){var b=null;a.b&&(b=a.b,a.b=b.next,b.next=null);a.b||(a.f=null);return b}pd.prototype.P=function(){for(var a;a=Fd(this);)Gd(this,a,this.a,this.j);this.i=!1};\nfunction Gd(a,b,c,d){if(c==td&&b.b&&!b.g)for(;a&&a.g;a=a.c)a.g=!1;if(b.a)b.a.c=null,Ld(b,c,d);else try{b.g?b.f.call(b.c):Ld(b,c,d)}catch(e){Md.call(null,e)}uc(vd,b)}function Ld(a,b,c){b==sd?a.f.call(a.c,c):a.b&&a.b.call(a.c,c)}function Jd(a,b){a.g=!0;kd(function(){a.g&&Md.call(null,b)})}var Md=hd;function Dd(a){Da.call(this,a)}wa(Dd,Da);Dd.prototype.name="cancel";function Bd(a,b,c){this.a=a;this.b=b;this.reject=c};function Nd(a,b,c){this.type=a;this.data=b;this.a=Ad();this.Xa=Fa(this.Xa,this);this.reject=Fa(this.reject,this);this.priority=Od;c!==x&&(this.priority=c);this.b().add(this)}var Od=1,Pd={hc:0,ic:Od,gc:2};l=Nd.prototype;l.then=function(a,b,c){return this.a.a.then(a,b,c)};l.Xa=function(a){this.Z=3;this.a.b(a)};l.reject=function(a){this.Z=5;this.a.reject(a)};l.Z=0;\nl.cancel=function(){if(3>this.Z){this.c();var a=this.b(),b=this.priority,c=a.a[b].indexOf(this);-1<c?a.a[b].splice(c,1):this.Ma&&a.ca.qb(this.Ma);this.Z=4}};Nd.prototype.cancel=Nd.prototype.cancel;function Qd(a){var b;this.a={};for(b in Pd)this.a[Pd[b]]=[];this.ca=a;this.ca.addEventListener("allocatable",Fa(this.b,this))}t("H.util.JobManager",Qd);var Rd=Object.keys(Pd).map(function(a){return Pd[a]}).sort().reverse();Qd.prototype.add=function(a){Na(a,Nd,this.add,0);this.a[a.priority].push(a);this.b()};Qd.prototype.contains=function(a){return-1<this.a[a.priority].indexOf(a)};\nQd.prototype.b=function(){Rd.forEach(function(a){this.a[a]=this.a[a].filter(function(b){var c;if((c=this.ca.jc(b))!==Ia){var d=Fa(this.ca.qb,this.ca,c,b);b.Ma=c;b.then(d,d);b.Z=b.kc(c)?1:5}else return!0},this)},this)};function Sd(a,b,c){var d=[],e=arguments.length;a&&d.push(Ua(a));1<e&&(e=2<e&&Oa(c,void 0,void 0,void 0)?" out of ["+c[0]+"..."+c[1]+"]":"",d.push("("+b+e+")"));d=Error(d.join(" "));Object.setPrototypeOf(d,Sd.prototype);return d}wa(Sd,Error);t("H.lang.OutOfRangeError",Sd);Sd.prototype.name="OutOfRangeError";var Td="closure_listenable_"+(1E6*Math.random()|0),Ud=0;function Vd(a,b,c,d,e){this.listener=a;this.proxy=null;this.src=b;this.type=c;this.capture=!!d;this.ha=e;this.key=++Ud;this.T=this.da=!1}function Wd(a){a.T=!0;a.listener=null;a.proxy=null;a.src=null;a.ha=null};function Xd(a){this.src=a;this.a={};this.b=0}Xd.prototype.add=function(a,b,c,d,e){var f=a.toString();a=this.a[f];a||(a=this.a[f]=[],this.b++);var g=Yd(a,b,d,e);-1<g?(b=a[g],c||(b.da=!1)):(b=new Vd(b,this.src,f,!!d,e),b.da=c,a.push(b));return b};function Zd(a,b){var c=b.type;if(c in a.a){var d=a.a[c],e=Ea(d,b),f;(f=0<=e)&&Array.prototype.splice.call(d,e,1);f&&(Wd(b),0==a.a[c].length&&(delete a.a[c],a.b--))}}\nXd.prototype.S=function(a){a=a&&a.toString();var b=0,c;for(c in this.a)if(!a||c==a){for(var d=this.a[c],e=0;e<d.length;e++)++b,Wd(d[e]);delete this.a[c];this.b--}return b};function Yd(a,b,c,d){for(var e=0;e<a.length;++e){var f=a[e];if(!f.T&&f.listener==b&&f.capture==!!c&&f.ha==d)return e}return-1};var $d;($d=!Wc)||($d=9<=Number(fd));var ae=$d,be;\nif(be=Wc){var ce;if(Object.prototype.hasOwnProperty.call(ed,"9"))ce=ed["9"];else{for(var de=0,ee=Ac(String(ad)).split("."),fe=Ac("9").split("."),ge=Math.max(ee.length,fe.length),he=0;0==de&&he<ge;he++){var ie=ee[he]||"",je=fe[he]||"";do{var ke=/(\\d*)(\\D*)(.*)/.exec(ie)||["","","",""],le=/(\\d*)(\\D*)(.*)/.exec(je)||["","","",""];if(0==ke[0].length&&0==le[0].length)break;de=Bc(0==ke[1].length?0:parseInt(ke[1],10),0==le[1].length?0:parseInt(le[1],10))||Bc(0==ke[2].length,0==le[2].length)||Bc(ke[2],le[2]);\nie=ke[3];je=le[3]}while(0==de)}ce=ed["9"]=0<=de}be=!ce}var me=be,ne=function(){if(!p.addEventListener||!Object.defineProperty)return!1;var a=!1,b=Object.defineProperty({},"passive",{get:function(){a=!0}});try{p.addEventListener("test",ma,b),p.removeEventListener("test",ma,b)}catch(c){}return a}();function oe(a,b){K.call(this,a?a.type:"");this.relatedTarget=this.currentTarget=this.target=null;this.button=this.screenY=this.screenX=this.clientY=this.clientX=0;this.key="";this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1;this.pointerId=0;this.pointerType="";this.b=null;if(a){var c=this.type=a.type,d=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;this.target=a.target||a.srcElement;this.currentTarget=b;if(b=a.relatedTarget){if(Yc){a:{try{Uc(b.nodeName);var e=!0;break a}catch(f){}e=\n!1}e||(b=null)}}else"mouseover"==c?b=a.fromElement:"mouseout"==c&&(b=a.toElement);this.relatedTarget=b;d?(this.clientX=void 0!==d.clientX?d.clientX:d.pageX,this.clientY=void 0!==d.clientY?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0):(this.clientX=void 0!==a.clientX?a.clientX:a.pageX,this.clientY=void 0!==a.clientY?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0);this.button=a.button;this.key=a.key||"";this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=\na.shiftKey;this.metaKey=a.metaKey;this.pointerId=a.pointerId||0;this.pointerType="string"===typeof a.pointerType?a.pointerType:pe[a.pointerType]||"";this.b=a;a.defaultPrevented&&this.c()}}wa(oe,K);var pe={2:"touch",3:"pen",4:"mouse"};oe.prototype.stopPropagation=function(){oe.U.stopPropagation.call(this);this.b.stopPropagation?this.b.stopPropagation():this.b.cancelBubble=!0};\noe.prototype.c=function(){oe.U.c.call(this);var a=this.b;if(a.preventDefault)a.preventDefault();else if(a.returnValue=!1,me)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};var qe="closure_lm_"+(1E6*Math.random()|0),re={},se=0;function te(a,b,c,d,e){if(d&&d.once)ue(a,b,c,d,e);else if("array"==na(b))for(var f=0;f<b.length;f++)te(a,b[f],c,d,e);else c=ve(c),a&&a[Td]?a.b.add(String(b),c,!1,oa(d)?!!d.capture:!!d,e):we(a,b,c,!1,d,e)}\nfunction we(a,b,c,d,e,f){if(!b)throw Error("Invalid event type");var g=oa(e)?!!e.capture:!!e,h=xe(a);h||(a[qe]=h=new Xd(a));c=h.add(b,c,d,g,f);if(!c.proxy){d=ye();c.proxy=d;d.src=a;d.listener=c;if(a.addEventListener)ne||(e=g),void 0===e&&(e=!1),a.addEventListener(b.toString(),d,e);else if(a.attachEvent)a.attachEvent(ze(b.toString()),d);else if(a.addListener&&a.removeListener)a.addListener(d);else throw Error("addEventListener and attachEvent are unavailable.");se++}}\nfunction ye(){var a=Ae,b=ae?function(c){return a.call(b.src,b.listener,c)}:function(c){c=a.call(b.src,b.listener,c);if(!c)return c};return b}function ue(a,b,c,d,e){if("array"==na(b))for(var f=0;f<b.length;f++)ue(a,b[f],c,d,e);else c=ve(c),a&&a[Td]?a.b.add(String(b),c,!0,oa(d)?!!d.capture:!!d,e):we(a,b,c,!0,d,e)}\nfunction Be(a,b,c,d,e){if("array"==na(b))for(var f=0;f<b.length;f++)Be(a,b[f],c,d,e);else(d=oa(d)?!!d.capture:!!d,c=ve(c),a&&a[Td])?(a=a.b,b=String(b).toString(),b in a.a&&(f=a.a[b],c=Yd(f,c,d,e),-1<c&&(Wd(f[c]),Array.prototype.splice.call(f,c,1),0==f.length&&(delete a.a[b],a.b--)))):a&&(a=xe(a))&&(b=a.a[b.toString()],a=-1,b&&(a=Yd(b,c,d,e)),(c=-1<a?b[a]:null)&&Ce(c))}\nfunction Ce(a){if("number"!==typeof a&&a&&!a.T){var b=a.src;if(b&&b[Td])Zd(b.b,a);else{var c=a.type,d=a.proxy;b.removeEventListener?b.removeEventListener(c,d,a.capture):b.detachEvent?b.detachEvent(ze(c),d):b.addListener&&b.removeListener&&b.removeListener(d);se--;(c=xe(b))?(Zd(c,a),0==c.b&&(c.src=null,b[qe]=null)):Wd(a)}}}function ze(a){return a in re?re[a]:re[a]="on"+a}\nfunction De(a,b,c,d){var e=!0;if(a=xe(a))if(b=a.a[b.toString()])for(b=b.concat(),a=0;a<b.length;a++){var f=b[a];f&&f.capture==c&&!f.T&&(f=Ee(f,d),e=e&&!1!==f)}return e}function Ee(a,b){var c=a.listener,d=a.ha||a.src;a.da&&Ce(a);return c.call(d,b)}\nfunction Ae(a,b){if(a.T)return!0;if(!ae){if(!b)a:{b=["window","event"];for(var c=p,d=0;d<b.length;d++)if(c=c[b[d]],null==c){b=null;break a}b=c}d=b;b=new oe(d,this);c=!0;if(!(0>d.keyCode||void 0!=d.returnValue)){a:{var e=!1;if(0==d.keyCode)try{d.keyCode=-1;break a}catch(g){e=!0}if(e||void 0==d.returnValue)d.returnValue=!0}d=[];for(e=b.currentTarget;e;e=e.parentNode)d.push(e);a=a.type;for(e=d.length-1;!b.a&&0<=e;e--){b.currentTarget=d[e];var f=De(d[e],a,!0,b);c=c&&f}for(e=0;!b.a&&e<d.length;e++)b.currentTarget=\nd[e],f=De(d[e],a,!1,b),c=c&&f}return c}return Ee(a,new oe(b,this))}function xe(a){a=a[qe];return a instanceof Xd?a:null}var Fe="__closure_events_fn_"+(1E9*Math.random()>>>0);function ve(a){if(r(a))return a;a[Fe]||(a[Fe]=function(b){return a.handleEvent(b)});return a[Fe]};function N(){J.call(this);this.b=new Xd(this);this.j=this;this.i=null}wa(N,J);N.prototype[Td]=!0;l=N.prototype;l.B=function(){return this.i};l.la=function(a){this.i=a};l.addEventListener=function(a,b,c,d){te(this,a,b,c,d)};l.removeEventListener=function(a,b,c,d){Be(this,a,b,c,d)};\nl.dispatchEvent=function(a){var b,c=this.B();if(c)for(b=[];c;c=c.B())b.push(c);c=this.j;var d=a.type||a;if("string"===typeof a)a=new K(a,c);else if(a instanceof K)a.target=a.target||c;else{var e=a;a=new K(d,c);Ba(a,e)}e=!0;if(b)for(var f=b.length-1;!a.a&&0<=f;f--){var g=a.currentTarget=b[f];e=g.N(d,!0,a)&&e}a.a||(g=a.currentTarget=c,e=g.N(d,!0,a)&&e,a.a||(e=g.N(d,!1,a)&&e));if(b)for(f=0;!a.a&&f<b.length;f++)g=a.currentTarget=b[f],e=g.N(d,!1,a)&&e;return e};\nl.v=function(){N.U.v.call(this);this.b&&this.b.S(void 0);this.i=null};l.N=function(a,b,c){a=this.b.a[String(a)];if(!a)return!0;a=a.concat();for(var d=!0,e=0;e<a.length;++e){var f=a[e];if(f&&!f.T&&f.capture==b){var g=f.listener,h=f.ha||f.src;f.da&&Zd(this.b,f);d=!1!==g.call(h,c)&&d}}return d&&0!=c.ab};t("H.util.EventTarget",N);N.prototype.la=N.prototype.la;N.prototype.setParentEventTarget=N.prototype.la;N.prototype.B=N.prototype.B;N.prototype.getParentEventTarget=N.prototype.B;N.prototype.addEventListener=N.prototype.addEventListener;N.prototype.addEventListener=N.prototype.addEventListener;N.prototype.removeEventListener=N.prototype.removeEventListener;N.prototype.removeEventListener=N.prototype.removeEventListener;N.prototype.dispatchEvent=N.prototype.dispatchEvent;\nN.prototype.dispatchEvent=N.prototype.dispatchEvent;N.prototype.s=N.prototype.s;N.prototype.dispose=N.prototype.s;N.prototype.L=N.prototype.L;N.prototype.addOnDisposeCallback=N.prototype.L;N.prototype.P=N.prototype.N;\nN.prototype.N=function(a,b,c){var d,e,f=!0;var g=c[c.currentTarget===c.target?"AT_TARGET":b?"CAPTURING_PHASE":(d=!0,"BUBBLING_PHASE")];if(!d||"pointerenter"!==(e=c.type)&&"pointerleave"!==e)c.eventPhase=g,f=N.prototype.P.apply(this,arguments),d&&this.B&&null===this.B()&&delete c.eventPhase;return f};N.prototype.Yb=function(a){for(var b,c=this;c&&(b=c.B())&&b!==a;)c=b;b||c.la(a)};N.prototype.setRootParentEventTarget=N.prototype.Yb;function Q(a){a=a||{};var b=a.callback;this.g=a.label;r(b)&&(this.callback=b);this.f=!!a.disabled;Q.U.constructor.call(this)}wa(Q,N);t("H.util.ContextItem",Q);Q.prototype.zb=function(){return this.g};Q.prototype.getLabel=Q.prototype.zb;Q.prototype.Xb=function(a){this.g!==a&&(this.g=a,this.dispatchEvent("update"));return this};Q.prototype.setLabel=Q.prototype.Xb;Q.prototype.Ob=function(){return this.f};Q.prototype.isDisabled=Q.prototype.Ob;\nQ.prototype.Wb=function(a){a!==this.f&&(this.f=a,this.dispatchEvent("update"));return this};Q.prototype.setDisabled=Q.prototype.Wb;var Ge=new Q;Q.SEPARATOR=Ge;function Ie(a){if(Ca.document){var b=document.createElement("canvas");b.width=b.height=1;b.getContext("2d",{lc:a})}}t("H.util.getPixelRatio",function(){return window.devicePixelRatio||1});Object.create(Ia,void 0);t("H.util.eval",function(a){return eval(a)});t("H.util.provide",function(a){var b=p.$jscomp;if(b&&("function"!=typeof b.wb?0:b.wb()))throw Error("goog.provide cannot be used within a module.");la(a,void 0)});function Je(){this.m=0}\nJe.prototype.next=function(a){if(9007199254740992===this.m)throw new Sd(a,this.m,[0,9007199254740991]);return this.m++};var Ke=new Je;Fa(Ke.next,Ke);function mc(){}var mb=Ha([]);Ha({});Ie(!0);Ie(!1);function Le(a,b,c){var d=Nb(+a,-90,90);if(b&&Ra(d))throw new y(b,c,a);return d}function Me(a,b,c){var d=+a;if(-180>d||180<d)d=Mb(d+180,360)-180;if(b&&Ra(d))throw new y(b,c,a);return d}function Ne(a,b,c){var d;if(a!==x&&Ra(d=+a)&&b)throw new y(b,c,a);return d}t("H.geo.isDBC",function(a,b){return 0>a!==0>b&&180<sb(b-a)});function R(){var a=R;if(!0===(Na(this,a)&&this.constructor===a))throw new TypeError("Illegal constructor "+Ua(a));}t("H.geo.AbstractGeometry",R);R.prototype.getBoundingBox=R.prototype.X;R.prototype.equals=R.prototype.F;R.prototype.oa="";R.prototype.va="";R.prototype.toString=function(){return this.eb([this.oa.toUpperCase()," "]).join("")};R.prototype.toString=R.prototype.toString;R.prototype.$b=function(){return{type:this.va,coordinates:this.cb()}};R.prototype.toGeoJSON=R.prototype.$b;\nR.prototype.ta=function(){return{type:this.oa,coordinates:this.ua(),boundingBox:this.X().ta()}};R.prototype.forWorkerMessage=R.prototype.ta;function S(a,b,c){this.lat=Le(a,S,0);this.lng=Me(b,S,1);c!==x&&(this.alt=Ne(c,S,2))}wa(S,R);t("H.geo.Point",S);S.prototype.F=function(a){return this===a||!!a&&this.lat===a.lat&&this.lng===a.lng&&(this.alt||0)===(a.alt||0)};S.prototype.equals=S.prototype.F;S.prototype.ra=function(a){if(this===a||this.lat===a.lat&&this.lng===a.lng)a=0;else{var b=this.lat*Ib;var c=a.lat*Ib;a=1.274200158E7*yb(nb(1,ub(vb(xb((b-c)/2),2)+zb(b)*zb(c)*vb(xb((this.lng*Ib-a.lng*Ib)/2),2))))}return a};\nS.prototype.distance=S.prototype.ra;\nS.prototype.dc=function(a,b,c){var d;if(c){if(d=b/6371000.79){b=a*Ib;a=Ib*this.lat;var e=xb(a);c=xb(d);var f=zb(d);d=Ib*this.lng;var g=zb(a);a=yb(g*zb(b)*c+e*f);b=Cb(xb(b)*g*c,f-e*xb(a));b=(d+b+E)%(2*E)-E;b*=Kb;e=new S(a*Kb,(b+540)%360-180)}return e||this}a=(a%360+360)%360;if(0===(a+90)%180)return a=this.lng+b/(6371000.79*Gb*zb(this.lat*Ib))*(270===a?-360:360),new S(this.lat,(a+540)%360-180);if(b/=6371000.79)a*=Ib,e=this.lat*Ib,c=this.lng*Ib,d=e+b*zb(a),f=d-e,g=tb(Ab(d/2+Fb)/Ab(e/2+Fb)),g=Ra(f/g)?\nzb(e):f/g,a=b*xb(a)/g,sb(d)>Eb&&(d=0<d?E-d:-(E+d)),d=new S(d*Kb,((c+a+Hb+(sb(e+f)>Eb?E:0))%Gb-E)*Kb);return d||this};S.prototype.walk=S.prototype.dc;S.prototype.X=function(){return new V(this.lat,this.lng,this.lat,this.lng)};S.prototype.getBoundingBox=S.prototype.X;function Oe(a,b,c){var d=oa(a)&&!(Ra(a.lat=Le(a.lat))||Ra(a.lng=Me(a.lng))||a.alt!==x&&Ra(a.alt=Ne(a.alt)));if(!d&&b)throw new y(b,c,a);return d}S.validate=Oe;function Pe(a){if(!a)throw new y(Pe,0,a);return new S(a.lat,a.lng,a.alt)}\nS.fromIPoint=Pe;l=S.prototype;l.oa="Point";l.eb=function(a){a.push("(",this.lng," ",this.lat,")");return a};l.va="Point";l.cb=function(){return[this.lng,this.lat,this.alt||0]};l.ua=function(){return[this.lat,this.lng,this.alt||0]};function Qe(){}function Re(a){return nb(1,ob(0,.5-tb(Ab(Fb+Eb*a/180))/E/2))}Qe.prototype.ia=function(a,b,c){c?(c.x=b/360+.5,c.y=Re(a)):c=new F(b/360+.5,Re(a));return c};Qe.prototype.latLngToPoint=Qe.prototype.ia;Qe.prototype.tb=function(a,b){return this.ia(a.lat,a.lng,b)};Qe.prototype.geoToPoint=Qe.prototype.tb;function Se(a){return 0>=a?90:1<=a?-90:Kb*(2*Bb(wb(E*(1-2*a)))-Eb)}Qe.prototype.V=function(a,b,c){c?(c.lat=Se(b),c.lng=360*(1===a?1:Mb(a,1))-180):c=new S(Se(b),360*(1===a?1:Mb(a,1))-180);return c};\nQe.prototype.xyToGeo=Qe.prototype.V;Qe.prototype.Tb=function(a,b){return this.V(a.x,a.y,b)};Qe.prototype.pointToGeo=Qe.prototype.Tb;var Te=new Qe;t("H.geo.mercator",Te);t("H.util.constants.DEFAULT_MIN_ZOOM_LEVEL",0);t("H.util.constants.DEFAULT_MAX_ZOOM_LEVEL",22);function W(a,b){this.projection=a||Te;this.b=0;this.a=this.exp=tb(b||256)/Db;Ue(this);this.y=this.x=0}t("H.geo.PixelProjection",W);var Ve=sb(24)+sb(-8);W.prototype.Vb=Te;W.prototype.projection=W.prototype.Vb;W.prototype.x=0;W.prototype.x=W.prototype.x;W.prototype.y=0;W.prototype.y=W.prototype.y;W.prototype.cc=vb(2,Ve);W.prototype.w=W.prototype.cc;W.prototype.Jb=vb(2,Ve);W.prototype.h=W.prototype.Jb;\nW.prototype.ba=function(a){if(Ra(a))throw new y(this.ba,0,a);var b=this.x/this.w;var c=this.y/this.h;this.b=a;this.a=this.exp+a;Ue(this);this.x=b*this.w;this.y=c*this.h};W.prototype.rescale=W.prototype.ba;function Ue(a){a.a>Ve&&(a.a=Ve);a.w=vb(2,a.a);a.h=vb(2,a.a)}W.prototype.Ta=function(){return this.b||0};W.prototype.getZoomScale=W.prototype.Ta;W.prototype.sb=function(a,b){a=this.projection.ia(a.lat,a.lng,b);a.x=a.x*this.w-this.x;a.y=a.y*this.h-this.y;return a};W.prototype.geoToPixel=W.prototype.sb;\nW.prototype.Fa=function(a,b){return this.projection.V((a.x+this.x)/this.w,(a.y+this.y)/this.h,b)};W.prototype.pixelToGeo=W.prototype.Fa;W.prototype.V=function(a,b,c){return this.projection.V((a+this.x)/this.w,(b+this.y)/this.h,c)};W.prototype.xyToGeo=W.prototype.V;W.prototype.Ba=function(a,b,c){a=this.projection.ia(a,b,c);a.x=a.x*this.w-this.x;a.y=a.y*this.h-this.y;return a};W.prototype.latLngToPixel=W.prototype.Ba;W.prototype.Ub=function(a){return new F(a.x*this.w-this.x,a.y*this.h-this.y)};\nW.prototype.pointToPixel=W.prototype.Ub;t("H.util.Disposable",J);J.prototype.L=J.prototype.L;J.prototype.addOnDisposeCallback=J.prototype.L;t("H.util.dispose",function(a){a&&"function"==typeof a.s&&a.s()});J.prototype.s=J.prototype.s;J.prototype.dispose=J.prototype.s;J.prototype.v=J.prototype.v;J.prototype.disposeInternal=J.prototype.v;function We(a,b,c,d){if(!a||!b||!c)throw new y(We,x,"Must specify name, version and revision parameter");this.name=a;this.version=b;this.revision=c;d&&Ba(this,d)}t("H.util.BuildInfo",We);We.prototype.toString=function(){var a,b=[];for(a in this)Qa(this[a])&&b.push(this[a]);return b.join(";")};var Xe={};function Ye(a,b,c,d){if(!a)throw new y(Ye,1,"Must specify a name parameter");return Xe[a]||(Xe[a]=new We(a,b,c,d))}We.get=Ye;function Y(a,b,c,d,e,f){if(a&&b)this.Ka(a),this.ka(b),this.Ia(c),this.Ja(e),this.bb(f),this.ma(d);else throw new y(Y,x,\'Parameters "scheme" and "host" must be specified\');}t("H.service.Url",Y);\nfunction Ze(a,b){var c=Ca.document,d;var e="";if(c){e=c.createElement("a");if(b){var f=(d=c.getElementsByTagName("base")[0])&&d.href;var g=c.head;var h=d||g.appendChild(c.createElement("base"));h.href=b}e.href=a;e=e.href;b&&(d?d.href=f:g.removeChild(h))}else/[\\w]+:\\/\\//.test(a)&&(e=a);f=/(?:(\\w+):\\/\\/)?(?:([^:]+):([^@/]*)@)?([^/:]+)?(?:[:]{1}([0-9]+))?(\\/[^?#]*)?(\\?[^#]+)?(#.*)?/.exec(e);a=f[1];g=f[4];b=f[5];h=f[6];c=f[7];d=f[8];!f[2]&&g&&/@/.test(g)&&(g=g.split("@")[1]);f=Y;h=h&&0<h.length?h.substr(1):\n"";e={};var k,m;if(c)for(k=/([?&]?([^=&+]+))(=([^&]+))?/g;m=k.exec(c);)e[decodeURIComponent(m[2])]=m[4]?decodeURIComponent(m[4]):void 0;return new f(a,g,h,e,isNaN(+b)?void 0:+b,d&&0<d.length?d.substr(1):"")}Y.parse=Ze;Y.prototype.clone=function(){var a={},b;for(b in this.a)a[b]=this.a[b];return new Y(this.i,this.g,this.b,a,this.f,this.c)};Y.prototype.clone=Y.prototype.clone;\nY.prototype.Ka=function(a){if(!a||"string"!==typeof a)throw new y(this.Ka,0,\'The "scheme" parameter must be a non-empty string.\');this.i=a;return this};Y.prototype.setScheme=Y.prototype.Ka;Y.prototype.Gb=function(){return this.i};Y.prototype.getScheme=Y.prototype.Gb;Y.prototype.ka=function(a){if(!a||"string"!==typeof a||"-"===a.charAt(0)||"."===a.charAt(0)||"."===a.charAt(a.length-1))throw new y(this.ka,0,\'The "host" parameter is not a valid host name.\');this.g=a;return this};\nY.prototype.setHost=Y.prototype.ka;Y.prototype.yb=function(){return this.g};Y.prototype.getHost=Y.prototype.yb;Y.prototype.Ia=function(a){this.b=a||void 0;return this};Y.prototype.setPath=Y.prototype.Ia;Y.prototype.Db=function(){return this.b};Y.prototype.getPath=Y.prototype.Db;Y.prototype.ma=function(a){if(a)if("object"==typeof a)this.a=a;else throw new y(this.ma,0,\'Parameter "params" must be an object.\');else this.a={};return this};Y.prototype.setQuery=Y.prototype.ma;Y.prototype.Kb=function(){return!$e(this)};\nY.prototype.hasQuery=Y.prototype.Kb;Y.prototype.getQuery=function(){return this.a};Y.prototype.getQuery=Y.prototype.getQuery;Y.prototype.Ja=function(a){if(void 0===a)this.f=a;else{var b=Nb(+a<<0,0,65535);if(b!=a)throw new y(this.Ja,0,\'Parameter "port" must be an integer in range [0...65535]\');this.f=b}return this};Y.prototype.setPort=Y.prototype.Ja;Y.prototype.Eb=function(){return this.f};Y.prototype.getPort=Y.prototype.Eb;Y.prototype.bb=function(a){this.c=a||void 0;return this};\nY.prototype.setAnchor=Y.prototype.bb;Y.prototype.ub=function(){return this.c};Y.prototype.getAnchor=Y.prototype.ub;Y.prototype.R=function(a){if("object"!==typeof a)throw new y(this.R,0,\'Parameter "other" must be an object.\');var b=this.a,c;for(c in a)a.hasOwnProperty(c)&&"function"!==typeof a[c]&&(b[c]=a[c]);return this};Y.prototype.mergeQuery=Y.prototype.R;\nY.prototype.Na=function(a){if(!a||"string"!==typeof a)throw new y(this.Na,0,\'Parameter "subDomain" must be a non-empty string\');"."===a.substr(a.length-1)&&(a=a.substr(0,a.length-1));return this.ka(a+"."+this.g)};Y.prototype.addSubDomain=Y.prototype.Na;Y.prototype.Oa=function(a){if(!a||"string"!==typeof a)throw new y(this.Oa,0,\'Parameter "subPath" must be a non-empty string\');return this.Ia((this.b?this.b+"/":"")+a)};Y.prototype.addSubPath=Y.prototype.Oa;\nY.prototype.toString=function(){return[this.i+"://",this.g,this.f?":"+this.f:"",this.b||!$e(this)||this.c?"/":"",this.b?encodeURI(this.b):"",af(this),this.c?"#"+encodeURIComponent(this.c):""].join("")};Y.prototype.toString=Y.prototype.toString;function bf(a){return encodeURIComponent(a).replace(/[!\'()*]/g,function(b){return"%"+b.charCodeAt(0).toString(16)})}\nfunction af(a){var b=[],c=a.a,d={},e;for(e in c){if(c.hasOwnProperty(e)&&"function"!==typeof c[e]){var f=a.a[e];d.K=bf(e);Na(f,cf)?f.a.forEach(function(g){return function(h){b.push(g.K+"="+bf(h))}}(d)):Na(f,df)?b.push(d.K+"="+f.b.map(function(g){return bf(g)}).join(f.a)):b.push(void 0===f?d.K:d.K+"="+bf(f))}d={K:d.K}}return 0<b.length?"?"+b.join("&"):""}function $e(a){var b,c=0;for(b in a.a)if(a.a.hasOwnProperty(b)&&"function"!==typeof a.a[b]&&(c++,0<c))break;return!c}\nfunction ef(a,b){if(Oa(a,void 0,void 0,void 0))for(var c=0;c<a.length;c++){var d=a[c];if(!Qa(d)&&!Sa(d)){var e="The Array does not contain only strings and numbers";break}}else e="Not an Array";if(e)throw new y(b,0,a);return a}function cf(a){this.a=ef(a,cf)}Y.MultiValueQueryParameter=cf;cf.prototype.Ib=function(){return this.a};cf.prototype.getValues=cf.prototype.Ib;function df(a,b){this.b=ef(a,df);if(!/^[!\\$\\(\\)\\*\\+,;]$/.test(b))throw new y(df,1,\'Invalid delimiter "\'+b+\'"\');this.a=b}\nY.DelimitedQuerySubValues=df;var ff={};function gf(a){try{importScripts.apply(self,arguments)}catch(b){this.postError("invalid_script")}}function hf(a){delete ff[a];this.postMessage(a)}function jf(a,b,c){if(r(b))var d=b;else try{d=self.eval("("+b+")"),r(d)||(d=null)}catch(e){}d?(ff[a]=d,c||this.postMessage(a)):this.postError("invalid_processor")}function kf(a){this.b=a&&a[0];this.a=a&&a[1];this.c=a&&a[2]||[]}kf.prototype.postError=function(a){this.postMessage(a,x,0)};\nkf.prototype.postMessage=function(a,b,c){self.postMessage({processor:this.b,taskId:this.a,type:c===x?1:c,data:a},b||x)};function lf(a,b,c){if(!Qa(a))throw new y(lf,0,"InvalidArgument");if(!r(b))throw new y(lf,1,"InvalidArgument");var d=mf++;nf[d]={mimeType:c||of,ob:b};(new kf(["3",d,[]])).postMessage(a,[],2)}var nf={},mf=0;\nfunction pf(a,b){var c=a;if(nf[this.a]){var d=nf[this.a];var e=d.ob;delete nf[this.a];if(b)e(null,b);else{if(d.mimeType===qf){a=new Uint8Array(a);b=a.byteLength;d="";c=0;for(var f,g,h,k;c<b;)f=a[c++],192>f||(g=a[c++],224>f?f=(f&31)<<6|g&63:(h=a[c++],240>f?f=(f&15)<<12|(g&63)<<6|h&63:(k=a[c++],f=(f&7)<<18|(g&63)<<12|(h&63)<<6|k&63))),65536>f?d+=String.fromCharCode(f):(f-=65536,d+=String.fromCharCode((f>>10)+55296,(f&1023)+56320));c=d}e(c)}}}var of=0,qf=1;function V(a,b,c,d){rf(this,Le(a,V,0),Me(b,V,1),Le(c,V,2),Me(d,V,3))}wa(V,R);t("H.geo.Rect",V);V.prototype.oa="Polygon";V.prototype.eb=function(a){var b=this.f,c=this.a,d=this.c,e=this.b;a.push("(","(",c," ",b,",",e," ",b,",",e," ",d,",",c," ",d,",",c," ",b,")",")");return a};V.prototype.F=function(a){var b=this===a;!b&&Na(a,V)&&(b=this.f===a.f&&this.a===a.a&&this.c===a.c&&this.b===a.b);return b};V.prototype.equals=V.prototype.F;\nV.prototype.clone=function(){return new V(this.f,this.a,this.c,this.b)};V.prototype.clone=V.prototype.clone;function rf(a,b,c,d,e){a.a=c;a.b=e;b<d&&(c=b,b=d,d=c);a.f=b;a.c=d;a.j=a.g=a.i=null;return a}V.prototype.Sa=function(){this.j||(this.j=new S(this.f,this.a));return this.j};V.prototype.getTopLeft=V.prototype.Sa;V.prototype.Ra=function(){this.g||(this.g=new S(this.c,this.b));return this.g};V.prototype.getBottomRight=V.prototype.Ra;V.prototype.Hb=function(){return this.f};V.prototype.getTop=V.prototype.Hb;\nV.prototype.vb=function(){return this.c};V.prototype.getBottom=V.prototype.vb;V.prototype.Ab=function(){return this.a};V.prototype.getLeft=V.prototype.Ab;V.prototype.Fb=function(){return this.b};V.prototype.getRight=V.prototype.Fb;V.prototype.G=function(){this.i||(this.i=new S(this.c+(this.f-this.c)/2,sf(this.a,this.I())));return this.i};V.prototype.getCenter=V.prototype.G;V.prototype.I=function(){return tf(this.a,this.b)};V.prototype.getWidth=V.prototype.I;\nV.prototype.O=function(){return this.f-this.c};V.prototype.getHeight=V.prototype.O;V.prototype.Nb=function(){return this.a>this.b};V.prototype.isCDB=V.prototype.Nb;V.prototype.Pb=function(){return!this.I()&&!this.O()};V.prototype.isEmpty=V.prototype.Pb;V.prototype.X=function(){return new V(this.f,this.a,this.c,this.b)};V.prototype.getBoundingBox=V.prototype.X;\nV.prototype.ea=function(a,b,c){var d=this.G();c||(a=Le(a,this.ea,0),b=Me(b,this.ea,1));b=this.J(a,b,c);a=b.G();return a.lat===d.lat&&a.lng===d.lng&&this.O()===b.O()&&this.I()===b.I()};V.prototype.containsLatLng=V.prototype.ea;V.prototype.fa=function(a,b){b||Oe(a,this.fa,0);return this.ea(a.lat,a.lng,b)};V.prototype.containsPoint=V.prototype.fa;\nV.prototype.Qa=function(a,b){var c=this.G();if(!b&&!Na(a,V))throw new y(this.Qa,0,a);b=this.ja(a,b);a=b.G();return a.lat===c.lat&&a.lng===c.lng&&this.O()===b.O()&&this.I()===b.I()};V.prototype.containsRect=V.prototype.Qa;V.prototype.J=function(a,b,c,d){if(!c){if(Ra(a=Le(a)))throw new y(this.J,0,a);if(Ra(b=Me(b)))throw new y(this.J,1,b);}return uf(this.f,this.a,this.c,this.b,a,b,a,b,d)};V.prototype.mergeLatLng=V.prototype.J;\nV.prototype.Ya=function(a,b,c){b||Oe(a,this.Ya,0);return this.J(a.lat,a.lng,b,c)};V.prototype.mergePoint=V.prototype.Ya;V.prototype.ja=function(a,b,c){if(!b&&!Na(a,V))throw new y(this.ja,0,a);return uf(this.f,this.a,this.c,this.b,a.f,a.a,a.c,a.b,c)};V.prototype.mergeRect=V.prototype.ja;V.prototype.$=function(a,b,c,d,e,f){e||(a=Le(a,this.$,0),b=Me(b,this.$,1),c=Le(c,this.$,2),d=Me(d,this.$,3));return uf(this.f,this.a,this.c,this.b,a,b,c,d,f)};V.prototype.mergeTopLeftBottomRight=V.prototype.$;\nV.prototype.Va=function(a,b){var c=this.a<=this.b,d=a.a<=a.b,e=this.a<a.b,f=a.a<this.b;if(!b&&!Na(a,V))throw new y(this.Va,0,a);return this.c<=a.f&&a.c<=this.f&&(!c&&(!d||e||f)||!d&&(e||f)||e&&f)};V.prototype.intersects=V.prototype.Va;function tf(a,b){a=b-a;return a+(0>a?360:0)}function sf(a,b){a+=b/2;return a-(180<a?360:0)}\nfunction uf(a,b,c,d,e,f,g,h,k){c=nb(c,g);a=ob(a,e);e=tf(b,d);var m=sf(b,e);g=tf(f,h);var n=sf(f,g)-m;n+=0>n-1E-6?360:0;if(180>n-1E-6){m=b;var q=h}else n=360-n,m=f,q=d;n=n+e/2+g/2;360<=n+5E-7?(m=-180,q=180):n-5E-7<e?(m=b,q=d):n-5E-7<g&&(m=f,q=h);return k?rf(k,a,m,c,q):new V(a,m,c,q)}V.merge=uf;function vf(a,b,c){c||(Oe(a,vf,0),Oe(b,vf,1));return new V(a.lat,a.lng,b.lat,b.lng)}V.fromPoints=vf;\nfunction wf(a,b){var c=1,d=a.length,e=null;var f=na(a);if("array"!=f&&("object"!=f||"number"!=typeof a.length))throw new y(wf,0,a);if(0<d)for(f=a[0],e=vf(f,f,b);c<d;c++)f=a[c],e.J(f.lat,f.lng,b,e);return e}V.coverPoints=wf;function xf(a,b){var c=3,d=a.length,e;if(!(b||a&&null!=a.length))throw new y(xf,0,a);if(0<d)for(e=new V(a[0],a[1],a[0],a[1]);c<d;c+=3)e.J(a[c],a[c+1],b,e);return e}V.coverLatLngAlts=xf;\nfunction yf(a,b){var c=1,d=a.length,e;if(b&&(!a||null==a.length))throw new y(yf,0,a);if(0<d)for(e=new V(a[0].f,a[0].a,a[0].c,a[0].b);c<d;c++)e.ja(a[c],b,e);return e}V.coverRects=yf;\nV.prototype.$a=function(a,b){var c=this.a,d=this.f,e=this.b,f=this.c,g=this.G().lng;Oe(a,this.$a,0);var h=a.lat-f-(d-f)/2;var k=a.lng-g;k=180<k||-180>k?-(g+a.lng):k;a=c+(0>k?2*k:0);a=-180>a?360+a:a;e+=0<k?2*k:0;e=180<e?e-360:e;d=0<h?d+2*h:d;90<=d&&(d=90);f=0>h?f+2*h:f;-90>=f&&(f=-90);return b?rf(b,d,a,f,e):new V(d,a,f,e)};V.prototype.resizeToCenter=V.prototype.$a;V.prototype.va="Polygon";\nV.prototype.cb=function(){return[[this.a,this.f,0],[this.b,this.f,0],[this.b,this.c,0],[this.a,this.c,0],[this.a,this.f,0]]};V.prototype.ta=function(){return this.ua()};V.prototype.ua=function(){return[this.f,this.a,this.c,this.b]};function zf(a,b,c,d){this.key="";this.x=a;this.y=b;this.b=c;this.Y=d;this.a=Ad()}zf.prototype.then=function(a,b,c){return this.a.a.then(a,b,c)};zf.prototype.reject=function(a){this.a.reject(a)};zf.prototype.cancel=function(){this.a.a.cancel()};zf.prototype.cancel=zf.prototype.cancel;function Af(a,b,c,d){var e=!!c,f,g=0,h=0,k=0,m=0,n=0,q,u=-1;var I=Ca.Float32Array;var L,w=[];if(b){b=Ja(b);a=Ja(a);e&&(f=Ja(c));c=b.length;d=d?1E-7:1E-5;for(L=new I(3*c);g<c;){I=b[g];var G=+I;var X=+a[g];e&&(q=+f[g]);Bf.test(I)?0<=u&&(0<g-u&&w.push(u,g+1),u=-1):0>u&&(u=g);g++;m=L[h++]=m+X*d;k=L[h++]=k+G*d;e&&(n=L[h]=n+q);h++}0<=u&&1<c-u&&w.push(u,c)}else L=new I(0);return{path:L,outlineIndices:w}}var Bf=/^-?0\\d/;\nfunction Cf(a,b){for(var c=0,d=a.length/3,e=new Ca.Array(d),f=0;c<d;)e[c++]=b.Ba(a[f],a[++f]),f+=2;return e};function Df(a,b){b=180/(1<<b);var c=a.lat+90;a=(a.lng+180)%360;var d=0;180==c&&d--;d+=Math.floor(c/b);return[d,Math.floor(a/b)]}var Ef=1/Math.pow(10,10);function Ff(a,b){var c=[],d=a.Sa();a=a.Ra();var e;180==a.lng&&(a.lng-=Ef);d=Df(d,b);a=Df(a,b);for(e=d[0];e>=a[0];e--)for(b=d[1];b<=a[1];b++)c.push(e,b);return c};function Gf(a,b){var c=a.tileSize||256;this.b={};this.j=Ze(a.serverUrl);this.g=b;this.fb=a.layerConfigs||[];this.i=a.projected;this.P=c;this.Ea=!1!==a.batchTiles;this.bc=a.horizontalMargin||0;this.gb=a.onlyOutline;this.ib=new W(x,c);this.f=new W(x,c);this.f.ba(22-Math.log(c)/Math.LN2+8)}wa(Gf,J);\nGf.prototype.kb=function(a,b,c){var d=this.P,e=this.bc,f={x:a*d-e,y:b*d};d={x:(a+1)*d-1+e,y:(b+1)*d-1};e=this.ib;e.ba(c);f=e.Fa(f);d=e.Fa(d);return Hf(this,new V(f.lat,f.lng,d.lat,d.lng),this.fb,{x:a,y:b,z:c})};Gf.prototype.jb=function(a,b,c,d,e){return Hf(this,new V(a,b,c,d),e)};\nfunction Hf(a,b,c,d){var e=If(c),f=e.length,g={},h,k=a.b,m=[],n=[];for(c=0;c<f;c++){var q=e[c];var u=q.layerId;var I=q.level;g[u]=q.columns;q=Ff(b,I);var L=q.length-1;for(h=0;h<L;h+=2){var w=[u,q[h+1],q[h],I].join("_");var G=k[w]||a.g.get(w);G||(G=new zf(q[h+1],q[h],I,u),G.key=w,k[w]=G,n.push(G));m.push(G)}}n.length&&(a.Ea?Jf(a,n):Kf(a,n));return zd(m.map(function(X){return X.then(Fa(this.Ga,this,X.Y,Lf(e))).then(Fa(this.hb,this,X,d||Mf)).then(Fa(this.ac,this,g[X.Y]))},a))}var Mf={x:0,y:0,z:0};\nGf.prototype.Ga=function(a,b,c){var d=c.Rows,e=d.length,f,g;if(e&&(f=b[a])){b=new C(c.Rows);var h=[];for(g=0;g<e;g++){var k=d[g];f(b.ga(g),a)&&h.push(k)}a={Rows:h};if(c=c.Meta)a.Meta=c}else a=c;return a};function Kf(a,b){function c(k,m,n){n?(delete a.b[k.key],k.reject(n)):Nf(a,k,m)}var d,e=b.length,f=a.j;for(d=0;d<e;d++){var g=b[d];var h=f.clone().R({tilex:g.x}).R({tiley:g.y}).R({level:g.b}).R({layer:g.Y});new lf(h.toString(),Fa(c,null,g),qf)}}\nfunction Jf(a,b){var c=b.length,d;for(d=0;d<c;d+=15){var e=b.slice(d,d+15);Of(a,e)}}function Of(a,b){var c=a.j.clone(),d=[],e=[],f=[],g=c.getQuery();b.length&&(b.forEach(function(h){d.push(h.x,h.y);e.push(h.b);f.push(h.Y)}),g.tilexy=d.join(","),g.layers=f.join(","),g.levels=e.join(","),c.ma(g),new lf(c.toString(),function(h,k){k?b.forEach(function(m){delete a.b[m.key];m.reject("error")}):Nf(a,b,h)},qf))}\nfunction Nf(a,b,c){var d=b.length,e;if(Oa(b,void 0,void 0,void 0)){var f=c.indexOf("[")+1;for(e=0;e<d;e++){var g=c.indexOf("]},{",f+3)+2;g<f&&(g=c.lastIndexOf("]}"));var h=c.substr(f,g-f);f=g+1;Pf(a,b[e],h)}}else Pf(a,b,c)}function Pf(a,b,c){try{var d=c.length;var e=b.key;delete a.b[e];a.g.add(e,b,2*d);var f=JSON.parse(c);b.a.b(f)}catch(g){b.reject(g.message)}}\nfunction Lf(a){var b={},c,d=a.length;for(c=0;c<d;c++){var e=a[c];if(e.rowFilter){var f=e.layerId;f=f!==x?f:e.layer;b[f]=Fa(e.rowFilter,e.rowFilterContext)}}return b}function Qf(a,b,c,d,e){return e?[new F(a,b),new F(c,b),new F(c,d),new F(a,d),new F(a,b)]:[a,b,c,b,c,d,a,d]}\nGf.prototype.hb=function(a,b,c){var d=this.f.Ta()-b.z,e=this.P<<d,f=50<<d,g=b.x*e;b=b.y*e;var h=g+e;e=b+e;var k=g-f,m=b-f,n=h+f;f=e+f;var q,u,I=c.Rows,L=I.length,w,G=/^ADAS/.test(a.Y),X=this.f,qa=this.gb,O,bb=[],Ka=[],La=[],cb=[];for(a=0;a<L;a++){var z=w=I[a];var T=(O=G)?"HPY":"LAT";var U=O?"HPX":"LON";var da=O?"HPZ":"ZLEVEL";if(z[T]){var P=Af(z[T],z[U],z[da],O);z.geometry=P;delete z[T];delete z[U];delete z[da];if(z.INNER_LAT)for(T=z.INNER_LAT.split(";"),P=z.INNER_LON.split(";"),delete z.INNER_LAT,\ndelete z.INNER_LON,z.interiors=da=[],U=T.length,z=0;z<U;z++)da.push(Af(T[z],P[z],"",O))}if(this.i){U=w;z=X;P=U.$$projected$$;T=0;if(!P){var Z=U.geometry;O=Cf(Z.path,z);w=[O];U.$$projected$$=P={Sb:w};U=(da=U.interiors)?da.length:0;w.length+=U;T|=+Rf(w,O,Z.outlineIndices);if(U)for(P.Lb=1,q=0;q<U;q++)Z=da[q],O=Cf(Z.path,z),w[1+q]=O,T|=+Rf(w,O,Z.outlineIndices);T&&(P.Qb=1+U)}z=P;O=z.Sb;w=z.Lb;var Fc=z.Qb;P=[];T=U=Lb;var db=da=x;z=O[0];if(1===z.length){var Gc=Gc||(Gc=Qf(g,b,h,e,!1));w=z[0];Rb(w.x,w.y,\nGc)&&P.push(Sf(z,g,b,d))}else{var He=O.length;for(Z=qa?Fc:0;Z<He&&(qa||!Z||P.length);Z++)if(z=O[Z],Z>=Fc){Z===Fc&&(T=P.length);var ia=Ub([z],k,m,n,f,!1);Tf(ia,g,b,d,P)}else{var Jb=Jb||(Jb=Qf(k,m,n,f,!0));if(Z>=w)if(Z===w&&(U=P.length),db)for(q=db.length;q--;){if(ia=Uf(db[q],z),u=ia.length){for(da=da||[];u--;)da.push(q);Tf(ia,g,b,d,P)}}else ia=Uf(Jb,z),Tf(ia,g,b,d,P);else if(ia=Uf(Jb,z),Tf(ia,g,b,d,P),1<ia.length&&w<He)for(db=[],q=ia.length;q--;)db[q]=ia[q]}}P.length&&(bb[a]=P,Ka[a]=U,La[a]=da,cb[a]=\nT)}}return{Zb:c,pb:bb,Mb:Ka,rb:La,Rb:cb}};function Rf(a,b,c){for(var d=c.length,e=0,f,g,h=b.length;e<d;)f=c[e++],g=c[e++],a.push(g-f===h?b:b.slice(f,g));return 0<c.length}function Uf(a,b){var c,d=[];if(c=Wb(a,b)){do{a=[];b=c;do a.push(b);while(b=b.next);d.push(a)}while(c=c.Za)}else Sb(b[0],Tb(a))?d.push(b):Sb(a[0],Tb(b))&&d.push(a);return d}function Tf(a,b,c,d,e){for(var f=0,g=a.length;f<g;f++)e.push(Sf(a[f],b,c,d))}\nfunction Sf(a,b,c,d){var e,f=a.length,g=new Int32Array(2*f),h=0;for(e=0;e<f;e++){var k=a[e];g[h++]=k.x-b>>d;g[h++]=k.y-c>>d}return g}\nGf.prototype.ac=function(a,b){var c=b.Zb,d=b.pb,e=b.Mb,f=b.Rb;b=b.rb;for(var g=[],h,k={Rows:g},m,n=a?a.length:0,q=0,u,I=c.Rows,L=I.length,w;q<L;q+=1)if(d[q]||!this.i){h={};u=I[q];if(n)for(m=0;m<n;m++)u.hasOwnProperty(a[m])&&(h[a[m]]=u[a[m]]);else for(w in u)"$$projected$$"!==w&&(h[w]=u[w]);u.geometry&&(h.geometry=u.geometry);m=void 0;var G,X=h,qa=d[q],O=e[q],bb=b[q],Ka=f[q],La=g;if(qa){var cb=qa.length;if(bb)for(G=O;G--;){if(G){var z={};for(m in X)z[m]=X[m]}else z=X;u=[qa[G]];var T=nb(cb,Ka)-O;for(h=\n0;h<T;h++)bb[h]===G&&u.push(qa[O+h]);T=u.length;if(!G)for(h=Ka;h<cb;h++)u.push(qa[h]);z.$HProjGeometry={paths:u,interiorsIndex:1,outlinesIndex:T};La.push(z)}else X.$HProjGeometry={paths:qa,interiorsIndex:O,outlinesIndex:Ka},La.push(X)}else La.push(X)}c.Meta&&(k.Meta=c.Meta);return k};Gf.prototype.v=function(){var a,b=this.b;for(a in b)b.hasOwnProperty(a)&&(b[a].reject("disposed"),delete b[a])};Gf.prototype.disposeInternal=Gf.prototype.v;\nfunction If(a){for(var b=[],c,d=a.length,e=0;e<d;e++){c=za(a[e]);if(c.rowFilter&&(c.rowFilter=eval("("+c.rowFilter+")"),!r(c.rowFilter)))throw Error("Invalid row filter for layer "+c.layerId);b.push(c)}return b};t("H.service.extension.worker.processor",function(a,b,c){function d(h){e.postMessage(h)}var e=this,f=ya[a];var g=function(h){e.postError(h.toString())};if(0===b)f||(ya[a]=new Gf(c,Vf)),this.postMessage(void 0);else if(f)switch(b){case 1:try{f.kb.apply(f,c).then(d,g)}catch(h){this.postError(h.message)}break;case 2:try{f.jb.apply(f,c).then(d,g)}catch(h){this.postError(h.message)}break;case 3:f.s();delete ya[a];xa()&&Vf.S();break;default:e.postError("Unsupported command")}});\nvar Vf=new A(26214400),ya=Object.create(Ia,void 0);function Wf(a,b,c){var d=a[b];a=a[b+1];this.Ua=[];this.La=0;this.b=b;this.a=[a-c,d-c,a+c,d+c]}Wf.prototype.fa=function(a,b){var c=a[b];a=a[b+1];b=this.a;return b[1]<=c&&c<=b[3]&&b[0]<=a&&a<=b[2]};Wf.prototype.G=function(){return this.b};var Xf=new F(0,0);function Yf(a,b,c,d,e){d[e]=b;d[e+1]=a}var Zf=new W;function $f(a,b,c,d,e){Zf.Ba(a,b,Xf);d[e]=Xf.x;d[e+1]=Xf.y}\nt("H.clustering.dynamicgrid.worker",function(a,b,c,d,e){var f=e?Yf:$f,g=0;e=!!self.ArrayBuffer;var h=a.byteLength?new Float64Array(a):a,k=h.length/3;a=[];var m=[],n=[],q=e?new Float64Array(2*k):[];k=0;var u=0;for(Zf.ba(d);g<h.length;){var I=h[g++];var L=h[g++];var w=h[g++];f(w,L,d,q,u);for(w=a.length;w--;)if(L=a[w],L.fa(q,u)){var G=L;break}G||(G=new Wf(q,u,b),a.push(G));w=u/2;G.La+=I||1;G.Ua.push(w);G=null;u+=2}for(w=a.length;w--;)L=a[w],b=L.La>=c,f=L.Ua,d=f.length,b?(m.push(d),m=m.concat(f)):\n(k+=d,n=n.concat(f));c=[k].concat(n,m);c=e?(new Uint32Array(c)).buffer:c;this.postMessage(c,[c])});self.addEventListener("message",function(a){a=new kf(a.data);var b=ff[a.b];if(b)try{b.apply(a,a.c)}catch(c){a.postError(c.message)}else a.postError("processor_not_found")});(function(){var a=new kf;var b=function(c,d){jf.apply(a,[c,d,!0])};b("0",gf);b("1",jf);b("2",hf);b("3",pf)})();\n',function(){var f=function(){var target=("undefined"==typeof self||!("undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope))&&(module.exports||"undefined"!=typeof window),__worker_src__,__worker_src_map__,__worker_src_origin__;target&&(__worker_src__=f.toString(),__worker_src_map__="",__worker_src_origin__="undefined"!=typeof document&&document.currentScript instanceof HTMLScriptElement?document.currentScript.src:""),function(){var toString={}.toString,classofRaw=function(t){return toString.call(t).slice(8,-1)},commonjsGlobal="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function commonjsRequire(){throw new Error("Dynamic requires are not currently supported by rollup-plugin-commonjs")}function unwrapExports(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function createCommonjsModule(t,e){return t(e={exports:{}},e.exports),e.exports}function getCjsExportFromNamespace(t){return t&&t.default||t}var commonjsHelpers=Object.freeze({commonjsGlobal,commonjsRequire,unwrapExports,createCommonjsModule,getCjsExportFromNamespace}),O="object",check=function(t){return t&&t.Math==Math&&t},global_1=check(typeof globalThis==O&&globalThis)||check(typeof window==O&&window)||check(typeof self==O&&self)||check(typeof commonjsGlobal==O&&commonjsGlobal)||Function("return this")(),fails=function(t){try{return!!t()}catch(t){return!0}},descriptors=!fails((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})),isObject=function(t){return"object"==typeof t?null!==t:"function"==typeof t},document$1=global_1.document,exist=isObject(document$1)&&isObject(document$1.createElement),documentCreateElement=function(t){return exist?document$1.createElement(t):{}},ie8DomDefine=!descriptors&&!fails((function(){return 7!=Object.defineProperty(documentCreateElement("div"),"a",{get:function(){return 7}}).a})),anObject=function(t){if(!isObject(t))throw TypeError(String(t)+" is not an object");return t},toPrimitive=function(t,e){if(!isObject(t))return t;var r,i;if(e&&"function"==typeof(r=t.toString)&&!isObject(i=r.call(t)))return i;if("function"==typeof(r=t.valueOf)&&!isObject(i=r.call(t)))return i;if(!e&&"function"==typeof(r=t.toString)&&!isObject(i=r.call(t)))return i;throw TypeError("Can't convert object to primitive value")},nativeDefineProperty=Object.defineProperty,f=descriptors?nativeDefineProperty:function(t,e,r){if(anObject(t),e=toPrimitive(e,!0),anObject(r),ie8DomDefine)try{return nativeDefineProperty(t,e,r)}catch(t){}if("get"in r||"set"in r)throw TypeError("Accessors not supported");return"value"in r&&(t[e]=r.value),t},objectDefineProperty={f},createPropertyDescriptor=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},hide=descriptors?function(t,e,r){return objectDefineProperty.f(t,e,createPropertyDescriptor(1,r))}:function(t,e,r){return t[e]=r,t},setGlobal=function(t,e){try{hide(global_1,t,e)}catch(r){global_1[t]=e}return e},isPure=!1,shared=createCommonjsModule((function(t){var e="__core-js_shared__",r=global_1[e]||setGlobal(e,{});(t.exports=function(t,e){return r[t]||(r[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.1.0",mode:"global",copyright:" 2019 Denis Pushkarev (zloirock.ru)"})})),id=0,postfix=Math.random(),uid=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++id+postfix).toString(36))},nativeSymbol=!fails((function(){return!String(Symbol())})),store=shared("wks"),Symbol$1=global_1.Symbol,wellKnownSymbol=function(t){return store[t]||(store[t]=nativeSymbol&&Symbol$1[t]||(nativeSymbol?Symbol$1:uid)("Symbol."+t))},TO_STRING_TAG=wellKnownSymbol("toStringTag"),CORRECT_ARGUMENTS="Arguments"==classofRaw(function(){return arguments}()),tryGet=function(t,e){try{return t[e]}catch(t){}},classof=function(t){var e,r,i;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(r=tryGet(e=Object(t),TO_STRING_TAG))?r:CORRECT_ARGUMENTS?classofRaw(e):"Object"==(i=classofRaw(e))&&"function"==typeof e.callee?"Arguments":i},TO_STRING_TAG$1=wellKnownSymbol("toStringTag"),test={};test[TO_STRING_TAG$1]="z";var objectToString="[object z]"!==String(test)?function(){return"[object "+classof(this)+"]"}:test.toString,hasOwnProperty={}.hasOwnProperty,has=function(t,e){return hasOwnProperty.call(t,e)},functionToString=shared("native-function-to-string",Function.toString),WeakMap=global_1.WeakMap,nativeWeakMap="function"==typeof WeakMap&&/native code/.test(functionToString.call(WeakMap)),shared$1=shared("keys"),sharedKey=function(t){return shared$1[t]||(shared$1[t]=uid(t))},hiddenKeys={},WeakMap$1=global_1.WeakMap,set,get,has$1,enforce=function(t){return has$1(t)?get(t):set(t,{})},getterFor=function(t){return function(e){var r;if(!isObject(e)||(r=get(e)).type!==t)throw TypeError("Incompatible receiver, "+t+" required");return r}},store$1,wmget,wmhas,wmset,set,get,has$1,STATE;has$1=nativeWeakMap?(store$1=new WeakMap$1,wmget=store$1.get,wmhas=store$1.has,wmset=store$1.set,set=function(t,e){return wmset.call(store$1,t,e),e},get=function(t){return wmget.call(store$1,t)||{}},function(t){return wmhas.call(store$1,t)}):(STATE=sharedKey("state"),hiddenKeys[STATE]=!0,set=function(t,e){return hide(t,STATE,e),e},get=function(t){return has(t,STATE)?t[STATE]:{}},function(t){return has(t,STATE)});var internalState={set,get,has:has$1,enforce,getterFor},redefine=createCommonjsModule((function(t){var e=internalState.get,r=internalState.enforce,i=String(functionToString).split("toString");shared("inspectSource",(function(t){return functionToString.call(t)})),(t.exports=function(t,e,n,o){var a=!!o&&!!o.unsafe,s=!!o&&!!o.enumerable,l=!!o&&!!o.noTargetGet;"function"==typeof n&&("string"!=typeof e||has(n,"name")||hide(n,"name",e),r(n).source=i.join("string"==typeof e?e:"")),t!==global_1?(a?!l&&t[e]&&(s=!0):delete t[e],s?t[e]=n:hide(t,e,n)):s?t[e]=n:setGlobal(e,n)})(Function.prototype,"toString",(function(){return"function"==typeof this&&e(this).source||functionToString.call(this)}))})),ObjectPrototype=Object.prototype;objectToString!==ObjectPrototype.toString&&redefine(ObjectPrototype,"toString",objectToString,{unsafe:!0});var ceil=Math.ceil,floor=Math.floor,toInteger=function(t){return isNaN(t=+t)?0:(0<t?floor:ceil)(t)},requireObjectCoercible=function(t){if(null==t)throw TypeError("Can't call method on "+t);return t},stringAt=function(t,e,r){var i,n,o=String(requireObjectCoercible(t)),a=toInteger(e),s=o.length;return a<0||s<=a?r?"":void 0:(i=o.charCodeAt(a))<55296||56319<i||a+1===s||(n=o.charCodeAt(a+1))<56320||57343<n?r?o.charAt(a):i:r?o.slice(a,a+2):n-56320+(i-55296<<10)+65536},nativePropertyIsEnumerable={}.propertyIsEnumerable,nativeGetOwnPropertyDescriptor=Object.getOwnPropertyDescriptor,NASHORN_BUG=nativeGetOwnPropertyDescriptor&&!nativePropertyIsEnumerable.call({1:2},1),f$1=NASHORN_BUG?function(t){var e=nativeGetOwnPropertyDescriptor(this,t);return!!e&&e.enumerable}:nativePropertyIsEnumerable,objectPropertyIsEnumerable={f:f$1},split="".split,indexedObject=fails((function(){return!Object("z").propertyIsEnumerable(0)}))?function(t){return"String"==classofRaw(t)?split.call(t,""):Object(t)}:Object,toIndexedObject=function(t){return indexedObject(requireObjectCoercible(t))},nativeGetOwnPropertyDescriptor$1=Object.getOwnPropertyDescriptor,f$2=descriptors?nativeGetOwnPropertyDescriptor$1:function(t,e){if(t=toIndexedObject(t),e=toPrimitive(e,!0),ie8DomDefine)try{return nativeGetOwnPropertyDescriptor$1(t,e)}catch(t){}if(has(t,e))return createPropertyDescriptor(!objectPropertyIsEnumerable.f.call(t,e),t[e])},objectGetOwnPropertyDescriptor={f:f$2},min=Math.min,toLength=function(t){return 0<t?min(toInteger(t),9007199254740991):0},max=Math.max,min$1=Math.min,toAbsoluteIndex=function(t,e){var r=toInteger(t);return r<0?max(r+e,0):min$1(r,e)},arrayIncludes=function(t){return function(e,r,i){var n,o=toIndexedObject(e),a=toLength(o.length),s=toAbsoluteIndex(i,a);if(t&&r!=r){for(;s<a;)if((n=o[s++])!=n)return!0}else for(;s<a;s++)if((t||s in o)&&o[s]===r)return t||s||0;return!t&&-1}},arrayIndexOf=arrayIncludes(!1),objectKeysInternal=function(t,e){var r,i=toIndexedObject(t),n=0,o=[];for(r in i)!has(hiddenKeys,r)&&has(i,r)&&o.push(r);for(;e.length>n;)has(i,r=e[n++])&&(~arrayIndexOf(o,r)||o.push(r));return o},enumBugKeys=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],hiddenKeys$1=enumBugKeys.concat("length","prototype"),f$3=Object.getOwnPropertyNames||function(t){return objectKeysInternal(t,hiddenKeys$1)},objectGetOwnPropertyNames={f:f$3},f$4=Object.getOwnPropertySymbols,objectGetOwnPropertySymbols={f:f$4},Reflect$1=global_1.Reflect,ownKeys=Reflect$1&&Reflect$1.ownKeys||function(t){var e=objectGetOwnPropertyNames.f(anObject(t)),r=objectGetOwnPropertySymbols.f;return r?e.concat(r(t)):e},copyConstructorProperties=function(t,e){for(var r=ownKeys(e),i=objectDefineProperty.f,n=objectGetOwnPropertyDescriptor.f,o=0;o<r.length;o++){var a=r[o];has(t,a)||i(t,a,n(e,a))}},replacement=/#|\.prototype\./,isForced=function(t,e){var r=data[normalize(t)];return r==POLYFILL||r!=NATIVE&&("function"==typeof e?fails(e):!!e)},normalize=isForced.normalize=function(t){return String(t).replace(replacement,".").toLowerCase()},data=isForced.data={},NATIVE=isForced.NATIVE="N",POLYFILL=isForced.POLYFILL="P",isForced_1=isForced,getOwnPropertyDescriptor=objectGetOwnPropertyDescriptor.f,_export=function(t,e){var r,i,n,o,a=t.target,s=t.global,l=t.stat,c=s?global_1:l?global_1[a]||setGlobal(a,{}):(global_1[a]||{}).prototype;if(c)for(r in e){if(n=e[r],i=t.noTargetGet?(o=getOwnPropertyDescriptor(c,r))&&o.value:c[r],!isForced_1(s?r:a+(l?".":"#")+r,t.forced)&&void 0!==i){if(typeof n==typeof i)continue;copyConstructorProperties(n,i)}(t.sham||i&&i.sham)&&hide(n,"sham",!0),redefine(c,r,n,t)}},toObject=function(t){return Object(requireObjectCoercible(t))},correctPrototypeGetter=!fails((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype})),IE_PROTO=sharedKey("IE_PROTO"),ObjectPrototype$1=Object.prototype,objectGetPrototypeOf=correctPrototypeGetter?Object.getPrototypeOf:function(t){return t=toObject(t),has(t,IE_PROTO)?t[IE_PROTO]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?ObjectPrototype$1:null},ITERATOR=wellKnownSymbol("iterator"),BUGGY_SAFARI_ITERATORS=!1,returnThis=function(){return this},IteratorPrototype,PrototypeOfArrayIteratorPrototype,arrayIterator;[].keys&&(arrayIterator=[].keys(),"next"in arrayIterator?(PrototypeOfArrayIteratorPrototype=objectGetPrototypeOf(objectGetPrototypeOf(arrayIterator)),PrototypeOfArrayIteratorPrototype!==Object.prototype&&(IteratorPrototype=PrototypeOfArrayIteratorPrototype)):BUGGY_SAFARI_ITERATORS=!0),null==IteratorPrototype&&(IteratorPrototype={}),has(IteratorPrototype,ITERATOR)||hide(IteratorPrototype,ITERATOR,returnThis);var iteratorsCore={IteratorPrototype,BUGGY_SAFARI_ITERATORS},objectKeys=Object.keys||function(t){return objectKeysInternal(t,enumBugKeys)},objectDefineProperties=descriptors?Object.defineProperties:function(t,e){anObject(t);for(var r,i=objectKeys(e),n=i.length,o=0;o<n;)objectDefineProperty.f(t,r=i[o++],e[r]);return t},document$2=global_1.document,html=document$2&&document$2.documentElement,IE_PROTO$1=sharedKey("IE_PROTO"),PROTOTYPE="prototype",Empty=function(){},createDict=function(){var t,e=documentCreateElement("iframe"),r=enumBugKeys.length;for(e.style.display="none",html.appendChild(e),e.src=String("javascript:"),(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),createDict=t.F;r--;)delete createDict[PROTOTYPE][enumBugKeys[r]];return createDict()},objectCreate=Object.create||function(t,e){var r;return null!==t?(Empty[PROTOTYPE]=anObject(t),r=new Empty,Empty[PROTOTYPE]=null,r[IE_PROTO$1]=t):r=createDict(),void 0===e?r:objectDefineProperties(r,e)};hiddenKeys[IE_PROTO$1]=!0;var defineProperty=objectDefineProperty.f,TO_STRING_TAG$2=wellKnownSymbol("toStringTag"),setToStringTag=function(t,e,r){t&&!has(t=r?t:t.prototype,TO_STRING_TAG$2)&&defineProperty(t,TO_STRING_TAG$2,{configurable:!0,value:e})},iterators={},IteratorPrototype$1=iteratorsCore.IteratorPrototype,returnThis$1=function(){return this},createIteratorConstructor=function(t,e,r){var i=e+" Iterator";return t.prototype=objectCreate(IteratorPrototype$1,{next:createPropertyDescriptor(1,r)}),setToStringTag(t,i,!1,!0),iterators[i]=returnThis$1,t},validateSetPrototypeOfArguments=function(t,e){if(anObject(t),!isObject(e)&&null!==e)throw TypeError("Can't set "+String(e)+" as a prototype")},objectSetPrototypeOf=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,r={};try{(t=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(r,[]),e=r instanceof Array}catch(r){}return function(r,i){return validateSetPrototypeOfArguments(r,i),e?t.call(r,i):r.__proto__=i,r}}():void 0),ITERATOR$1=wellKnownSymbol("iterator"),IteratorPrototype$2=iteratorsCore.IteratorPrototype,BUGGY_SAFARI_ITERATORS$1=iteratorsCore.BUGGY_SAFARI_ITERATORS,KEYS="keys",VALUES="values",ENTRIES="entries",returnThis$2=function(){return this},defineIterator=function(t,e,r,i,n,o,a){function s(t){if(t===n&&y)return y;if(!BUGGY_SAFARI_ITERATORS$1&&t in f)return f[t];switch(t){case KEYS:case VALUES:case ENTRIES:return function(){return new r(this,t)}}return function(){return new r(this)}}createIteratorConstructor(r,e,i);var l,c,u,h=e+" Iterator",p=!1,f=t.prototype,d=f[ITERATOR$1]||f["@@iterator"]||n&&f[n],y=!BUGGY_SAFARI_ITERATORS$1&&d||s(n),g="Array"==e&&f.entries||d;if(g&&(l=objectGetPrototypeOf(g.call(new t)),IteratorPrototype$2!==Object.prototype&&l.next&&(objectGetPrototypeOf(l)!==IteratorPrototype$2&&(objectSetPrototypeOf?objectSetPrototypeOf(l,IteratorPrototype$2):"function"!=typeof l[ITERATOR$1]&&hide(l,ITERATOR$1,returnThis$2)),setToStringTag(l,h,!0,!0))),n==VALUES&&d&&d.name!==VALUES&&(p=!0,y=function(){return d.call(this)}),f[ITERATOR$1]!==y&&hide(f,ITERATOR$1,y),iterators[e]=y,n)if(c={values:s(VALUES),keys:o?y:s(KEYS),entries:s(ENTRIES)},a)for(u in c)!BUGGY_SAFARI_ITERATORS$1&&!p&&u in f||redefine(f,u,c[u]);else _export({target:e,proto:!0,forced:BUGGY_SAFARI_ITERATORS$1||p},c);return c},STRING_ITERATOR="String Iterator",setInternalState=internalState.set,getInternalState=internalState.getterFor(STRING_ITERATOR);defineIterator(String,"String",(function(t){setInternalState(this,{type:STRING_ITERATOR,string:String(t),index:0})}),(function(){var t,e=getInternalState(this),r=e.string,i=e.index;return i>=r.length?{value:void 0,done:!0}:(t=stringAt(r,i,!0),e.index+=t.length,{value:t,done:!1})}));var domIterables={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},UNSCOPABLES=wellKnownSymbol("unscopables"),ArrayPrototype=Array.prototype;null==ArrayPrototype[UNSCOPABLES]&&hide(ArrayPrototype,UNSCOPABLES,objectCreate(null));var addToUnscopables=function(t){ArrayPrototype[UNSCOPABLES][t]=!0},ARRAY_ITERATOR="Array Iterator",setInternalState$1=internalState.set,getInternalState$1=internalState.getterFor(ARRAY_ITERATOR),es_array_iterator=defineIterator(Array,"Array",(function(t,e){setInternalState$1(this,{type:ARRAY_ITERATOR,target:toIndexedObject(t),index:0,kind:e})}),(function(){var t=getInternalState$1(this),e=t.target,r=t.kind,i=t.index++;return!e||i>=e.length?{value:t.target=void 0,done:!0}:"keys"==r?{value:i,done:!1}:"values"==r?{value:e[i],done:!1}:{value:[i,e[i]],done:!1}}),"values");iterators.Arguments=iterators.Array,addToUnscopables("keys"),addToUnscopables("values"),addToUnscopables("entries");var ITERATOR$2=wellKnownSymbol("iterator"),TO_STRING_TAG$3=wellKnownSymbol("toStringTag"),ArrayValues=es_array_iterator.values;for(var COLLECTION_NAME in domIterables){var Collection=global_1[COLLECTION_NAME],CollectionPrototype=Collection&&Collection.prototype;if(CollectionPrototype){if(CollectionPrototype[ITERATOR$2]!==ArrayValues)try{hide(CollectionPrototype,ITERATOR$2,ArrayValues)}catch(t){CollectionPrototype[ITERATOR$2]=ArrayValues}if(CollectionPrototype[TO_STRING_TAG$3]||hide(CollectionPrototype,TO_STRING_TAG$3,COLLECTION_NAME),domIterables[COLLECTION_NAME])for(var METHOD_NAME in es_array_iterator)if(CollectionPrototype[METHOD_NAME]!==es_array_iterator[METHOD_NAME])try{hide(CollectionPrototype,METHOD_NAME,es_array_iterator[METHOD_NAME])}catch(t){CollectionPrototype[METHOD_NAME]=es_array_iterator[METHOD_NAME]}}}var aFunction=function(t){if("function"!=typeof t)throw TypeError(String(t)+" is not a function");return t},anInstance=function(t,e,r){if(!(t instanceof e))throw TypeError("Incorrect "+(r?r+" ":"")+"invocation");return t},ITERATOR$3=wellKnownSymbol("iterator"),ArrayPrototype$1=Array.prototype,isArrayIteratorMethod=function(t){return void 0!==t&&(iterators.Array===t||ArrayPrototype$1[ITERATOR$3]===t)},bindContext=function(t,e,r){if(aFunction(t),void 0===e)return t;switch(r){case 0:return function(){return t.call(e)};case 1:return function(r){return t.call(e,r)};case 2:return function(r,i){return t.call(e,r,i)};case 3:return function(r,i,n){return t.call(e,r,i,n)}}return function(){return t.apply(e,arguments)}},ITERATOR$4=wellKnownSymbol("iterator"),getIteratorMethod=function(t){if(null!=t)return t[ITERATOR$4]||t["@@iterator"]||iterators[classof(t)]},callWithSafeIterationClosing=function(t,e,r,i){try{return i?e(anObject(r)[0],r[1]):e(r)}catch(e){var n=t.return;throw void 0!==n&&anObject(n.call(t)),e}},iterate=createCommonjsModule((function(t){var e={};(t.exports=function(t,r,i,n,o){var a,s,l,c,u,h=bindContext(r,i,n?2:1);if(o)a=t;else{if("function"!=typeof(s=getIteratorMethod(t)))throw TypeError("Target is not iterable");if(isArrayIteratorMethod(s)){for(l=0,c=toLength(t.length);l<c;l++)if((n?h(anObject(u=t[l])[0],u[1]):h(t[l]))===e)return e;return}a=s.call(t)}for(;!(u=a.next()).done;)if(callWithSafeIterationClosing(a,h,u.value,n)===e)return e}).BREAK=e})),ITERATOR$5=wellKnownSymbol("iterator"),SAFE_CLOSING=!1;try{var called=0,iteratorWithReturn={next:function(){return{done:!!called++}},return:function(){SAFE_CLOSING=!0}};iteratorWithReturn[ITERATOR$5]=function(){return this}}catch(t){}var checkCorrectnessOfIteration=function(t,e){if(!e&&!SAFE_CLOSING)return!1;var r=!1;try{var i={};i[ITERATOR$5]=function(){return{next:function(){return{done:r=!0}}}},t(i)}catch(t){}return r},SPECIES=wellKnownSymbol("species"),speciesConstructor=function(t,e){var r,i=anObject(t).constructor;return void 0===i||null==(r=anObject(i)[SPECIES])?e:aFunction(r)},location=global_1.location,set$1=global_1.setImmediate,clear=global_1.clearImmediate,process=global_1.process,MessageChannel=global_1.MessageChannel,Dispatch=global_1.Dispatch,counter=0,queue={},ONREADYSTATECHANGE="onreadystatechange",defer,channel,port,run=function(t){var e;queue.hasOwnProperty(t)&&(e=queue[t],delete queue[t],e())},runner=function(t){return function(){run(t)}},listener=function(t){run(t.data)},post=function(t){global_1.postMessage(t+"",location.protocol+"//"+location.host)};set$1&&clear||(set$1=function(t){for(var e=[],r=1;r<arguments.length;)e.push(arguments[r++]);return queue[++counter]=function(){("function"==typeof t?t:Function(t)).apply(void 0,e)},defer(counter),counter},clear=function(t){delete queue[t]},"process"==classofRaw(process)?defer=function(t){process.nextTick(runner(t))}:Dispatch&&Dispatch.now?defer=function(t){Dispatch.now(runner(t))}:MessageChannel?(channel=new MessageChannel,port=channel.port2,channel.port1.onmessage=listener,defer=bindContext(port.postMessage,port,1)):!global_1.addEventListener||"function"!=typeof postMessage||global_1.importScripts||fails(post)?defer=ONREADYSTATECHANGE in documentCreateElement("script")?function(t){html.appendChild(documentCreateElement("script"))[ONREADYSTATECHANGE]=function(){html.removeChild(this),run(t)}}:function(t){setTimeout(runner(t),0)}:(defer=post,global_1.addEventListener("message",listener,!1)));var task={set:set$1,clear},navigator$1=global_1.navigator,userAgent=navigator$1&&navigator$1.userAgent||"",getOwnPropertyDescriptor$1=objectGetOwnPropertyDescriptor.f,macrotask=task.set,MutationObserver=global_1.MutationObserver||global_1.WebKitMutationObserver,process$1=global_1.process,Promise$1=global_1.Promise,IS_NODE="process"==classofRaw(process$1),queueMicrotaskDescriptor=getOwnPropertyDescriptor$1(global_1,"queueMicrotask"),queueMicrotask=queueMicrotaskDescriptor&&queueMicrotaskDescriptor.value,flush,head,last,notify,toggle,node,promise;queueMicrotask||(flush=function(){var t,e;for(IS_NODE&&(t=process$1.domain)&&t.exit();head;){e=head.fn,head=head.next;try{e()}catch(t){throw head?notify():last=void 0,t}}last=void 0,t&&t.enter()},notify=IS_NODE?function(){process$1.nextTick(flush)}:MutationObserver&&!/(iphone|ipod|ipad).*applewebkit/i.test(userAgent)?(toggle=!0,node=document.createTextNode(""),new MutationObserver(flush).observe(node,{characterData:!0}),function(){node.data=toggle=!toggle}):Promise$1&&Promise$1.resolve?(promise=Promise$1.resolve(void 0),function(){promise.then(flush)}):function(){macrotask.call(global_1,flush)});var microtask=queueMicrotask||function(t){var e={fn:t,next:void 0};last&&(last.next=e),head||(head=e,notify()),last=e},PromiseCapability=function(t){var e,r;this.promise=new t((function(t,i){if(void 0!==e||void 0!==r)throw TypeError("Bad Promise constructor");e=t,r=i})),this.resolve=aFunction(e),this.reject=aFunction(r)},f$5=function(t){return new PromiseCapability(t)},newPromiseCapability={f:f$5},promiseResolve=function(t,e){if(anObject(t),isObject(e)&&e.constructor===t)return e;var r=newPromiseCapability.f(t);return(0,r.resolve)(e),r.promise},hostReportErrors=function(t,e){var r=global_1.console;r&&r.error&&(1===arguments.length?r.error(t):r.error(t,e))},perform=function(t){try{return{error:!1,value:t()}}catch(t){return{error:!0,value:t}}},redefineAll=function(t,e,r){for(var i in e)redefine(t,i,e[i],r);return t},path=global_1,aFunction$1=function(t){return"function"==typeof t?t:void 0},getBuiltIn=function(t,e){return arguments.length<2?aFunction$1(path[t])||aFunction$1(global_1[t]):path[t]&&path[t][e]||global_1[t]&&global_1[t][e]},SPECIES$1=wellKnownSymbol("species"),setSpecies=function(t){var e=getBuiltIn(t),r=objectDefineProperty.f;descriptors&&e&&!e[SPECIES$1]&&r(e,SPECIES$1,{configurable:!0,get:function(){return this}})},PROMISE="Promise",task$1=task.set,SPECIES$2=wellKnownSymbol("species"),getInternalState$2=internalState.get,setInternalState$2=internalState.set,getInternalPromiseState=internalState.getterFor(PROMISE),PromiseConstructor=global_1[PROMISE],TypeError$1=global_1.TypeError,document$3=global_1.document,process$2=global_1.process,$fetch=global_1.fetch,versions=process$2&&process$2.versions,v8=versions&&versions.v8||"",newPromiseCapability$1=newPromiseCapability.f,newGenericPromiseCapability=newPromiseCapability$1,IS_NODE$1="process"==classofRaw(process$2),DISPATCH_EVENT=!!(document$3&&document$3.createEvent&&global_1.dispatchEvent),UNHANDLED_REJECTION="unhandledrejection",REJECTION_HANDLED="rejectionhandled",PENDING=0,FULFILLED=1,REJECTED=2,HANDLED=1,UNHANDLED=2,Internal,OwnPromiseCapability,PromiseWrapper,FORCED=isForced_1(PROMISE,(function(){function t(){}var e=PromiseConstructor.resolve(1),r=(e.constructor={})[SPECIES$2]=function(e){e(t,t)};return!((IS_NODE$1||"function"==typeof PromiseRejectionEvent)&&(!isPure||e.finally)&&e.then(t)instanceof r&&0!==v8.indexOf("6.6")&&-1===userAgent.indexOf("Chrome/66"))})),INCORRECT_ITERATION=FORCED||!checkCorrectnessOfIteration((function(t){PromiseConstructor.all(t).catch((function(){}))})),isThenable=function(t){var e;return!(!isObject(t)||"function"!=typeof(e=t.then))&&e},notify$1=function(t,e,r){var i;e.notified||(e.notified=!0,i=e.reactions,microtask((function(){for(var n=e.value,o=e.state==FULFILLED,a=0;i.length>a;)!function(r){var i,a,s,l=o?r.ok:r.fail,c=r.resolve,u=r.reject,h=r.domain;try{l?(o||(e.rejection===UNHANDLED&&onHandleUnhandled(t,e),e.rejection=HANDLED),!0===l?i=n:(h&&h.enter(),i=l(n),h&&(h.exit(),s=!0)),i===r.promise?u(TypeError$1("Promise-chain cycle")):(a=isThenable(i))?a.call(i,c,u):c(i)):u(n)}catch(r){h&&!s&&h.exit(),u(r)}}(i[a++]);e.reactions=[],e.notified=!1,r&&!e.rejection&&onUnhandled(t,e)})))},dispatchEvent=function(t,e,r){var i,n;DISPATCH_EVENT?((i=document$3.createEvent("Event")).promise=e,i.reason=r,i.initEvent(t,!1,!0),global_1.dispatchEvent(i)):i={promise:e,reason:r},(n=global_1["on"+t])?n(i):t===UNHANDLED_REJECTION&&hostReportErrors("Unhandled promise rejection",r)},onUnhandled=function(t,e){task$1.call(global_1,(function(){var r,i=e.value;if(isUnhandled(e)&&(r=perform((function(){IS_NODE$1?process$2.emit("unhandledRejection",i,t):dispatchEvent(UNHANDLED_REJECTION,t,i)})),e.rejection=IS_NODE$1||isUnhandled(e)?UNHANDLED:HANDLED,r.error))throw r.value}))},isUnhandled=function(t){return t.rejection!==HANDLED&&!t.parent},onHandleUnhandled=function(t,e){task$1.call(global_1,(function(){IS_NODE$1?process$2.emit("rejectionHandled",t):dispatchEvent(REJECTION_HANDLED,t,e.value)}))},bind=function(t,e,r,i){return function(n){t(e,r,n,i)}},internalReject=function(t,e,r,i){e.done||(e.done=!0,i&&(e=i),e.value=r,e.state=REJECTED,notify$1(t,e,!0))},internalResolve=function(t,e,r,i){if(!e.done){e.done=!0,i&&(e=i);try{if(t===r)throw TypeError$1("Promise can't be resolved itself");var n=isThenable(r);n?microtask((function(){var i={done:!1};try{n.call(r,bind(internalResolve,t,i,e),bind(internalReject,t,i,e))}catch(r){internalReject(t,i,r,e)}})):(e.value=r,e.state=FULFILLED,notify$1(t,e,!1))}catch(r){internalReject(t,{done:!1},r,e)}}};FORCED&&(PromiseConstructor=function(t){anInstance(this,PromiseConstructor,PROMISE),aFunction(t),Internal.call(this);var e=getInternalState$2(this);try{t(bind(internalResolve,this,e),bind(internalReject,this,e))}catch(t){internalReject(this,e,t)}},Internal=function(){setInternalState$2(this,{type:PROMISE,done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:PENDING,value:void 0})},Internal.prototype=redefineAll(PromiseConstructor.prototype,{then:function(t,e){var r=getInternalPromiseState(this),i=newPromiseCapability$1(speciesConstructor(this,PromiseConstructor));return i.ok="function"!=typeof t||t,i.fail="function"==typeof e&&e,i.domain=IS_NODE$1?process$2.domain:void 0,r.parent=!0,r.reactions.push(i),r.state!=PENDING&&notify$1(this,r,!1),i.promise},catch:function(t){return this.then(void 0,t)}}),OwnPromiseCapability=function(){var t=new Internal,e=getInternalState$2(t);this.promise=t,this.resolve=bind(internalResolve,t,e),this.reject=bind(internalReject,t,e)},newPromiseCapability.f=newPromiseCapability$1=function(t){return t===PromiseConstructor||t===PromiseWrapper?new OwnPromiseCapability(t):newGenericPromiseCapability(t)},"function"==typeof $fetch&&_export({global:!0,enumerable:!0,forced:!0},{fetch:function(t){return promiseResolve(PromiseConstructor,$fetch.apply(global_1,arguments))}})),_export({global:!0,wrap:!0,forced:FORCED},{Promise:PromiseConstructor}),setToStringTag(PromiseConstructor,PROMISE,!1,!0),setSpecies(PROMISE),PromiseWrapper=path[PROMISE],_export({target:PROMISE,stat:!0,forced:FORCED},{reject:function(t){var e=newPromiseCapability$1(this);return e.reject.call(void 0,t),e.promise}}),_export({target:PROMISE,stat:!0,forced:FORCED},{resolve:function(t){return promiseResolve(this,t)}}),_export({target:PROMISE,stat:!0,forced:INCORRECT_ITERATION},{all:function(t){var e=this,r=newPromiseCapability$1(e),i=r.resolve,n=r.reject,o=perform((function(){var r=aFunction(e.resolve),o=[],a=0,s=1;iterate(t,(function(t){var l=a++,c=!1;o.push(void 0),s++,r.call(e,t).then((function(t){c||(c=!0,o[l]=t,--s||i(o))}),n)})),--s||i(o)}));return o.error&&n(o.value),r.promise},race:function(t){var e=this,r=newPromiseCapability$1(e),i=r.reject,n=perform((function(){var n=aFunction(e.resolve);iterate(t,(function(t){n.call(e,t).then(r.resolve,i)}))}));return n.error&&i(n.value),r.promise}}),_export({target:"Promise",proto:!0,real:!0},{finally:function(t){var e=speciesConstructor(this,getBuiltIn("Promise")),r="function"==typeof t;return this.then(r?function(r){return promiseResolve(e,t()).then((function(){return r}))}:t,r?function(r){return promiseResolve(e,t()).then((function(){throw r}))}:t)}});var promise$1=path.Promise,perf,start;function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),t}function _defineProperty(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function _construct(t,e,r){return(_construct=_isNativeReflectConstruct()?Reflect.construct:function(t,e,r){var i=[null];i.push.apply(i,e);var n=new(Function.bind.apply(t,i));return r&&_setPrototypeOf(n,r.prototype),n}).apply(null,arguments)}function _isNativeFunction(t){return-1!==Function.toString.call(t).indexOf("[native code]")}function _wrapNativeSuper(t){var e="function"==typeof Map?new Map:void 0;return(_wrapNativeSuper=function(t){if(null===t||!_isNativeFunction(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return _construct(t,arguments,_getPrototypeOf(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(r,t)})(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _possibleConstructorReturn(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?_assertThisInitialized(t):e}function _createSuper(t){var e=_isNativeReflectConstruct();return function(){var r,i=_getPrototypeOf(t);return _possibleConstructorReturn(this,e?(r=_getPrototypeOf(this).constructor,Reflect.construct(i,arguments,r)):i.apply(this,arguments))}}function _superPropBase(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=_getPrototypeOf(t)););return t}function _get(t,e,r){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var i=_superPropBase(t,e);if(i){var n=Object.getOwnPropertyDescriptor(i,e);return n.get?n.get.call(r):n.value}})(t,e,r||t)}function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_unsupportedIterableToArray(t,e)||_nonIterableRest()}function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_unsupportedIterableToArray(t)||_nonIterableSpread()}function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _iterableToArray(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function _iterableToArrayLimit(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var r=[],i=!0,n=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done)&&(r.push(a.value),!e||r.length!==e);i=!0);}catch(t){n=!0,o=t}finally{try{i||null==s.return||s.return()}finally{if(n)throw o}}return r}}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=t[r];return i}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _createForOfIteratorHelper(t,e){var r;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=_unsupportedIterableToArray(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var i=0,n=function(){};return{s:n,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}"function"!=typeof Object.assign&&(Object.assign=function(t){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),r=1;r<arguments.length;r++){var i=arguments[r];if(null!=i)for(var n in i)i.hasOwnProperty(n)&&(e[n]=i[n])}return e}),"function"!=typeof Object.values&&(Object.values=function(t){return Object.keys(t).map((function(e){return t[e]}))}),Math.hypot=Math.hypot||function(){for(var t=0,e=arguments.length,r=0;r<e;r++){if(arguments[r]===1/0||arguments[r]===-1/0)return 1/0;t+=arguments[r]*arguments[r]}return Math.sqrt(t)},Math.log2=Math.log2||function(t){return Math.log(t)*Math.LOG2E},"undefined"!=typeof window?("performance"in window==0&&(window.performance={}),perf=window.performance):"undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&("performance"in self==0&&(self.performance={}),perf=self.performance),perf&&"function"!=typeof perf.now&&(start=+new Date,perf.now=function(){return new Date-start});var global$1="undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},ns={},MathUtils;(function(){var t,e,r="function"==typeof Object.defineProperties?Object.defineProperty:function(t,e,r){t!=Array.prototype&&t!=Object.prototype&&(t[e]=r.value)},i="undefined"!=typeof window&&window===this||void 0===global$1||null==global$1?this:global$1;if("function"==typeof Object.setPrototypeOf)t=Object.setPrototypeOf;else{t:{var n={};try{n.__proto__={ea:!0},e=n.ea;break t}catch(t){}e=!1}t=e?function(t,e){if(t.__proto__=e,t.__proto__!==e)throw new TypeError(t+" is not extensible");return t}:null}var o=t;!function(t,e){if(e){var n=i;t=t.split(".");for(var o=0;o<t.length-1;o++){var a=t[o];a in n||(n[a]={}),n=n[a]}(e=e(o=n[t=t[t.length-1]]))!=o&&null!=e&&r(n,t,{configurable:!0,writable:!0,value:e})}}("Object.setPrototypeOf",(function(t){return t||o}));var a=this||self;function s(t){var e=_typeof(t);if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var r=Object.prototype.toString.call(t);if("[object Window]"==r)return"object";if("[object Array]"==r||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==r||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e}function l(t){return"function"==s(t)}function c(t){var e=_typeof(t);return"object"==e&&null!=t||"function"==e}function u(t,e){t=t.split(".");var r,i=a;t[0]in i||void 0===i.execScript||i.execScript("var "+t[0]);for(;t.length&&(r=t.shift());)t.length||void 0===e?i=i[r]&&i[r]!==Object.prototype[r]?i[r]:i[r]={}:i[r]=e}function h(t,e){function r(){}r.prototype=e.prototype,t.ua=e.prototype,t.prototype=new r,t.prototype.constructor=t}var p=Math,f=p.min,d=p.max,y=p.round,g=p.floor,v=p.ceil,m=p.abs,_=p.log,b=p.sqrt,w=p.pow,x=p.sin,E=p.asin,T=p.cos,A=p.tan,S=p.atan2,k=p.PI,O=k/2,L=k/4,P=2*k,R=3*k,I=k/180,C=180/k;function M(t,e,r){return r<t?r:t<e?e:t}function N(t,e,r){return e<r?e<=t&&t<=r:r<=t&&t<=e}function j(t,e,r,i,n,o){return b(w((t-n)*(i-o)-(e-o)*(r-n),2)/(w(r-n,2)+w(i-o,2)))}u("H.math.normalize",(function(t,e,r){return e-=r=r||0,(t-=r)-g(t/e)*e+r})),u("H.math.clamp",M);var D={NONE:0,VERTEX:1,EDGE:2,SURFACE:3};function B(t,e){var r=t.x;t=t.y;for(var i,n,o,a,s=e.length,l=s,c=e[0],u=0,h=0,p=0;1!=u&&1<l;)n=e[--l],i=e[--l],a=e[l?l-1:(s+(l-1))%s],o=e[l?l-2:(s+(l-2))%s],r<=i&&i<=r&&t<=n&&n<=t||r<=o&&o<=r&&t<=a&&a<=t?u=1:u||i!==r?!u&&N(r,i,o)&&((i<r&&r<o||r<i&&o<r)&&(h+=t<(c=n+(r-i)/(o-i)*(a-n)),p+=c<t),u=N(t,n,a)&&j(r,t,i,n,o,a)<=0?2:0):(o===r&&(n<t&&t<a||t<n&&a<t)||(c<=r&&r<o||r<=c&&o<r)&&(t<=n?++h:++p),u=N(t,n,a)&&j(r,t,i,n,o,a)<=0?2:0),c=i;return u||0===p||0==h%2||(u=3),u!==D.NONE}function z(t,e){this.x=+t,this.y=+e}function F(t,e,r,i,n,o,a,s,l,c){return t={x:t,y:e,next:r||null,s:i||null,ta:n||null,X:o||null,o:!!a,T:s||0,O:l||0,alpha:c||0},i&&(t.s.next=t),r&&(t.next.s=t),t}function U(t){for(;t&&t.o;)t=t.next;return t}function G(t){if(t)for(;t.next;)t=t.next;return t}function H(t){var e=G(t);(e.s.next=t).s=e.s}function V(t){for(var e=[];t;)e.push(t.x,t.y),t=t.next;return e}function q(t,e,r){for(e=e.next;e!==r&&e.alpha<=t.alpha;)e=e.next;t.next=e,t.s=e.s,(t.next.s=t).s.next=t}function $(t,e){for(var r,i=null,n=0,o=t.length;n<o;n++)(r=F(t[n].x,t[n].y,i)).qa=e,(r.next=i)&&(i.s=r),i=r;return i}function W(t,e,r,i){return(t-=r)*t+(e-=i)*e}u("H.math.CoverType",D),u("H.math.isPointInsidePolygon",B),u("H.math.flatten",(function(t){for(var e=t.length,r=new Float64Array(2*e),i=e&&t[0].x!==K;e--;){var n=t[e],o=e<<1;r[o]=i?n.x:n[0],r[1+o]=i?n.y:n[1]}return r})),u("H.math.Point",z),(z.prototype.set=z).prototype.clone=function(t){return t?(t.x=this.x,t.y=this.y):t=new z(this.x,this.y),t},z.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this},z.prototype.sub=function(t){return this.x-=t.x,this.y-=t.y,this},z.prototype.scale=function(t,e){return this.x*=t,this.y*=void 0===e?t:e,this},z.prototype.round=function(){return this.x=y(this.x),this.y=y(this.y),this},z.prototype.floor=function(){return this.x=g(this.x),this.y=g(this.y),this},z.prototype.ceil=function(){return this.x=v(this.x),this.y=v(this.y),this},z.prototype.equals=z.prototype.w=function(t){return!(!t||this.x!==t.x||this.y!==t.y)},z.prototype.getNearest=z.prototype.la=function(t,e){var r,i=e.x-t.x,n=e.y-t.y,o=t;return(i||n)&&(o=(r=((this.x-t.x)*i+(this.y-t.y)*n)/(i*i+n*n))<=0?t:1<=r?e:new z(t.x+r*i,t.y+r*n)),o},z.prototype.distance=z.prototype.R=function(t){return b(w(this.x-t.x,2)+w(this.y-t.y,2))},z.fromIPoint=function(t){if(!t)throw Error("invalid argument");return t instanceof z?t:new z(t.x,t.y)},u("H.math.clipping.clipStrips",(function(t,e,r,i,n,o){var a,s,l,c=t.length;if(c)for(a=[];c--;)for(var u,h,p=t[c],f=p.length,d=0,y=1;y<f;y++)(l=function(t,e,r,i,n,o){var a=t.x;t=-t.y;var s=e.x;if(e=-e.y,r=-r,o=-o,s<a){if(n<s||a<i)return;var l=a,c=t;a=s,t=e,s=l,e=c,l=1}else if(n<a||s<i)return;if(e<t){if(r<e||t<o)return;var u=1;t=-t,e=-e,c=o,o=-r,r=-c}else if(r<t||e<o)return;if(a<i){if((t+=(i-a)*(e-t)/(s-a))>r)return;a=i}if(t<o){if((a+=(o-t)*(s-a)/(e-t))>n)return;t=o}return n<s&&(e=t+(n-a)*(e-t)/(s-a),s=n),r<e&&(s=a+(r-t)*(s-a)/(e-t),e=r),u&&(t=-t,e=-e),l?[new z(s,-e),new z(a,-t)]:[new z(a,-t),new z(s,-e)]}(p[y-1],p[y],r,e,i,n))&&(u=l[0],h=l[1],d&&d.w(u)?s.push(h):a.push(s=l),d=h,o&&(y=f,c=0));else a=t;return a})),u("H.math.clipping.clipPolygon",(function(t,e,r){var i;t=$(t,!0),e=$(e,!1);var n={},o=i=1;switch(~~(r||0)){case 1:o=i=0;break;case 2:i=0,o=1;break;case 3:i=1,o=0}r=i;var a,s,l,c,u,h,p=o;if(e&&t){for(e.M=F(e.x,e.y,null,G(e)),t.M=F(t.x,t.y,null,G(t)),o=e;o.next;o=o.next)if(!o.o)for(i=t;i.next;i=i.next)i.o||(h=function t(e,r,i,n,o){var a,s=r.x-e.x,l=r.y-e.y,c=n.x-i.x,u=n.y-i.y,h=s*u-l*c;return h?(c=((i.x-e.x)*u-(i.y-e.y)*c)/h,h=(l*(i.x-e.x)-s*(i.y-e.y))/h,c<0||1<c||h<0||1<h?0:(0===c?a=e:1===c?a=r:0===h?a=i:1===h&&(a=n),a?(a.x+=2480549651603763e-20,a.y+=7321997314118067e-20,a.M&&(a.M.x=a.x,a.M.y=a.y),t(e,r,i,n,o)):(o.xa=e.x+c*s,o.ya=e.y+c*l,o.fa=c,o.ga=h,1))):0}(o,a=U(o.next),i,s=U(i.next),n))&&(h=n.fa,l=n.ga,q(h=F(c=n.xa,u=n.ya,null,null,null,null,!0,0,0,h),o,a),q(a=F(c,u,null,null,null,null,!0,0,0,l),i,s),(h.X=a).X=h);for(n=B(e,V(t)),r&&(n=!n),o=e;o;o=o.next)o.o&&(n=!(o.T=n));for(n=B(t,V(e)),p&&(n=!n),i=t;i.next;i=i.next)i.o&&(n=!(i.T=n));for(H(e),H(t);(t=function(t){var e=t;if(e)for(;(e=e.next)!=t&&(!e.o||e.o&&e.O););return e}(e))!=e;){for(r=null;!t.O;t=t.X){for(n=t.T;(r=F(t.x,t.y,r)).artificial=t.o||t.qa,t.O=1,t=n?t.next:t.s;)if(t.o){t.O=1;break}if(!t)break}r.ta=f;var f=r}return f}})),u("H.math.simplifyDP",(function(t,e,r){return function t(e,r,i,n,o){var a=0,s=n,l=e[n].x,c=e[n].y,u=e[o].x,h=e[o].y,p=n+1,f=W(l,c,u,h);if(f)for(;p<o;){var d=e[p++],y=d.x,g=((y-l)*(u-l)+((d=d.y)-c)*(h-c))/f;a<(y=g<0?W(y,d,l,c):1<g?W(y,d,u,h):W(y,d,l+g*(u-l),c+g*(h-c)))&&(a=y,s=p-1)}else for(;p<o;)a<(y=W(y=(d=e[p++]).x,d=d.y,l,c))&&(a=y,s=p-1);return r<=a||0<i&&s-n?(--i,1<s-n?(n=t(e,r,i,n,s)).splice(n.length-1,1):n=[e[n]],1<o-s?n.concat(t(e,r,i,s,o)):n.concat(e.slice(s,o+1))):[e[n],e[o]]}(t,e*e,r||0,0,t.length-1)}));var Y=this,X=String,K=[].pop(),Z=/x/.exec(""),J="prototype constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Q(t,e){if(1==(t instanceof e&&t.constructor===e))throw new TypeError("Illegal constructor "+nt(e))}u("H.lang.isArray",(function(t,e,r,i){var n;if(!(n="Array"===rt(t))&&e)throw new ct(e,r,i!==K?i:t);return n})),u("H.lang.isString",(function(t){return"string"==typeof t}));var tt=isNaN;function et(t){return t===+t}function rt(t){var e=Object[J[0]][J[6]].call(t).match(/^\[object (\w+)\]$/);return e?e[1]:_typeof(t)}u("H.lang.isNumber",et),u("H.lang.isInteger",Number.isInteger?Number.isInteger:function(t){return"number"==typeof t&&0==t%1});var it=[];function nt(t,e,r,i){var n,o,a="",s=arguments.length<2;return s&&(e={H:Y.H},r="",i=it.slice()),st(e,!0,(function(e,o){try{if(n=e[o],s=n,st(e,!(u=[]),(function(t,e){t[e]===s&&u.push(e)})),o=u.sort(ot)[0],!(c(n)&&n.window===n&&n.self===n||c(n)&&0<n.nodeType&&l(n.cloneNode))&&c(n)){if(n===t)return a=r+"."+o,1;if(i.indexOf(n)<0&&(i.push(n),a=nt(t,n,r+"."+o,i)))return 1}}catch(e){}var s,u})),s&&(a=a?a.substr(1).replace("."+J[0]+".","#"):"~"+(l(t)?((o=/^\s*function ([^\( ]+)/.exec(o=t))?o[1]:"anonymous")+"()":rt(t))),a}function ot(t,e){return e.length-t.length}it.indexOf(it)<0&&it.push(it);var at=Object[J[0]][J[2]];function st(t,e,r){var i;if(t){for(n in t)if((!e||at.call(t,n))&&r(t,n,!0))return;for(i=J.length;i--;){var n=J[i];if((!e||at.call(t,n))&&r(t,n,!1))break}}}function lt(t,e,r){r[e]="#"+e}function ct(t,e,r){var i,n,o=arguments.length;return(e=e!==K?+e:e)!==K&&((n=i=(n=/^.*?\(([^\)]+)/.exec((""+t).replace(/(\/\*([\s\S]*?)\*\/)|(\/\/(.*)$)/gm,"")))?X(n[1].replace(/\s+/g,"")).split(","!==K?",":" "):[]).forEach(lt),n=n[e]||"#"+e),i=t?nt(t):"",o=2<o?X(r):"",(n||o)&&(i+=" (Argument "+(n||"")+(o?" "+o:"")+")"),o=Error(i),Object.setPrototypeOf(o,ct.prototype),o}function ut(t,e,r){var i=M(+t,-90,90);if(e&&tt(i))throw new ct(e,r,t);return i}function ht(t,e,r){var i,n=+t;if((n<-180||180<n)&&(n=(0==(i=(n+180)%360)<0?i:360+i)-180),e&&tt(n))throw new ct(e,r,t);return n}function pt(t,e,r){var i;if(t!==K&&tt(i=+t)&&e)throw new ct(e,r,t);return i}function ft(){Q(this,ft)}function dt(t,e,r){this.lat=ut(t,dt,0),this.lng=ht(e,dt,1),r!==K&&(this.alt=pt(r,dt,2))}function yt(t,e,r){var i=c(t)&&!(tt(t.lat=ut(t.lat))||tt(t.lng=ht(t.lng))||t.alt!==K&&tt(t.alt=pt(t.alt)));if(!i&&e)throw new ct(e,r,t);return i}function gt(t,e,r,i){vt(this,ut(t,gt,0),ht(e,gt,1),ut(r,gt,2),ht(i,gt,3))}function vt(t,e,r,i,n){return t.f=r,t.g=n,e<i&&(r=e,e=i,i=r),t.i=e,t.h=i,t.m=t.b=t.c=null,t}function mt(t,e){return(t=e-t)+(t<0?360:0)}function _t(t,e){return(t+=e/2)-(180<t?360:0)}function bt(t,e,r,i,n,o,a,s,l){r=f(r,a),t=d(t,n);var c=_t(e,n=mt(e,i)),u=_t(o,a=mt(o,s))-c,h=(u+=u-1e-6<0?360:0)-1e-6<180?(c=e,s):(u=360-u,c=o,i);return 360<=(u=u+n/2+a/2)+5e-7?(c=-180,h=180):u-5e-7<n?(c=e,h=i):u-5e-7<a&&(c=o,h=s),l?vt(l,t,c,r,h):new gt(t,c,r,h)}function wt(t,e,r){return r||(yt(t,wt,0),yt(e,wt,1)),new gt(t.lat,t.lng,e.lat,e.lng)}function xt(t,e,r,i,n,o){Q(this,xt),this.sa=t||10,this.c=this.b=null,this.j=i||0,this.l=n||0,this.m=e||1,this.u=r||1,this.I=!!o,this.flush()}function Et(t,e,r){var i,n;if(t.I&&(i=t.c))for(n=3;0<=n;n--){var o=e[n];if(n%3?o>=i[n]:o<=i[n]){if(!r){t.c=null;break}i[n]=o}}}function Tt(t,e){var r,i=t.a;if(e){var n=e;if(n!==i)for(i=n;n=n.c;)(n.entries||1<n.a)&&(i=n)}else for(;!i.entries&&(r=i.a)<2&&r;)i=n;t.a=i}h(ct,Error),u("H.lang.InvalidArgumentError",ct),ct.prototype.name="InvalidArgumentError",u("H.geo.isDBC",(function(t,e){return 0!=(t<0^e<0)&&180<m(e-t)})),u("H.geo.AbstractGeometry",ft),ft.prototype.getBoundingBox=ft.prototype.D,ft.prototype.equals=ft.prototype.w,ft.prototype.a="",ft.prototype.l="",ft.prototype.toString=function(){return this.I([this.a.toUpperCase()," "]).join("")},ft.prototype.toGeoJSON=ft.prototype.va=function(){return{type:this.l,coordinates:this.u()}},ft.prototype.forWorkerMessage=ft.prototype.U=function(){return{type:this.a,coordinates:this.j(),boundingBox:this.D().U()}},h(dt,ft),u("H.geo.Point",dt),dt.prototype.equals=dt.prototype.w=function(t){return this===t||!!t&&this.lat===t.lat&&this.lng===t.lng&&(this.alt||0)===(t.alt||0)},dt.prototype.distance=dt.prototype.R=function(t){var e,r;return this===t||this.lat===t.lat&&this.lng===t.lng?0:(e=this.lat*I,r=t.lat*I,12742001.58*E(f(1,b(w(x((e-r)/2),2)+T(e)*T(r)*w(x((this.lng*I-t.lng*I)/2),2)))))},dt.prototype.walk=dt.prototype.wa=function(t,e,r){var i,n,o,a,s,l,c;return r?((e/=6371000.79)&&(t*=I,s=I*this.lat,i=x(s),n=x(e),o=T(e),a=I*this.lng,l=T(s),s=E(l*T(t)*n+i*o),l=(t=(a+(t=S(x(t)*l*n,o-i*x(s)))+k)%(2*k)-k)*C),e?new dt(s*C,(l+540)%360-180):this):0==(90+(t=(t%360+360)%360))%180?(s=this.lng+e/(6371000.79*P*T(this.lat*I))*(270===t?-360:360),new dt(this.lat,(s+540)%360-180)):((e/=6371000.79)&&(t*=I,a=this.lat*I,i=this.lng*I,o=(n=a+e*T(t))-a,s=_(A(n/2+L)/A(a/2+L)),s=tt(o/s)?T(a):o/s,c=e*x(t)/s,m(n)>O&&(n=0<n?k-n:-(k+n))),e?new dt(n*C,((i+c+R+(m(a+o)>O?k:0))%P-k)*C):this)},dt.prototype.getBoundingBox=dt.prototype.D=function(){return new gt(this.lat,this.lng,this.lat,this.lng)},dt.validate=yt,dt.fromIPoint=function t(e){if(!e)throw new ct(t,0,e);return new dt(e.lat,e.lng,e.alt)},dt.prototype.a="Point",dt.prototype.I=function(t){return t.push("(",this.lng," ",this.lat,")"),t},dt.prototype.l="Point",dt.prototype.u=function(){return[this.lng,this.lat,this.alt||0]},dt.prototype.j=function(){return[this.lat,this.lng,this.alt||0]},h(gt,ft),u("H.geo.Rect",gt),gt.prototype.a="Polygon",gt.prototype.I=function(t){var e=this.i,r=this.f,i=this.h,n=this.g;return t.push("(","(",r," ",e,",",n," ",e,",",n," ",i,",",r," ",i,",",r," ",e,")",")"),t},gt.prototype.equals=gt.prototype.w=function(t){return this===t||!!t&&this.i===t.i&&this.f===t.f&&this.h===t.h&&this.g===t.g},gt.prototype.clone=function(){return new gt(this.i,this.f,this.h,this.g)},gt.prototype.getTopLeft=gt.prototype.W=function(){return this.m||(this.m=new dt(this.i,this.f)),this.m},gt.prototype.getBottomRight=gt.prototype.V=function(){return this.b||(this.b=new dt(this.h,this.g)),this.b},gt.prototype.getTop=gt.prototype.na=function(){return this.i},gt.prototype.getBottom=gt.prototype.ha=function(){return this.h},gt.prototype.getLeft=gt.prototype.ja=function(){return this.f},gt.prototype.getRight=gt.prototype.ma=function(){return this.g},gt.prototype.getCenter=gt.prototype.F=function(){return this.c||(this.c=new dt(this.h+(this.i-this.h)/2,_t(this.f,this.A()))),this.c},gt.prototype.getWidth=gt.prototype.A=function(){return mt(this.f,this.g)},gt.prototype.getHeight=gt.prototype.G=function(){return this.i-this.h},gt.prototype.isCDB=gt.prototype.N=function(){return this.f>this.g},gt.prototype.isEmpty=gt.prototype.ra=function(){return!this.A()&&!this.G()},gt.prototype.getBoundingBox=gt.prototype.D=function(){return new gt(this.i,this.f,this.h,this.g)},gt.prototype.containsLatLng=gt.prototype.L=function(t,e,r){var i=this.F();return r||(t=ut(t,this.L,0),e=ht(e,this.L,1)),(t=(e=this.B(t,e,r)).F()).lat===i.lat&&t.lng===i.lng&&this.G()===e.G()&&this.A()===e.A()},gt.prototype.containsPoint=gt.prototype.$=function(t,e){return e||yt(t,this.$,0),this.L(t.lat,t.lng,e)},gt.prototype.containsRect=gt.prototype.aa=function(t,e){var r=this.F();if(!(e||t instanceof gt))throw new ct(this.aa,0,t);return(t=(e=this.J(t,e)).F()).lat===r.lat&&t.lng===r.lng&&this.G()===e.G()&&this.A()===e.A()},gt.prototype.mergeLatLng=gt.prototype.B=function(t,e,r,i){if(!r){if(tt(t=ut(t)))throw new ct(this.B,0,t);if(tt(e=ht(e)))throw new ct(this.B,1,e)}return bt(this.i,this.f,this.h,this.g,t,e,t,e,i)},gt.prototype.mergePoint=gt.prototype.ca=function(t,e,r){return e||yt(t,this.ca,0),this.B(t.lat,t.lng,e,r)},gt.prototype.mergeRect=gt.prototype.J=function(t,e,r){if(!(e||t instanceof gt))throw new ct(this.J,0,t);return bt(this.i,this.f,this.h,this.g,t.i,t.f,t.h,t.g,r)},gt.prototype.mergeTopLeftBottomRight=gt.prototype.C=function(t,e,r,i,n,o){return n||(t=ut(t,this.C,0),e=ht(e,this.C,1),r=ut(r,this.C,2),i=ht(i,this.C,3)),bt(this.i,this.f,this.h,this.g,t,e,r,i,o)},gt.prototype.intersects=gt.prototype.ba=function(t,e){var r=this.f<=this.g,i=t.f<=t.g,n=this.f<t.g,o=t.f<this.g;if(!(e||t instanceof gt))throw new ct(this.ba,0,t);return this.h<=t.i&&t.h<=this.i&&(!r&&(!i||n||o)||!i&&(n||o)||n&&o)},gt.merge=bt,gt.fromPoints=wt,gt.coverPoints=function t(e,r){var i=1,n=e.length,o=null,a=s(e);if("array"!=a&&("object"!=a||"number"!=typeof e.length))throw new ct(t,0,e);if(0<n)for(o=wt(a=e[0],a,r);i<n;i++)a=e[i],o.B(a.lat,a.lng,r,o);return o},gt.coverLatLngAlts=function t(e,r){var i,n=3,o=e.length;if(!(r||e&&null!=e.length))throw new ct(t,0,e);if(0<o)for(i=new gt(e[0],e[1],e[0],e[1]);n<o;n+=3)i.B(e[n],e[n+1],r,i);return i},gt.coverRects=function t(e,r){var i,n=1,o=e.length;if(r&&(!e||null==e.length))throw new ct(t,0,e);if(0<o)for(i=new gt(e[0].i,e[0].f,e[0].h,e[0].g);n<o;n++)i.J(e[n],r,i);return i},gt.prototype.resizeToCenter=gt.prototype.da=function(t,e){var r=this.f,i=this.i,n=this.g,o=this.h,a=this.F().lng;yt(t,this.da,0);var s=t.lat-o-(i-o)/2,l=t.lng-a;return t=(t=r+((l=180<l||l<-180?-(a+t.lng):l)<0?2*l:0))<-180?360+t:t,n=180<(n+=0<l?2*l:0)?n-360:n,90<=(i=0<s?i+2*s:i)&&(i=90),(o=s<0?o+2*s:o)<=-90&&(o=-90),e?vt(e,i,t,o,n):new gt(i,t,o,n)},gt.prototype.l="Polygon",gt.prototype.u=function(){return[[this.f,this.i,0],[this.g,this.i,0],[this.g,this.h,0],[this.f,this.h,0],[this.f,this.i,0]]},gt.prototype.U=function(){return this.j()},gt.prototype.j=function(){return[this.i,this.f,this.h,this.g]},xt.prototype.remove=function(t){var e,r,i,n,o,a,s=!1;if(t&&(e=t.a)&&e.b===this&&(r=e.entries)&&0<=(i=r.indexOf(t))){for(r.splice(i,1),r=this.a;e;)(n=e.entries)&&n.length||(n&&delete e.entries,e.a||!(o=e.c))?e=Z:((i=o)[a=(s=e).j]===s&&(delete i[a],delete s.c,--i.a),r===e&&(r=o),e=o);this.a!==r&&(this.a=r,Tt(this)),Et(this,t,!1),s=!0}return s},xt.prototype.flush=function(){var t=new St(null,NaN,this.j-this.m,this.l-this.u,this.j+this.m,this.l+this.u);(t.b=this).a=this.b=t,this.c=null},xt.prototype.o=function(t,e,r,i,n,o){var a=[],s=this.a,l=this.b;return t<=s[5]&&e<=s[6]&&(n?r>=s[7]:r>s[7])&&(o?i>=s[4]:i>s[4])&&function t(e,r,i,n,o,a,s,l,c){var u,h=r.entries,p=r[7],f=r[4],d=r[5],y=r[6],g=r[8],v=r[9];if(h){var m=h.length;if(f<o||p<n||s<y||a<d)for(;m--;)f=(p=h[m])[3],d=p[0],y=p[1],o<=p[2]&&n<=y&&(d<s||l&&d==s)&&(f<a||c&&f==a)&&i.push(p);else for(;m--;)i.push(h[m])}(g<a||c&&a==g)&&(o<v&&(u=r[1])&&t(e,u,i,n,o,a,s,l,c),(v<s||l&&s==v)&&(u=r[3])&&t(e,u,i,n,o,a,s,l,c)),n<g&&(o<v&&(u=r[0])&&t(e,u,i,n,o,a,s,l,c),(v<s||l&&s==v)&&(u=r[2])&&t(e,u,i,n,o,a,s,l,c))}(this,s,a,t,e,r,i,o||i>=l[6],n||r>=l[5]),a};var At=0;function St(t,e,r,i,n,o){this.j=e,t&&(this.c=t,this.b=t.b,n=1&e?(r=t[8],t[5]):(r=t[7],t[8]),o=2&e?(i=t[9],t[6]):(i=t[4],t[9])),this[7]=r,this[5]=n,this[8]=(r+n)/2,this[4]=i,this[6]=o,this[9]=(i+o)/2}function kt(t,e,r,i,n,o){kt.ua.constructor.apply(this,arguments)}function Ot(t,e,r,i,n,o,a){var s,l,c=e[8],u=e[9];return a&&(n<c||(s=c<=r))&&(o<u||(l=u<=i))?r=(c=Ot)(t,e=e[s|=l<<1]||(++e.a,e[s]=new St(e,s)),r,i,n,o,a-1):(i=r=new Lt(r,i,n,o),(e.entries||(e.entries=[])).push(i),i.a=e,Et(t,r,!0),Tt(t,e)),r}function Lt(t,e,r,i){this.id=At++,this[0]=e,this[1]=r,this[2]=i,this[3]=t}function Pt(t){this.l=new kt(+t||10,180,90,0,0,!0),this.j=[],this.m=!1,this.a=this.b=this.c=null}function Rt(t,e,r,i,n,o){if(o)o=new Lt(n,-e,r+360,-i),t.j.push(o),t.m=!0,t.a&&t.a.C(e,r,i,n,!0,t.a);else{var a=-e,s=-i,l=(o=t.l).b,c=l[5],u=l[6];if(!(l[7]<=r&&l[4]<=a&&(n<c||c===n&&c===l.b.b[5])&&(s<u||u===s&&u===l.b.b[6])))throw Error("Coordinates out of bounds");o=Ot(o,o.b,r,a,n,s,o.sa),t.b&&t.b.C(e,r,i,n,!0,t.b)}return t.c=null,o}function It(t,e,r,i,n,o,a){var s=(t=t.j).length,l=[];if(s)for(var c=r+360,u=n+360;s--;){var h=t[s];(Ct(h,e,r,i,n,o,a)||Ct(h,e,c,i,u,o,a))&&l.push(h)}return l}function Ct(t,e,r,i,n,o,a){var s=t[3],l=t[0],c=t[1];return t=t[2],(o?l<=i:l<i)&&(a?s<=n:s<n)&&e<=t&&r<=c}function Mt(t,e){var r,i;if(r=e.length){for(var n=t.length,o={};n--;)o[t[n].id]=1;for(;r--;)(i=e[r]).id in o||t.push(i)}}function Nt(){}function jt(t,e,r){if(this.l=[],e&&this.K(e),r&&!l(r))throw new ct(jt,2,r);this.b=0,this.m=r,this.a={},this.j=this.c=null,this.Z(t)}function Dt(t,e){return e&&(t.c=zt(t,e,t.c)),e}function Bt(t){for(;t.b>t.u&&t.j;)Ft(t,t.j,!0)}function zt(t,e,r){return r!==e&&((e.H||e.v)&&Ft(t,e,!1),(e.H=r)&&(e.v=r.v,r.v=e),e.v||(t.c=e),e.H||(t.j=e),t.b+=e.size),e}function Ft(t,e,r){var i=e.v,n=e.H;(i||n||e==t.c&&e==t.j)&&(i?i.H=n:t.c=n,n?n.v=i:t.j=i,t.b-=e.size,r&&(delete t.a[e.id],Ut(t,e))),e.H=e.v=null}function Ut(t,e){for(var r=t.l.length;r--;)t.l[r].call(t,e.id,e.data,e.size)}St.prototype.a=0,h(kt,xt),u("H.geo.QuadTree",Pt),Pt.prototype.N=function(){return this.m},Pt.prototype.D=function(){var t;if(!this.c){var e,r,i=[];if((a=!this.b)&&(s=(o=this.l).c,o.I&&!s&&((a=o.a).entries||a[0]||a[1]||a[2]||a[3])&&(s=function t(e,r){for(var i,n,o=0,a=3;0<=a;a--){for(var s=a+4,l=0<a%3,c=[],u=r[a],h=e[a],p=h.length;p--;){var f=h[p];if(i=f.entries)for(n=i.length;n--;){var d=i[n][a];(l?u<d:d<u)&&(u=d)}for(n=4;n--;)(i=f[n])&&(l?i[s]>u:i[s]<u)&&c.push(i)}o+=c.length,r[a]=u,e[a]=c}return o&&(r=t(e,r)),r}([s=[a],s,s,s],[a[6],a[7],a[4],a[5]]),o.c=s),a=o=s),a&&(this.b=new gt(-o[0],o[3],-o[2],o[1])),(t=this.b)&&i.push(t),!this.a&&(r=(e=this.j).length)){for(a=360,s=-(o=90),l=0;r--;)var n=e[r],o=f(o,n[0]),a=f(a,n[3]),s=d(s,n[2]),l=d(l,n[1]);this.a=new gt(-o,a,-s,l-360)}(t=this.a)&&i.push(t),(t=i[0])&&(i[1]&&(t=t.J(i[1],!0)),this.c=t)}return this.c},Pt.prototype.insertBoundingBox=Pt.prototype.oa=function(t){var e=t.W(),r=t.V();return(t=t.N())?Rt(this,e.lat,r.lng,r.lat,e.lng,t):Rt(this,e.lat,e.lng,r.lat,r.lng,t)},Pt.prototype.remove=function(t){var e,r;return t.a?(r=this.l.remove(t),this.b=null):(r=0<=(t=(e=this.j).indexOf(t)))&&(e.splice(t,1),this.m=0<e.length,this.a=null),r&&(this.c=null),r},Pt.prototype.intersectBoundingBox=Pt.prototype.pa=function(t,e,r){var i=this.l,n=t.W(),o=t.V(),a=-n.lat,s=(n=n.lng,-o.lat);return o=o.lng,!e&&a==s||!r&&n===o?t=[]:t.N()?(Mt(t=i.o(-180,a,o,s,r,e),i.o(n,a,180,s,!1,e)),Mt(t,It(this,a,o,s,n+360,e,r))):Mt(t=i.o(n,a,o,s,r,e),It(this,a,n,s,o,e,r)),t},u("H.util.ICache",Nt),Nt.prototype.add=function(){},Nt.prototype.get=function(){},Nt.prototype.drop=Nt.prototype.S=function(){},Nt.prototype.forEach=function(){},Nt.prototype.removeAll=Nt.prototype.Y=function(){},Nt.prototype.registerOnDrop=Nt.prototype.K=function(){},Nt.prototype.deRegisterOnDrop=Nt.prototype.P=function(){},u("H.util.Cache",jt),jt.prototype.add=function(t,e,r){var i,n;if(!et(r=+r)||r<0)throw new ct(this.add,2,r);return t=String(t),(n=!this.m||this.m(t,e,r))&&((i=this.a[t])?(i.data!==e&&Ut(this,i),this.b+=r-i.size,i.size=r,i.data=e,Dt(this,i)):this.a[t]=zt(this,{id:t,data:e,size:r,H:null,v:null},this.c),Bt(this)),n},jt.prototype.registerOnDrop=jt.prototype.K=function(t){if(!l(t))throw new ct(this.K,0,t);this.l.push(t)},jt.prototype.deRegisterOnDrop=jt.prototype.P=function(t){this.l=this.l.filter((function(e){return e!==t}))},jt.prototype.get=function(t,e){return(t=e?this.a[t]:Dt(this,this.a[t]))&&t.data},jt.prototype.drop=jt.prototype.S=function(t){var e;(e=this.a[t])&&Ft(this,e,!0)},jt.prototype.forEach=function(t,e,r){var i;for(i in this.a){var n=this.a[i];r&&!r(i,n.data,n.size)||t.call(e,i,n.data,n.size)}},jt.prototype.removeAll=jt.prototype.Y=function(t){var e;for(e in this.a){var r=this.a[e];t&&!t(e,r.data,r.size)||Ft(this,this.a[e],!0)}},jt.prototype.setMaxSize=jt.prototype.Z=function(t){if(!(0<+t))throw new ct(jt.prototype.Z,0,t);return this.u=+t,Bt(this),this},jt.prototype.getMaxSize=jt.prototype.ka=function(){return this.u},jt.prototype.getCurrentSize=jt.prototype.ia=function(){return this.b}}).call(ns);var MathUtils$1=MathUtils={},Geo;function _xyToArr(t){return[t.x,t.y]}function _arrToXy(t){return _construct(ns.H.math.Point,_toConsumableArray(t))}MathUtils.clipPolygon=function(t,e){var r,i,n=[],o=ns.H.math.clipping.clipPolygon(t.map(_arrToXy),e.map(_arrToXy));if(o)do{for(r=[],i=o;r.push(_xyToArr(i)),i=i.next;);n.push(r)}while(o=o.nextPoly);else MathUtils.isPointInsidePolygon(e[0],t)?n.push(e):MathUtils.isPointInsidePolygon(t[0],e)&&n.push(t);return n},MathUtils.isPointInsidePolygon=function(t,e){return ns.H.math.isPointInsidePolygon({x:t[0],y:t[1]},ns.H.math.flatten(e))},MathUtils.clamp=function(t,e,r){return(t-=0)>r?r:t<e?e:t},MathUtils.splitLegs=function(t,e){var r=[];t.push(t[0]);for(var i=0;i<t.length-1;i++){var n,o=t[i],a=t[i+1];r.push(o),Math.abs(a[0]-o[0])>=e&&(n=[(o[0]+a[0])/2,(o[1]+a[1])/2],r.push(n))}return r.length!==t.length-1?MathUtils.splitLegs(r,e):r},MathUtils.getBBox=function(t){var e=1/0,r=1/0,i=-1/0,n=-1/0;return t.forEach((function(t){t[0]<e&&(e=t[0]),t[1]<r&&(r=t[1]),t[0]>i&&(i=t[0]),t[1]>n&&(n=t[1])})),[e,r,i,n]},MathUtils.getBBoxCenter=function(t){var e=_slicedToArray(t,4),r=e[0],i=e[1];return[r+(e[2]-r)/2,i+(e[3]-i)/2]},MathUtils.getLineLength=function(t,e,r,i){return Math.sqrt(Math.pow(t-r,2)+Math.pow(e-i,2))},MathUtils.modulo=function(t,e){var r;return(r=t%e)<0==e<0?r:r+e};var Geo$1=Geo={};Geo.default_source_max_zoom=18,Geo.default_view_max_zoom=20,Geo.tile_size=256,Geo.half_circumference_meters=20037508.342789244,Geo.circumference_meters=2*Geo.half_circumference_meters,Geo.min_zoom_meters_per_pixel=Geo.circumference_meters/Geo.tile_size;var meters_per_pixel=[];Geo.metersPerPixel=function(t){return meters_per_pixel[t]=meters_per_pixel[t]||Geo.min_zoom_meters_per_pixel/Math.pow(2,t),meters_per_pixel[t]};var meters_per_tile=[];Geo.metersPerTile=function(t){return meters_per_tile[t]=meters_per_tile[t]||Geo.circumference_meters/Math.pow(2,t),meters_per_tile[t]},Geo.tile_scale=4096,Geo.units_per_pixel=Geo.tile_scale/Geo.tile_size,Geo.height_scale=16;var units_per_meter=[];Geo.unitsPerMeter=function(t){return units_per_meter[t]=units_per_meter[t]||Geo.tile_scale/(Geo.tile_size*Geo.metersPerPixel(t)),units_per_meter[t]},Geo.metersForTile=function(t){return{x:t.x*Geo.circumference_meters/Math.pow(2,t.z)-Geo.half_circumference_meters,y:-(t.y*Geo.circumference_meters/Math.pow(2,t.z)-Geo.half_circumference_meters)}},Geo.tileForMeters=function(t,e){var r=_slicedToArray(t,2),i=r[0],n=r[1];return{x:Math.floor((i+Geo.half_circumference_meters)/(Geo.circumference_meters/Math.pow(2,e))),y:Math.floor((-n+Geo.half_circumference_meters)/(Geo.circumference_meters/Math.pow(2,e))),z:e}},Geo.metersToExactTileCoords=function(t,e){var r=_slicedToArray(t,2),i=r[0],n=r[1];return{x:Math.pow(2,e-1)*(1+i/Geo.half_circumference_meters),y:Math.pow(2,e-1)*(1-n/Geo.half_circumference_meters),z:e}},Geo.wrapTile=function(t){var e=t.x,r=t.y,i=t.z,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{x:!0,y:!1},o=(1<<i)-1;return n.x&&(e&=o),n.y&&(r&=o),{x:e,y:r,z:i}},Geo.wrapMeters=function(t){var e=t.x,r=t.y;return{x:MathUtils$1.modulo(e+Geo.half_circumference_meters,Geo.circumference_meters)-Geo.half_circumference_meters,y:r}},Geo.metersToLatLng=function(t){var e=_slicedToArray(t,2),r=e[0],i=e[1];return r/=Geo.half_circumference_meters,i/=Geo.half_circumference_meters,i=(2*Math.atan(Math.exp(i*Math.PI))-Math.PI/2)/Math.PI,[r*=180,i*=180]},Geo.latLngToMeters=function(t){var e=_slicedToArray(t,2),r=e[0],i=e[1];return i=Math.log(Math.tan(i*Math.PI/360+Math.PI/4))/Math.PI,i*=Geo.half_circumference_meters,i=Math.min(Math.max(i,-Geo.half_circumference_meters),Geo.half_circumference_meters),[r*=Geo.half_circumference_meters/180,i]},Geo.tileSpaceToMeters=function(t,e,r){var i=_slicedToArray(t,2),n=i[0],o=i[1],a=Geo.unitsPerMeter(e);return[n/a+r.x,o/a+r.y]},Geo.tileSpaceToLatlng=function(t,e,r){var i=Geo.unitsPerMeter(e);return Geo.transformGeometry(t,(function(t){t[0]=t[0]/i+r.x,t[1]=t[1]/i+r.y;var e=_slicedToArray(Geo.metersToLatLng(t),2),n=e[0],o=e[1];t[0]=n,t[1]=o})),t},Geo.copyGeometry=function(t){if(null!=t){var e={type:t.type};return"Point"===t.type?e.coordinates=[t.coordinates[0],t.coordinates[1]]:"LineString"===t.type||"MultiPoint"===t.type?e.coordinates=t.coordinates.map((function(t){return[t[0],t[1]]})):"Polygon"===t.type||"MultiLineString"===t.type?e.coordinates=t.coordinates.map((function(t){return t.map((function(t){return[t[0],t[1]]}))})):"MultiPolygon"===t.type&&(e.coordinates=t.coordinates.map((function(t){return t.map((function(t){return t.map((function(t){return[t[0],t[1]]}))}))}))),e}},Geo.transformGeometry=function(t,e){null!=t&&("Point"===t.type?e(t.coordinates):"LineString"===t.type||"MultiPoint"===t.type?t.coordinates.forEach(e):"Polygon"===t.type||"MultiLineString"===t.type?t.coordinates.forEach((function(t){return t.forEach(e)})):"MultiPolygon"===t.type&&t.coordinates.forEach((function(t){t.forEach((function(t){return t.forEach(e)}))})))},Geo.boxIntersect=function(t,e){return!(e.sw.x>t.ne.x||e.ne.x<t.sw.x||e.sw.y>t.ne.y||e.ne.y<t.sw.y)},Geo.findBoundingBox=function(t){for(var e=1/0,r=-1/0,i=1/0,n=-1/0,o=t[0].length,a=0;a<o;a++){var s=t[0][a];s[0]<e&&(e=s[0]),s[1]<i&&(i=s[1]),s[0]>r&&(r=s[0]),s[1]>n&&(n=s[1])}return[e,i,r,n]},Geo.geometryType=function(t){return"Polygon"===t||"MultiPolygon"===t?"polygon":"LineString"===t||"MultiLineString"===t?"line":"Point"===t||"MultiPoint"===t?"point":void 0},Geo.centroid=function(t){var e=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];if(t&&0!==t.length){var r,i=0,n=0,o=0,a=t[0],s=a.length;e&&(r=a[0],a=a.map((function(t){return[t[0]-r[0],t[1]-r[1]]})));for(var l=0,c=s-1;l<s;c=l,l++){var u=a[l],h=a[c],p=u[1]*h[0]-h[1]*u[0];i+=(u[0]+h[0])*p,n+=(u[1]+h[1])*p,o+=3*p}var f=[i/o,n/o];return e&&(f[0]+=r[0],f[1]+=r[1]),f}},Geo.multiCentroid=function(t){for(var e=t.length,r=[0,0],i=0;i<t.length;i++){var n=Geo.centroid(t[i]);r[0]+=n[0],r[1]+=n[1]}return r[0]/=e,r[1]/=e,r},Geo.signedPolygonRingAreaSum=function(t){for(var e=0,r=t.length,i=0;i<r-1;i++){var n=t[i],o=t[i+1];e+=n[0]*o[1]-o[0]*n[1]}return e+(t[r-1][0]*t[0][1]-t[0][0]*t[r-1][1])},Geo.polygonRingArea=function(t){return Math.abs(Geo.signedPolygonRingAreaSum(t))/2},Geo.polygonArea=function(t){if(t)return Geo.polygonRingArea(t[0])},Geo.multiPolygonArea=function(t){for(var e=0,r=0;r<t.length;r++)e+=Geo.polygonArea(t[r]);return e},Geo.ringWinding=function(t){var e=Geo.signedPolygonRingAreaSum(t);return 0<e?"CW":e<0?"CCW":void 0},Geo.getTileBoundingBox=function(t,e){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,i=Geo.wrapTile(t,{x:!0}),n=Geo.metersForTile(i),o=Geo.metersPerPixel(i.z),a=Geo.metersToLatLng([n.x-r*o,n.y+r*o]),s=Geo.metersToLatLng([n.x+(e+r)*o,n.y-(e+r)*o]),l=Geo.isLastTile(i);return new ns.H.geo.Rect(0===t.y?90:MathUtils$1.clamp(a[1],-90,90),MathUtils$1.clamp(a[0],-180,180),l.row?-90:MathUtils$1.clamp(s[1],-90,90),l.column?180:MathUtils$1.clamp(s[0],-180,180))},Geo.isLastTile=function(t){var e=t.x,r=t.y,i=t.z;return{row:r===Math.pow(2,i)-1,column:e===Math.pow(2,i)-1}};var MethodNotImplemented=function(){_inherits(e,_wrapNativeSuper(Error));var t=_createSuper(e);function e(r){var i;return _classCallCheck(this,e),(i=t.call(this)).name="MethodNotImplemented",i.message="Method "+r+" must be implemented in subclass",i}return e}(),is_worker=!1,is_main=!1,force_main,force_worker;try{window.document!==HTMLDocument&&(is_main=!0)}catch(t){void 0!==self&&(is_worker=!0,self.window={document:{}},self.document=self.window.document)}var Thread={get is_fake_worker(){return self.is_fake_worker},get is_worker(){return void 0!==force_worker?force_worker:is_worker||self.is_fake_worker},set is_worker(t){force_worker=t},get is_main(){return void 0!==force_main?force_main:is_main&&!self.is_fake_worker},set is_main(t){force_main=t},is_native_worker:is_worker},WorkerBroker={},message_id=0,messages={},targets={},main_worker_targets={};function findTarget(t,e){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:targets,i=[];if("string"==typeof t&&(t=(i=t.split(".")).pop()),Thread.is_main&&e&&1===i.length&&"self"===i[0])r=e;else for(var n=0;n<i.length;n++){if(!r[i[n]])return[];r=r[i[n]]}return[t,r]}WorkerBroker.addTarget=function(t,e){Thread.is_fake_worker?main_worker_targets[t]=e:targets[t]=e},WorkerBroker.removeTarget=function(t){delete targets[t],delete main_worker_targets[t]};var ERROR_NO_TARGET=" No object with that name is registered on main thread.",ERROR_NO_METHOD=" Object has no method with that name.",ERROR_NOT_SET="_worker_broker_error_not_set_";function setupMainThread(){WorkerBroker.postMessage=function(t,e){for(var r=arguments.length,i=new Array(2<r?r-2:0),n=2;n<r;n++)i[n-2]=arguments[n];if(Array.isArray(t))return Promise.all(t.map((function(t){return WorkerBroker.postMessage.apply(WorkerBroker,[t,e].concat(_toConsumableArray(i)))})));var o,a={};"object"===_typeof(e)&&(e=(a=e).method);var s="main_send";"string"==typeof t?(e=t,i=Array.prototype.slice.call(arguments,1),o=!0,s="worker_send"):t.init&&(o=!0);var l,c=[];if(i&&1===i.length&&i[0]instanceof WorkerBroker.withTransferables&&(c=i[0].transferables,i=i[0].value),l={type:s,message_id:++message_id,method:e,message:i},o)return function(t,e){var r=t.type,i=_slicedToArray(findTarget(t.method,e,"main_send"===r?main_worker_targets:targets),2),n=i[0],o=i[1],a="Worker broker could not dispatch message type ".concat(t.method," on target ").concat(t.target,".");if(!o)throw Error(a+ERROR_NO_TARGET);var s="function"==typeof o[n]&&o[n];if(!s)throw Error(a+ERROR_NO_METHOD);return new Promise((function(e,r){var i;try{i=s.apply(o,t.message)}catch(i){return void r(i)}i instanceof Promise?i.then((function(t){t instanceof WorkerBroker.withTransferables&&(t=t.value[0]),e(t)}),(function(t){r(t instanceof Error?"".concat(t.message,": ").concat(t.stack):t)})):(i instanceof WorkerBroker.withTransferables&&(i=i.value[0]),e(i))}))}(l,t&&t.init?t:void 0);var u=new Promise((function(t,r){messages[message_id]={method:e,message:i,resolve:t,reject:r}}));return a.stringify&&(l=JSON.stringify(l)),t.postMessage(l,c.map((function(t){return t.object}))),freeTransferables(c),u},WorkerBroker.addWorker=function(t){if(!(t instanceof Worker))throw Error("Worker broker could not add non-Worker object",t);t.addEventListener("message",(function(e){var r="string"==typeof e.data?JSON.parse(e.data):e.data,i=r.message_id;if("worker_reply"===r.type)messages[i]&&(r.error?messages[i].reject(r.error):messages[i].resolve(r.message),delete messages[i]);else if("worker_send"===r.type&&null!=i){var n=_slicedToArray(findTarget(r.method),2),o=n[0],a=n[1],s="Worker broker could not dispatch message type ".concat(r.method," on target ").concat(r.target,".");if(!a)throw Error(s+ERROR_NO_TARGET);var l="function"==typeof a[o]&&a[o];if(!l)throw Error(s+ERROR_NO_METHOD);var c,u=ERROR_NOT_SET;try{c=l.apply(a,r.message)}catch(e){u=e}var h,p=[];c&&"function"==typeof c.then?c.then((function(e){e instanceof WorkerBroker.withTransferables&&(p=e.transferables,e=e.value[0]),h={type:"main_reply",message_id:i,message:e},t.postMessage(h,p.map((function(t){return t.object}))),freeTransferables(p)}),(function(e){t.postMessage({type:"main_reply",message_id:i,error:e instanceof Error?"".concat(e.message,": ").concat(e.stack):e})})):(c instanceof WorkerBroker.withTransferables&&(p=c.transferables,c=c.value[0]),h={type:"main_reply",message_id:i,message:c,error:u instanceof Error?"".concat(u.message,": ").concat(u.stack):u},t.postMessage(h,p.map((function(t){return t.object}))),freeTransferables(p))}}))},WorkerBroker.getMessages=function(){return messages},WorkerBroker.getMessageId=function(){return message_id}}function setupWorkerThread(){WorkerBroker.postMessage=function(t){for(var e=arguments.length,r=new Array(1<e?e-1:0),i=1;i<e;i++)r[i-1]=arguments[i];var n={};"object"===_typeof(t)&&(t=(n=t).method);var o,a=new Promise((function(e,i){messages[message_id]={method:t,message:r,resolve:e,reject:i}})),s=[];return r&&1===r.length&&r[0]instanceof WorkerBroker.withTransferables&&(s=r[0].transferables,r=r[0].value),o={type:"worker_send",message_id,method:t,message:r},n.stringify&&(o=JSON.stringify(o)),self.postMessage(o,s.map((function(t){return t.object}))),freeTransferables(s),message_id++,a},self.addEventListener("message",(function(t){var e="string"==typeof t.data?JSON.parse(t.data):t.data,r=e.message_id;if("main_reply"===e.type)messages[r]&&(e.hasOwnProperty("error")&&e.error!==ERROR_NOT_SET?messages[r].reject(e.error):messages[r].resolve(e.message),delete messages[r]);else if("main_send"===e.type&&null!=r){var i=_slicedToArray(findTarget(e.method),2),n=i[0],o=i[1],a="Worker broker could not dispatch message type ".concat(e.method," on target ").concat(e.target,".");if(!o)throw Error(a+ERROR_NO_TARGET);var s,l,c="function"==typeof o[n]&&o[n];if(!c)throw Error(a+ERROR_NO_METHOD);try{s=c.apply(o,e.message)}catch(t){l=t}var u,h=[];s instanceof Promise?s.then((function(t){t instanceof WorkerBroker.withTransferables&&(h=t.transferables,t=t.value[0]),u={type:"worker_reply",message_id:r,message:t},self.postMessage(u,h.map((function(t){return t.object}))),freeTransferables(h)}),(function(t){self.postMessage({type:"worker_reply",message_id:r,error:t instanceof Error?"".concat(t.message,": ").concat(t.stack):t})})):(s instanceof WorkerBroker.withTransferables&&(h=s.transferables,s=s.value[0]),u={type:"worker_reply",message_id:r,message:s,error:l instanceof Error?"".concat(l.message,": ").concat(l.stack):l},self.postMessage(u,h.map((function(t){return t.object}))),freeTransferables(h))}}))}function findTransferables(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:[];if(!t)return i;if(Array.isArray(t))t.forEach((function(e,r){return findTransferables(e,t,r,i)}));else if("object"===_typeof(t))if(t instanceof ArrayBuffer)i.push({object:t,parent:e,property:r});else if(t.buffer instanceof ArrayBuffer)i.push({object:t.buffer,parent:e,property:r});else for(var n in t)findTransferables(t[n],t,n,i);return i}function freeTransferables(t){Array.isArray(t)&&t.filter((function(t){return t.parent&&t.property})).forEach((function(t){return delete t.parent[t.property]}))}WorkerBroker.withTransferables=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];if(!(this instanceof WorkerBroker.withTransferables))return _construct(WorkerBroker.withTransferables,e);this.value=e,this.transferables=findTransferables(this.value)},Thread.is_main&&setupMainThread(),Thread.is_worker&&setupWorkerThread();var LEVELS={silent:-1,error:0,warn:1,info:2,debug:3,trace:4},methods={},logged_once={},Utils;function methodForLevel(t){return methods[t]=methods[t]||(console[t]?console[t]:console.log).bind(console),methods[t]}function log(t){var e="object"===_typeof(t)?t.level:t;if(LEVELS[e]<=LEVELS[log.level]){for(var r=arguments.length,i=new Array(1<r?r-1:0),n=1;n<r;n++)i[n-1]=arguments[n];if(Thread.is_native_worker)WorkerBroker.postMessage.apply(WorkerBroker,[{method:"_logProxy",stringify:!0},t].concat(i));else{if("object"===_typeof(t)&&!0===t.once){if(logged_once[JSON.stringify(i)])return;logged_once[JSON.stringify(i)]=!0}var o=methodForLevel(e);1<i.length?o.apply(void 0,["Tangram [".concat(e,"]: ").concat(i[0])].concat(_toConsumableArray(i.slice(1)))):o("Tangram [".concat(e,"]: ").concat(i[0]))}}}function debounce(t,e,r){var i,n;return r=r||0,function(){var o=this,a=arguments;function s(){n=0,t.apply(o,a)}clearTimeout(i),n&&r&&Date.now()-n>=r?s():(n=n||Date.now(),i=setTimeout((function(){s()}),e))}}log.level="info",log.workers=null,log.setLevel=function(t){log.level=t,Thread.is_main&&Array.isArray(log.workers)&&WorkerBroker.postMessage(log.workers,"_logSetLevelProxy",t)},Thread.is_main&&(log.setWorkers=function(t){log.workers=t},log.reset=function(){logged_once={}}),WorkerBroker.addTarget("_logProxy",log),WorkerBroker.addTarget("_logSetLevelProxy",log.setLevel);var Utils$1=Utils={};WorkerBroker.addTarget("Utils",Utils),Utils.isSafari=function(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)},Utils.isMicrosoft=function(){return/(Trident\/7.0|Edge[ /](\d+[\.\d]+))/i.test(navigator.userAgent)},Utils._requests={},Utils._proxy_requests={},Utils.io=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:6e4,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"text",i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"GET",n=4<arguments.length&&void 0!==arguments[4]?arguments[4]:{},o=5<arguments.length&&void 0!==arguments[5]?arguments[5]:null,a=6<arguments.length&&void 0!==arguments[6]&&arguments[6];if(Thread.is_worker&&Utils.isMicrosoft())return log("debug","Proxying request for URL to worker",t),o&&(Utils._proxy_requests[o]=!0),WorkerBroker.postMessage("Utils.io",t,e,r,i,n,o,!0);var s=new XMLHttpRequest,l=(l=new Promise((function(n,o){s.open(i,t,!0),s.timeout=e,s.responseType=r,s.onload=function(){200===s.status?-1<["text","json"].indexOf(s.responseType)?n(s.responseText):n(s.response):o(Error("Request error with a status of "+s.statusText))},s.onerror=function(t){o(Error("There was a network error"+t.toString()))},s.ontimeout=function(t){o(Error("timeout "+t.toString()))},s.send()}))).then((function(t){return o&&delete Utils._requests[o],a?WorkerBroker.withTransferables(t):t}));return o&&(Utils._requests[o]=s),l},Utils.cancelRequest=function(t){if(Thread.is_worker&&Utils._proxy_requests[t])return WorkerBroker.postMessage("Utils.cancelRequest",t);Utils._requests[t]?(log("trace","Cancelling network request key '".concat(t,"'")),Utils._requests[t].abort(),delete Utils._requests[t]):log("trace","Could not find network request key '".concat(t,"'"))},Utils.requestAnimationFramePolyfill=function(){"function"!=typeof window.requestAnimationFrame&&(window.requestAnimationFrame=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){setTimeout(t,1e3/60)})},Utils.serializeWithFunctions=function(t){return"function"==typeof t?t.toString():JSON.stringify(t,(function(t,e){return"function"==typeof e?e.toString():e}))},Utils.stringsToFunctions=function(t,e){if("string"==typeof t)t=Utils.stringToFunction(t,e);else if(null!=t&&"object"===_typeof(t))for(var r in t)t[r]=Utils.stringsToFunctions(t[r],e);return t},Utils._use_count=0,Utils._function_cache={};var _clear_function_cache=debounce((function(){log("trace","Cleared cached ".concat(Object.keys(Utils._function_cache).length," functions (reused ").concat(Utils._use_count," times)")),Utils._use_count=0,Utils._function_cache={}}),1e4),FUNCTION_MATCH_RGX=/^\s*function[^(]*\(([^)]*)\)\s*?\{([\s\S]*)\}$/m,_createObjectURL,_revokeObjectURL;function addBaseURL(t,e){if(!t||!isRelativeURL(t))return t;var r,i="/"!==t[0];return e?(r=document.createElement("a")).href=e:r=window.location,i?pathForURL(r.href)+t:(r.origin||r.protocol+"//"+r.host)+t}function pathForURL(t){if("string"!=typeof t||-1!==t.search(/^(data|blob):/))return"";var e=t.indexOf("?");-1<e&&(t=t.substr(0,e));var r=t.indexOf("#");return-1<r&&(t=t.substr(0,r)),t.substr(0,t.lastIndexOf("/")+1)||""}function extensionForURL(t){var e=(t=t.split("/").pop()).lastIndexOf(".");if(-1<e)return t.substring(e+1)}function isRelativeURL(t){return"string"==typeof t&&!(-1<t.search(/^(http|https|data|blob):/)||"//"===t.substr(0,2))}function addParamsToURL(t,e){if(!e||0===Object.keys(e).length)return[t,[]];var r=t.indexOf("?"),i=t.indexOf("#"),n="";-1<i&&(n=t.slice(i),t=t.slice(0,i)),-1===r&&(r=t.length,t+="?"),r++;var o="",a=[];for(var s in e)""===getURLParameter(s,t)?o+="".concat(s,"=").concat(e[s],"&"):a.push([s,e[s]]);return[t=t.slice(0,r)+o+t.slice(r)+n,a]}function createObjectURL(t){return void 0===_createObjectURL&&"function"!=typeof(_createObjectURL=window.URL&&window.URL.createObjectURL||window.webkitURL&&window.webkitURL.createObjectURL)&&(_createObjectURL=null,log("warn","window.URL.createObjectURL (or vendor prefix) not found, unable to create local blob URLs")),_createObjectURL?_createObjectURL(t):t}function revokeObjectURL(t){return void 0===_revokeObjectURL&&"function"!=typeof(_revokeObjectURL=window.URL&&window.URL.revokeObjectURL||window.webkitURL&&window.webkitURL.revokeObjectURL)&&(_revokeObjectURL=null,log("warn","window.URL.revokeObjectURL (or vendor prefix) not found, unable to create local blob URLs")),_revokeObjectURL?_revokeObjectURL(t):t}function getURLParameter(t,e){t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var r=new RegExp("[\\?&]"+t+"=([^&#]*)").exec(e);return null===r?"":decodeURIComponent(r[1].replace(/\+/g," "))}Utils.stringToFunction=function(t,e){var r=t;e&&(r+=e.toString());var i=Utils._function_cache[r];if(_clear_function_cache(),i)return Utils._use_count++,i;var n="string"==typeof t&&t.match(FUNCTION_MATCH_RGX);if(n&&2<n.length)try{var o=n[2],a=0<(a=0<n[1].length&&n[1].split(",").map((function(t){return t.trim()})).filter((function(t){return t}))).length?a:["context"],s=new Function(a.toString(),"function"==typeof e?e(o):o);return Utils._function_cache[r]=s}catch(e){return t}return t},Utils.device_pixel_ratio=1,Utils.isPowerOf2=function(t){return 0==(t&t-1)},Utils.interpolate=function(t,e,r){if(!Array.isArray(e)||!Array.isArray(e[0]))return e;if(e.length<1)return e;var i,n,o,a,s;if(t<=e[0][0])a=e[0][1],"function"==typeof r&&(a=r(a));else if(t>=e[e.length-1][0])a=e[e.length-1][1],"function"==typeof r&&(a=r(a));else for(var l=0;l<e.length-1;l++)if(t>=e[l][0]&&t<e[l+1][0]){if(i=e[l][0],n=e[l+1][0],Array.isArray(e[l][1])){a=[];for(var c=0;c<e[l][1].length;c++)"function"==typeof r?(s=r(e[l][1][c]),o=r(e[l+1][1][c])-s,a[c]=o*(t-i)/(n-i)+s):(o=e[l+1][1][c]-e[l][1][c],a[c]=o*(t-i)/(n-i)+e[l][1][c])}else a="function"==typeof r?(s=r(e[l][1]),(o=r(e[l+1][1])-s)*(t-i)/(n-i)+s):(o=e[l+1][1]-e[l][1])*(t-i)/(n-i)+e[l][1];break}return a},Utils.toCSSColor=function(t){return 1===t[3]?"rgb(".concat(t.slice(0,3).map((function(t){return Math.round(255*t)})).join(", "),")"):"rgba(".concat(t.map((function(t,e){return e<3&&Math.round(255*t)||t})).join(", "),")")},Utils.pointInTile=function(t){return 0<=t[0]&&t[1]>-Geo$1.tile_scale&&t[0]<Geo$1.tile_scale&&t[1]<=0},Utils.zoomToTileLevel=function(t){return Math.floor(t)};var DataSource=function(){function t(e,r){var i=this;if(_classCallCheck(this,t),this.config=e,this.sources=r,this.id=e.id,this.name=e.name,this.pad_scale=e.pad_scale||1e-4,this.default_winding=null,this.rasters=[],Array.isArray(e.rasters)&&e.rasters.forEach((function(t){-1===i.rasters.indexOf(t)&&i.rasters.push(t)})),this.preprocess=e.preprocess,"function"==typeof this.preprocess&&this.preprocess.bind(this),this.transform=e.transform,"function"==typeof this.transform)this.transform=this.transform.bind(this);else if("object"===_typeof(this.transform))for(var n in this.transform)"function"==typeof this.transform[n]&&(this.transform[n]=this.transform[n].bind(this));this.extra_data=e.extra_data,this.scripts=e.scripts,this.max_zoom=null!=e.max_zoom?e.max_zoom:Geo$1.default_source_max_zoom,this.setTileSize(e.tile_size),this.max_coord_zoom=this.max_zoom+this.zoom_bias,this.min_display_zoom=null!=e.min_display_zoom?e.min_display_zoom:0,this.max_display_zoom=null!=e.max_display_zoom?e.max_display_zoom:null,this._has_volatile_data=!!e.has_volatile_data}return _createClass(t,[{key:"hasLabeledData",value:function(){return!0}},{key:"_transformTile",value:function(t){if(t.source_data.layers){var e={coords:t.coords},r=[];if("function"==typeof this.transform)r.push(this.transform);else if("object"===_typeof(this.transform))for(var i=Object.keys(this.transform).sort(),n=0;n<i.length;n++)r.push(this.transform[i[n]]);for(var o=1===Object.keys(t.source_data.layers).length&&t.source_data.layers._default,a=0;a<r.length;a++)o?t.source_data.layers._default=r[a](t.source_data.layers._default,this.extra_data,e):t.source_data.layers=r[a](t.source_data.layers,this.extra_data,e)}}},{key:"_postProcessTile",value:function(t){var e=this;for(var r in this._transformTile(t),t.source_data.layers){var i=t.source_data.layers[r];i&&i.features&&i.features.forEach((function(t){Geo$1.transformGeometry(t.geometry,(function(t){t[1]=-t[1],e.pad_scale&&(t[0]=Math.round(t[0]*(1+e.pad_scale)-Geo$1.tile_scale*e.pad_scale/2),t[1]=Math.round(t[1]*(1+e.pad_scale)-Geo$1.tile_scale*e.pad_scale/2))})),e.updateDefaultWinding(t.geometry)}))}t.default_winding=this.default_winding||"CCW"}},{key:"load",value:function(t){return t.source_data={},t.source_data.layers={},t.pad_scale=this.pad_scale,t.rasters=_toConsumableArray(this.rasters),this._load(t)}},{key:"_load",value:function(){throw new MethodNotImplemented("_load")}},{key:"setTileSize",value:function(t){this.tile_size=t||256,("number"!=typeof this.tile_size||this.tile_size<256||!Utils$1.isPowerOf2(this.tile_size))&&(log({level:"warn",once:!0},"Data source '".concat(this.name,"': 'tile_size' parameter must be a number that is a power of 2 greater than or equal to 256, but was '").concat(t,"'")),this.tile_size=256),this.zoom_bias=Math.log2(this.tile_size)-8}},{key:"updateDefaultWinding",value:function(t){return null==this.default_winding&&("Polygon"===t.type?this.default_winding=Geo$1.ringWinding(t.coordinates[0]):"MultiPolygon"===t.type&&(this.default_winding=Geo$1.ringWinding(t.coordinates[0][0]))),this.default_winding}},{key:"includesTile",value:function(t,e){if(t.z<this.min_display_zoom||null!=this.max_display_zoom&&e>this.max_display_zoom)return!1;for(var r=0;r<this.rasters.length;r++){var i=this.rasters[r];if(this.sources[i]&&this.sources[i]!==this&&!this.sources[i].includesTile(t,t.z))return!1}return!0}},{key:"has_volatile_data",get:function(){return this._has_volatile_data},set:function(t){var e=0<arguments.length&&void 0!==t&&t;this._has_volatile_data=e}}],[{key:"create",value:function(e,r){for(var i in r)if(r[i].config.name===e.name&&t.sameConfig(r[i],{config:e}))return r[i];if(t.types[e.type])return new t.types[e.type](e,r)}},{key:"sameConfig",value:function(t,e){if(!t||!e)return!1;var r=Object.assign({},t.config,{id:null,tiled:null,url:null}),i=Object.assign({},e.config,{id:null,tiled:null,url:null});return JSON.stringify(r)===JSON.stringify(i)}},{key:"coordsToMeters",value:function(t){var e=_slicedToArray(Geo$1.latLngToMeters(t),2),r=e[0],i=e[1];t[0]=r,t[1]=i}},{key:"projectData",value:function(e){for(var r in e.layers)for(var i=e.layers[r].features.length,n=0;n<i;n++){var o=e.layers[r].features[n];Geo$1.transformGeometry(o.geometry,t.coordsToMeters)}}},{key:"metersToTileUnits",value:function(t,e,r){r[0]=Math.round((r[0]-e.x)*t),r[1]=-1*Math.round((r[1]-e.y)*t)}},{key:"scaleData",value:function(e,r){var i=r.coords.z,n=r.min,o=(r.max,t.metersToTileUnits.bind(this,Geo$1.unitsPerMeter(i),n));for(var a in e.layers)for(var s=e.layers[a].features.length,l=0;l<s;l++){var c=e.layers[a].features[l];Geo$1.transformGeometry(c.geometry,o)}}},{key:"register",value:function(e,r){e&&r&&(t.types[r]=e)}}]),t}();DataSource.types={};var network_request_id=0,NetworkSource=function(){_inherits(e,DataSource);var t=_createSuper(e);function e(r,i){var n;_classCallCheck(this,e),(n=t.call(this,r,i)).response_type="";var o=_slicedToArray(addParamsToURL(r.url,r.url_params),2),a=o[0],s=o[1];if(n.url=a,s.forEach((function(t){var e=_slicedToArray(t,2),i=e[0],o=e[1];log({level:"warn",once:!0},"Data source '".concat(n.name,"': parameter '").concat(i,"' already present in URL '").concat(r.url,"', ")+"skipping value '".concat(i,"=").concat(o,"' specified in 'url_params'"))})),"string"!=typeof n.url)throw Error("Network data source must provide a string `url` property");return n}return _createClass(e,[{key:"_load",value:function(t){var e=this,r=this.formatUrl(this.url,t),i=t.source_data;return i.url=r,new Promise((function(n,o){i.error=null;var a=network_request_id+++"-"+r,s=Utils$1.io(r,6e4,e.response_type,"GET",{},a);i.request_id=a,s.then((function(r){"function"==typeof e.preprocess&&(r=e.preprocess(r)),(r=r instanceof Promise?r:Promise.resolve(r)).then((function(r){e.parseSourceData(t,i,r),e._postProcessTile(t),n(t)}))}),(function(r){i.error=r.stack,e._postProcessTile(t),n(t)}))}))}},{key:"formatUrl",value:function(){throw new MethodNotImplemented("formatUrl")}},{key:"parseSourceData",value:function(){throw new MethodNotImplemented("parseSourceData")}}]),e}(),NetworkTileSource=function(){_inherits(e,NetworkSource);var t=_createSuper(e);function e(r,i){var n;return _classCallCheck(this,e),(n=t.call(this,r,i)).tiled=!0,n.parseBounds(r),n.builds_geometry_tiles=!1,n.tms=!0===r.tms,-1<n.url.search("{s}")&&(Array.isArray(r.url_subdomains)&&0<r.url_subdomains.length?(n.url_subdomains=r.url_subdomains,n.next_url_subdomain=0):log({level:"warn",once:!0},"Data source '".concat(n.name,"': source URL includes '{s}' subdomain marker ('").concat(n.url,"'), but no subdomains ")+"were specified in 'url_subdomains' parameter")),n}return _createClass(e,[{key:"parseBounds",value:function(t){var e,r,i,n,o;Array.isArray(t.bounds)&&4===t.bounds.length&&(this.bounds=t.bounds,r=(e=_slicedToArray(this.bounds,4))[0],i=e[1],n=e[2],o=e[3],this.bounds_meters={min:Geo$1.latLngToMeters([r,o]),max:Geo$1.latLngToMeters([n,i])},this.bounds_tiles={min:{},max:{}})}},{key:"checkBounds",value:function(t){if(this.bounds){t=Geo$1.wrapTile(t,{x:!0});var e=(e=this.bounds_tiles.min[t.z])||(this.bounds_tiles.min[t.z]=Geo$1.tileForMeters(this.bounds_meters.min,t.z)),r=(r=this.bounds_tiles.max[t.z])||(this.bounds_tiles.max[t.z]=Geo$1.tileForMeters(this.bounds_meters.max,t.z));if(t.x<e.x||t.x>r.x||t.y<e.y||t.y>r.y)return!1}return!0}},{key:"includesTile",value:function(t,r){return!!_get(_getPrototypeOf(e.prototype),"includesTile",this).call(this,t,r)&&!!this.checkBounds(t)}},{key:"formatUrl",value:function(t,e){var r=Geo$1.wrapTile(e.coords,{x:!0});this.tms&&(r.y=Math.pow(2,r.z)-1-r.y);var i=t.replace("{x}",r.x).replace("{y}",r.y).replace("{z}",r.z);return null!=this.url_subdomains&&(i=i.replace("{s}",this.url_subdomains[this.next_url_subdomain]),this.next_url_subdomain=(this.next_url_subdomain+1)%this.url_subdomains.length),i}},{key:"urlHasTilePattern",value:function(t){return t&&-1<t.search("{x}")&&-1<t.search("{y}")&&-1<t.search("{z}")}}]),e}(),MapsJsSource=function(){_inherits(e,DataSource);var t=_createSuper(e);function e(r,i){var n;return _classCallCheck(this,e),(n=t.call(this,r,i)).target_name="MapsJsSource"+r.uid,n.tiled=!!r.tiled,WorkerBroker.addTarget(n.target_name,_assertThisInitialized(n)),Thread.is_worker&&WorkerBroker.postMessage(n.target_name+".onWorkerInitialized"),Thread.is_main&&(n._workers_left=0),n}return _createClass(e,[{key:"initialize",value:function(t,e,r,i){this._main_initialized||(this.provider=t,this.worker=i,this._workers_left+=r,this._on_update=e,this._main_initialized=!0,this._onProviderUpdate=this._onProviderUpdate.bind(this),t.addEventListener("update",this._onProviderUpdate),this._isReady()&&this.onReady())}},{key:"onWorkerInitialized",value:function(){--this._workers_left,this._isReady()&&this.onReady()}},{key:"onReady",value:function(){}},{key:"_isReady",value:function(){return this._main_initialized&&!this._workers_left}},{key:"_onProviderUpdate",value:function(t){this._isReady()&&this.onProviderUpdate(t)}},{key:"onProviderUpdate",value:function(t){this.dispatchUpdate(void 0,t.data)}},{key:"dispatchUpdate",value:function(t,e){this._on_update(this.name,t,e)}},{key:"dispose",value:function(){WorkerBroker.removeTarget(this.target_name),this.provider.removeEventListener("update",this._onProviderUpdate)}}]),e}(),read=function(t,e,r,i,n){var o,a,s=8*n-i-1,l=(1<<s)-1,c=l>>1,u=-7,h=r?n-1:0,p=r?-1:1,f=t[e+h];for(h+=p,o=f&(1<<-u)-1,f>>=-u,u+=s;0<u;o=256*o+t[e+h],h+=p,u-=8);for(a=o&(1<<-u)-1,o>>=-u,u+=i;0<u;a=256*a+t[e+h],h+=p,u-=8);if(0===o)o=1-c;else{if(o===l)return a?NaN:1/0*(f?-1:1);a+=Math.pow(2,i),o-=c}return(f?-1:1)*a*Math.pow(2,o-i)},write=function(t,e,r,i,n,o){var a,s,l,c=8*o-n-1,u=(1<<c)-1,h=u>>1,p=23===n?Math.pow(2,-24)-Math.pow(2,-77):0,f=i?0:o-1,d=i?1:-1,y=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=u):(a=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-a))<1&&(a--,l*=2),2<=(e+=1<=a+h?p/l:p*Math.pow(2,1-h))*l&&(a++,l/=2),u<=a+h?(s=0,a=u):1<=a+h?(s=(e*l-1)*Math.pow(2,n),a+=h):(s=e*Math.pow(2,h-1)*Math.pow(2,n),a=0));8<=n;t[r+f]=255&s,f+=d,s/=256,n-=8);for(a=a<<n|s,c+=n;0<c;t[r+f]=255&a,f+=d,a/=256,c-=8);t[r+f-d]|=128*y},ieee754={read,write},pbf=Pbf;function Pbf(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}Pbf.Varint=0,Pbf.Fixed64=1,Pbf.Bytes=2,Pbf.Fixed32=5;var SHIFT_LEFT_32=4294967296,SHIFT_RIGHT_32=1/SHIFT_LEFT_32;function readVarintRemainder(t,e,r){var i=r.buf,n=i[r.pos++],o=(112&n)>>4;if(n<128)return toNum(t,o,e);if(o|=(127&(n=i[r.pos++]))<<3,n<128)return toNum(t,o,e);if(o|=(127&(n=i[r.pos++]))<<10,n<128)return toNum(t,o,e);if(o|=(127&(n=i[r.pos++]))<<17,n<128)return toNum(t,o,e);if(o|=(127&(n=i[r.pos++]))<<24,n<128)return toNum(t,o,e);if(o|=(1&(n=i[r.pos++]))<<31,n<128)return toNum(t,o,e);throw new Error("Expected varint not more than 10 bytes")}function readPackedEnd(t){return t.type===Pbf.Bytes?t.readVarint()+t.pos:t.pos+1}function toNum(t,e,r){return r?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function writeBigVarint(t,e){var r,i;if(0<=t?(r=t%4294967296|0,i=t/4294967296|0):(i=~(-t/4294967296),4294967295^(r=~(-t%4294967296))?r=r+1|0:i=i+1|(r=0)),0x10000000000000000<=t||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),writeBigVarintLow(r,i,e),writeBigVarintHigh(i,e)}function writeBigVarintLow(t,e,r){r.buf[r.pos++]=127&t|128,t>>>=7,r.buf[r.pos++]=127&t|128,t>>>=7,r.buf[r.pos++]=127&t|128,t>>>=7,r.buf[r.pos++]=127&t|128,t>>>=7,r.buf[r.pos]=127&t}function writeBigVarintHigh(t,e){var r=(7&t)<<4;e.buf[e.pos++]|=r|((t>>>=3)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t)))))}function makeRoomForExtraLength(t,e,r){var i=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.ceil(Math.log(e)/(7*Math.LN2));r.realloc(i);for(var n=r.pos-1;t<=n;n--)r.buf[n+i]=r.buf[n]}function writePackedVarint(t,e){for(var r=0;r<t.length;r++)e.writeVarint(t[r])}function writePackedSVarint(t,e){for(var r=0;r<t.length;r++)e.writeSVarint(t[r])}function writePackedFloat(t,e){for(var r=0;r<t.length;r++)e.writeFloat(t[r])}function writePackedDouble(t,e){for(var r=0;r<t.length;r++)e.writeDouble(t[r])}function writePackedBoolean(t,e){for(var r=0;r<t.length;r++)e.writeBoolean(t[r])}function writePackedFixed32(t,e){for(var r=0;r<t.length;r++)e.writeFixed32(t[r])}function writePackedSFixed32(t,e){for(var r=0;r<t.length;r++)e.writeSFixed32(t[r])}function writePackedFixed64(t,e){for(var r=0;r<t.length;r++)e.writeFixed64(t[r])}function writePackedSFixed64(t,e){for(var r=0;r<t.length;r++)e.writeSFixed64(t[r])}function readUInt32(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function writeInt32(t,e,r){t[r]=e,t[r+1]=e>>>8,t[r+2]=e>>>16,t[r+3]=e>>>24}function readInt32(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}function readUtf8(t,e,r){for(var i="",n=e;n<r;){var o,a,s,l=t[n],c=null,u=239<l?4:223<l?3:191<l?2:1;if(r<n+u)break;1===u?l<128&&(c=l):2===u?128==(192&(o=t[n+1]))&&(c=(31&l)<<6|63&o)<=127&&(c=null):3===u?(o=t[n+1],a=t[n+2],128==(192&o)&&128==(192&a)&&((c=(15&l)<<12|(63&o)<<6|63&a)<=2047||55296<=c&&c<=57343)&&(c=null)):4===u&&(o=t[n+1],a=t[n+2],s=t[n+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&((c=(15&l)<<18|(63&o)<<12|(63&a)<<6|63&s)<=65535||1114112<=c)&&(c=null)),null===c?(c=65533,u=1):65535<c&&(c-=65536,i+=String.fromCharCode(c>>>10&1023|55296),c=56320|1023&c),i+=String.fromCharCode(c),n+=u}return i}function writeUtf8(t,e,r){for(var i,n,o=0;o<e.length;o++){if(55295<(i=e.charCodeAt(o))&&i<57344){if(!n){56319<i||o+1===e.length?(t[r++]=239,t[r++]=191,t[r++]=189):n=i;continue}if(i<56320){t[r++]=239,t[r++]=191,t[r++]=189,n=i;continue}i=n-55296<<10|i-56320|65536,n=null}else n&&(t[r++]=239,t[r++]=191,t[r++]=189,n=null);i<128?t[r++]=i:(i<2048?t[r++]=i>>6|192:(i<65536?t[r++]=i>>12|224:(t[r++]=i>>18|240,t[r++]=i>>12&63|128),t[r++]=i>>6&63|128),t[r++]=63&i|128)}return r}Pbf.prototype={destroy:function(){this.buf=null},readFields:function(t,e,r){for(r=r||this.length;this.pos<r;){var i=this.readVarint(),n=i>>3,o=this.pos;this.type=7&i,t(n,e,this),this.pos===o&&this.skip(i)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=readUInt32(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=readInt32(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=readUInt32(this.buf,this.pos)+readUInt32(this.buf,this.pos+4)*SHIFT_LEFT_32;return this.pos+=8,t},readSFixed64:function(){var t=readUInt32(this.buf,this.pos)+readInt32(this.buf,this.pos+4)*SHIFT_LEFT_32;return this.pos+=8,t},readFloat:function(){var t=ieee754.read(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=ieee754.read(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e=this.buf,r=e[this.pos++],i=127&r;return r<128?i:(i|=(127&(r=e[this.pos++]))<<7,r<128?i:(i|=(127&(r=e[this.pos++]))<<14,r<128?i:(i|=(127&(r=e[this.pos++]))<<21,r<128?i:readVarintRemainder(i|=(15&(r=e[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=readUtf8(this.buf,this.pos,t);return this.pos=t,e},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){var r=readPackedEnd(this);for(t=t||[];this.pos<r;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){var e=readPackedEnd(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){var e=readPackedEnd(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){var e=readPackedEnd(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){var e=readPackedEnd(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){var e=readPackedEnd(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){var e=readPackedEnd(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){var e=readPackedEnd(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){var e=readPackedEnd(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===Pbf.Varint)for(;127<this.buf[this.pos++];);else if(e===Pbf.Bytes)this.pos=this.readVarint()+this.pos;else if(e===Pbf.Fixed32)this.pos+=4;else{if(e!==Pbf.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e,r=this.length||16;r<this.pos+t;)r*=2;r!==this.length&&((e=new Uint8Array(r)).set(this.buf),this.buf=e,this.length=r)},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),writeInt32(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),writeInt32(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),writeInt32(this.buf,-1&t,this.pos),writeInt32(this.buf,Math.floor(t*SHIFT_RIGHT_32),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),writeInt32(this.buf,-1&t,this.pos),writeInt32(this.buf,Math.floor(t*SHIFT_RIGHT_32),this.pos+4),this.pos+=8},writeVarint:function(t){268435455<(t=+t||0)||t<0?writeBigVarint(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(127<t?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(127<t?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(127<t?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=writeUtf8(this.buf,t,this.pos);var r=this.pos-e;128<=r&&makeRoomForExtraLength(e,r,this),this.pos=e-1,this.writeVarint(r),this.pos+=r},writeFloat:function(t){this.realloc(4),ieee754.write(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),ieee754.write(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var r=0;r<e;r++)this.buf[this.pos++]=t[r]},writeRawMessage:function(t,e){this.pos++;var r=this.pos;t(e,this);var i=this.pos-r;128<=i&&makeRoomForExtraLength(r,i,this),this.pos=r-1,this.writeVarint(i),this.pos+=i},writeMessage:function(t,e,r){this.writeTag(t,Pbf.Bytes),this.writeRawMessage(e,r)},writePackedVarint:function(t,e){this.writeMessage(t,writePackedVarint,e)},writePackedSVarint:function(t,e){this.writeMessage(t,writePackedSVarint,e)},writePackedBoolean:function(t,e){this.writeMessage(t,writePackedBoolean,e)},writePackedFloat:function(t,e){this.writeMessage(t,writePackedFloat,e)},writePackedDouble:function(t,e){this.writeMessage(t,writePackedDouble,e)},writePackedFixed32:function(t,e){this.writeMessage(t,writePackedFixed32,e)},writePackedSFixed32:function(t,e){this.writeMessage(t,writePackedSFixed32,e)},writePackedFixed64:function(t,e){this.writeMessage(t,writePackedFixed64,e)},writePackedSFixed64:function(t,e){this.writeMessage(t,writePackedSFixed64,e)},writeBytesField:function(t,e){this.writeTag(t,Pbf.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,Pbf.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,Pbf.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,Pbf.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,Pbf.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,Pbf.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,Pbf.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,Pbf.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,Pbf.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,Pbf.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}};var pointGeometry=Point;function Point(t,e){this.x=t,this.y=e}Point.prototype={clone:function(){return new Point(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,r=t.y-this.y;return e*e+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[0]*this.x+t[1]*this.y,r=t[2]*this.x+t[3]*this.y;return this.x=e,this.y=r,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),r=Math.sin(t),i=e*this.x-r*this.y,n=r*this.x+e*this.y;return this.x=i,this.y=n,this},_rotateAround:function(t,e){var r=Math.cos(t),i=Math.sin(t),n=e.x+r*(this.x-e.x)-i*(this.y-e.y),o=e.y+i*(this.x-e.x)+r*(this.y-e.y);return this.x=n,this.y=o,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Point.convert=function(t){return t instanceof Point||!Array.isArray(t)?t:new Point(t[0],t[1])};var vectortilefeature=VectorTileFeature;function VectorTileFeature(t,e,r,i,n){this.properties={},this.extent=r,this.type=0,this._pbf=t,this._geometry=-1,this._keys=i,this._values=n,t.readFields(readFeature,this,e)}function readFeature(t,e,r){1==t?e.id=r.readVarint():2==t?readTag(r,e):3==t?e.type=r.readVarint():4==t&&(e._geometry=r.pos)}function readTag(t,e){for(var r=t.readVarint()+t.pos;t.pos<r;){var i=e._keys[t.readVarint()],n=e._values[t.readVarint()];e.properties[i]=n}}function classifyRings(t){var e=t.length;if(e<=1)return[t];for(var r,i,n=[],o=0;o<e;o++){var a=signedArea(t[o]);0!==a&&(void 0===i&&(i=a<0),i===a<0?(r&&n.push(r),r=[t[o]]):r.push(t[o]))}return r&&n.push(r),n}function signedArea(t){for(var e,r,i=0,n=0,o=t.length,a=o-1;n<o;a=n++)e=t[n],i+=((r=t[a]).x-e.x)*(e.y+r.y);return i}VectorTileFeature.types=["Unknown","Point","LineString","Polygon"],VectorTileFeature.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e,r,i=t.readVarint()+t.pos,n=1,o=0,a=0,s=0,l=[];t.pos<i;)if(o||(n=7&(r=t.readVarint()),o=r>>3),o--,1===n||2===n)a+=t.readSVarint(),s+=t.readSVarint(),1===n&&(e&&l.push(e),e=[]),e.push(new pointGeometry(a,s));else{if(7!==n)throw new Error("unknown command "+n);e&&e.push(e[0].clone())}return e&&l.push(e),l},VectorTileFeature.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e,r=t.readVarint()+t.pos,i=1,n=0,o=0,a=0,s=1/0,l=-1/0,c=1/0,u=-1/0;t.pos<r;)if(n||(i=7&(e=t.readVarint()),n=e>>3),n--,1===i||2===i)(o+=t.readSVarint())<s&&(s=o),l<o&&(l=o),(a+=t.readSVarint())<c&&(c=a),u<a&&(u=a);else if(7!==i)throw new Error("unknown command "+i);return[s,c,l,u]},VectorTileFeature.prototype.toGeoJSON=function(t,e,r){var i,n=this.extent*Math.pow(2,r),o=this.extent*t,a=this.extent*e,s=this.loadGeometry(),l=VectorTileFeature.types[this.type];function c(t){for(var e=0;e<t.length;e++){var r=t[e],i=180-360*(r.y+a)/n;t[e]=[360*(r.x+o)/n-180,360/Math.PI*Math.atan(Math.exp(i*Math.PI/180))-90]}}switch(this.type){case 1:for(var u=[],h=0;h<s.length;h++)u[h]=s[h][0];c(s=u);break;case 2:for(h=0;h<s.length;h++)c(s[h]);break;case 3:for(s=classifyRings(s),h=0;h<s.length;h++)for(i=0;i<s[h].length;i++)c(s[h][i])}1===s.length?s=s[0]:l="Multi"+l;var p={type:"Feature",geometry:{type:l,coordinates:s},properties:this.properties};return"id"in this&&(p.id=this.id),p};var VectorTileFeature$1=vectortilefeature,long_1=Long,wasm=null;try{wasm=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(t){}function Long(t,e,r){this.low=0|t,this.high=0|e,this.unsigned=!!r}function isLong(t){return!0===(t&&t.__isLong__)}Long.prototype.__isLong__,Object.defineProperty(Long.prototype,"__isLong__",{value:!0}),Long.isLong=isLong;var INT_CACHE={},UINT_CACHE={};function fromInt(t,e){var r,i,n;return e?(n=0<=(t>>>=0)&&t<256)&&(i=UINT_CACHE[t])?i:(r=fromBits(t,(0|t)<0?-1:0,!0),n&&(UINT_CACHE[t]=r),r):(n=-128<=(t|=0)&&t<128)&&(i=INT_CACHE[t])?i:(r=fromBits(t,t<0?-1:0,!1),n&&(INT_CACHE[t]=r),r)}function fromNumber(t,e){if(isNaN(t))return e?UZERO:ZERO;if(e){if(t<0)return UZERO;if(TWO_PWR_64_DBL<=t)return MAX_UNSIGNED_VALUE}else{if(t<=-TWO_PWR_63_DBL)return MIN_VALUE;if(TWO_PWR_63_DBL<=t+1)return MAX_VALUE}return t<0?fromNumber(-t,e).neg():fromBits(t%TWO_PWR_32_DBL|0,t/TWO_PWR_32_DBL|0,e)}function fromBits(t,e,r){return new Long(t,e,r)}Long.fromInt=fromInt,Long.fromNumber=fromNumber,Long.fromBits=fromBits;var pow_dbl=Math.pow;function fromString(t,e,r){if(0===t.length)throw Error("empty string");if("NaN"===t||"Infinity"===t||"+Infinity"===t||"-Infinity"===t)return ZERO;if(e="number"==typeof e?(r=e,!1):!!e,(r=r||10)<2||36<r)throw RangeError("radix");var i;if(0<(i=t.indexOf("-")))throw Error("interior hyphen");if(0===i)return fromString(t.substring(1),e,r).neg();for(var n=fromNumber(pow_dbl(r,8)),o=ZERO,a=0;a<t.length;a+=8){var s,l=Math.min(8,t.length-a),c=parseInt(t.substring(a,a+l),r);o=l<8?(s=fromNumber(pow_dbl(r,l)),o.mul(s).add(fromNumber(c))):(o=o.mul(n)).add(fromNumber(c))}return o.unsigned=e,o}function fromValue(t,e){return"number"==typeof t?fromNumber(t,e):"string"==typeof t?fromString(t,e):fromBits(t.low,t.high,"boolean"==typeof e?e:t.unsigned)}Long.fromString=fromString,Long.fromValue=fromValue;var TWO_PWR_16_DBL=65536,TWO_PWR_24_DBL=1<<24,TWO_PWR_32_DBL=TWO_PWR_16_DBL*TWO_PWR_16_DBL,TWO_PWR_64_DBL=TWO_PWR_32_DBL*TWO_PWR_32_DBL,TWO_PWR_63_DBL=TWO_PWR_64_DBL/2,TWO_PWR_24=fromInt(TWO_PWR_24_DBL),ZERO=fromInt(0);Long.ZERO=ZERO;var UZERO=fromInt(0,!0);Long.UZERO=UZERO;var ONE=fromInt(1);Long.ONE=ONE;var UONE=fromInt(1,!0);Long.UONE=UONE;var NEG_ONE=fromInt(-1);Long.NEG_ONE=NEG_ONE;var MAX_VALUE=fromBits(-1,2147483647,!1);Long.MAX_VALUE=MAX_VALUE;var MAX_UNSIGNED_VALUE=fromBits(-1,-1,!0);Long.MAX_UNSIGNED_VALUE=MAX_UNSIGNED_VALUE;var MIN_VALUE=fromBits(0,-2147483648,!1);Long.MIN_VALUE=MIN_VALUE;var LongPrototype=Long.prototype;LongPrototype.toInt=function(){return this.unsigned?this.low>>>0:this.low},LongPrototype.toNumber=function(){return this.unsigned?(this.high>>>0)*TWO_PWR_32_DBL+(this.low>>>0):this.high*TWO_PWR_32_DBL+(this.low>>>0)},LongPrototype.toString=function(t){if((t=t||10)<2||36<t)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(MIN_VALUE)){var e=fromNumber(t),r=this.div(e),i=r.mul(e).sub(this);return r.toString(t)+i.toInt().toString(t)}return"-"+this.neg().toString(t)}for(var n=fromNumber(pow_dbl(t,6),this.unsigned),o=this,a="";;){var s=o.div(n),l=(o.sub(s.mul(n)).toInt()>>>0).toString(t);if((o=s).isZero())return l+a;for(;l.length<6;)l="0"+l;a=""+l+a}},LongPrototype.getHighBits=function(){return this.high},LongPrototype.getHighBitsUnsigned=function(){return this.high>>>0},LongPrototype.getLowBits=function(){return this.low},LongPrototype.getLowBitsUnsigned=function(){return this.low>>>0},LongPrototype.getNumBitsAbs=function(){if(this.isNegative())return this.eq(MIN_VALUE)?64:this.neg().getNumBitsAbs();for(var t=0!=this.high?this.high:this.low,e=31;0<e&&0==(t&1<<e);e--);return 0!=this.high?e+33:e+1},LongPrototype.isZero=function(){return 0===this.high&&0===this.low},LongPrototype.eqz=LongPrototype.isZero,LongPrototype.isNegative=function(){return!this.unsigned&&this.high<0},LongPrototype.isPositive=function(){return this.unsigned||0<=this.high},LongPrototype.isOdd=function(){return 1==(1&this.low)},LongPrototype.isEven=function(){return 0==(1&this.low)},LongPrototype.equals=function(t){return isLong(t)||(t=fromValue(t)),(this.unsigned===t.unsigned||this.high>>>31!=1||t.high>>>31!=1)&&this.high===t.high&&this.low===t.low},LongPrototype.eq=LongPrototype.equals,LongPrototype.notEquals=function(t){return!this.eq(t)},LongPrototype.neq=LongPrototype.notEquals,LongPrototype.ne=LongPrototype.notEquals,LongPrototype.lessThan=function(t){return this.comp(t)<0},LongPrototype.lt=LongPrototype.lessThan,LongPrototype.lessThanOrEqual=function(t){return this.comp(t)<=0},LongPrototype.lte=LongPrototype.lessThanOrEqual,LongPrototype.le=LongPrototype.lessThanOrEqual,LongPrototype.greaterThan=function(t){return 0<this.comp(t)},LongPrototype.gt=LongPrototype.greaterThan,LongPrototype.greaterThanOrEqual=function(t){return 0<=this.comp(t)},LongPrototype.gte=LongPrototype.greaterThanOrEqual,LongPrototype.ge=LongPrototype.greaterThanOrEqual,LongPrototype.compare=function(t){if(isLong(t)||(t=fromValue(t)),this.eq(t))return 0;var e=this.isNegative(),r=t.isNegative();return e&&!r?-1:!e&&r?1:this.unsigned?t.high>>>0>this.high>>>0||t.high===this.high&&t.low>>>0>this.low>>>0?-1:1:this.sub(t).isNegative()?-1:1},LongPrototype.comp=LongPrototype.compare,LongPrototype.negate=function(){return!this.unsigned&&this.eq(MIN_VALUE)?MIN_VALUE:this.not().add(ONE)},LongPrototype.neg=LongPrototype.negate,LongPrototype.add=function(t){isLong(t)||(t=fromValue(t));var e=this.high>>>16,r=65535&this.high,i=this.low>>>16,n=65535&this.low,o=t.high>>>16,a=65535&t.high,s=t.low>>>16,l=0,c=0,u=0,h=0;return u+=(h+=n+(65535&t.low))>>>16,c+=(u+=i+s)>>>16,l+=(c+=r+a)>>>16,l+=e+o,fromBits((u&=65535)<<16|(h&=65535),(l&=65535)<<16|(c&=65535),this.unsigned)},LongPrototype.subtract=function(t){return isLong(t)||(t=fromValue(t)),this.add(t.neg())},LongPrototype.sub=LongPrototype.subtract,LongPrototype.multiply=function(t){if(this.isZero())return ZERO;if(isLong(t)||(t=fromValue(t)),wasm)return fromBits(wasm.mul(this.low,this.high,t.low,t.high),wasm.get_high(),this.unsigned);if(t.isZero())return ZERO;if(this.eq(MIN_VALUE))return t.isOdd()?MIN_VALUE:ZERO;if(t.eq(MIN_VALUE))return this.isOdd()?MIN_VALUE:ZERO;if(this.isNegative())return t.isNegative()?this.neg().mul(t.neg()):this.neg().mul(t).neg();if(t.isNegative())return this.mul(t.neg()).neg();if(this.lt(TWO_PWR_24)&&t.lt(TWO_PWR_24))return fromNumber(this.toNumber()*t.toNumber(),this.unsigned);var e=this.high>>>16,r=65535&this.high,i=this.low>>>16,n=65535&this.low,o=t.high>>>16,a=65535&t.high,s=t.low>>>16,l=65535&t.low,c=0,u=0,h=0,p=0;return h+=(p+=n*l)>>>16,u+=(h+=i*l)>>>16,h&=65535,u+=(h+=n*s)>>>16,c+=(u+=r*l)>>>16,u&=65535,c+=(u+=i*s)>>>16,u&=65535,c+=(u+=n*a)>>>16,c+=e*l+r*s+i*a+n*o,fromBits((h&=65535)<<16|(p&=65535),(c&=65535)<<16|(u&=65535),this.unsigned)},LongPrototype.mul=LongPrototype.multiply,LongPrototype.divide=function(t){if(isLong(t)||(t=fromValue(t)),t.isZero())throw Error("division by zero");var e,r,i;if(wasm)return this.unsigned||-2147483648!==this.high||-1!==t.low||-1!==t.high?fromBits((this.unsigned?wasm.div_u:wasm.div_s)(this.low,this.high,t.low,t.high),wasm.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?UZERO:ZERO;if(this.unsigned){if(t.unsigned||(t=t.toUnsigned()),t.gt(this))return UZERO;if(t.gt(this.shru(1)))return UONE;r=UZERO}else{if(this.eq(MIN_VALUE))return t.eq(ONE)||t.eq(NEG_ONE)?MIN_VALUE:t.eq(MIN_VALUE)?ONE:(i=this.shr(1).div(t).shl(1)).eq(ZERO)?t.isNegative()?ONE:NEG_ONE:(e=this.sub(t.mul(i)),r=i.add(e.div(t)));if(t.eq(MIN_VALUE))return this.unsigned?UZERO:ZERO;if(this.isNegative())return t.isNegative()?this.neg().div(t.neg()):this.neg().div(t).neg();if(t.isNegative())return this.div(t.neg()).neg();r=ZERO}for(e=this;e.gte(t);){i=Math.max(1,Math.floor(e.toNumber()/t.toNumber()));for(var n=Math.ceil(Math.log(i)/Math.LN2),o=n<=48?1:pow_dbl(2,n-48),a=fromNumber(i),s=a.mul(t);s.isNegative()||s.gt(e);)s=(a=fromNumber(i-=o,this.unsigned)).mul(t);a.isZero()&&(a=ONE),r=r.add(a),e=e.sub(s)}return r},LongPrototype.div=LongPrototype.divide,LongPrototype.modulo=function(t){return isLong(t)||(t=fromValue(t)),wasm?fromBits((this.unsigned?wasm.rem_u:wasm.rem_s)(this.low,this.high,t.low,t.high),wasm.get_high(),this.unsigned):this.sub(this.div(t).mul(t))},LongPrototype.mod=LongPrototype.modulo,LongPrototype.rem=LongPrototype.modulo,LongPrototype.not=function(){return fromBits(~this.low,~this.high,this.unsigned)},LongPrototype.and=function(t){return isLong(t)||(t=fromValue(t)),fromBits(this.low&t.low,this.high&t.high,this.unsigned)},LongPrototype.or=function(t){return isLong(t)||(t=fromValue(t)),fromBits(this.low|t.low,this.high|t.high,this.unsigned)},LongPrototype.xor=function(t){return isLong(t)||(t=fromValue(t)),fromBits(this.low^t.low,this.high^t.high,this.unsigned)},LongPrototype.shiftLeft=function(t){return isLong(t)&&(t=t.toInt()),0==(t&=63)?this:t<32?fromBits(this.low<<t,this.high<<t|this.low>>>32-t,this.unsigned):fromBits(0,this.low<<t-32,this.unsigned)},LongPrototype.shl=LongPrototype.shiftLeft,LongPrototype.shiftRight=function(t){return isLong(t)&&(t=t.toInt()),0==(t&=63)?this:t<32?fromBits(this.low>>>t|this.high<<32-t,this.high>>t,this.unsigned):fromBits(this.high>>t-32,0<=this.high?0:-1,this.unsigned)},LongPrototype.shr=LongPrototype.shiftRight,LongPrototype.shiftRightUnsigned=function(t){if(isLong(t)&&(t=t.toInt()),0==(t&=63))return this;var e=this.high;return t<32?fromBits(this.low>>>t|e<<32-t,e>>>t,this.unsigned):fromBits(32===t?e:e>>>t-32,0,this.unsigned)},LongPrototype.shru=LongPrototype.shiftRightUnsigned,LongPrototype.shr_u=LongPrototype.shiftRightUnsigned,LongPrototype.toSigned=function(){return this.unsigned?fromBits(this.low,this.high,!1):this},LongPrototype.toUnsigned=function(){return this.unsigned?this:fromBits(this.low,this.high,!0)},LongPrototype.toBytes=function(t){return t?this.toBytesLE():this.toBytesBE()},LongPrototype.toBytesLE=function(){var t=this.high,e=this.low;return[255&e,e>>>8&255,e>>>16&255,e>>>24,255&t,t>>>8&255,t>>>16&255,t>>>24]},LongPrototype.toBytesBE=function(){var t=this.high,e=this.low;return[t>>>24,t>>>16&255,t>>>8&255,255&t,e>>>24,e>>>16&255,e>>>8&255,255&e]},Long.fromBytes=function(t,e,r){return r?Long.fromBytesLE(t,e):Long.fromBytesBE(t,e)},Long.fromBytesLE=function(t,e){return new Long(t[0]|t[1]<<8|t[2]<<16|t[3]<<24,t[4]|t[5]<<8|t[6]<<16|t[7]<<24,e)},Long.fromBytesBE=function(t,e){return new Long(t[4]<<24|t[5]<<16|t[6]<<8|t[7],t[0]<<24|t[1]<<16|t[2]<<8|t[3],e)};var aspromise=asPromise;function asPromise(t,e){for(var r=new Array(arguments.length-1),i=0,n=2,o=!0;n<arguments.length;)r[i++]=arguments[n++];return new Promise((function(n,a){r[i]=function(t){if(o)if(o=!1,t)a(t);else{for(var e=new Array(arguments.length-1),r=0;r<e.length;)e[r++]=arguments[r];n.apply(null,e)}};try{t.apply(e||null,r)}catch(t){o&&(o=!1,a(t))}}))}var base64_1=createCommonjsModule((function(t,e){var r=e;r.length=function(t){var e=t.length;if(!e)return 0;for(var r=0;1<--e%4&&"="===t.charAt(e);)++r;return Math.ceil(3*t.length)/4-r};for(var i=new Array(64),n=new Array(123),o=0;o<64;)n[i[o]=o<26?o+65:o<52?o+71:o<62?o-4:o-59|43]=o++;r.encode=function(t,e,r){for(var n,o=null,a=[],s=0,l=0;e<r;){var c=t[e++];switch(l){case 0:a[s++]=i[c>>2],n=(3&c)<<4,l=1;break;case 1:a[s++]=i[n|c>>4],n=(15&c)<<2,l=2;break;case 2:a[s++]=i[n|c>>6],a[s++]=i[63&c],l=0}8191<s&&((o=o||[]).push(String.fromCharCode.apply(String,a)),s=0)}return l&&(a[s++]=i[n],a[s++]=61,1===l&&(a[s++]=61)),o?(s&&o.push(String.fromCharCode.apply(String,a.slice(0,s))),o.join("")):String.fromCharCode.apply(String,a.slice(0,s))};var a="invalid encoding";r.decode=function(t,e,r){for(var i,o=r,s=0,l=0;l<t.length;){var c=t.charCodeAt(l++);if(61===c&&1<s)break;if(void 0===(c=n[c]))throw Error(a);switch(s){case 0:i=c,s=1;break;case 1:e[r++]=i<<2|(48&c)>>4,i=c,s=2;break;case 2:e[r++]=(15&i)<<4|(60&c)>>2,i=c,s=3;break;case 3:e[r++]=(3&i)<<6|c,s=0}}if(1===s)throw Error(a);return r-o},r.test=function(t){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(t)}})),eventemitter=EventEmitter;function EventEmitter(){this._listeners={}}EventEmitter.prototype.on=function(t,e,r){return(this._listeners[t]||(this._listeners[t]=[])).push({fn:e,ctx:r||this}),this},EventEmitter.prototype.off=function(t,e){if(void 0===t)this._listeners={};else if(void 0===e)this._listeners[t]=[];else for(var r=this._listeners[t],i=0;i<r.length;)r[i].fn===e?r.splice(i,1):++i;return this},EventEmitter.prototype.emit=function(t){var e=this._listeners[t];if(e){for(var r=[],i=1;i<arguments.length;)r.push(arguments[i++]);for(i=0;i<e.length;)e[i].fn.apply(e[i++].ctx,r)}return this};var float_1=factory(factory);function factory(t){function e(t,e,r,i){var n,o=e<0?1:0;o&&(e=-e),0===e?t(0<1/e?0:2147483648,r,i):isNaN(e)?t(2143289344,r,i):t(34028234663852886e22<e?(o<<31|2139095040)>>>0:e<11754943508222875e-54?(o<<31|Math.round(e/1401298464324817e-60))>>>0:(o<<31|(n=Math.floor(Math.log(e)/Math.LN2))+127<<23|8388607&Math.round(e*Math.pow(2,-n)*8388608))>>>0,r,i)}function r(t,e,r){var i=t(e,r),n=2*(i>>31)+1,o=i>>>23&255,a=8388607&i;return 255==o?a?NaN:1/0*n:0==o?1401298464324817e-60*n*a:n*Math.pow(2,o-150)*(8388608+a)}function i(t,e,r){s[0]=t,e[r]=l[0],e[r+1]=l[1],e[r+2]=l[2],e[r+3]=l[3]}function n(t,e,r){s[0]=t,e[r]=l[3],e[r+1]=l[2],e[r+2]=l[1],e[r+3]=l[0]}function o(t,e){return l[0]=t[e],l[1]=t[e+1],l[2]=t[e+2],l[3]=t[e+3],s[0]}function a(t,e){return l[3]=t[e],l[2]=t[e+1],l[1]=t[e+2],l[0]=t[e+3],s[0]}var s,l,c,u,h,p;function f(t,e,r,i,n,o){var a,s,l=i<0?1:0;l&&(i=-i),0===i?(t(0,n,o+e),t(0<1/i?0:2147483648,n,o+r)):isNaN(i)?(t(0,n,o+e),t(2146959360,n,o+r)):17976931348623157e292<i?(t(0,n,o+e),t((l<<31|2146435072)>>>0,n,o+r)):i<22250738585072014e-324?(t((a=i/5e-324)>>>0,n,o+e),t((l<<31|a/4294967296)>>>0,n,o+r)):(1024===(s=Math.floor(Math.log(i)/Math.LN2))&&(s=1023),t(4503599627370496*(a=i*Math.pow(2,-s))>>>0,n,o+e),t((l<<31|s+1023<<20|1048576*a&1048575)>>>0,n,o+r))}function d(t,e,r,i,n){var o=t(i,n+e),a=t(i,n+r),s=2*(a>>31)+1,l=a>>>20&2047,c=4294967296*(1048575&a)+o;return 2047==l?c?NaN:1/0*s:0==l?5e-324*s*c:s*Math.pow(2,l-1075)*(c+4503599627370496)}function y(t,e,r){u[0]=t,e[r]=h[0],e[r+1]=h[1],e[r+2]=h[2],e[r+3]=h[3],e[r+4]=h[4],e[r+5]=h[5],e[r+6]=h[6],e[r+7]=h[7]}function g(t,e,r){u[0]=t,e[r]=h[7],e[r+1]=h[6],e[r+2]=h[5],e[r+3]=h[4],e[r+4]=h[3],e[r+5]=h[2],e[r+6]=h[1],e[r+7]=h[0]}function v(t,e){return h[0]=t[e],h[1]=t[e+1],h[2]=t[e+2],h[3]=t[e+3],h[4]=t[e+4],h[5]=t[e+5],h[6]=t[e+6],h[7]=t[e+7],u[0]}function m(t,e){return h[7]=t[e],h[6]=t[e+1],h[5]=t[e+2],h[4]=t[e+3],h[3]=t[e+4],h[2]=t[e+5],h[1]=t[e+6],h[0]=t[e+7],u[0]}return"undefined"!=typeof Float32Array?(s=new Float32Array([-0]),c=128===(l=new Uint8Array(s.buffer))[3],t.writeFloatLE=c?i:n,t.writeFloatBE=c?n:i,t.readFloatLE=c?o:a,t.readFloatBE=c?a:o):(t.writeFloatLE=e.bind(null,writeUintLE),t.writeFloatBE=e.bind(null,writeUintBE),t.readFloatLE=r.bind(null,readUintLE),t.readFloatBE=r.bind(null,readUintBE)),"undefined"!=typeof Float64Array?(u=new Float64Array([-0]),p=128===(h=new Uint8Array(u.buffer))[7],t.writeDoubleLE=p?y:g,t.writeDoubleBE=p?g:y,t.readDoubleLE=p?v:m,t.readDoubleBE=p?m:v):(t.writeDoubleLE=f.bind(null,writeUintLE,0,4),t.writeDoubleBE=f.bind(null,writeUintBE,4,0),t.readDoubleLE=d.bind(null,readUintLE,0,4),t.readDoubleBE=d.bind(null,readUintBE,4,0)),t}function writeUintLE(t,e,r){e[r]=255&t,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}function writeUintBE(t,e,r){e[r]=t>>>24,e[r+1]=t>>>16&255,e[r+2]=t>>>8&255,e[r+3]=255&t}function readUintLE(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0}function readUintBE(t,e){return(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}var inquire_1=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(t){}return null}var utf8_1=createCommonjsModule((function(t,e){var r=e;r.length=function(t){for(var e=0,r=0,i=0;i<t.length;++i)(r=t.charCodeAt(i))<128?e+=1:r<2048?e+=2:55296==(64512&r)&&56320==(64512&t.charCodeAt(i+1))?(++i,e+=4):e+=3;return e},r.read=function(t,e,r){if(r-e<1)return"";for(var i,n=null,o=[],a=0;e<r;)(i=t[e++])<128?o[a++]=i:191<i&&i<224?o[a++]=(31&i)<<6|63&t[e++]:239<i&&i<365?(i=((7&i)<<18|(63&t[e++])<<12|(63&t[e++])<<6|63&t[e++])-65536,o[a++]=55296+(i>>10),o[a++]=56320+(1023&i)):o[a++]=(15&i)<<12|(63&t[e++])<<6|63&t[e++],8191<a&&((n=n||[]).push(String.fromCharCode.apply(String,o)),a=0);return n?(a&&n.push(String.fromCharCode.apply(String,o.slice(0,a))),n.join("")):String.fromCharCode.apply(String,o.slice(0,a))},r.write=function(t,e,r){for(var i,n,o=r,a=0;a<t.length;++a)(i=t.charCodeAt(a))<128?e[r++]=i:(i<2048?e[r++]=i>>6|192:(55296==(64512&i)&&56320==(64512&(n=t.charCodeAt(a+1)))?(i=65536+((1023&i)<<10)+(1023&n),++a,e[r++]=i>>18|240,e[r++]=i>>12&63|128):e[r++]=i>>12|224,e[r++]=i>>6&63|128),e[r++]=63&i|128);return r-o}})),pool_1=pool;function pool(t,e,r){var i=r||8192,n=i>>>1,o=null,a=i;return function(r){if(r<1||n<r)return t(r);i<a+r&&(o=t(i),a=0);var s=e.call(o,a,a+=r);return 7&a&&(a=1+(7|a)),s}}var longbits=LongBits;function LongBits(t,e){this.lo=t>>>0,this.hi=e>>>0}var zero=LongBits.zero=new LongBits(0,0);zero.toNumber=function(){return 0},zero.zzEncode=zero.zzDecode=function(){return this},zero.length=function(){return 1};var zeroHash=LongBits.zeroHash="\0\0\0\0\0\0\0\0";LongBits.fromNumber=function(t){if(0===t)return zero;var e=t<0;e&&(t=-t);var r=t>>>0,i=(t-r)/4294967296>>>0;return e&&(i=~i>>>0,r=~r>>>0,4294967295<++r&&(r=0,4294967295<++i&&(i=0))),new LongBits(r,i)},LongBits.from=function(t){if("number"==typeof t)return LongBits.fromNumber(t);if(minimal.isString(t)){if(!minimal.Long)return LongBits.fromNumber(parseInt(t,10));t=minimal.Long.fromString(t)}return t.low||t.high?new LongBits(t.low>>>0,t.high>>>0):zero},LongBits.prototype.toNumber=function(t){if(!t&&this.hi>>>31){var e=1+~this.lo>>>0,r=~this.hi>>>0;return e||(r=r+1>>>0),-(e+4294967296*r)}return this.lo+4294967296*this.hi},LongBits.prototype.toLong=function(t){return minimal.Long?new minimal.Long(0|this.lo,0|this.hi,Boolean(t)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(t)}};var charCodeAt=String.prototype.charCodeAt;LongBits.fromHash=function(t){return t===zeroHash?zero:new LongBits((charCodeAt.call(t,0)|charCodeAt.call(t,1)<<8|charCodeAt.call(t,2)<<16|charCodeAt.call(t,3)<<24)>>>0,(charCodeAt.call(t,4)|charCodeAt.call(t,5)<<8|charCodeAt.call(t,6)<<16|charCodeAt.call(t,7)<<24)>>>0)},LongBits.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},LongBits.prototype.zzEncode=function(){var t=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^t)>>>0,this.lo=(this.lo<<1^t)>>>0,this},LongBits.prototype.zzDecode=function(){var t=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^t)>>>0,this.hi=(this.hi>>>1^t)>>>0,this},LongBits.prototype.length=function(){var t=this.lo,e=(this.lo>>>28|this.hi<<4)>>>0,r=this.hi>>>24;return 0==r?0==e?t<16384?t<128?1:2:t<2097152?3:4:e<16384?e<128?5:6:e<2097152?7:8:r<128?9:10};var minimal=createCommonjsModule((function(t,e){var r=e;function i(t,e,r){for(var i=Object.keys(e),n=0;n<i.length;++n)void 0!==t[i[n]]&&r||(t[i[n]]=e[i[n]]);return t}function n(t){function e(t,r){if(!(this instanceof e))return new e(t,r);Object.defineProperty(this,"message",{get:function(){return t}}),Error.captureStackTrace?Error.captureStackTrace(this,e):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),r&&i(this,r)}return(e.prototype=Object.create(Error.prototype)).constructor=e,Object.defineProperty(e.prototype,"name",{get:function(){return t}}),e.prototype.toString=function(){return this.name+": "+this.message},e}r.asPromise=aspromise,r.base64=base64_1,r.EventEmitter=eventemitter,r.float=float_1,r.inquire=inquire_1,r.utf8=utf8_1,r.pool=pool_1,r.LongBits=longbits,r.isNode=Boolean(void 0!==commonjsGlobal&&commonjsGlobal&&commonjsGlobal.process&&commonjsGlobal.process.versions&&commonjsGlobal.process.versions.node),r.global=r.isNode&&commonjsGlobal||"undefined"!=typeof window&&window||"undefined"!=typeof self&&self||commonjsGlobal,r.emptyArray=Object.freeze?Object.freeze([]):[],r.emptyObject=Object.freeze?Object.freeze({}):{},r.isInteger=Number.isInteger||function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t},r.isString=function(t){return"string"==typeof t||t instanceof String},r.isObject=function(t){return t&&"object"==typeof t},r.isset=r.isSet=function(t,e){var r=t[e];return!(null==r||!t.hasOwnProperty(e))&&("object"!=typeof r||0<(Array.isArray(r)?r.length:Object.keys(r).length))},r.Buffer=function(){try{var t=r.inquire("buffer").Buffer;return t.prototype.utf8Write?t:null}catch(t){return null}}(),r._Buffer_from=null,r._Buffer_allocUnsafe=null,r.newBuffer=function(t){return"number"==typeof t?r.Buffer?r._Buffer_allocUnsafe(t):new r.Array(t):r.Buffer?r._Buffer_from(t):"undefined"==typeof Uint8Array?t:new Uint8Array(t)},r.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,r.Long=r.global.dcodeIO&&r.global.dcodeIO.Long||r.global.Long||r.inquire("long"),r.key2Re=/^true|false|0|1$/,r.key32Re=/^-?(?:0|[1-9][0-9]*)$/,r.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,r.longToHash=function(t){return t?r.LongBits.from(t).toHash():r.LongBits.zeroHash},r.longFromHash=function(t,e){var i=r.LongBits.fromHash(t);return r.Long?r.Long.fromBits(i.lo,i.hi,e):i.toNumber(Boolean(e))},r.merge=i,r.lcFirst=function(t){return t.charAt(0).toLowerCase()+t.substring(1)},r.newError=n,r.ProtocolError=n("ProtocolError"),r.oneOfGetter=function(t){for(var e={},r=0;r<t.length;++r)e[t[r]]=1;return function(){for(var t=Object.keys(this),r=t.length-1;-1<r;--r)if(1===e[t[r]]&&void 0!==this[t[r]]&&null!==this[t[r]])return t[r]}},r.oneOfSetter=function(t){return function(e){for(var r=0;r<t.length;++r)t[r]!==e&&delete this[t[r]]}},r.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},r._configure=function(){var t=r.Buffer;t?(r._Buffer_from=t.from!==Uint8Array.from&&t.from||function(e,r){return new t(e,r)},r._Buffer_allocUnsafe=t.allocUnsafe||function(e){return new t(e)}):r._Buffer_from=r._Buffer_allocUnsafe=null}})),writer=Writer,BufferWriter,LongBits$1=minimal.LongBits,base64=minimal.base64,utf8=minimal.utf8;function Op(t,e,r){this.fn=t,this.len=e,this.next=void 0,this.val=r}function noop(){}function State(t){this.head=t.head,this.tail=t.tail,this.len=t.len,this.next=t.states}function Writer(){this.len=0,this.head=new Op(noop,0,0),this.tail=this.head,this.states=null}var create=function(){return minimal.Buffer?function(){return(Writer.create=function(){return new BufferWriter})()}:function(){return new Writer}};function writeByte(t,e,r){e[r]=255&t}function writeVarint32(t,e,r){for(;127<t;)e[r++]=127&t|128,t>>>=7;e[r]=t}function VarintOp(t,e){this.len=t,this.next=void 0,this.val=e}function writeVarint64(t,e,r){for(;t.hi;)e[r++]=127&t.lo|128,t.lo=(t.lo>>>7|t.hi<<25)>>>0,t.hi>>>=7;for(;127<t.lo;)e[r++]=127&t.lo|128,t.lo=t.lo>>>7;e[r++]=t.lo}function writeFixed32(t,e,r){e[r]=255&t,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}Writer.create=create(),Writer.alloc=function(t){return new minimal.Array(t)},minimal.Array!==Array&&(Writer.alloc=minimal.pool(Writer.alloc,minimal.Array.prototype.subarray)),Writer.prototype._push=function(t,e,r){return this.tail=this.tail.next=new Op(t,e,r),this.len+=e,this},VarintOp.prototype=Object.create(Op.prototype),VarintOp.prototype.fn=writeVarint32,Writer.prototype.uint32=function(t){return this.len+=(this.tail=this.tail.next=new VarintOp((t>>>=0)<128?1:t<16384?2:t<2097152?3:t<268435456?4:5,t)).len,this},Writer.prototype.int32=function(t){return t<0?this._push(writeVarint64,10,LongBits$1.fromNumber(t)):this.uint32(t)},Writer.prototype.sint32=function(t){return this.uint32((t<<1^t>>31)>>>0)},Writer.prototype.uint64=function(t){var e=LongBits$1.from(t);return this._push(writeVarint64,e.length(),e)},Writer.prototype.int64=Writer.prototype.uint64,Writer.prototype.sint64=function(t){var e=LongBits$1.from(t).zzEncode();return this._push(writeVarint64,e.length(),e)},Writer.prototype.bool=function(t){return this._push(writeByte,1,t?1:0)},Writer.prototype.fixed32=function(t){return this._push(writeFixed32,4,t>>>0)},Writer.prototype.sfixed32=Writer.prototype.fixed32,Writer.prototype.fixed64=function(t){var e=LongBits$1.from(t);return this._push(writeFixed32,4,e.lo)._push(writeFixed32,4,e.hi)},Writer.prototype.sfixed64=Writer.prototype.fixed64,Writer.prototype.float=function(t){return this._push(minimal.float.writeFloatLE,4,t)},Writer.prototype.double=function(t){return this._push(minimal.float.writeDoubleLE,8,t)};var writeBytes=minimal.Array.prototype.set?function(t,e,r){e.set(t,r)}:function(t,e,r){for(var i=0;i<t.length;++i)e[r+i]=t[i]};Writer.prototype.bytes=function(t){var e,r=t.length>>>0;return r?(minimal.isString(t)&&(e=Writer.alloc(r=base64.length(t)),base64.decode(t,e,0),t=e),this.uint32(r)._push(writeBytes,r,t)):this._push(writeByte,1,0)},Writer.prototype.string=function(t){var e=utf8.length(t);return e?this.uint32(e)._push(utf8.write,e,t):this._push(writeByte,1,0)},Writer.prototype.fork=function(){return this.states=new State(this),this.head=this.tail=new Op(noop,0,0),this.len=0,this},Writer.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Op(noop,0,0),this.len=0),this},Writer.prototype.ldelim=function(){var t=this.head,e=this.tail,r=this.len;return this.reset().uint32(r),r&&(this.tail.next=t.next,this.tail=e,this.len+=r),this},Writer.prototype.finish=function(){for(var t=this.head.next,e=this.constructor.alloc(this.len),r=0;t;)t.fn(t.val,e,r),r+=t.len,t=t.next;return e},Writer._configure=function(t){BufferWriter=t,Writer.create=create(),BufferWriter._configure()};var writer_buffer=BufferWriter$1;function BufferWriter$1(){writer.call(this)}function writeStringBuffer(t,e,r){t.length<40?minimal.utf8.write(t,e,r):e.utf8Write?e.utf8Write(t,r):e.write(t,r)}(BufferWriter$1.prototype=Object.create(writer.prototype)).constructor=BufferWriter$1,BufferWriter$1._configure=function(){BufferWriter$1.alloc=minimal._Buffer_allocUnsafe,BufferWriter$1.writeBytesBuffer=minimal.Buffer&&minimal.Buffer.prototype instanceof Uint8Array&&"set"===minimal.Buffer.prototype.set.name?function(t,e,r){e.set(t,r)}:function(t,e,r){if(t.copy)t.copy(e,r,0,t.length);else for(var i=0;i<t.length;)e[r++]=t[i++]}},BufferWriter$1.prototype.bytes=function(t){minimal.isString(t)&&(t=minimal._Buffer_from(t,"base64"));var e=t.length>>>0;return this.uint32(e),e&&this._push(BufferWriter$1.writeBytesBuffer,e,t),this},BufferWriter$1.prototype.string=function(t){var e=minimal.Buffer.byteLength(t);return this.uint32(e),e&&this._push(writeStringBuffer,e,t),this},BufferWriter$1._configure();var reader=Reader,BufferReader,LongBits$2=minimal.LongBits,utf8$1=minimal.utf8;function indexOutOfRange(t,e){return RangeError("index out of range: "+t.pos+" + "+(e||1)+" > "+t.len)}function Reader(t){this.buf=t,this.pos=0,this.len=t.length}var create_array="undefined"!=typeof Uint8Array?function(t){if(t instanceof Uint8Array||Array.isArray(t))return new Reader(t);throw Error("illegal buffer")}:function(t){if(Array.isArray(t))return new Reader(t);throw Error("illegal buffer")},create$1=function(){return minimal.Buffer?function(t){return(Reader.create=function(t){return minimal.Buffer.isBuffer(t)?new BufferReader(t):create_array(t)})(t)}:create_array},fU;function readLongVarint(){var t=new LongBits$2(0,0),e=0;if(!(4<this.len-this.pos)){for(;e<3;++e){if(this.pos>=this.len)throw indexOutOfRange(this);if(t.lo=(t.lo|(127&this.buf[this.pos])<<7*e)>>>0,this.buf[this.pos++]<128)return t}return t.lo=(t.lo|(127&this.buf[this.pos++])<<7*e)>>>0,t}for(;e<4;++e)if(t.lo=(t.lo|(127&this.buf[this.pos])<<7*e)>>>0,this.buf[this.pos++]<128)return t;if(t.lo=(t.lo|(127&this.buf[this.pos])<<28)>>>0,t.hi=(t.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return t;if(e=0,4<this.len-this.pos){for(;e<5;++e)if(t.hi=(t.hi|(127&this.buf[this.pos])<<7*e+3)>>>0,this.buf[this.pos++]<128)return t}else for(;e<5;++e){if(this.pos>=this.len)throw indexOutOfRange(this);if(t.hi=(t.hi|(127&this.buf[this.pos])<<7*e+3)>>>0,this.buf[this.pos++]<128)return t}throw Error("invalid varint encoding")}function readFixed32_end(t,e){return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0}function readFixed64(){if(this.pos+8>this.len)throw indexOutOfRange(this,8);return new LongBits$2(readFixed32_end(this.buf,this.pos+=4),readFixed32_end(this.buf,this.pos+=4))}Reader.create=create$1(),Reader.prototype._slice=minimal.Array.prototype.subarray||minimal.Array.prototype.slice,Reader.prototype.uint32=(fU=4294967295,function(){if(fU=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return fU;if(fU=(fU|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return fU;if(fU=(fU|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return fU;if(fU=(fU|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return fU;if(fU=(fU|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return fU;if((this.pos+=5)>this.len)throw this.pos=this.len,indexOutOfRange(this,10);return fU}),Reader.prototype.int32=function(){return 0|this.uint32()},Reader.prototype.sint32=function(){var t=this.uint32();return t>>>1^-(1&t)|0},Reader.prototype.bool=function(){return 0!==this.uint32()},Reader.prototype.fixed32=function(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);return readFixed32_end(this.buf,this.pos+=4)},Reader.prototype.sfixed32=function(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);return 0|readFixed32_end(this.buf,this.pos+=4)},Reader.prototype.float=function(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);var t=minimal.float.readFloatLE(this.buf,this.pos);return this.pos+=4,t},Reader.prototype.double=function(){if(this.pos+8>this.len)throw indexOutOfRange(this,4);var t=minimal.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,t},Reader.prototype.bytes=function(){var t=this.uint32(),e=this.pos,r=this.pos+t;if(r>this.len)throw indexOutOfRange(this,t);return this.pos+=t,Array.isArray(this.buf)?this.buf.slice(e,r):e===r?new this.buf.constructor(0):this._slice.call(this.buf,e,r)},Reader.prototype.string=function(){var t=this.bytes();return utf8$1.read(t,0,t.length)},Reader.prototype.skip=function(t){if("number"==typeof t){if(this.pos+t>this.len)throw indexOutOfRange(this,t);this.pos+=t}else do{if(this.pos>=this.len)throw indexOutOfRange(this)}while(128&this.buf[this.pos++]);return this},Reader.prototype.skipType=function(t){switch(t){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(t=7&this.uint32());)this.skipType(t);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+t+" at offset "+this.pos)}return this},Reader._configure=function(t){BufferReader=t,Reader.create=create$1(),BufferReader._configure();var e=minimal.Long?"toLong":"toNumber";minimal.merge(Reader.prototype,{int64:function(){return readLongVarint.call(this)[e](!1)},uint64:function(){return readLongVarint.call(this)[e](!0)},sint64:function(){return readLongVarint.call(this).zzDecode()[e](!1)},fixed64:function(){return readFixed64.call(this)[e](!0)},sfixed64:function(){return readFixed64.call(this)[e](!1)}})};var reader_buffer=BufferReader$1;function BufferReader$1(t){reader.call(this,t)}(BufferReader$1.prototype=Object.create(reader.prototype)).constructor=BufferReader$1,BufferReader$1._configure=function(){minimal.Buffer&&(BufferReader$1.prototype._slice=minimal.Buffer.prototype.slice)},BufferReader$1.prototype.string=function(){var t=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+t,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+t,this.len))},BufferReader$1._configure();var service=Service;function Service(t,e,r){if("function"!=typeof t)throw TypeError("rpcImpl must be a function");minimal.EventEmitter.call(this),this.rpcImpl=t,this.requestDelimited=Boolean(e),this.responseDelimited=Boolean(r)}(Service.prototype=Object.create(minimal.EventEmitter.prototype)).constructor=Service,Service.prototype.rpcCall=function t(e,r,i,n,o){if(!n)throw TypeError("request must be specified");var a=this;if(!o)return minimal.asPromise(t,a,e,r,i,n);if(a.rpcImpl)try{return a.rpcImpl(e,r[a.requestDelimited?"encodeDelimited":"encode"](n).finish(),(function(t,r){if(t)return a.emit("error",t,e),o(t);if(null!==r){if(!(r instanceof i))try{r=i[a.responseDelimited?"decodeDelimited":"decode"](r)}catch(t){return a.emit("error",t,e),o(t)}return a.emit("data",r,e),o(null,r)}a.end(!0)}))}catch(t){return a.emit("error",t,e),void setTimeout((function(){o(t)}),0)}else setTimeout((function(){o(Error("already ended"))}),0)},Service.prototype.end=function(t){return this.rpcImpl&&(t||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this};var rpc_1=createCommonjsModule((function(t,e){e.Service=service})),roots={},indexMinimal=createCommonjsModule((function(t,e){var r=e;r.build="minimal",r.Writer=writer,r.BufferWriter=writer_buffer,r.Reader=reader,r.BufferReader=reader_buffer,r.util=minimal,r.rpc=rpc_1,r.roots=roots,(r.configure=function(){r.util._configure(),r.Writer._configure(r.BufferWriter),r.Reader._configure(r.BufferReader)})()})),minimal$1=indexMinimal;minimal$1.util.Long=long_1,minimal$1.configure(),VectorTileFeature$1.prototype.loadGeometry=function(t){var e=this._pbf;e.pos=this._geometry;for(var r,i,n=e.readVarint()+e.pos,o=1,a=0,s=0,l=0,c=[];e.pos<n;)if(a<=0&&(o=7&(i=e.readVarint()),a=i>>3),a--,1===o||2===o)s+=e.readSVarint(),l+=e.readSVarint(),1===o&&(r&&c.push(r),r=[]),r.push([s*t,l*t]);else{if(7!==o)throw new Error("unknown command "+o);r&&r.push(r[0].slice())}return r&&c.push(r),c};var MAX_SAFE_INTEGER=long_1.fromNumber(Number.MAX_SAFE_INTEGER,!0),MIN_SAFE_INTEGER=long_1.fromNumber(Number.MIN_SAFE_INTEGER,!1);function readLong(t,e,r){e.pos=t.pos;var i=r.call(e);return t.pos=e.pos,long_1.isLong(i)?0<i.comp(MAX_SAFE_INTEGER)||i.comp(MIN_SAFE_INTEGER)<0?i.toString():i.toNumber():i}var VectorTileLayer=function(){function t(e,r){_classCallCheck(this,t),this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],this._protobufjsReader=minimal$1.Reader.create(e.buf),e.readFields(readLayer,this,r),this.length=this._features.length}return _createClass(t,[{key:"feature",value:function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new VectorTileFeature$1(this._pbf,e,this.extent,this._keys,this._values)}}]),t}();function readLayer(t,e,r){15===t?e.version=r.readVarint():1===t?e.name=r.readString():5===t?e.extent=r.readVarint():2===t?e._features.push(r.pos):3===t?e._keys.push(r.readString()):4===t&&e._values.push(readValueMessage(r,e._protobufjsReader))}function readValueMessage(t,e){for(var r=null,i=t.readVarint()+t.pos;t.pos<i;){var n=t.readVarint()>>3;r=1==n?t.readString():2==n?t.readFloat():3==n?t.readDouble():4==n?readLong(t,e,e.int64):5==n?readLong(t,e,e.uint64):6==n?readLong(t,e,e.sint64):7==n?t.readBoolean():null}return r}var VectorTile=function t(e,r){_classCallCheck(this,t),this.layers=e.readFields(readTile,{},r)};function readTile(t,e,r){var i;3!==t||(i=new VectorTileLayer(r,r.readVarint()+r.pos)).length&&(e[i.name]=i)}function getLayersFromMVT(t){var e={};for(var r in t.layers){for(var i=t.layers[r],n=[],o=Geo$1.tile_scale/i.extent,a=0,s=i.length;a<s;a++){var l=i.feature(a),c=VectorTileFeature$1.types[l.type],u=l.loadGeometry(o),h=null;switch(c){case"Point":h=decodePoint({coordinates:u});break;case"LineString":h=1===u.length?{type:c,coordinates:u[0]}:{type:"MultiLineString",coordinates:u};break;case"Polygon":h=decodeMultiPolygon({coordinates:u})}h&&h.coordinates&&n.push({type:"Feature",geometry:h,properties:l.properties})}e[r]={type:"FeatureCollection",features:n}}return e}var GeomType={UNKNOWN:0,POINT:1,LINESTRING:2,POLYGON:3};function parseGeoJSONVectorTile(t){var e=[],r=t&&t.features;if(r)for(var i=0,n=r.length;i<n;i++){var o=r[i],a=o.type,s=void 0;switch(a){case GeomType.POINT:s={type:"MultiPoint",coordinates:o.geometry.map((function(t){return t.slice()}))};break;case GeomType.LINESTRING:case GeomType.POLYGON:if(s={type:"MultiLineString",coordinates:o.geometry.map((function(t){return t.map((function(t){return t.slice()}))}))},a===GeomType.POLYGON&&null==(s=decodeMultiPolygon(s)))continue;break;default:continue}e.push({id:o.id,type:"Feature",geometry:s,properties:o.tags})}return{type:"FeatureCollection",features:e}}function decodeMultiPolygon(t){for(var e,r=[],i=[],n=0,o=t.coordinates.length;n<o;n++){var a=t.coordinates[n],s=Geo$1.ringWinding(a);null!=s&&(s===(e=e||s)&&i.length&&(r.push(i),i=[]),i.push(a))}return 0<i.length&&r.push(i),1===r.length?(t.type="Polygon",t.coordinates=r[0]):1<r.length?(t.type="MultiPolygon",t.coordinates=r):t=null,t}function decodePoint(t){var e=t.coordinates.length;if(1<e){t.type="MultiPoint";for(var r=[],i=0;i<e;i++)r.push(t.coordinates[i][0]);t.coordinates=r}else t.type="Point",t.coordinates=t.coordinates[0][0];return t}var EMPTY_FEATURE_COLLECTION={type:"FeatureCollection",features:[]},MVTSource=function(){_inherits(e,MapsJsSource);var t=_createSuper(e);function e(r,i){return _classCallCheck(this,e),r.tiled=!0,t.call(this,r,i)}return _createClass(e,[{key:"fetchTile",value:function(t,e,r){return this.provider?this.provider.requestTileAsPromise(t,e,r).then((function(t){return t.data})):Promise.resolve()}},{key:"_load",value:function(t){var e=this,r=Geo$1.wrapTile(t.coords,{x:!0,y:!0}),i=r.x,n=r.y,o=r.z;return WorkerBroker.postMessage(this.target_name+".fetchTile",i,n,o).then((function(r){var i;return r instanceof ArrayBuffer?(i=new pbf(new Uint8Array(r)),t.source_data.layers=getLayersFromMVT(new VectorTile(i))):r?t.source_data.error=r:t.source_data.layers={_default:EMPTY_FEATURE_COLLECTION},e._postProcessTile(t),t}))}},{key:"onReady",value:function(){this.dispatchUpdate()}}]),e}();DataSource.register(MVTSource,"MVT"),DataSource.register(MVTSource,"OMV");var csscolorparser=createCommonjsModule((function(t,e){var r={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function i(t){return(t=Math.round(t))<0?0:255<t?255:t}function n(t){return t<0?0:1<t?1:t}function o(t){return"%"===t[t.length-1]?i(parseFloat(t)/100*255):i(parseInt(t))}function a(t){return"%"===t[t.length-1]?n(parseFloat(t)/100):n(parseFloat(t))}function s(t,e,r){return r<0?r+=1:1<r&&--r,6*r<1?t+(e-t)*r*6:2*r<1?e:3*r<2?t+(e-t)*(2/3-r)*6:t}try{e.parseCSSColor=function(t){var e,n=t.replace(/ /g,"").toLowerCase();if(n in r)return r[n].slice();if("#"===n[0])return 4===n.length?0<=(e=parseInt(n.substr(1),16))&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:7===n.length&&0<=(e=parseInt(n.substr(1),16))&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var l=n.indexOf("("),c=n.indexOf(")");if(-1!==l&&c+1===n.length){var u=n.substr(0,l),h=n.substr(l+1,c-(l+1)).split(","),p=1;switch(u){case"rgba":if(4!==h.length)return null;p=a(h.pop());case"rgb":return 3!==h.length?null:[o(h[0]),o(h[1]),o(h[2]),p];case"hsla":if(4!==h.length)return null;p=a(h.pop());case"hsl":if(3!==h.length)return null;var f=(parseFloat(h[0])%360+360)%360/360,d=a(h[1]),y=a(h[2]),g=y<=.5?y*(d+1):y+d-y*d,v=2*y-g;return[i(255*s(v,g,f+1/3)),i(255*s(v,g,f)),i(255*s(v,g,f-1/3)),p];default:return null}}return null}}catch(t){}})),csscolorparser_1=csscolorparser.parseCSSColor,StyleParser={},clampPositive=function(t){return Math.max(t,0)},noNaN=function(t){return isNaN(t)?0:t},parseNumber=function(t){return Array.isArray(t)?t.map(parseFloat).map(noNaN):noNaN(parseFloat(t))},parsePositiveNumber=function(t){return Array.isArray(t)?t.map(parseNumber).map(clampPositive):clampPositive(parseNumber(t))};Object.assign(StyleParser,{clampPositive,noNaN,parseNumber,parsePositiveNumber}),StyleParser.wrapFunction=function(t){return"\n        var feature = context.feature.properties;\n        var global = context.global;\n        var $zoom = context.zoom;\n        var $layer = context.layer;\n        var $source = context.source;\n        var sources = context.sources;\n        var $geometry = context.geometry;\n        var $meters_per_pixel = context.meters_per_pixel;\n\n        var val = (function(){ ".concat(t," }());\n\n        if (typeof val === 'number' && isNaN(val)) {\n            val = null; // convert NaNs to nulls\n        }\n\n        return val;\n    ")},StyleParser.zeroPair=Object.freeze([0,0]),StyleParser.defaults={color:[1,1,1,1],width:1,size:1,extrude:!1,height:20,min_height:0,order:0,z:0,outline:{color:[0,0,0,0],width:0},material:{ambient:1,diffuse:1}},StyleParser.macros={"Style.color.pseudoRandomColor":function(){return[parseInt(feature.id,16)/100%1*.7,parseInt(feature.id,16)/1e4%1*.7,parseInt(feature.id,16)/1e6%1*.7,1]},"Style.color.randomColor":function(){return[.7*Math.random(),.7*Math.random(),.7*Math.random(),1]}},StyleParser.getFeatureParseContext=function(t,e,r,i){return{feature:t,tile:e,global:r,sources:i,zoom:e.style_zoom,geometry:Geo$1.geometryType(t.geometry.type),meters_per_pixel:e.meters_per_pixel,meters_per_pixel_sq:e.meters_per_pixel_sq,units_per_meter_overzoom:e.units_per_meter_overzoom}};var CACHE_TYPE={STATIC:0,DYNAMIC:1,ZOOM:2};StyleParser.CACHE_TYPE=CACHE_TYPE,StyleParser.createPropertyCache=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;if(null!=t){if(t.value)return{value:t.value,zoom:t.zoom?{}:null,type:t.type};var r={value:t,type:CACHE_TYPE.STATIC};return Array.isArray(r.value)&&Array.isArray(r.value[0])?(r.zoom={},r.type=CACHE_TYPE.ZOOM):"function"==typeof r.value&&(r.type=CACHE_TYPE.DYNAMIC),"function"==typeof e&&(r.zoom?r.value=r.value.map((function(t,r){return[t[0],e(t[1],r)]})):"function"!=typeof r.value&&(r.value=e(r.value,0))),r}},StyleParser.createColorPropertyCache=function(t){return StyleParser.createPropertyCache(t,(function(t){return"Style.color.pseudoRandomColor"===t?Utils$1.stringToFunction(StyleParser.wrapFunction(StyleParser.macros["Style.color.pseudoRandomColor"])):"Style.color.randomColor"===t?StyleParser.macros["Style.color.randomColor"]:t}))};var isPercent=function(t){return"string"==typeof t&&"%"===t[t.length-1]},isRatio=function(t){return"auto"===t},isComputed=function(t){return isPercent(t)||isRatio(t)},dualRatioError="'size' can specify either width or height as derived from aspect ratio, but not both";StyleParser.createPointSizePropertyCache=function(t){var e=null,r=null;if(isPercent(t))e=[!0];else if(Array.isArray(t))if(Array.isArray(t[0])){if(t.some((function(t){return Array.isArray(t[1])?t[1].some((function(t){return isComputed(t)})):isPercent(t[1])}))&&(e=t.map((function(t){return Array.isArray(t[1])?t[1].map((function(t){return isPercent(t)})):isPercent(t[1])})),(r=t.map((function(t){return Array.isArray(t[1])&&t[1].map((function(t){return isRatio(t)}))}))).some((function(t){return Array.isArray(t)&&t.every((function(t){return t}))}))))throw dualRatioError}else if(t.some(isComputed)&&(e=[t.map(isPercent)],(r=[t.map(isRatio)])[0].every((function(t){return t}))))throw dualRatioError;return e?((t={value:t}).has_pct=e,t.has_ratio=r,t.sprites={}):t=StyleParser.createPropertyCache(t,parsePositiveNumber),t},StyleParser.evalCachedPointSizeProperty=function(t,e,r){return t.has_pct||t.has_ratio?e?(t.sprites[e.sprite]||(t.sprites[e.sprite]=StyleParser.createPropertyCache(t.value,(function(r,i){return Array.isArray(r)?(r=r.map((function(e,r){return t.has_ratio[i][r]?e:parsePositiveNumber(e)})).map((function(r,n){return t.has_pct[i][n]?e.css_size[n]*r/100:r})),t.has_ratio[i][0]?r[0]=r[1]*e.aspect:t.has_ratio[i][1]&&(r[1]=r[0]/e.aspect)):(r=parsePositiveNumber(r),r=t.has_pct[i]?e.css_size.map((function(t){return t*r/100})):[r,r]),r}))),StyleParser.evalCachedProperty(t.sprites[e.sprite],r)):void 0:StyleParser.evalCachedProperty(t,r)},StyleParser.evalCachedProperty=function(t,e){if(null!=t)return t.dynamic?t.dynamic(e):t.static?t.static:t.zoom&&t.zoom[e.zoom]?t.zoom[e.zoom]:"function"!=typeof t.value?Array.isArray(t.value)&&Array.isArray(t.value[0])?(t.zoom=t.zoom||{},t.zoom[e.zoom]=Utils$1.interpolate(e.zoom,t.value),t.zoom[e.zoom]):(t.static=t.value,t.static):(t.dynamic=t.value,t.dynamic(e))},StyleParser.convertUnits=function(t,e){if(null!=t.val)return"px"===t.units?t.val*Geo$1.metersPerPixel(e.zoom):t.val;if("string"==typeof t)"px"===t.trim().slice(-2)?(t=parseNumber(t),t*=Geo$1.metersPerPixel(e.zoom)):t=parseNumber(t);else if(Array.isArray(t))return Array.isArray(t[0])?t.map((function(t){return[t[0],StyleParser.convertUnits(t[1],e)]})):t.map((function(t){return StyleParser.convertUnits(t,e)}));return t},StyleParser.parseUnits=function(t){var e={val:parseNumber(t)};return 0!==e.val&&"string"==typeof t&&"px"===t.trim().slice(-2)&&(e.units="px"),e},StyleParser.evalCachedDistanceProperty=function(t,e){return t.dynamic?t.dynamic(e):t.zoom&&t.zoom[e.zoom]?t.zoom[e.zoom]:"function"!=typeof t.value?t.zoom?(t.zoom[e.zoom]=Utils$1.interpolate(e.zoom,t.value,(function(t){return StyleParser.convertUnits(t,e)})),t.zoom[e.zoom]):StyleParser.convertUnits(t.value,e):(t.dynamic=t.value,t.dynamic(e))},StyleParser.string_colors={},StyleParser.colorForString=function(t){if(StyleParser.string_colors[t])return StyleParser.string_colors[t];var e=null;return"none"!==t&&((e=csscolorparser.parseCSSColor(t))&&4===e.length?(e[0]/=255,e[1]/=255,e[2]/=255):e=StyleParser.defaults.color),StyleParser.string_colors[t]=e},StyleParser.evalCachedColorProperty=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(t.dynamic){var r=t.dynamic(e);return"string"==typeof r&&(r=StyleParser.colorForString(r)),r&&null==r[3]&&(r[3]=1),r}if(t.static)return t.static;if(t.zoom&&t.zoom[e.zoom])return t.zoom[e.zoom];if("function"==typeof t.value){t.dynamic=t.value;var i=t.dynamic(e);return"string"==typeof i&&(i=StyleParser.colorForString(i)),i&&null==i[3]&&(i[3]=1),i}if("string"==typeof t.value)return t.static=StyleParser.colorForString(t.value),t.static;if(t.zoom){if(!t.zoom_preprocessed){for(var n=0;n<t.value.length;n++){var o=t.value[n];o&&"string"==typeof o[1]&&(o[1]=StyleParser.colorForString(o[1]))}t.zoom_preprocessed=!0}return t.zoom[e.zoom]=Utils$1.interpolate(e.zoom,t.value),t.zoom[e.zoom][3]=t.zoom[e.zoom][3]||1,t.zoom[e.zoom]}return t.static=t.value.map((function(t){return t})),t.static&&null==t.static[3]&&(t.static[3]=1),t.static},StyleParser.parseColor=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if("function"==typeof t&&(t=t(e)),"string"==typeof t)t=StyleParser.colorForString(t);else if(Array.isArray(t)&&Array.isArray(t[0])){for(var r=0;r<t.length;r++){var i=t[r];"string"==typeof i[1]&&(i[1]=StyleParser.colorForString(i[1]))}e.zoom&&(t=Utils$1.interpolate(e.zoom,t))}return Array.isArray(t)?null==(t=t.map((function(t){return t})))[3]&&(t[3]=1):t=[0,0,0,1],t},StyleParser.calculateOrder=function(t,e){return"function"==typeof t?t=t(e):"string"==typeof t&&(t=e.feature.properties[t]?e.feature.properties[t]:parsePositiveNumber(t)),t},StyleParser.evalProperty=function(t,e){return"function"==typeof t?t(e):t};var RepeatGroup=function(){function t(e,r){_classCallCheck(this,t),this.key=e,this.repeat_dist=r,this.repeat_dist_sq=this.repeat_dist*this.repeat_dist,this.positions=[]}return _createClass(t,[{key:"check",value:function(t){for(var e=t.position,r=0;r<this.positions.length;r++){var i=this.positions[r],n=e[0]-i[0],o=e[1]-i[1],a=n*n+o*o;if(a<this.repeat_dist_sq)return{dist_sq:a,repeat_dist_sq:this.repeat_dist_sq}}}},{key:"add",value:function(t){t&&t.position&&this.positions.push(t.position)}}],[{key:"clear",value:function(t){this.groups[t]={}}},{key:"check",value:function(t,e,r){if(e.repeat_distance&&e.repeat_group&&this.groups[r][e.repeat_group])return this.groups[r][e.repeat_group].check(t)}},{key:"add",value:function(e,r,i){r.repeat_distance&&r.repeat_group&&(null==this.groups[i][r.repeat_group]&&(this.groups[i][r.repeat_group]=new t(r.repeat_group,r.repeat_distance*r.repeat_scale)),this.groups[i][r.repeat_group].add(e))}}]),t}();RepeatGroup.groups={};var GridIndex=function(){function t(e,r,i){_classCallCheck(this,t);var n=this.boxCells=[],o=this.circleCells=[];this.xCellCount=Math.ceil(e/i),this.yCellCount=Math.ceil(r/i);for(var a=0;a<this.xCellCount*this.yCellCount;a++)n.push([]),o.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=r,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/r,this.boxUid=0,this.circleUid=0}return _createClass(t,[{key:"keysLength",value:function(){return this.boxKeys.length+this.circleKeys.length}},{key:"insert",value:function(t,e,r,i,n){this._forEachCell(e,r,i,n,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(e),this.bboxes.push(r),this.bboxes.push(i),this.bboxes.push(n)}},{key:"insertCircle",value:function(t,e,r,i){this._forEachCell(e-i,r-i,e+i,r+i,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(e),this.circles.push(r),this.circles.push(i)}},{key:"insertCircleList",value:function(t,e){for(var r=0;r<e.length-2;r+=3)this.insertCircle("".concat(t,"/").concat(r),e[r],e[r+1],e[r+2])}},{key:"_insertBoxCell",value:function(t,e,r,i,n,o){this.boxCells[n].push(o)}},{key:"_insertCircleCell",value:function(t,e,r,i,n,o){this.circleCells[n].push(o)}},{key:"_query",value:function(t,e,r,i,n,o){if(r<0||t>this.width||i<0||e>this.height)return!n&&[];var a=[];if(t<=0&&e<=0&&this.width<=r&&this.height<=i){if(n)return!0;for(var s=0;s<this.boxKeys.length;s++)a.push({key:this.boxKeys[s],x1:this.bboxes[4*s],y1:this.bboxes[4*s+1],x2:this.bboxes[4*s+2],y2:this.bboxes[4*s+3]});for(var l=0;l<this.circleKeys.length;l++){var c=this.circles[3*l],u=this.circles[3*l+1],h=this.circles[3*l+2];a.push({key:this.circleKeys[l],x1:c-h,y1:u-h,x2:c+h,y2:u+h})}return o?a.filter(o):a}var p={hitTest:n,seenUids:{box:{},circle:{}}};return this._forEachCell(t,e,r,i,this._queryCell,a,p,o),n?0<a.length:a}},{key:"_queryCircle",value:function(t,e,r,i,n){var o=t-r,a=t+r,s=e-r,l=e+r;if(a<0||o>this.width||l<0||s>this.height)return!i&&[];var c=[],u={hitTest:i,circle:{x:t,y:e,radius:r},seenUids:{box:{},circle:{}}};return this._forEachCell(o,s,a,l,this._queryCellCircle,c,u,n),i?0<c.length:c}},{key:"query",value:function(t,e,r,i,n){return this._query(t,e,r,i,!1,n)}},{key:"hitTest",value:function(t,e,r,i,n){return this._query(t,e,r,i,!0,n)}},{key:"hitTestCircle",value:function(t,e,r,i){return this._queryCircle(t,e,r,!0,i)}},{key:"hitTestCircleList",value:function(t,e){for(var r=0;r<t.length-2;r+=3)if(this.hitTestCircle(t[r],t[r+1],t[r+2],e))return!0;return!1}},{key:"_queryCell",value:function(t,e,r,i,n,o,a,s){var l=a.seenUids,c=this.boxCells[n];if(null!==c){var u,h=this.bboxes,p=_createForOfIteratorHelper(c);try{for(p.s();!(u=p.n()).done;){var f=u.value;if(!l.box[f]){l.box[f]=!0;var d=4*f;if(t<=h[2+d]&&e<=h[3+d]&&r>=h[0+d]&&i>=h[1+d]&&(!s||s(this.boxKeys[f]))){if(a.hitTest)return o.push(!0),!0;o.push({key:this.boxKeys[f],x1:h[d],y1:h[1+d],x2:h[2+d],y2:h[3+d]})}}}}catch(t){p.e(t)}finally{p.f()}}var y=this.circleCells[n];if(null!==y){var g,v=this.circles,m=_createForOfIteratorHelper(y);try{for(m.s();!(g=m.n()).done;){var _=g.value;if(!l.circle[_]){l.circle[_]=!0;var b=3*_;if(this._circleAndRectCollide(v[b],v[1+b],v[2+b],t,e,r,i)&&(!s||s(this.circleKeys[_]))){if(a.hitTest)return o.push(!0),!0;var w=v[b],x=v[1+b],E=v[2+b];o.push({key:this.circleKeys[_],x1:w-E,y1:x-E,x2:w+E,y2:x+E})}}}}catch(t){m.e(t)}finally{m.f()}}}},{key:"_queryCellCircle",value:function(t,e,r,i,n,o,a,s){var l=a.circle,c=a.seenUids,u=this.boxCells[n];if(null!==u){var h,p=this.bboxes,f=_createForOfIteratorHelper(u);try{for(f.s();!(h=f.n()).done;){var d=h.value;if(!c.box[d]){c.box[d]=!0;var y=4*d;if(this._circleAndRectCollide(l.x,l.y,l.radius,p[0+y],p[1+y],p[2+y],p[3+y])&&(!s||s(this.boxKeys[d])))return o.push(!0),!0}}}catch(t){f.e(t)}finally{f.f()}}var g=this.circleCells[n];if(null!==g){var v,m=this.circles,_=_createForOfIteratorHelper(g);try{for(_.s();!(v=_.n()).done;){var b=v.value;if(!c.circle[b]){c.circle[b]=!0;var w=3*b;if(this._circlesCollide(m[w],m[1+w],m[2+w],l.x,l.y,l.radius)&&(!s||s(this.circleKeys[b])))return o.push(!0),!0}}}catch(t){_.e(t)}finally{_.f()}}}},{key:"_forEachCell",value:function(t,e,r,i,n,o,a,s){for(var l=this._convertToXCellCoord(t),c=this._convertToYCellCoord(e),u=this._convertToXCellCoord(r),h=this._convertToYCellCoord(i),p=l;p<=u;p++)for(var f=c;f<=h;f++){var d=this.xCellCount*f+p;if(n.call(this,t,e,r,i,d,o,a,s))return}}},{key:"_convertToXCellCoord",value:function(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}},{key:"_convertToYCellCoord",value:function(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}},{key:"_circlesCollide",value:function(t,e,r,i,n,o){var a=i-t,s=n-e,l=r+o;return a*a+s*s<l*l}},{key:"_circleAndRectCollide",value:function(t,e,r,i,n,o,a){var s=(o-i)/2,l=Math.abs(t-(i+s));if(s+r<l)return!1;var c=(a-n)/2,u=Math.abs(e-(n+c));if(c+r<u)return!1;if(l<=s||u<=c)return!0;var h=l-s,p=u-c;return h*h+p*p<=r*r}}]),t}(),CollisionUtils={toDiscardLabel:function(t,e,r,i){var n;if(i&&(n=function(t){return t!==i.id}),!e){if("point"===t.type&&!t.angle){var o=t.getAABB(),a=o.left,s=o.top,l=o.right,c=o.bottom;if(r.hitTest(a,-s,l,-c,n)){if(Array.isArray(t.layout.anchor))for(var u=1;u<t.layout.anchor.length;u++){t.setAnchor(t.layout.anchor[u]);var h=t.getAABB(),p=h.left,f=h.top,d=h.right,y=h.bottom;if(!r.hitTest(p,-f,d,-y,n))return!1}return!0}return!1}var g=t.getBoundingCircles();return r.hitTestCircleList(g,n)}if(e){if("point"===t.type&&!t.isFlat()){var v=t.getScreenSpaceBoundingBox(),m=v.left,_=v.top,b=v.right,w=v.bottom;return r.hitTest(m,_,b,w,n)}var x=t.getBoundingCircles();return r.hitTestCircleList(x,n)}return!1},addLabel:function(t,e,r){var i,n,o,a,s,l,c,u,h,p,f,d,y=t.id;t.placed=!0,e||("point"!==t.type||t.angle?(i=t.getBoundingCircles(),r.insertCircleList(y,i)):(o=(n=t.getAABB()).left,a=n.top,s=n.right,l=n.bottom,r.insert(y,o,-a,s,-l))),e&&("point"!==t.type||t.isFlat()?(c=t.getBoundingCircles(),r.insertCircleList(y,c)):(h=(u=t.getScreenSpaceBoundingBox()).left,p=u.top,f=u.right,d=u.bottom,r.insert(y,h,p,f,d)))}},Collision={tiles:{},startTile:function(t,e){var r=1<arguments.length&&void 0!==e?e:{},i=r.apply_repeat_groups,n=void 0===i||i,o=r.return_hidden,a=void 0!==o&&o,s=r.grid_index,l=void 0===s?null:s,c=this.tiles[t]={grid_index:l||new GridIndex(Geo$1.tile_scale,Geo$1.tile_scale,240),objects:{},labels:{},styles:{},repeat:n,return_hidden:a};null==c.complete&&(c.complete=new Promise((function(t,e){c.resolve=t,c.reject=e})))},resetTile:function(t){delete this.tiles[t]},abortTile:function(t){this.tiles[t]&&this.tiles[t].resolve&&this.tiles[t].resolve([]),this.resetTile(t)},addStyle:function(t,e){this.tiles[e].styles[t]=!0},collide:function(t,e,r){var i=this.tiles[r];if(!i)return Promise.resolve([]);for(var n=i.objects,o=0;o<t.length;o++){var a=t[o],s=a.label.layout.priority;n[s]=n[s]||{},n[s][e]=n[s][e]||[],n[s][e].push(a)}return delete i.styles[e],0===Object.keys(i.styles).length&&this.endTile(r),i.complete.then((function(){return i.resolve=null,i.labels[e]||[]}))},endTile:function(t){var e=this.tiles[t],r=e.labels;e.repeat&&RepeatGroup.clear(t);for(var i=Object.keys(e.objects).sort((function(t,e){return t-e})),n=0;n<i.length;n++){var o=e.objects[i[n]];if(o)for(var a in o){var s=o[a];r[a]=r[a]||[];for(var l=0;l<s.length;l++){var c=s[l];this.canBePlaced(c,t,c.linked,e)?c.linked?this.canBePlaced(c.linked,t,c,e)?(c.show=!0,(c.label.breach||c.linked.label.breach)&&(c.label.breach=!0,c.linked.label.breach=!0),r[a].push(c),this.place(c,t,e),this.place(c.linked,t,e)):e.return_hidden&&(c.show=!1,r[a].push(c)):(c.show=!0,r[a].push(c),this.place(c,t,e)):e.return_hidden&&(c.show=!1,r[a].push(c))}}}delete this.tiles[t],e.resolve()},canBePlaced:function(t,e,r,i){var n=2<arguments.length&&void 0!==r?r:null,o=(3<arguments.length&&void 0!==i?i:{}).repeat,a=void 0===o||o,s=t.label,l=t.label.layout;if(null!==s.placed)return s.placed;var c=this.tiles[e].grid_index;if(l.collide&&CollisionUtils.toDiscardLabel(s,"main"===e,c,n&&n.label))l.collide&&(s.placed=!1);else{if(!a||!RepeatGroup.check(s,l,e))return!0;s.placed=!1}return s.placed},place:function(t,e,r){var i=t.label,n=r.repeat,o=void 0===n||n;null===i.placed&&(o&&RepeatGroup.add(i,i.layout,e),CollisionUtils.addLabel(i,"main"===e,this.tiles[e].grid_index))}},Task={id:0,queue:[],max_time:20,start_time:null,state:{},ignore_user_moving_view:!1,_ignoreViewMoveWithDebounce:debounce((function(){Task.ignore_user_moving_view=!0}),0,500),add:function(t){t.id=Task.id++,t.max_time=t.max_time||Task.max_time,t.pause_factor=t.pause_factor||1;var e=new Promise((function(e,r){t.resolve=e,t.reject=r}));return t.promise=e,t.total_elapsed=0,t.stats={calls:0},this.queue.push(t),this.start_time=this.start_time||performance.now(),this.elapsed=performance.now()-this.start_time,this.elapsed<Task.max_time&&this.process(t),t.promise},remove:function(t){var e=this.queue.indexOf(t);-1<e&&this.queue.splice(e,1)},process:function(t){if(!this.state.user_moving_view||!1!==t.user_moving_view||this.ignore_user_moving_view)return t.pause?(t.pause--,!0):(t.stats.calls++,t.start_time=performance.now(),t.run(t));Task._ignoreViewMoveWithDebounce()},processAll:function(){this.start_time=this.start_time||performance.now(),this.ignore_user_moving_view&&!this.hasPendingTasks()&&(this.ignore_user_moving_view=!1);for(var t=0;t<this.queue.length;t++){var e=this.queue[t];if(!0!==this.process(e)&&(e.pause||(e.pause=e.elapsed>e.max_time?e.pause_factor:0),e.total_elapsed+=e.elapsed),this.elapsed=performance.now()-this.start_time,this.elapsed>=Task.max_time){this.start_time=null;break}}},finish:function(t,e){return t.elapsed=performance.now()-t.start_time,t.total_elapsed+=t.elapsed,this.remove(t),t.resolve(e),t.promise},cancel:function(t){var e;t.cancel instanceof Function&&(e=t.cancel(t)),t.resolve(e||{})},shouldContinue:function(t){return t.elapsed=performance.now()-t.start_time,this.elapsed=performance.now()-this.start_time,t.elapsed<t.max_time&&this.elapsed<Task.max_time},removeForTile:function(t){for(var e=this.queue.length-1;0<=e;e--)this.queue[e].tile_id===t&&(this.cancel(this.queue[e]),this.queue.splice(e,1))},setState:function(t){this.state=t},hasPendingTasks:function(){return!!this.queue.length}};function sliceOptions(t){return{coords:t.coords,uid:t.uid,filtering:t.filtering,sprites:t.sprites,url:t.url,element:t.element,data:t.data,width:t.width,height:t.height,density:t.density,repeat:t.repeat,TEXTURE_WRAP_S:t.TEXTURE_WRAP_S,TEXTURE_WRAP_T:t.TEXTURE_WRAP_T,UNPACK_FLIP_Y_WEBGL:t.UNPACK_FLIP_Y_WEBGL,UNPACK_PREMULTIPLY_ALPHA_WEBGL:t.UNPACK_PREMULTIPLY_ALPHA_WEBGL}}var Texture=function(){function t(e,r,i){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{};_classCallCheck(this,t),n=sliceOptions(n),this.gl=e,this.texture=e.createTexture(),this.texture&&(this.valid=!0),this.manager=i,this.bind(),this.name=r,this.retain_count=0,this.config_type=null,this.loading=null,this.loaded=!1,this.filtering=n.filtering,this.density=n.density||1,this.sprites=n.sprites,this.texcoords={},this.sizes={},this.css_sizes={},this.aspects={},this._byte_length=0,this.setData(1,1,new Uint8Array([0,0,0,0]),{filtering:"nearest"}),this.loaded=!1,this.manager.textures[this.name]&&(this.retain_count=this.manager.textures[this.name].retain_count,this.manager.textures[this.name].retain_count=0,this.manager.textures[this.name].destroy()),(this.manager.textures[this.name]=this).manager.texture_configs[this.name]=JSON.stringify(Object.assign({name:r},n)),this.load(n),log("trace","creating Texture ".concat(this.name))}return _createClass(t,[{key:"destroy",value:function(t){var e=(0<arguments.length&&void 0!==t?t:{}).force;0<this.retain_count&&!e?log("error","Texture '".concat(this.name,"': destroying texture with retain count of '").concat(this.retain_count,"'")):this.valid&&(this.gl.deleteTexture(this.texture),this.texture=null,delete this.data,this.data=null,delete this.manager.textures[this.name],delete this.manager.texture_configs[this.name],this.valid=!1,this._byte_length=0,log("trace","destroying Texture ".concat(this.name)))}},{key:"retain",value:function(){this.retain_count++}},{key:"release",value:function(){this.retain_count<=0&&log("error","Texture '".concat(this.name,"': releasing texture with retain count of '").concat(this.retain_count,"'")),this.retain_count--,this.retain_count<=0&&this.destroy()}},{key:"bind",value:function(t){var e=0<arguments.length&&void 0!==t?t:0;this.valid&&(this.manager.activeUnit!==e&&(this.gl.activeTexture(this.gl.TEXTURE0+e),this.manager.activeUnit=e,this.manager.boundTexture=null),this.manager.boundTexture!==this.texture&&(this.gl.bindTexture(this.gl.TEXTURE_2D,this.texture),this.manager.boundTexture=this.texture))}},{key:"load",value:function(t){var e=this;return t?(this.loading=null,"string"==typeof t.url?(this.config_type="url",this.setUrl(t.url,t)):t.element?(this.config_type="element",this.setElement(t.element,t)):t.data&&t.width&&t.height&&(this.config_type="data",this.setData(t.width,t.height,t.data,t)),this.loading=this.loading&&this.loading.then((function(){return e.calculateSprites(),e}))||Promise.resolve(this),this.loading):this.loading||Promise.resolve(this)}},{key:"setUrl",value:function(t,e){var r=this,i=1<arguments.length&&void 0!==e?e:{};if(this.valid)return this.url=t,this.loading=new Promise((function(t,e){var n=new Image;n.onload=function(){try{r.setElement(n,i)}catch(t){r.loaded=!1,log("warn","Texture '".concat(r.name,"': failed to load url: '").concat(r.url,"'"),t,i),r.manager.trigger("warning",{message:"Failed to load texture from ".concat(r.url),error:t,texture:i})}r.loaded=!0,t(r)},n.onerror=function(e){r.loaded=!1,log("warn","Texture '".concat(r.name,"': failed to load url: '").concat(r.url,"'"),e,i),r.manager.trigger("warning",{message:"Failed to load texture from ".concat(r.url),error:e,texture:i}),t(r)},Utils$1.isSafari()&&"data:"===r.url.slice(0,5)||(n.crossOrigin="anonymous"),n.src=r.url})),this.loading}},{key:"setData",value:function(t,e,r,i){var n=3<arguments.length&&void 0!==i?i:{};return this.width=t,this.height=e,Array.isArray(r)&&(r=new Uint8Array(r)),this.update(r,n),this.setFiltering(n),this.loaded=!0,this.loading=Promise.resolve(this),this.loading}},{key:"setElement",value:function(t,e){var r,i=t;return"string"==typeof t&&(t=document.querySelector(t)),t instanceof HTMLCanvasElement||t instanceof HTMLImageElement||t instanceof HTMLVideoElement?(this.update(t,e),this.setFiltering(e)):(this.loaded=!1,r="the 'element' parameter (`element: ".concat(JSON.stringify(i),"`) must be a CSS "),r+="selector string, or a <canvas>, <image> or <video> object",log("warn","Texture '".concat(this.name,"': ").concat(r),e),this.manager.trigger("warning",{message:"Failed to load texture because ".concat(r),texture:e})),this.loaded=!0,this.loading=Promise.resolve(this),this.loading}},{key:"update",value:function(t,e){var r=1<arguments.length&&void 0!==e?e:{};this.valid&&(this.bind(),t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof HTMLImageElement&&t.complete?(this.width=t.width,this.height=t.height,this._byte_length=this.width*this.height*4,this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1!==r.UNPACK_FLIP_Y_WEBGL),this.gl.pixelStorei(this.gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.UNPACK_PREMULTIPLY_ALPHA_WEBGL||!1),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,t)):(this._byte_length=t?t.byteLength:0,this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.gl.pixelStorei(this.gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.width,this.height,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,t)),this.manager.trigger("update",this))}},{key:"getByteLength",value:function(){return this._byte_length}},{key:"setFiltering",value:function(t){var e,r=0<arguments.length&&void 0!==t?t:{};this.valid&&(r.filtering=r.filtering||"linear",e=this.gl,this.bind(),Utils$1.isPowerOf2(this.width)&&Utils$1.isPowerOf2(this.height)?(this.power_of_2=!0,e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,r.TEXTURE_WRAP_S||r.repeat&&e.REPEAT||e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,r.TEXTURE_WRAP_T||r.repeat&&e.REPEAT||e.CLAMP_TO_EDGE),"mipmap"===r.filtering?(this.filtering="mipmap",e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.generateMipmap(e.TEXTURE_2D)):"linear"===r.filtering?(this.filtering="linear",e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR)):"nearest"===r.filtering&&(this.filtering="nearest",e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST))):(this.power_of_2=!1,e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),"nearest"===r.filtering?(this.filtering="nearest",e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST)):(this.filtering="linear",e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR))),this.manager.trigger("update",this))}},{key:"calculateSprites",value:function(){if(this.sprites)for(var t in this.sprites){var e=this.sprites[t];this.texcoords[t]=this.manager.getTexcoordsForSprite([e[0],e[1]],[e[2],e[3]],[this.width,this.height]),this.sizes[t]=[e[2],e[3]],this.css_sizes[t]=[e[2]/this.density,e[3]/this.density],this.aspects[t]=e[2]/e[3]}}}]),t}();function subscribeMixin(t){var e=[];return Object.assign(t,{subscribe:function(t){-1===e.indexOf(t)&&e.push(t)},unsubscribe:function(t){var r=e.indexOf(t);-1<r&&e.splice(r,1)},unsubscribeAll:function(){e=[]},trigger:function(t){for(var r=arguments.length,i=new Array(1<r?r-1:0),n=1;n<r;n++)i[n-1]=arguments[n];e.forEach((function(e){if("function"==typeof e[t])try{e[t].apply(e,i)}catch(e){log("warn","Caught exception in listener for event '".concat(t,"':"),e)}}))},hasSubscribersFor:function(t){var r=!1;return e.forEach((function(e){"function"==typeof e[t]&&(r=!0)})),r}})}var TextureManager=function(){function t(e){_classCallCheck(this,t),this.default=t.DEFAULT_TEXTURE_NAME,this.textures={},this.texture_configs={},this.boundTexture=null,this.activeUnit=null,this.scene_id=e,WorkerBroker.addTarget("Texture"+this.scene_id,this),subscribeMixin(this)}return _createClass(t,[{key:"create",value:function(e,r,i){for(var n=t.matchers_,o=0;o<n.length;o++){var a=n[o][0],s=n[o][1];if(s&&s(i))return new a(e,r,this,i)}return new Texture(e,r,this,i)}},{key:"retain",value:function(t){this.textures[t]&&this.textures[t].retain()}},{key:"release",value:function(t){this.textures[t]&&this.textures[t].release()}},{key:"getRetainCount",value:function(t){if(this.textures[t])return this.textures[t].retain_count}},{key:"getByteLength",value:function(t){if(this.textures[t])return this.textures[t].getByteLength()}},{key:"destroy",value:function(t){var e=this;Object.keys(this.textures).forEach((function(r){var i=e.textures[r];r!==e.default&&i.gl===t&&i.destroy({force:!0})}))}},{key:"getSpriteInfo",value:function(t,e){var r=this.textures[t];return r&&{size:r.sizes[e],css_size:r.css_sizes[e],aspect:r.aspects[e],texcoords:r.texcoords[e]}}},{key:"getTexcoordsForSprite",value:function(t,e,r){var i=r[1]-t[1]-e[1];return[t[0]/r[0],i/r[1],(e[0]+t[0])/r[0],(e[1]+i)/r[1]]}},{key:"createFromObject",value:function(t,e){var r=[];if(e)for(var i in e){var n,o=e[i];this.changed(i,o)&&(n=this.create(t,i,o),r.push(n.loading))}return Promise.all(r)}},{key:"createDefault",value:function(t){return this.create(t,this.default)}},{key:"changed",value:function(t,e){var r=this.textures[t];if(r){if("element"===r.config_type||null!=e.element)return!0;if(e=sliceOptions(e),this.texture_configs[t]===JSON.stringify(Object.assign({name:t},e)))return!1}return!0}},{key:"getInfo",value:function(t){var e=this;if(t=t||Object.keys(this.textures),Array.isArray(t))return Promise.all(t.map((function(t){return e.getInfo(t)})));var r=this.textures[t];return r?(r.loading||Promise.resolve(r)).then((function(){return{name:r.name,width:r.width,height:r.height,density:r.density,sprites:r.sprites,texcoords:r.texcoords,sizes:r.sizes,css_sizes:r.css_sizes,aspects:r.aspects,filtering:r.filtering,power_of_2:r.power_of_2,valid:r.valid}})):Promise.resolve(null)}},{key:"syncTexturesToWorker",value:function(t){var e=this;return Thread.is_main?Promise.all(t.map((function(t){var r=e.textures[t];return r&&r.loading||Promise.resolve()}))).then((function(){return e.textures})):WorkerBroker.postMessage("Texture"+this.scene_id+".getInfo",t).then((function(t){return t.forEach((function(t){e.textures[t.name]=t})),e.textures}))}},{key:"getMaxTextureSize",value:function(t){return t.getParameter(t.MAX_TEXTURE_SIZE)}}],[{key:"register",value:function(e,r){var i=t.matchers_;if(!(e instanceof Function&&r instanceof Function))throw"Invalid texture constructor or matcher";this.deRegister(e),i.push([e,r])}},{key:"deRegister",value:function(e){for(var r=t.matchers_,i=0;i<r.length;i++)r[i][0]===e&&r.splice(i,1)}}]),t}();TextureManager.DEFAULT_TEXTURE_NAME="__default",TextureManager.matchers_=[];var Registry={};function getTextureManager(t){return Registry[t]||(Registry[t]=new TextureManager(t)),Registry[t]}var transformMat4_1=transformMat4;function transformMat4(t,e,r){var i=e[0],n=e[1],o=e[2],a=(a=r[3]*i+r[7]*n+r[11]*o+r[15])||1;return t[0]=(r[0]*i+r[4]*n+r[8]*o+r[12])/a,t[1]=(r[1]*i+r[5]*n+r[9]*o+r[13])/a,t[2]=(r[2]*i+r[6]*n+r[10]*o+r[14])/a,t}var normalFromMat4_1=normalFromMat4;function normalFromMat4(t,e){var r=e[0],i=e[1],n=e[2],o=e[3],a=e[4],s=e[5],l=e[6],c=e[7],u=e[8],h=e[9],p=e[10],f=e[11],d=e[12],y=e[13],g=e[14],v=e[15],m=r*s-i*a,_=r*l-n*a,b=r*c-o*a,w=i*l-n*s,x=i*c-o*s,E=n*c-o*l,T=u*y-h*d,A=u*g-p*d,S=u*v-f*d,k=h*g-p*y,O=h*v-f*y,L=p*v-f*g,P=m*L-_*O+b*k+w*S-x*A+E*T;return P?(P=1/P,t[0]=(s*L-l*O+c*k)*P,t[1]=(l*S-a*L-c*A)*P,t[2]=(a*O-s*S+c*T)*P,t[3]=(n*O-i*L-o*k)*P,t[4]=(r*L-n*S+o*A)*P,t[5]=(i*S-r*O-o*T)*P,t[6]=(y*E-g*x+v*w)*P,t[7]=(g*b-d*E-v*_)*P,t[8]=(d*x-y*b+v*m)*P,t):null}var invert_1=invert;function invert(t,e){var r=e[0],i=e[1],n=e[2],o=e[3],a=e[4],s=e[5],l=e[6],c=e[7],u=e[8],h=u*a-s*c,p=-u*o+s*l,f=c*o-a*l,d=r*h+i*p+n*f;return d?(d=1/d,t[0]=h*d,t[1]=(-u*i+n*c)*d,t[2]=(s*i-n*a)*d,t[3]=p*d,t[4]=(u*r-n*l)*d,t[5]=(-s*r+n*o)*d,t[6]=f*d,t[7]=(-c*r+i*l)*d,t[8]=(a*r-i*o)*d,t):null}var identity_1=identity;function identity(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}var multiply_1=multiply;function multiply(t,e,r){var i=e[0],n=e[1],o=e[2],a=e[3],s=e[4],l=e[5],c=e[6],u=e[7],h=e[8],p=e[9],f=e[10],d=e[11],y=e[12],g=e[13],v=e[14],m=e[15],_=r[0],b=r[1],w=r[2],x=r[3];return t[0]=_*i+b*s+w*h+x*y,t[1]=_*n+b*l+w*p+x*g,t[2]=_*o+b*c+w*f+x*v,t[3]=_*a+b*u+w*d+x*m,_=r[4],b=r[5],w=r[6],x=r[7],t[4]=_*i+b*s+w*h+x*y,t[5]=_*n+b*l+w*p+x*g,t[6]=_*o+b*c+w*f+x*v,t[7]=_*a+b*u+w*d+x*m,_=r[8],b=r[9],w=r[10],x=r[11],t[8]=_*i+b*s+w*h+x*y,t[9]=_*n+b*l+w*p+x*g,t[10]=_*o+b*c+w*f+x*v,t[11]=_*a+b*u+w*d+x*m,_=r[12],b=r[13],w=r[14],x=r[15],t[12]=_*i+b*s+w*h+x*y,t[13]=_*n+b*l+w*p+x*g,t[14]=_*o+b*c+w*f+x*v,t[15]=_*a+b*u+w*d+x*m,t}var translate_1=translate;function translate(t,e,r){var i,n,o,a,s,l,c,u,h,p,f,d,y=r[0],g=r[1],v=r[2];return e===t?(t[12]=e[0]*y+e[4]*g+e[8]*v+e[12],t[13]=e[1]*y+e[5]*g+e[9]*v+e[13],t[14]=e[2]*y+e[6]*g+e[10]*v+e[14],t[15]=e[3]*y+e[7]*g+e[11]*v+e[15]):(i=e[0],n=e[1],o=e[2],a=e[3],s=e[4],l=e[5],c=e[6],u=e[7],h=e[8],p=e[9],f=e[10],d=e[11],t[0]=i,t[1]=n,t[2]=o,t[3]=a,t[4]=s,t[5]=l,t[6]=c,t[7]=u,t[8]=h,t[9]=p,t[10]=f,t[11]=d,t[12]=i*y+s*g+h*v+e[12],t[13]=n*y+l*g+p*v+e[13],t[14]=o*y+c*g+f*v+e[14],t[15]=a*y+u*g+d*v+e[15]),t}var scale_1=scale;function scale(t,e,r){var i=r[0],n=r[1],o=r[2];return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}var perspective_1=perspective;function perspective(t,e,r,i,n){var o=1/Math.tan(e/2),a=1/(i-n);return t[0]=o/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(n+i)*a,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*n*i*a,t[15]=0,t}var identity_1$1=identity$1;function identity$1(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}var lookAt_1=lookAt;function lookAt(t,e,r,i){var n,o,a,s,l,c,u,h,p,f,d=e[0],y=e[1],g=e[2],v=i[0],m=i[1],_=i[2],b=r[0],w=r[1],x=r[2];return Math.abs(d-b)<1e-6&&Math.abs(y-w)<1e-6&&Math.abs(g-x)<1e-6?identity_1$1(t):(u=d-b,h=y-w,p=g-x,n=m*(p*=f=1/Math.sqrt(u*u+h*h+p*p))-_*(h*=f),o=_*(u*=f)-v*p,a=v*h-m*u,(f=Math.sqrt(n*n+o*o+a*a))?(n*=f=1/f,o*=f,a*=f):a=o=n=0,s=h*a-p*o,l=p*n-u*a,c=u*o-h*n,(f=Math.sqrt(s*s+l*l+c*c))?(s*=f=1/f,l*=f,c*=f):c=l=s=0,t[0]=n,t[1]=s,t[2]=u,t[3]=0,t[4]=o,t[5]=l,t[6]=h,t[7]=0,t[8]=a,t[9]=c,t[10]=p,t[11]=0,t[12]=-(n*d+o*y+a*g),t[13]=-(s*d+l*y+c*g),t[14]=-(u*d+h*y+p*g),t[15]=1,t)}var copy_1=copy;function copy(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}var invert_1$1=invert$1;function invert$1(t,e){var r=e[0],i=e[1],n=e[2],o=e[3],a=e[4],s=e[5],l=e[6],c=e[7],u=e[8],h=e[9],p=e[10],f=e[11],d=e[12],y=e[13],g=e[14],v=e[15],m=r*s-i*a,_=r*l-n*a,b=r*c-o*a,w=i*l-n*s,x=i*c-o*s,E=n*c-o*l,T=u*y-h*d,A=u*g-p*d,S=u*v-f*d,k=h*g-p*y,O=h*v-f*y,L=p*v-f*g,P=m*L-_*O+b*k+w*S-x*A+E*T;return P?(P=1/P,t[0]=(s*L-l*O+c*k)*P,t[1]=(n*O-i*L-o*k)*P,t[2]=(y*E-g*x+v*w)*P,t[3]=(p*x-h*E-f*w)*P,t[4]=(l*S-a*L-c*A)*P,t[5]=(r*L-n*S+o*A)*P,t[6]=(g*b-d*E-v*_)*P,t[7]=(u*E-p*b+f*_)*P,t[8]=(a*O-s*S+c*T)*P,t[9]=(i*S-r*O-o*T)*P,t[10]=(d*x-y*b+v*m)*P,t[11]=(h*b-u*x-f*m)*P,t[12]=(s*A-a*k-l*T)*P,t[13]=(r*k-i*A+n*T)*P,t[14]=(y*_-d*w-g*m)*P,t[15]=(u*w-h*_+p*m)*P,t):null}var transformMat4_1$1=transformMat4$1;function transformMat4$1(t,e,r){var i=e[0],n=e[1],o=e[2],a=e[3];return t[0]=r[0]*i+r[4]*n+r[8]*o+r[12]*a,t[1]=r[1]*i+r[5]*n+r[9]*o+r[13]*a,t[2]=r[2]*i+r[6]*n+r[10]*o+r[14]*a,t[3]=r[3]*i+r[7]*n+r[11]*o+r[15]*a,t}var normalize_1=normalize$1;function normalize$1(t,e){var r=e[0],i=e[1],n=e[2],o=e[3],a=r*r+i*i+n*n+o*o;return 0<a&&(a=1/Math.sqrt(a),t[0]=r*a,t[1]=i*a,t[2]=n*a,t[3]=o*a),t}var scale_1$1=scale$1;function scale$1(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t}var vec3={fromValues:function(t,e,r){var i=new Float64Array(3);return i[0]=t,i[1]=e,i[2]=r,i},transformMat4:transformMat4_1},mat3={normalFromMat4:normalFromMat4_1,invert:invert_1,identity:identity_1},mat4={multiply:multiply_1,translate:translate_1,scale:scale_1,perspective:perspective_1,lookAt:lookAt_1,identity:identity_1$1,copy:copy_1,invert:invert_1$1},vec4={transformMat4:transformMat4_1$1,normalize:normalize_1,scale:scale_1$1},FeatureSelection=function(){function t(e,r){_classCallCheck(this,t),this._gl=e,this._requests={},this._pixels=null,this._has_dirty_buffer=!1,this._fbo=this._gl.createFramebuffer(),this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,this._fbo),this._fbo_size={width:256,height:256};var i=getTextureManager(r).create(this._gl,"selection_fbo",{filtering:"nearest"});i.setData(this._fbo_size.width,this._fbo_size.height,null,{filtering:"nearest"}),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.COLOR_ATTACHMENT0,this._gl.TEXTURE_2D,i.texture,0);var n=this._gl.createRenderbuffer();this._gl.bindRenderbuffer(this._gl.RENDERBUFFER,n),this._gl.renderbufferStorage(this._gl.RENDERBUFFER,this._gl.DEPTH_COMPONENT16,this._fbo_size.width,this._fbo_size.height),this._gl.framebufferRenderbuffer(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.RENDERBUFFER,n),this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,null)}return _createClass(t,[{key:"destroy",value:function(){this._gl&&this._fbo&&(this._gl.deleteFramebuffer(this._fbo),this._fbo=null,this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,null))}},{key:"bind",value:function(){var e;this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,this._fbo),this._gl.viewport(0,0,this._fbo_size.width,this._fbo_size.height),(e=this._gl).clearColor.apply(e,_toConsumableArray(t.defaultColor))}},{key:"getFeatureAt",value:function(e,r,i){var n=r.radius,o=r.top_most_only,a=void 0===o||o;!e||e.x<0||e.y<0||1<e.x||1<e.y?i({features:null}):(this.selection_request_id=this.selection_request_id+1||0,this._requests[this.selection_request_id]={id:this.selection_request_id,point:e,radius:n,top_most_only:a,ttl:a?1:t.MAX_PICKING_TRIES,callback:i})}},{key:"hasPendingRequests",value:function(){return 0<Object.keys(this._requests).length}},{key:"clearPendingRequests",value:function(){for(var t in this._requests)this._requests[t].callback(new Error("cleared")),delete this._requests[t];this._pending_deep_request=null}},{key:"read",value:function(t){if(this.hasPendingRequests()){var e=this._gl;for(var r in e.bindFramebuffer(e.FRAMEBUFFER,this._fbo),this._pending_deep_request&&this.processRequest(this._pending_deep_request,t),this._requests)if(this.processRequest(this._requests[r],t))break;e.bindFramebuffer(e.FRAMEBUFFER,null)}}},{key:"processRequest",value:function(e,r){var i,n,o,a=this._gl,s=255,l=e.point,c=e.radius,u=(o=c?(n=Math.min(this._fbo_size.width,this._fbo_size.height),{x:Math.min(Math.ceil(2*c.x*this._fbo_size.width),n),y:Math.min(Math.ceil(2*c.y*this._fbo_size.height),n)}):(c={x:0,y:0},{x:1,y:1})).x*o.y*4;if(null==this._pixels||this._pixels.byteLength<u)this._pixels=new Uint8Array(u);else if(this._pixels.fill instanceof Function)this._pixels.fill(0,0,u);else for(var h=0;h<u;h++)this._pixels[h]=0;a.readPixels(Math.round((l.x-c.x)*this._fbo_size.width),Math.round((1-l.y-c.y)*this._fbo_size.height),o.x,o.y,a.RGBA,a.UNSIGNED_BYTE,this._pixels),e.ttl--;var p=Math.floor(o.x/2),f=Math.floor(o.y/2),d=4*(f*o.x+p),y=this._pixels.slice(d,d+4),g=y[0]+(y[1]<<8)+(y[2]<<16);if(0<g)i=g+(y[3]<<24)>>>0,s=y[3];else if(4<u)for(var v=1/0,m=(d=0,0);m<o.y;m++)for(var _,b=0;b<o.x;b++,d+=4)0<(g=(y=this._pixels.slice(d,d+4))[0]+(y[1]<<8)+(y[2]<<16))&&(_=Math.pow(b-p,2)+Math.pow(m-f,2))<v&&(i=g+(y[3]<<24)>>>0,s=y[3],v=_);if(255!==s){var w=this._getFeatureByKey(i,r);if(e.features||(e.features=[]),!w)return void this._finishRead(e);if(e.features.every((function(t){return t.id!==w.id}))&&e.features.push(w),e.ttl)return this._pending_deep_request=e,t._discardColor(y),this._has_dirty_buffer=!0;this._finishRead(e)}else this._finishRead(e)}},{key:"_finishRead",value:function(e){var r=e.features||t.EMPTY_ARRAY;e.top_most_only||(this._pending_deep_request=null,t._resetDiscardedColors()),delete this._requests[e.id],e.callback({features:r})}},{key:"_getFeatureByKey",value:function(t,e){for(var r=null,i=0;i<e.length;i++){var n=e[i];if(n.selection_data&&(r=n.selection_data[t])){r.tile={coords:n.coords};break}}return r}},{key:"setupDiscards",value:function(e){for(var r=t.MAX_PICKING_TRIES;r--;)e.uniform("4fv","u_selection_discard".concat(r),t._discarded_colors[r]||t.defaultColor)}},{key:"has_dirty_buffer",get:function(){return this._has_dirty_buffer},set:function(){this._has_dirty_buffer=!!this._pending_deep_request}}],[{key:"makeEntry",value:function(){this.map_entry++;var t=255&this.map_entry,e=this.map_entry>>8&255,r=this.map_entry>>16&255,i=this.map_prefix;return{key:t+(e<<8)+(r<<16)+(i<<24)>>>0,color:[t/255,e/255,r/255,i/255]}}},{key:"reset",value:function(){this.map_entry=0}},{key:"setPrefix",value:function(t){this.map_prefix=t}},{key:"_discardColor",value:function(t){this._discarded_colors.push([t[0]/255,t[1]/255,t[2]/255,t[3]/255])}},{key:"_resetDiscardedColors",value:function(){this._discarded_colors.length=0}}]),t}();FeatureSelection._discarded_colors=[],FeatureSelection.map_entry=0,FeatureSelection.map_prefix=0,FeatureSelection.defaultColor=[0,0,0,1],FeatureSelection.MAX_PICKING_TRIES=10,FeatureSelection.EMPTY_ARRAY=Object.freeze([]);var GLSL={parseUniforms:function(t){var e=[];for(var r in t){var i,n=r,o=t[r];if("number"==typeof o)e.push({type:"float",method:"1f",name:r,value:o,key:n,uniforms:t});else if(Array.isArray(o)){if("number"==typeof o[0])2<=o.length&&o.length<=4?e.push({type:"vec"+o.length,method:o.length+"fv",name:r,value:o,key:n,uniforms:t}):4<o.length&&e.push({type:"float[]",method:"1fv",name:r+"[0]",value:o,key:n,uniforms:t});else if("string"==typeof o[0])for(i=0;i<o.length;i++)e.push({type:"sampler2D",method:"1i",name:r+"["+i+"]",value:o[i],key:i,uniforms:o});else if(Array.isArray(o[0])&&"number"==typeof o[0][0]&&2<=o[0].length&&o[0].length<=4)for(i=0;i<o.length;i++)e.push({type:"vec"+o[0].length,method:o[i].length+"fv",name:r+"["+i+"]",value:o[i],key:i,uniforms:o})}else"boolean"==typeof o?e.push({type:"bool",method:"1i",name:r,value:o,key:n,uniforms:t}):"string"==typeof o&&e.push({type:"sampler2D",method:"1i",name:r,value:o,key:n,uniforms:t})}return e},defineVariable:function(t,e){var r,i;if("number"==typeof e)r="float";else if(Array.isArray(e))"number"==typeof e[0]?2<=e.length&&e.length<=4?r="vec"+e.length:(r="float",i=e.length):"string"==typeof e[0]&&(r="sampler2D",i=e.length);else if("boolean"==typeof e)r="bool";else{if("string"!=typeof e)return;r="sampler2D"}var n="";return n+="".concat(r," ").concat(t),i&&(n+="[".concat(i,"]")),n+";\n"},defineUniform:function(t,e){var r=GLSL.defineVariable(t,e);if(r)return"uniform "+r},isUniformDefined:function(t,e){var r=new RegExp("uniform[^;]+(?:{[\\s\\S]*})?[^;]*\\b"+t+"\\b","g");return!!e.match(r)},isSymbolReferenced:function(t,e){var r=new RegExp("\\b"+t+"\\b","g");return 0<=e.search(r)},expandVec3:function(t){var e,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;if(Array.isArray(t)){if(2!==t.length)return t;e=[].concat(_toConsumableArray(t),[r]).map(parseFloat)}else e=[t,t,t].map(parseFloat);if(e&&e.every((function(t){return"number"==typeof t&&!isNaN(t)})))return e},expandVec4:function(t){var e,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;if(Array.isArray(t)){if(3!==t.length)return t;e=[].concat(_toConsumableArray(t),[r]).map(parseFloat)}else e=[t,t,t,r].map(parseFloat);if(e&&e.every((function(t){return"number"==typeof t&&!isNaN(t)})))return e}},extensions=[];function getExtension(t,e){var r=extensions.filter((function(e){return e[0]===t}))[0];return(r=r&&r[1])||(extensions.push([t,{}]),r=extensions[extensions.length-1][1]),r[e]||(r[e]=t.getExtension(e)),r[e]}function hashString(t){var e,r,i=0;if(0===t.length)return i;for(e=0,r=t.length;e<r;e++)i=(i<<5)-i+t.charCodeAt(e),i|=0;return i}var stripComments=createCommonjsModule((function(t){var e="(.|[\\r\\n]|\\n)*?\\*\\/\\n?\\n?",r=/(^|[^\S\n])(?:\/\/)([\s\S]+?)$/gm,i=/(^|[^\S\n])(?:\/\/[^!])([\s\S]+?)$/gm,n=t.exports=function(t,e){return t?n.block(n.line(t,e),e):""};n.block=function(t,r){r=r||{};var i=new RegExp("\\/\\*"+e,"gm");return r.safe&&(i=new RegExp("\\/\\*(?!\\*?\\!)"+e,"gm")),t?t.replace(i,""):""},n.line=function(t,e){var n=r;return(e=e||{}).safe&&(n=i),t?t.replace(n,""):""}})),glShaderErrors=parseErrors;function parseErrors(t){t=String(t);for(var e,r=[];e=t.match(/ERROR\:([^\n]+)/);){t=t.slice(e.index+1);var i=(a=e[1].trim()).split(":"),n=i.slice(2).join(":").trim(),o=parseInt(i[0],10),a=parseInt(i[1],10);r.push({message:n,file:o,line:a})}return r}var re_pragma=/^\s*#pragma.*$/gm,re_continue_line=/\\\s*\n/gm,ShaderProgram=function(){function t(e,r,i,n,o){if(_classCallCheck(this,t),o=o||{},this.textureManager=getTextureManager(n),this.gl=e,this.program=null,this.compiled=!1,this.compiling=!1,this.error=null,!t.polyfills[n]){t.polyfills[n]={};try{this.gl.uniformMatrix3fv(null,!1,new Float64Array(9))}catch(e){t.polyfills[n].uniformMatrix3fv=this.gl.uniformMatrix3fv,this.gl.uniformMatrix3fv=function(e,r,i){t.polyfills[n].uniformMatrix3fv.call(this,e,r,new Float32Array(i))}}try{this.gl.uniformMatrix4fv(null,!1,new Float64Array(16))}catch(e){t.polyfills[n].uniformMatrix4fv=this.gl.uniformMatrix4fv,this.gl.uniformMatrix4fv=function(e,r,i){t.polyfills[n].uniformMatrix4fv.call(this,e,r,new Float32Array(i))}}}this.defines=Object.assign({},o.defines||{}),this.blocks=Object.assign({},o.blocks||{}),this.block_scopes=Object.assign({},o.block_scopes||{}),this.extensions=o.extensions||[],this.dependent_uniforms=o.uniforms,this.uniforms={},this.attribs={},this.vertex_source=r,this.fragment_source=i,this.id=t.id++,this.name=o.name}return _createClass(t,[{key:"destroy",value:function(){this.gl.useProgram(null),this.gl.deleteProgram(this.program),this.program=null,this.uniforms={},this.attribs={},this.compiled=!1}},{key:"use",value:function(){this.compiled&&(t.current!==this&&this.gl.useProgram(this.program),t.current=this)}},{key:"compile",value:function(){var e=this;if(this.compiling)throw new Error("ShaderProgram.compile(): skipping for ".concat(this.id," (").concat(this.name,") because already compiling"));this.compiling=!0,this.compiled=!1,this.error=null,this.computed_vertex_source=this.vertex_source,this.computed_fragment_source=this.fragment_source;var r,i=this.checkExtensions(),n=this.buildDefineList(),o=this.buildShaderBlockList();for(var a in o){var s,l,c,u=o[a];!u||Array.isArray(u)&&0===u.length||(r=new RegExp("^\\s*#pragma\\s+tangram:\\s+"+a+"\\s*$","m"),s=this.computed_vertex_source.match(r),l=this.computed_fragment_source.match(r),null==s&&null==l||(c="",u.forEach((function(t){var e="".concat(t.scope,", ").concat(t.key,", ").concat(t.num);c+="\n// tangram-block-start: ".concat(e,"\n"),c+=t.source,c+="\n// tangram-block-end: ".concat(e,"\n")})),null!=s&&(this.computed_vertex_source=this.computed_vertex_source.replace(r,c)),null!=l&&(this.computed_fragment_source=this.computed_fragment_source.replace(r,c)),n["TANGRAM_BLOCK_"+a.replace(/[\s-]+/g,"_").toUpperCase()]=!0))}this.computed_vertex_source=this.computed_vertex_source.replace(re_pragma,""),this.computed_fragment_source=this.computed_fragment_source.replace(re_pragma,""),this.ensureUniforms(this.dependent_uniforms);var h=this.gl.getShaderPrecisionFormat(this.gl.FRAGMENT_SHADER,this.gl.HIGH_FLOAT),p=h&&0<h.precision?"precision highp float;\n":"precision mediump float;\n";n.TANGRAM_VERTEX_SHADER=!0,n.TANGRAM_FRAGMENT_SHADER=!1,this.computed_vertex_source=p+t.buildDefineString(n)+this.computed_vertex_source,n.TANGRAM_VERTEX_SHADER=!1,n.TANGRAM_FRAGMENT_SHADER=!0,this.computed_fragment_source=t.buildExtensionString(i)+p+t.buildDefineString(n)+this.computed_fragment_source,this.computed_vertex_source=this.computed_vertex_source.replace(re_continue_line,""),this.computed_fragment_source=this.computed_fragment_source.replace(re_continue_line,"");try{this.program=t.updateProgram(this.gl,this.program,this.computed_vertex_source,this.computed_fragment_source),this.compiled=!0,this.compiling=!1}catch(i){throw this.program=null,this.compiled=!1,this.compiling=!1,"vertex"!==(this.error=i).type&&"fragment"!==i.type||(this.shader_errors=i.errors,this.shader_errors.forEach((function(t){t.type=i.type,t.block=e.block(i.type,t.line)}))),i}this.computed_vertex_source=null,this.computed_fragment_source=null,this.use(),this.refreshUniforms(),this.refreshAttributes()}},{key:"buildDefineList",value:function(){var e,r={};for(e in t.defines)r[e]=t.defines[e];for(e in this.defines)r[e]=this.defines[e];return r}},{key:"buildShaderBlockList",value:function(){var e,r,i={};for(e in t.blocks)i[e]=[],Array.isArray(t.blocks[e])?(r=i[e]).push.apply(r,_toConsumableArray(t.blocks[e].map((function(t,r){return{key:e,source:t,num:r,scope:"ShaderProgram"}})))):i[e]=[{key:e,source:t.blocks[e],num:0,scope:"ShaderProgram"}];for(e in this.blocks)if(i[e]=i[e]||[],Array.isArray(this.blocks[e]))for(var n=this.block_scopes&&this.block_scopes[e]||[],o=null,a=0,s=0;s<this.blocks[e].length;s++)n[s]!==o&&(o=n[s],a=0),i[e].push({key:e,source:this.blocks[e][s],num:a,scope:o||this.name}),a++;else i[e].push({key:e,source:this.blocks[e],num:0,scope:this.name});return i}},{key:"ensureUniforms",value:function(t){if(t){var e,r=stripComments(this.computed_vertex_source),i=stripComments(this.computed_fragment_source),n=[],o=[];for(var a in t){var s=GLSL.isUniformDefined(a,r),l=GLSL.isUniformDefined(a,i);if(!s||!l){if(!(e=GLSL.defineUniform(a,t[a])))continue;s||(log("trace","Program ".concat(this.name,": ").concat(a," not defined in vertex shader, injecting: '").concat(e,"'")),n.push(e)),l||(log("trace","Program ".concat(this.name,": ").concat(a," not defined in fragment shader, injecting: '").concat(e,"'")),o.push(e))}}0<n.length&&(this.computed_vertex_source=n.join("\n")+this.computed_vertex_source),0<o.length&&(this.computed_fragment_source=o.join("\n")+this.computed_fragment_source)}}},{key:"setUniforms",value:function(t,e){var r=!(1<arguments.length&&void 0!==e)||e;if(this.compiled){r&&(this.texture_unit=0);for(var i=GLSL.parseUniforms(t),n=0;n<i.length;n++){var o=i[n];"sampler2D"===o.type?this.setTextureUniform(o.name,o.value):this.uniform(o.method,o.name,o.value)}}}},{key:"saveUniforms",value:function(t){var e=t||this.uniforms;for(var r in e){var i=this.uniforms[r];i&&(i.saved_value=i.value)}this.saved_texture_unit=this.texture_unit||0}},{key:"restoreUniforms",value:function(t){var e=t||this.uniforms;for(var r in e){var i=this.uniforms[r];i&&i.saved_value&&(i.value=i.saved_value,this.updateUniform(i))}this.texture_unit=this.saved_texture_unit||0}},{key:"setTextureUniform",value:function(t,e){var r=this.textureManager.textures[e];null!=r?(r.bind(this.texture_unit),this.uniform("1i",t,this.texture_unit),this.texture_unit++):log("warn","Cannot find texture '".concat(e,"'"))}},{key:"uniform",value:function(t,e,r){var i;this.compiled&&(this.uniforms[e]=this.uniforms[e]||{},(i=this.uniforms[e]).name=e,void 0===i.location&&(i.location=this.gl.getUniformLocation(this.program,e)),i.method=t,i.value=r,this.updateUniform(i))}},{key:"updateUniform",value:function(t){this.compiled&&t&&null!=t.location&&(this.use(),this.commitUniform(t))}},{key:"commitUniform",value:function(t){var e=t.location,r=t.value;switch(t.method){case"1i":this.gl.uniform1i(e,r);break;case"1f":this.gl.uniform1f(e,r);break;case"2f":this.gl.uniform2f(e,r[0],r[1]);break;case"3f":this.gl.uniform3f(e,r[0],r[1],r[2]);break;case"4f":this.gl.uniform4f(e,r[0],r[1],r[2],r[3]);break;case"1iv":this.gl.uniform1iv(e,r);break;case"3iv":this.gl.uniform3iv(e,r);break;case"1fv":this.gl.uniform1fv(e,r);break;case"2fv":this.gl.uniform2fv(e,r);break;case"3fv":this.gl.uniform3fv(e,r);break;case"4fv":this.gl.uniform4fv(e,r);break;case"Matrix3fv":this.gl.uniformMatrix3fv(e,!1,r);break;case"Matrix4fv":this.gl.uniformMatrix4fv(e,!1,r)}}},{key:"refreshUniforms",value:function(){if(this.compiled)for(var t in this.uniforms){var e=this.uniforms[t];e.location=this.gl.getUniformLocation(this.program,t),this.updateUniform(e)}}},{key:"refreshAttributes",value:function(){this.attribs={}}},{key:"attribute",value:function(t){if(this.compiled){var e=this.attribs[t]=this.attribs[t]||{};return null!=e.location||(e.name=t,e.location=this.gl.getAttribLocation(this.program,t)),e}}},{key:"source",value:function(t){return"vertex"===t?this.computed_vertex_source:"fragment"===t?this.computed_fragment_source:void 0}},{key:"lines",value:function(t){var e=this.source(t);return e?e.split("\n"):[]}},{key:"line",value:function(t,e){var r=this.lines(t);if(r)return r[e]}},{key:"block",value:function(t,e){for(var r,i=this.lines(t),n=0;n<e&&n<i.length;n++){var o=i[n],a=o.match(/\/\/ tangram-block-start: ([A-Za-z0-9_-]+), ([A-Za-z0-9_-]+), (\d+)/);a&&1<a.length?r={scope:a[1],name:a[2],num:a[3]}:(a=o.match(/\/\/ tangram-block-end: ([A-Za-z0-9_-]+), ([A-Za-z0-9_-]+), (\d+)/))&&1<a.length&&(r=null),r&&(r.line=null==r.line?-1:r.line+1,r.source=o)}return r}},{key:"checkExtensions",value:function(){var t=this,e=[];return this.extensions.forEach((function(r){var i=getExtension(t.gl,r),n="TANGRAM_EXTENSION_".concat(r);t.defines[n]=null!=i,i?e.push(r):log("debug","Could not enable extension '".concat(r,"'"))})),e}}]),t}();ShaderProgram.polyfills={},ShaderProgram.id=0,ShaderProgram.current=null,ShaderProgram.defines={},ShaderProgram.blocks={},ShaderProgram.reset=function(){ShaderProgram.programs_by_source={},ShaderProgram.shaders_by_source={}},ShaderProgram.reset(),ShaderProgram.buildDefineString=function(t){var e="";for(var r in t)null!=t[r]&&!1!==t[r]&&("boolean"==typeof t[r]&&!0===t[r]?e+="#define "+r+"\n":"number"==typeof t[r]&&Math.floor(t[r])===t[r]?e+="#define "+r+" "+t[r].toFixed(1)+"\n":e+="#define "+r+" "+t[r]+"\n");return e},ShaderProgram.buildExtensionString=function(t){var e="";return(t=t||[]).forEach((function(t){e+="#ifdef GL_".concat(t,"\n#extension GL_").concat(t," : enable\n#endif\n")})),e},ShaderProgram.addBlock=function(t){var e;ShaderProgram.blocks[t]=ShaderProgram.blocks[t]||[];for(var r=arguments.length,i=new Array(1<r?r-1:0),n=1;n<r;n++)i[n-1]=arguments[n];(e=ShaderProgram.blocks[t]).push.apply(e,i)},ShaderProgram.removeBlock=function(t){ShaderProgram.blocks[t]=[]},ShaderProgram.replaceBlock=function(t){ShaderProgram.removeBlock(t);for(var e=arguments.length,r=new Array(1<e?e-1:0),i=1;i<e;i++)r[i-1]=arguments[i];ShaderProgram.addBlock.apply(ShaderProgram,[t].concat(r))},ShaderProgram.updateProgram=function(t,e,r,i){var n=hashString(t._tangram_id+"::"+r+"::"+i);if(ShaderProgram.programs_by_source[n])return log("trace","Reusing identical source GL program object"),ShaderProgram.programs_by_source[n];var o=ShaderProgram.createShader(t,r,t.VERTEX_SHADER),a=ShaderProgram.createShader(t,i,t.FRAGMENT_SHADER);if(t.useProgram(null),null!=e)for(var s=t.getAttachedShaders(e),l=0;l<s.length;l++)t.detachShader(e,s[l]);else e=t.createProgram();if(null==o||null==a)return e;if(t.attachShader(e,o),t.attachShader(e,a),t.linkProgram(e),t.getProgramParameter(e,t.LINK_STATUS))return ShaderProgram.programs_by_source[n]=e;var c=new Error("WebGL program error:\n            VALIDATE_STATUS: ".concat(t.getProgramParameter(e,t.VALIDATE_STATUS),"\n            ERROR: ").concat(t.getError(),"\n            --- Vertex Shader ---\n            ").concat(r,"\n            --- Fragment Shader ---\n            ").concat(i));throw Object.assign(new Error(c),{type:"program"})},ShaderProgram.createShader=function(t,e,r){var i=hashString(t._tangram_id+"::"+e);if(ShaderProgram.shaders_by_source[i])return log("trace","Reusing identical source GL shader object"),ShaderProgram.shaders_by_source[i];var n=t.createShader(r);if(t.shaderSource(n,e),t.compileShader(n),t.getShaderParameter(n,t.COMPILE_STATUS))return ShaderProgram.shaders_by_source[i]=n;var o=r===t.VERTEX_SHADER?"vertex":"fragment",a=t.getShaderInfoLog(n),s=glShaderErrors(a);throw Object.assign(new Error(a),{type:o,errors:s})};var VertexArrayObject={disabled:!1,bound_vao:[],init:function(t){var e;!0!==this.disabled&&(e=getExtension(t,"OES_vertex_array_object")),null!=e?log("info","Vertex Array Object extension available"):!0!==this.disabled?log("warn","Vertex Array Object extension NOT available"):log("warn","Vertex Array Object extension force disabled")},create:function(t,e,r){var i={};i.setup=e,i.teardown=r;var n=getExtension(t,"OES_vertex_array_object");return null!=n&&(i._vao=n.createVertexArrayOES(),n.bindVertexArrayOES(i._vao)),i.setup(!0),i},getCurrentBinding:function(t){var e=this.bound_vao.filter((function(e){return e[0]===t}))[0];return e&&e[1]},setCurrentBinding:function(t,e){var r=this.bound_vao,i=r.filter((function(e){return e[0]===t}))[0];null==i?r.push([t,e]):i[1]=e},bind:function(t,e){var r,i=getExtension(t,"OES_vertex_array_object");null!=e?null!=i&&null!=e._vao?(i.bindVertexArrayOES(e._vao),this.setCurrentBinding(t,e)):e.setup(!1):(r=this.getCurrentBinding(t),null!=i?i.bindVertexArrayOES(null):null!=r&&"function"==typeof r.teardown&&r.teardown(),this.setCurrentBinding(t,null))},destroy:function(t,e){var r=getExtension(t,"OES_vertex_array_object");null!=r&&null!=e&&null!=e._vao&&(r.deleteVertexArrayOES(e._vao),e._vao=null)}},VBOMesh=function(){function t(e,r,i,n,o,a){_classCallCheck(this,t),a=a||{},this.textureManager=getTextureManager(o),this.gl=e,this.vertex_data=r,this.element_data=i,this.vertex_layout=n,this.vertex_buffer=this.gl.createBuffer(),this.buffer_size=this.vertex_data.byteLength,this.draw_mode=a.draw_mode||this.gl.TRIANGLES,this.data_usage=a.data_usage||this.gl.STATIC_DRAW,this.vertices_per_geometry=3,this.uniforms=a.uniforms,this.textures=a.textures,this.retain=a.retain||!1,this.created_at=+new Date,this.fade_in_time=a.fade_in_time||0,this.vertex_count=this.vertex_data.byteLength/this.vertex_layout.stride,this.element_count=0,this.vaos={},this.toggle_element_array=!1,this.element_data?(this.toggle_element_array=!0,this.element_count=this.element_data.length,this.geometry_count=this.element_count/this.vertices_per_geometry,this.element_type=this.element_data.constructor===Uint16Array?this.gl.UNSIGNED_SHORT:this.gl.UNSIGNED_INT,this.element_buffer=this.gl.createBuffer(),this.buffer_size+=this.element_data.byteLength,this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.element_buffer),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,this.element_data,this.data_usage)):this.geometry_count=this.vertex_count/this.vertices_per_geometry,this.upload(),this.retain||(delete this.vertex_data,delete this.element_data),this.valid=!0}return _createClass(t,[{key:"render",value:function(t){var e=0<arguments.length&&void 0!==t?t:{};if(!this.valid)return!1;var r=e.program||ShaderProgram.current;r.use(),this.uniforms&&(r.saveUniforms(this.uniforms),r.setUniforms(this.uniforms,!1));var i=(new Date-this.created_at)/1e3;return r.uniform("1f","u_visible_time",i),this.bind(r),this.toggle_element_array?this.gl.drawElements(this.draw_mode,this.element_count,this.element_type,0):this.gl.drawArrays(this.draw_mode,0,this.vertex_count),VertexArrayObject.bind(this.gl,null),this.uniforms&&r.restoreUniforms(this.uniforms),i<this.fade_in_time}},{key:"bind",value:function(t){var e=this,r=this.vaos[t.id];r?VertexArrayObject.bind(this.gl,r):this.vaos[t.id]=VertexArrayObject.create(this.gl,(function(r){e.gl.bindBuffer(e.gl.ARRAY_BUFFER,e.vertex_buffer),e.toggle_element_array&&e.gl.bindBuffer(e.gl.ELEMENT_ARRAY_BUFFER,e.element_buffer),e.vertex_layout.enable(e.gl,t,r)}))}},{key:"upload",value:function(){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertex_buffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.vertex_data,this.data_usage)}},{key:"destroy",value:function(){var t=this;if(!this.valid)return!1;for(var e in this.valid=!1,this.vaos)VertexArrayObject.destroy(this.gl,this.vaos[e]);return this.gl.deleteBuffer(this.vertex_buffer),this.vertex_buffer=null,this.element_buffer&&(this.gl.deleteBuffer(this.element_buffer),this.element_buffer=null),delete this.vertex_data,delete this.element_data,this.textures&&this.textures.forEach((function(e){return t.textureManager.release(e)})),!0}}]),t}(),shaderSrc_material="/*Defines globals:materiallight_accumulator_**/struct Material{\n#ifdef TANGRAM_MATERIAL_EMISSION\nvec4 emission;\n#ifdef TANGRAM_MATERIAL_EMISSION_TEXTURE\nvec3 emissionScale;\n#endif\n#endif\n#ifdef TANGRAM_MATERIAL_AMBIENT\nvec4 ambient;\n#ifdef TANGRAM_MATERIAL_AMBIENT_TEXTURE\nvec3 ambientScale;\n#endif\n#endif\n#ifdef TANGRAM_MATERIAL_DIFFUSE\nvec4 diffuse;\n#ifdef TANGRAM_MATERIAL_DIFFUSE_TEXTURE\nvec3 diffuseScale;\n#endif\n#endif\n#ifdef TANGRAM_MATERIAL_SPECULAR\nvec4 specular;float shininess;\n#ifdef TANGRAM_MATERIAL_SPECULAR_TEXTURE\nvec3 specularScale;\n#endif\n#endif\n#ifdef TANGRAM_MATERIAL_NORMAL_TEXTURE\nvec3 normalScale;float normalAmount;\n#endif\n};uniform Material u_material;Material material;\n#ifdef TANGRAM_MATERIAL_EMISSION_TEXTURE\nuniform sampler2D u_material_emission_texture;\n#endif\n#ifdef TANGRAM_MATERIAL_AMBIENT_TEXTURE\nuniform sampler2D u_material_ambient_texture;\n#endif\n#ifdef TANGRAM_MATERIAL_DIFFUSE_TEXTURE\nuniform sampler2D u_material_diffuse_texture;\n#endif\n#ifdef TANGRAM_MATERIAL_SPECULAR_TEXTURE\nuniform sampler2D u_material_specular_texture;\n#endif\n#ifdef TANGRAM_MATERIAL_NORMAL_TEXTURE\nuniform sampler2D u_material_normal_texture;\n#endif\nvec4 light_accumulator_ambient=vec4(vec3(0.0),1.);vec4 light_accumulator_diffuse=vec4(vec3(0.0),1.);\n#ifdef TANGRAM_MATERIAL_SPECULAR\nvec4 light_accumulator_specular=vec4(vec3(0.0),1.);\n#endif\n#ifdef TANGRAM_MATERIAL_TEXTURE_SPHEREMAP\nvec4 getSphereMap(in sampler2D _tex,in vec3 _eyeToPoint,in vec3 _normal,in vec2 _skew){vec3 eye=normalize(_eyeToPoint);eye.xy-=_skew;eye=normalize(eye);vec3 r=reflect(eye,_normal);r.z+=1.0;float m=2.*length(r);vec2 uv=r.xy/m+.5;return texture2D(_tex,uv);}\n#endif\n#ifdef TANGRAM_MATERIAL_TEXTURE_TRIPLANAR\nvec3 getTriPlanarBlend(in vec3 _normal){vec3 blending=abs(_normal);blending=normalize(max(blending,0.00001));float b=(blending.x+blending.y+blending.z);return blending/b;}vec4 getTriPlanar(in sampler2D _tex,in vec3 _pos,in vec3 _normal,in vec3 _scale){vec3 blending=getTriPlanarBlend(_normal);vec4 xaxis=texture2D(_tex,fract(_pos.yz*_scale.x));vec4 yaxis=texture2D(_tex,fract(_pos.xz*_scale.y));vec4 zaxis=texture2D(_tex,fract(_pos.xy*_scale.z));return xaxis*blending.x+yaxis*blending.y+zaxis*blending.z;}\n#endif\n#ifdef TANGRAM_MATERIAL_TEXTURE_PLANAR\nvec4 getPlanar(in sampler2D _tex,in vec3 _pos,in vec2 _scale){return texture2D(_tex,fract(_pos.xy*_scale.x));}\n#endif\n#ifdef TANGRAM_MATERIAL_NORMAL_TEXTURE\nvoid calculateNormal(inout vec3 _normal){\n#ifdef TANGRAM_MATERIAL_NORMAL_TEXTURE_UV\n_normal+=texture2D(u_material_normal_texture,fract(v_texcoord*material.normalScale.xy)).rgb*2.0-1.0;\n#endif\n#ifdef TANGRAM_MATERIAL_NORMAL_TEXTURE_PLANAR\nvec3 normalTex=getPlanar(u_material_normal_texture,v_world_position.xyz,material.normalScale.xy).rgb*2.0-1.0;_normal+=normalTex;\n#endif\n#ifdef TANGRAM_MATERIAL_NORMAL_TEXTURE_TRIPLANAR\nvec3 normalTex=getTriPlanar(u_material_normal_texture,v_world_position.xyz,_normal,material.normalScale).rgb*2.0-1.0;_normal+=normalTex;\n#endif\n_normal=normalize(_normal);}\n#endif\nvoid calculateMaterial(in vec3 _eyeToPoint,inout vec3 _normal){\n#ifdef TANGRAM_MATERIAL_EMISSION_TEXTURE\n#ifdef TANGRAM_MATERIAL_EMISSION_TEXTURE_UV\nmaterial.emission*=texture2D(u_material_emission_texture,v_texcoord);\n#endif\n#ifdef TANGRAM_MATERIAL_EMISSION_TEXTURE_PLANAR\nmaterial.emission*=getPlanar(u_material_emission_texture,v_world_position.xyz,material.emissionScale.xy);\n#endif\n#ifdef TANGRAM_MATERIAL_EMISSION_TEXTURE_TRIPLANAR\nmaterial.emission*=getTriPlanar(u_material_emission_texture,v_world_position.xyz,_normal,material.emissionScale);\n#endif\n#ifdef TANGRAM_MATERIAL_EMISSION_TEXTURE_SPHEREMAP\nmaterial.emission*=getSphereMap(u_material_emission_texture,_eyeToPoint,_normal,u_center_offset);\n#endif\n#endif\n#ifdef TANGRAM_MATERIAL_AMBIENT_TEXTURE\n#ifdef TANGRAM_MATERIAL_AMBIENT_TEXTURE_UV\nmaterial.ambient*=texture2D(u_material_ambient_texture,v_texcoord);\n#endif\n#ifdef TANGRAM_MATERIAL_AMBIENT_TEXTURE_PLANAR\nmaterial.ambient*=getPlanar(u_material_ambient_texture,v_world_position.xyz,material.ambientScale.xy);\n#endif\n#ifdef TANGRAM_MATERIAL_AMBIENT_TEXTURE_TRIPLANAR\nmaterial.ambient*=getTriPlanar(u_material_ambient_texture,v_world_position.xyz,_normal,material.ambientScale);\n#endif\n#ifdef TANGRAM_MATERIAL_AMBIENT_TEXTURE_SPHEREMAP\nmaterial.ambient*=getSphereMap(u_material_ambient_texture,_eyeToPoint,_normal,u_center_offset);\n#endif\n#endif\n#ifdef TANGRAM_MATERIAL_DIFFUSE_TEXTURE\n#ifdef TANGRAM_MATERIAL_DIFFUSE_TEXTURE_UV\nmaterial.diffuse*=texture2D(u_material_diffuse_texture,v_texcoord);\n#endif\n#ifdef TANGRAM_MATERIAL_DIFFUSE_TEXTURE_PLANAR\nmaterial.diffuse*=getPlanar(u_material_diffuse_texture,v_world_position.xyz,material.diffuseScale.xy);\n#endif\n#ifdef TANGRAM_MATERIAL_DIFFUSE_TEXTURE_TRIPLANAR\nmaterial.diffuse*=getTriPlanar(u_material_diffuse_texture,v_world_position.xyz,_normal,material.diffuseScale);\n#endif\n#ifdef TANGRAM_MATERIAL_DIFFUSE_TEXTURE_SPHEREMAP\nmaterial.diffuse*=getSphereMap(u_material_diffuse_texture,_eyeToPoint,_normal,u_center_offset);\n#endif\n#endif\n#ifdef TANGRAM_MATERIAL_SPECULAR_TEXTURE\n#ifdef TANGRAM_MATERIAL_SPECULAR_TEXTURE_UV\nmaterial.specular*=texture2D(u_material_specular_texture,v_texcoord);\n#endif\n#ifdef TANGRAM_MATERIAL_SPECULAR_TEXTURE_PLANAR\nmaterial.specular*=getPlanar(u_material_specular_texture,v_world_position.xyz,material.specularScale.xy);\n#endif\n#ifdef TANGRAM_MATERIAL_SPECULAR_TEXTURE_TRIPLANAR\nmaterial.specular*=getTriPlanar(u_material_specular_texture,v_world_position.xyz,_normal,material.specularScale);\n#endif\n#ifdef TANGRAM_MATERIAL_SPECULAR_TEXTURE_SPHEREMAP\nmaterial.specular*=getSphereMap(u_material_specular_texture,_eyeToPoint,_normal,u_center_offset);\n#endif\n#endif\n}",material_props=["emission","ambient","diffuse","specular"],Material=function(){function t(e){var r=this;_classCallCheck(this,t),e=e||{},material_props.forEach((function(t){var i=e[t];null!=i&&(i.texture?r[t]={texture:i.texture,mapping:i.mapping||"spheremap",scale:GLSL.expandVec3(null!=i.scale?i.scale:1),amount:GLSL.expandVec4(null!=i.amount?i.amount:1)}:"number"==typeof i||Array.isArray(i)?r[t]={amount:GLSL.expandVec4(i)}:r[t]="string"==typeof i?{amount:StyleParser.parseColor(i)}:i)})),this.specular&&(this.specular.shininess=e.shininess?parseFloat(e.shininess):.2),null!=e.normal&&(this.normal={texture:e.normal.texture,mapping:e.normal.mapping||"triplanar",scale:GLSL.expandVec3(null!=e.normal.scale?e.normal.scale:1),amount:null!=e.normal.amount?e.normal.amount:1})}return _createClass(t,[{key:"inject",value:function(e){var r=this;material_props.forEach((function(t){var i="TANGRAM_MATERIAL_".concat(t.toUpperCase()),n=i+"_TEXTURE";e.defines[i]=null!=r[t],r[t]&&r[t].texture&&(e.defines[n]=!0,e.defines[n+"_"+r[t].mapping.toUpperCase()]=!0,e.defines["TANGRAM_MATERIAL_TEXTURE_".concat(r[t].mapping.toUpperCase())]=!0,e.texcoords=e.texcoords||"uv"===r[t].mapping)})),this.normal&&this.normal.texture&&(e.defines.TANGRAM_MATERIAL_NORMAL_TEXTURE=!0,e.defines["TANGRAM_MATERIAL_NORMAL_TEXTURE_"+this.normal.mapping.toUpperCase()]=!0,e.defines["TANGRAM_MATERIAL_TEXTURE_".concat(this.normal.mapping.toUpperCase())]=!0,e.texcoords=e.texcoords||"uv"===this.normal.mapping),e.replaceShaderBlock(t.block,shaderSrc_material,"Material"),e.addShaderBlock("setup","\nmaterial = u_material;\n","Material")}},{key:"setupProgram",value:function(t){var e=this;material_props.forEach((function(r){e[r]&&(e[r].texture?(t.setTextureUniform("u_material_".concat(r,"_texture"),e[r].texture),t.uniform("3fv","u_material.".concat(r,"Scale"),e[r].scale),t.uniform("4fv","u_material.".concat(r),e[r].amount)):e[r].amount&&t.uniform("4fv","u_material.".concat(r),e[r].amount))})),this.specular&&t.uniform("1f","u_material.shininess",this.specular.shininess),this.normal&&this.normal.texture&&(t.setTextureUniform("u_material_normal_texture",this.normal.texture),t.uniform("3fv","u_material.normalScale",this.normal.scale),t.uniform("1f","u_material.normalAmount",this.normal.amount))}}],[{key:"isValid",value:function(t){return null!=t&&(null!=t.emission||null!=t.ambient||null!=t.diffuse||null!=t.specular)}}]),t}(),Vector;Material.block="material";var Vector$1=Vector={};Vector.copy=function(t){for(var e=[],r=t.length,i=0;i<r;i++)e[i]=t[i];return e},Vector.neg=function(t){for(var e=[],r=t.length,i=0;i<r;i++)e[i]=-t[i];return e},Vector.add=function(t,e){for(var r=[],i=Math.min(t.length,e.length),n=0;n<i;n++)r[n]=t[n]+e[n];return r},Vector.sub=function(t,e){for(var r=[],i=Math.min(t.length,e.length),n=0;n<i;n++)r[n]=t[n]-e[n];return r},Vector.signed_area=function(t,e,r){return(e[0]-t[0])*(r[1]-t[1])-(r[0]-t[0])*(e[1]-t[1])},Vector.mult=function(t,e){var r,i=[],n=t.length;if("number"==typeof e)for(r=0;r<n;r++)i[r]=t[r]*e;else for(n=Math.min(t.length,e.length),r=0;r<n;r++)i[r]=t[r]*e[r];return i},Vector.multMatrix=function(t,e){return[t[0][0]*e[0]+t[0][1]*e[1],t[1][0]*e[0]+t[1][1]*e[1]]},Vector.div=function(t,e){var r=[];if("number"==typeof e)for(n=0;n<t.length;n++)r[n]=t[n]/e;else for(var i=Math.min(t.length,e.length),n=0;n<i;n++)r[n]=t[n]/e[n];return r},Vector.perp=function(t,e){return[e[1]-t[1],t[0]-e[0]]},Vector.rot=function(t,e){var r=Math.cos(e),i=Math.sin(e);return[t[0]*r-t[1]*i,t[0]*i+t[1]*r]},Vector.angle=function(t){var e=_slicedToArray(t,2),r=e[0],i=e[1];return Math.atan2(i,r)},Vector.angleBetween=function(t,e){var r=Vector.dot(Vector.normalize(Vector.copy(t)),Vector.normalize(Vector.copy(e)));return 1<r&&(r=1),Math.acos(r)},Vector.signedAngleBetween=function(t,e){return Math.atan2(t[0]*e[1]-t[1]*e[0],t[0]*e[0]+t[1]*e[1])},Vector.isEqual=function(t,e){for(var r=t.length,i=0;i<r;i++)if(t[i]!==e[i])return!1;return!0},Vector.lengthSq=function(t){return 2===t.length?t[0]*t[0]+t[1]*t[1]:3<=t.length?t[0]*t[0]+t[1]*t[1]+t[2]*t[2]:0},Vector.length=function(t){return Math.sqrt(Vector.lengthSq(t))},Vector.normalize=function(t){var e;if(2===t.length){if(1==(e=t[0]*t[0]+t[1]*t[1]))return t;0!==(e=Math.sqrt(e))?(t[0]/=e,t[1]/=e):(t[0]=0,t[1]=0)}else if(3<=t.length){if(1==(e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2]))return t;0!==(e=Math.sqrt(e))?(t[0]/=e,t[1]/=e,t[2]/=e):(t[0]=0,t[1]=0,t[2]=0)}return t},Vector.cross=function(t,e){return 2===t.length?t[0]*e[1]-t[1]*e[0]:3===t.length?[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]:void 0},Vector.dot=function(t,e){for(var r=0,i=Math.min(t.length,e.length),n=0;n<i;n++)r+=t[n]*e[n];return r};var shaderSrc_ambientLight="/*Expected globals:light_accumulator_**/struct AmbientLight{vec3 ambient;};void calculateLight(in AmbientLight _light,in vec3 _eyeToPoint,in vec3 _normal){light_accumulator_ambient.rgb+=_light.ambient;}",shaderSrc_directionalLight="/*Expected globals:materiallight_accumulator_**/struct DirectionalLight{vec3 ambient;vec3 diffuse;vec3 specular;vec3 direction;};void calculateLight(in DirectionalLight _light,in vec3 _eyeToPoint,in vec3 _normal){light_accumulator_ambient.rgb+=_light.ambient;float nDotVP=clamp(dot(_normal,-_light.direction),0.0,1.0);\n#ifdef TANGRAM_MATERIAL_DIFFUSE\nlight_accumulator_diffuse.rgb+=_light.diffuse*nDotVP;\n#endif\n#ifdef TANGRAM_MATERIAL_SPECULAR\nfloat pf=0.0;if(nDotVP>0.0){vec3 reflectVector=reflect(_light.direction,_normal);float eyeDotR=max(dot(normalize(_eyeToPoint),reflectVector),0.0);pf=pow(eyeDotR,material.shininess);}light_accumulator_specular.rgb+=_light.specular*pf;\n#endif\n}",shaderSrc_pointLight="/*Expected globals:materiallight_accumulator_**/struct PointLight{vec3 ambient;vec3 diffuse;vec3 specular;vec4 position;\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_EXPONENT\nfloat attenuationExponent;\n#endif\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_INNER_RADIUS\nfloat innerRadius;\n#endif\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS\nfloat outerRadius;\n#endif\n};void calculateLight(in PointLight _light,in vec3 _eyeToPoint,in vec3 _normal){float dist=length(_light.position.xyz-_eyeToPoint);vec3 VP=(_light.position.xyz-_eyeToPoint)/dist;float nDotVP=clamp(dot(VP,_normal),0.0,1.0);float attenuation=1.0;\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_EXPONENT\nfloat Rin=1.0;float e=_light.attenuationExponent;\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_INNER_RADIUS\nRin=_light.innerRadius;\n#endif\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS\nfloat Rdiff=_light.outerRadius-Rin;float d=clamp(max(0.0,dist-Rin)/Rdiff,0.0,1.0);attenuation=1.0-(pow(d,e));\n#else\nfloat d=max(0.0,dist-Rin)/Rin+1.0;attenuation=clamp(1.0/(pow(d,e)),0.0,1.0);\n#endif\n#else\nfloat Rin=0.0;\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_INNER_RADIUS\nRin=_light.innerRadius;\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS\nfloat Rdiff=_light.outerRadius-Rin;float d=clamp(max(0.0,dist-Rin)/Rdiff,0.0,1.0);attenuation=1.0-d*d;\n#else\nfloat d=max(0.0,dist-Rin)/Rin+1.0;attenuation=clamp(1.0/d,0.0,1.0);\n#endif\n#else\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS\nfloat d=clamp(dist/_light.outerRadius,0.0,1.0);attenuation=1.0-d*d;\n#else\nattenuation=1.0;\n#endif\n#endif\n#endif\nlight_accumulator_ambient.rgb+=_light.ambient*attenuation;\n#ifdef TANGRAM_MATERIAL_DIFFUSE\nlight_accumulator_diffuse.rgb+=_light.diffuse*nDotVP*attenuation;\n#endif\n#ifdef TANGRAM_MATERIAL_SPECULAR\nfloat pf=0.0;if(nDotVP>0.0){vec3 reflectVector=reflect(-VP,_normal);float eyeDotR=max(0.0,dot(-normalize(_eyeToPoint),reflectVector));pf=pow(eyeDotR,material.shininess);}light_accumulator_specular.rgb+=_light.specular*pf*attenuation;\n#endif\n}",shaderSrc_spotLight="/*Expected globals:materiallight_accumulator_**/struct SpotLight{vec3 ambient;vec3 diffuse;vec3 specular;vec4 position;\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_EXPONENT\nfloat attenuationExponent;\n#endif\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_INNER_RADIUS\nfloat innerRadius;\n#endif\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS\nfloat outerRadius;\n#endif\nvec3 direction;float spotCosCutoff;float spotExponent;};void calculateLight(in SpotLight _light,in vec3 _eyeToPoint,in vec3 _normal){float dist=length(_light.position.xyz-_eyeToPoint);vec3 VP=(_light.position.xyz-_eyeToPoint)/dist;float nDotVP=clamp(dot(_normal,VP),0.0,1.0);float attenuation=1.0;\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_EXPONENT\nfloat Rin=1.0;float e=_light.attenuationExponent;\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_INNER_RADIUS\nRin=_light.innerRadius;\n#endif\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS\nfloat Rdiff=_light.outerRadius-Rin;float d=clamp(max(0.0,dist-Rin)/Rdiff,0.0,1.0);attenuation=1.0-(pow(d,e));\n#else\nfloat d=max(0.0,dist-Rin)/Rin+1.0;attenuation=clamp(1.0/(pow(d,e)),0.0,1.0);\n#endif\n#else\nfloat Rin=0.0;\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_INNER_RADIUS\nRin=_light.innerRadius;\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS\nfloat Rdiff=_light.outerRadius-Rin;float d=clamp(max(0.0,dist-Rin)/Rdiff,0.0,1.0);attenuation=1.0-d*d;\n#else\nfloat d=max(0.0,dist-Rin)/Rin+1.0;attenuation=clamp(1.0/d,0.0,1.0);\n#endif\n#else\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS\nfloat d=clamp(dist/_light.outerRadius,0.0,1.0);attenuation=1.0-d*d;\n#else\nattenuation=1.0;\n#endif\n#endif\n#endif\nfloat spotAttenuation=0.0;float spotDot=clamp(dot(-VP,_light.direction),0.0,1.0);if(spotDot>=_light.spotCosCutoff){spotAttenuation=pow(spotDot,_light.spotExponent);}light_accumulator_ambient.rgb+=_light.ambient*attenuation*spotAttenuation;\n#ifdef TANGRAM_MATERIAL_DIFFUSE\nlight_accumulator_diffuse.rgb+=_light.diffuse*nDotVP*attenuation*spotAttenuation;\n#endif\n#ifdef TANGRAM_MATERIAL_SPECULAR\nfloat pf=0.0;if(nDotVP>0.0){vec3 reflectVector=reflect(-VP,_normal);float eyeDotR=max(dot(-normalize(_eyeToPoint),reflectVector),0.0);pf=pow(eyeDotR,material.shininess);}light_accumulator_specular.rgb+=_light.specular*pf*attenuation*spotAttenuation;\n#endif\n}",Light=function(){function t(e,r){_classCallCheck(this,t),this.name=r.name,this.view=e,null==r.ambient||"number"==typeof r.ambient?this.ambient=GLSL.expandVec3(r.ambient||0):this.ambient=StyleParser.parseColor(r.ambient).slice(0,3),null==r.diffuse||"number"==typeof r.diffuse?this.diffuse=GLSL.expandVec3(null!=r.diffuse?r.diffuse:1):this.diffuse=StyleParser.parseColor(r.diffuse).slice(0,3),null==r.specular||"number"==typeof r.specular?this.specular=GLSL.expandVec3(r.specular||0):this.specular=StyleParser.parseColor(r.specular).slice(0,3)}return _createClass(t,[{key:"inject",value:function(){var e="\n            uniform ".concat(this.struct_name," u_").concat(this.name,";\n            ").concat(this.struct_name," ").concat(this.name,";\n            "),r="\n            ".concat(this.name," = u_").concat(this.name,";\n\n        ");ShaderProgram.addBlock(t.block,e),ShaderProgram.addBlock("setup",r)}},{key:"update",value:function(){}},{key:"setupProgram",value:function(t){t.uniform("3fv","u_".concat(this.name,".ambient"),this.ambient),t.uniform("3fv","u_".concat(this.name,".diffuse"),this.diffuse),t.uniform("3fv","u_".concat(this.name,".specular"),this.specular)}}],[{key:"create",value:function(e,r){if(t.types[r.type])return new t.types[r.type](e,r)}},{key:"setMode",value:function(e,r){!0===e&&(e="fragment"),e=t.enabled&&(null!=e?e:"fragment"),r.defines.TANGRAM_LIGHTING_FRAGMENT="fragment"===e,r.defines.TANGRAM_LIGHTING_VERTEX="vertex"===e}},{key:"inject",value:function(e){if(ShaderProgram.removeBlock(t.block),t.enabled){var r="";if(e&&0<Object.keys(e).length){var i={};for(var n in e)i[e[n].type]=!0;for(var o in i)t.types[o].inject();for(var a in e)e[a].inject(),r+="calculateLight(".concat(a,", _eyeToPoint, _normal);\n")}var s="\n            vec4 calculateLighting(in vec3 _eyeToPoint, in vec3 _normal, in vec4 _color) {\n\n                // Do initial material calculations over normal, emission, ambient, diffuse and specular values\n                calculateMaterial(_eyeToPoint,_normal);\n\n                // Un roll the loop of individual ligths to calculate\n                ".concat(r,"\n\n                //  Final light intensity calculation\n                vec4 color = vec4(vec3(0.), _color.a); // start with vertex color alpha\n\n                #ifdef TANGRAM_MATERIAL_EMISSION\n                    color.rgb = material.emission.rgb;\n                    color.a *= material.emission.a;\n                #endif\n\n                #ifdef TANGRAM_MATERIAL_AMBIENT\n                    color.rgb += light_accumulator_ambient.rgb * _color.rgb * material.ambient.rgb;\n                    color.a *= material.ambient.a;\n                #else\n                    #ifdef TANGRAM_MATERIAL_DIFFUSE\n                        color.rgb += light_accumulator_ambient.rgb * _color.rgb * material.diffuse.rgb;\n                    #endif\n                #endif\n\n                #ifdef TANGRAM_MATERIAL_DIFFUSE\n                    color.rgb += light_accumulator_diffuse.rgb * _color.rgb * material.diffuse.rgb;\n                    color.a *= material.diffuse.a;\n                #endif\n\n                #ifdef TANGRAM_MATERIAL_SPECULAR\n                    color.rgb += light_accumulator_specular.rgb * material.specular.rgb;\n                    color.a *= material.specular.a;\n                #endif\n\n                // Clamp final color\n                color = clamp(color, 0.0, 1.0);\n\n                return color;\n            }");ShaderProgram.addBlock(t.block,s)}}}]),t}();Light.types={},Light.block="lighting",Light.enabled=!0;var AmbientLight=function(){_inherits(e,Light);var t=_createSuper(e);function e(r,i){var n;return _classCallCheck(this,e),(n=t.call(this,r,i)).type="ambient",n.struct_name="AmbientLight",n}return _createClass(e,[{key:"setupProgram",value:function(t){t.uniform("3fv","u_".concat(this.name,".ambient"),this.ambient)}}],[{key:"inject",value:function(){ShaderProgram.addBlock(Light.block,shaderSrc_ambientLight)}}]),e}();Light.types.ambient=AmbientLight;var DirectionalLight=function(){_inherits(e,Light);var t=_createSuper(e);function e(r,i){var n,o;return _classCallCheck(this,e),(n=t.call(this,r,i)).type="directional",n.struct_name="DirectionalLight",i.direction?n._direction=i.direction:(o=Math.sin(60*Math.PI/180),n._direction=[Math.cos(135*Math.PI/180)*o,Math.sin(135*Math.PI/180)*o,-.5]),null==i.ambient&&(n.ambient=GLSL.expandVec3(.5)),n.direction=n._direction.map(parseFloat),n._initial_direction=[n.direction[0],n.direction[1],n.direction[2]],n}return _createClass(e,[{key:"update",value:function(){vec3.transformMat4(this.direction,this._initial_direction,this.view.lookAtManipulator.getTransformationMatrix())}},{key:"setupProgram",value:function(t){_get(_getPrototypeOf(e.prototype),"setupProgram",this).call(this,t),t.uniform("3fv","u_".concat(this.name,".direction"),this.direction)}},{key:"direction",get:function(){return this._direction},set:function(t){this._direction=Vector$1.normalize(Vector$1.copy(t))}}],[{key:"inject",value:function(){ShaderProgram.addBlock(Light.block,shaderSrc_directionalLight)}}]),e}();Light.types.directional=DirectionalLight;var PointLight=function(){_inherits(e,Light);var t=_createSuper(e);function e(r,i){var n;return _classCallCheck(this,e),(n=t.call(this,r,i)).type="point",n.struct_name="PointLight",n.position=i.position||[0,0,"100px"],n.position_eye=[],n.origin=i.origin||"ground",n.attenuation=isNaN(parseFloat(i.attenuation))?0:parseFloat(i.attenuation),i.radius?Array.isArray(i.radius)&&2===i.radius.length?n.radius=i.radius:n.radius=[null,i.radius]:n.radius=null,n}return _createClass(e,[{key:"inject",value:function(){_get(_getPrototypeOf(e.prototype),"inject",this).call(this),ShaderProgram.defines.TANGRAM_POINTLIGHT_ATTENUATION_EXPONENT=0!==this.attenuation,ShaderProgram.defines.TANGRAM_POINTLIGHT_ATTENUATION_INNER_RADIUS=null!=this.radius&&null!=this.radius[0],ShaderProgram.defines.TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS=null!=this.radius}},{key:"update",value:function(){var t,e,r,i=this.view.lookAtManipulator.getLookAtData().zoom;"world"===this.origin?(e=(t=_slicedToArray(Geo$1.latLngToMeters(this.position),2))[0],r=t[1],this.position_eye[0]=e-this.view.lookAtManipulator.getLookAtData().position[0],this.position_eye[1]=r-this.view.lookAtManipulator.getLookAtData().position[1],this.position_eye[2]=StyleParser.convertUnits(this.position[2],{zoom:i,meters_per_pixel:Geo$1.metersPerPixel(i)}),this.position_eye[2]=this.position_eye[2]-this.view.lookAtManipulator.getLookAtData().distance):"ground"!==this.origin&&"camera"!==this.origin||(this.position_eye=StyleParser.convertUnits(this.position,{zoom:i,meters_per_pixel:Geo$1.metersPerPixel(i)}),"ground"===this.origin&&(this.position_eye[2]=this.position_eye[2]-this.view.lookAtManipulator.getLookAtData().distance)),this.position_eye[3]=1}},{key:"setupProgram",value:function(t){_get(_getPrototypeOf(e.prototype),"setupProgram",this).call(this,t),t.uniform("4fv","u_".concat(this.name,".position"),this.position_eye),ShaderProgram.defines.TANGRAM_POINTLIGHT_ATTENUATION_EXPONENT&&t.uniform("1f","u_".concat(this.name,".attenuationExponent"),this.attenuation);var r=this.view.lookAtManipulator.getLookAtData().zoom;ShaderProgram.defines.TANGRAM_POINTLIGHT_ATTENUATION_INNER_RADIUS&&t.uniform("1f","u_".concat(this.name,".innerRadius"),StyleParser.convertUnits(this.radius[0],{zoom:r,meters_per_pixel:Geo$1.metersPerPixel(r)})),ShaderProgram.defines.TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS&&t.uniform("1f","u_".concat(this.name,".outerRadius"),StyleParser.convertUnits(this.radius[1],{zoom:r,meters_per_pixel:Geo$1.metersPerPixel(r)}))}}],[{key:"inject",value:function(){ShaderProgram.addBlock(Light.block,shaderSrc_pointLight)}}]),e}();Light.types.point=PointLight;var SpotLight=function(){_inherits(e,PointLight);var t=_createSuper(e);function e(r,i){var n;return _classCallCheck(this,e),(n=t.call(this,r,i)).type="spotlight",n.struct_name="SpotLight",n.direction=n._direction=(i.direction||[0,0,-1]).map(parseFloat),n._initial_direction=[n.direction[0],n.direction[1],n.direction[2]],n.exponent=i.exponent?parseFloat(i.exponent):.2,n.angle=i.angle?parseFloat(i.angle):20,n}return _createClass(e,[{key:"setupProgram",value:function(t){_get(_getPrototypeOf(e.prototype),"setupProgram",this).call(this,t),t.uniform("3fv","u_".concat(this.name,".direction"),this.direction),t.uniform("1f","u_".concat(this.name,".spotCosCutoff"),Math.cos(3.14159*this.angle/180)),t.uniform("1f","u_".concat(this.name,".spotExponent"),this.exponent)}},{key:"update",value:function(){_get(_getPrototypeOf(e.prototype),"update",this).call(this),vec3.transformMat4(this.direction,this._initial_direction,this.view.lookAtManipulator.getTransformationMatrix())}},{key:"direction",get:function(){return this._direction},set:function(t){this._direction=Vector$1.normalize(Vector$1.copy(t))}}],[{key:"inject",value:function(){ShaderProgram.addBlock(Light.block,shaderSrc_spotLight)}}]),e}();function mergeObjects(t){for(var e=0;e<(arguments.length<=1?0:arguments.length-1);e++){var r=e+1<1||arguments.length<=e+1?void 0:arguments[e+1];if(r)for(var i in r){var n=r[i];null===n||"object"!==_typeof(n)||Array.isArray(n)?void 0!==n&&(t[i]=n):null===t[i]||"object"!==_typeof(t[i])||Array.isArray(t[i])?t[i]=mergeObjects({},n):t[i]=mergeObjects(t[i],n)}}return t}Light.types.spotlight=SpotLight;var shaderSrc_selectionFragment="\n#ifdef TANGRAM_FEATURE_SELECTION\nvarying vec4 v_selection_color;\n#endif\nvoid main(void){\n#ifdef TANGRAM_FEATURE_SELECTION\ngl_FragColor=v_selection_color;\n#else\ngl_FragColor=vec4(0.,0.,0.,1.);\n#endif\n}",shaderSrc_selectionCropFragment="\n#pragma tangram: utils\n#ifdef TANGRAM_FEATURE_SELECTION\nuniform float u_meters_per_pixel;varying vec4 v_selection_color;varying vec4 v_local_space_position;\n#endif\nvoid main(void){\n#ifdef TANGRAM_FEATURE_SELECTION\nif(isLocalSpacePixelOutsideTile(v_local_space_position,TANGRAM_TILE_SCALE.x)){discard;}else{gl_FragColor=v_selection_color;}\n#else\ngl_FragColor=vec4(0.,0.,0.,1.);\n#endif\n}",shaderSrc_rasters="#ifdef TANGRAM_FRAGMENT_SHADER\nuniform sampler2D u_raster;uniform vec3 u_raster_offset;\n#define sampleRaster() (texture2D(u_raster, v_modelpos_base_zoom.xy * u_raster_offset.z + u_raster_offset.xy))\n#endif\n",Style={init:function(t){var e=0<arguments.length&&void 0!==t?t:{},r=e.generation,i=e.styles,n=e.sources,o=void 0===n?{}:n,a=e.introspection,s=e.id,l=void 0!==s?s+"/":"";this.scene_id=s,this.textureManager=getTextureManager(s),this.main_thread_target="".concat(l,"Style/").concat(this.name),this.setGeneration(r),this.styles=i,this.sources=o,this.defines=this.hasOwnProperty("defines")&&this.defines||{},this.shaders=this.hasOwnProperty("shaders")&&this.shaders||{},this.introspection=a||!1,this.selection=this.selection||this.introspection||!1,this.compile_setup=!1,this.program=null,this.selection_program=null,this.feature_style={},this.vertex_template=[],this.tile_data={},this.defines.TANGRAM_WORLD_POSITION_WRAP=1e5,this.blend=this.blend||"opaque",this.defines["TANGRAM_BLEND_".concat(this.blend.toUpperCase())]=!0,null==this.blend_order&&(this.blend_order=-1),this.removeShaderBlock("setup"),this.material instanceof Material||(Material.isValid(this.material)||(this.material=StyleParser.defaults.material),this.material=new Material(this.material)),this.material.inject(this),Light.setMode(this.lighting,this),this.setupRasters(),this.initialized=!0},destroy:function(){this.program&&(this.program.destroy(),this.program=null),this.selection_program&&(this.selection_program.destroy(),this.selection_program=null),WorkerBroker.removeTarget(this.main_thread_target),this.gl=null,this.initialized=!1},reset:function(){},baseStyle:function(){return this.base||this.name},setGeneration:function(t){this.generation=t,Thread.is_main&&WorkerBroker.addTarget(this.main_thread_target,this)},fillVertexTemplate:function(t,e,r,i){var n=i.size,o=void 0===(o=i.offset)?0:o,a=t.index[e];if(void 0!==a)for(var s=0;s<n;++s){var l=r.length>s?r[s]:r;this.vertex_template[a+s+o]=l}else log("warn","Style: in style '".concat(this.name,"', no index found in vertex layout for attribute '").concat(e,"'"))},startData:function(t){this.tile_data[t.id]=this.tile_data[t.id]||{meshes:{},uniforms:{},textures:[]}},endData:function(t){var e=this.tile_data[t.id];if(this.tile_data[t.id]=null,e&&0<Object.keys(e.meshes).length){for(var r in e.meshes){var i=e.meshes[r];0!==i.vertex_data.vertex_count?(i.vertex_data.end(),i.vertex_elements=i.vertex_data.element_buffer,i.vertex_data=i.vertex_data.vertex_buffer):delete e.meshes[r]}return t.mesh_data[this.name]=e,this.buildRasterTextures(t,e).then((function(t){return t}))}return Promise.resolve(null)},hasDataForTile:function(t){return null!=this.tile_data[t.id]},getTileMesh:function(t,e){var r=this.tile_data[t.id].meshes;return null==r[e.key]&&(r[e.key]={variant:e,vertex_data:this.vertexLayoutForMeshVariant(e).createVertexData()}),r[e.key]},vertexLayoutForMeshVariant:function(){return this.vertex_layout},default_mesh_variant:{key:0},style_mesh_variants:{default:{variants:{0:{variant:{key:0},times_unref:0}}}},addMeshVariantForDraw:function(t,e){this.style_mesh_variants[t]||(this.style_mesh_variants[t]={variants:{}});var r=this.computeVariantForDraw(e);return this.style_mesh_variants[t].variants[r.key]={variant:r,times_unref:0},this.style_mesh_variants[t].variants[r.key].variant},getMeshVariantTypeForDraw:function(t){return this.getMeshVariantType(this.base,t)},getMeshVariantType:function(t,e){void 0===t&&(t="default");var r=this.style_mesh_variants[t];if(void 0===e.variantKey||!r||!r.variants[e.variantKey])return this.addMeshVariantForDraw(t,e);var i=e.variantKey,n=r.variants[i];return n.times_unref=0,n.variant},updateMeshVariantTypeCache:function(t){for(var e in this.style_mesh_variants){var r=this.style_mesh_variants[e].variants;for(var i in r){var n=r[i];n.times_unref++,n.times_unref>t&&("default"!==e||0!=+i)&&(delete r[i],0===Object.keys(r).length&&delete this.style_mesh_variants[e])}}},computeVariantForDraw:function(){return this.default_mesh_variant},addFeature:function(t,e,r){var i=r.tile;this.tile_data[i.id]||this.startData(i);var n,o,a,s,l=this.parseFeature(t,e,r);l&&(n="lines"===this.base?this.getMeshVariantTypeForDraw(e):this.getMeshVariantTypeForDraw(l),a=(o=this.getTileMesh(i,n)).vertex_data.offset,s=o.vertex_data.vertex_count,0<this.buildGeometry(t.geometry,l,o,r)?t.generation=this.generation:o.vertex_data.vertex_count>s&&(o.vertex_data.vertex_buffer.fill(0,a,o.vertex_data.offset),o.vertex_data.vertex_count=s,o.vertex_data.offset=a))},buildGeometry:function(t,e,r,i){var n;return"Polygon"===t.type?n=this.buildPolygons([t.coordinates],e,r,i):"MultiPolygon"===t.type?n=this.buildPolygons(t.coordinates,e,r,i):"LineString"===t.type?n=this.buildLines([t.coordinates],e,r,i):"MultiLineString"===t.type?n=this.buildLines(t.coordinates,e,r,i):"Point"===t.type?n=this.buildPoints([t.coordinates],e,r,i):"MultiPoint"===t.type&&(n=this.buildPoints(t.coordinates,e,r,i)),n},parseFeature:function(t,e,r){try{var i,n,o,a=this.feature_style;if(a.order=this.parseOrder(e.order,r),null==a.order&&"overlay"!==this.blend){var s="Layer '".concat(e.layers.join(", "),"', draw group '").concat(e.group,"': ");return s+="'order' parameter is required unless blend mode is 'overlay'",null!=e.order&&(s+="; 'order' was set to a dynamic value (e.g. string tied to feature property, ",s+="or JS function), but evaluated to null for one or more features"),void log({level:"warn",once:!0},s)}if(!(a=this._parseFeature(t,e,r)))return;return this.selection?a.interactive=StyleParser.evalProperty(this.introspection||e.interactive,r):a.interactive=!1,!0===a.interactive?(n=(i=FeatureSelection.makeEntry()).color,o=i.key,a.selection_color=n,r.tile.selection_data||(r.tile.selection_data={}),r.tile.selection_data[o]={id:t.id||o,properties:t.properties,source_name:r.source,source_layer:r.layer,layers:r.layers}):a.selection_color=FeatureSelection.defaultColor,a}catch(e){log("error","Style.parseFeature: style parsing error",t,a,e.stack)}},_parseFeature:function(){return this.feature_style},preprocess:function(t,e){if(!t.preprocessed){if(this.draw)for(var r in this.draw){var i=this.draw[r];"object"!==_typeof(i)||Array.isArray(i)?null==t[r]&&(t[r]=i):t[r]=mergeObjects({},i,t[r])}var n=e||"";if(!(t=this._preprocess(t,n)))return;t.preprocessed=!0}return t},_preprocess:function(t){return t},parseOrder:function(t,e){return"number"!=typeof t?StyleParser.calculateOrder(t,e):t},scaleOrder:function(t){return 2*t},parseColor:function(t,e){return t?StyleParser.evalCachedColorProperty(t,e):this.shaders.blocks.color||this.shaders.blocks.filter?StyleParser.defaults.color:void 0},buildPolygons:function(){return 0},buildLines:function(){return 0},buildPoints:function(){return 0},setGL:function(t){this.gl=t,this.max_texture_size=this.textureManager.getMaxTextureSize(this.gl)},makeMesh:function(t,e,r){var i=2<arguments.length&&void 0!==r?r:{},n=this.vertexLayoutForMeshVariant(i.variant);return new VBOMesh(this.gl,t,e,n,this.scene_id,i)},render:function(t){return t.render()},getProgram:function(t){var e=0<arguments.length&&void 0!==t?t:"program";this.compileSetup();var r=this[e];if(r&&!r.error){if(!r.compiled)try{r.compile()}catch(t){log("error","Style: error compiling program for style '".concat(this.name,"' (program key '").concat(e,"')"),this,t.stack)}return r}},compileSetup:function(){if(!this.compile_setup){if(!this.gl)throw new Error("style.compile(): skipping for ".concat(this.name," because no GL context"));var t,e=this.buildDefineList();this.selection&&((t=Object.assign({},e)).TANGRAM_FEATURE_SELECTION=!0);var r=this.shaders&&this.shaders.blocks,i=this.shaders&&this.shaders.block_scopes,n=Object.assign({},this.shaders&&this.shaders.uniforms);for(var o in n)null==n[o]&&log({level:"warn",once:!0},"Style '".concat(this.name,"' has invalid uniform '").concat(o,"': uniform values must be non-null"));var a=this.shaders&&this.shaders.extensions;"string"==typeof a&&(a=[a]),this.program=new ShaderProgram(this.gl,this.vertex_shader_src,this.fragment_shader_src,this.scene_id,{name:this.name,defines:e,uniforms:n,blocks:r,block_scopes:i,extensions:a}),this.selection?this.selection_program=new ShaderProgram(this.gl,this.vertex_shader_src,this.crop_by_tile?shaderSrc_selectionCropFragment:shaderSrc_selectionFragment,this.scene_id,{name:this.name+" (selection)",defines:t,uniforms:n,blocks:r,block_scopes:i,extensions:a}):this.selection_program=null,this.compile_setup=!0}},addShaderBlock:function(t,e,r){var i=2<arguments.length&&void 0!==r?r:null;this.shaders.blocks=this.shaders.blocks||{},this.shaders.blocks[t]=this.shaders.blocks[t]||[],this.shaders.blocks[t].push(e),this.shaders.block_scopes=this.shaders.block_scopes||{},this.shaders.block_scopes[t]=this.shaders.block_scopes[t]||[],this.shaders.block_scopes[t].push(i)},removeShaderBlock:function(t){this.shaders.blocks&&(this.shaders.blocks[t]=null)},replaceShaderBlock:function(t,e,r){var i=2<arguments.length&&void 0!==r?r:null;this.removeShaderBlock(t),this.addShaderBlock(t,e,i)},buildDefineList:function(){var t={};if(null!=this.defines)for(var e in this.defines)t[e]=this.defines[e];if(null!=this.shaders&&null!=this.shaders.defines)for(e in this.shaders.defines)t[e]=this.shaders.defines[e];return t},hasRasters:function(){return-1<["color","normal","custom"].indexOf(this.raster)},setupRasters:function(){if(!Thread.is_main)return!1;if(!this.hasRasters())return!1;"color"===this.raster?this.defines.TANGRAM_RASTER_TEXTURE_COLOR=!0:"normal"===this.raster&&(this.defines.TANGRAM_RASTER_TEXTURE_NORMAL=!0);var t=!1;for(var e in this.sources)if(this.sources[e]instanceof RasterTileSource){t=!0;break}return!!t&&(this.defines.TANGRAM_MODEL_POSITION_BASE_ZOOM_VARYING=!0,this.replaceShaderBlock("raster",shaderSrc_rasters,"Raster"),!0)},buildRasterTextures:function(t,e){var r=this;if(!this.hasRasters())return Promise.resolve(e);var i={};return t.rasters.map((function(t){return r.sources[t]})).filter((function(t){return t})).forEach((function(e,r){var n;e instanceof RasterTileSource&&(n=e.tileTexture(t),i[n.url]=n)})),0===Object.keys(i).length?Promise.resolve(e):WorkerBroker.postMessage(this.main_thread_target+".loadTextures",i).then((function(r){if(!r||r.length<1)return log("trace","Missing texture info for tile ".concat(t.key)),null;if(r.some((function(t){return!t.loaded})))return null;e.uniforms=e.uniforms||{},e.textures=e.textures||[];var n,o,a=r[0].name,s=i[a].coords;return e.uniforms.u_raster=a,e.textures.push(a),t.coords.z>s.z?(n=t.coords.z-s.z,o=Math.pow(2,n),e.uniforms.u_raster_offset=[(t.coords.x%o+o)%o/o,(o-1-t.coords.y%o)/o,1/o]):e.uniforms.u_raster_offset=[0,0,1],e}))},loadTextures:function(t){var e=this;return this.textureManager.createFromObject(this.gl,t).then((function(){return Promise.all(Object.keys(t).map((function(t){return e.textureManager.textures[t]&&e.textureManager.textures[t].load()})).filter((function(t){return t})))})).then((function(t){return t.forEach((function(t){return t.retain()})),t.map((function(t){return{name:t.name,width:t.width,height:t.height,loaded:t.loaded}}))}))},setup:function(){this.setUniforms(),this.material.setupProgram(ShaderProgram.current)},setUniforms:function(){var t=ShaderProgram.current;t&&t.setUniforms(this.shaders&&this.shaders.uniforms,!0)},render_states:{opaque:{depth_test:!0,depth_write:!0},translucent:{depth_test:!0,depth_write:!0},add:{depth_test:!0,depth_write:!1},multiply:{depth_test:!0,depth_write:!1},inlay:{depth_test:!0,depth_write:!1},overlay:{depth_test:!1,depth_write:!1}},default_blend_orders:{opaque:0,add:1,multiply:2,inlay:3,translucent:4,overlay:5},sortByBlendOrderWithinLayers:function(t){var e=[],r={};for(var i in t.forEach((function(t){var e=parseInt(t.name,10)||0;r[e]||(r[e]=[]),r[e].push(t)})),r)e.push.apply(e,_toConsumableArray(r[i].sort(Style.blendOrderSort)));return e},blendOrderSort:function(t,e){return"opaque"===t.blend||"opaque"===e.blend?"opaque"===t.blend&&"opaque"===e.blend?t.name<e.name?-1:1:"opaque"===t.blend?-1:1:t.blend_order<e.blend_order||!(t.blend_order>e.blend_order)&&(Style.default_blend_orders[t.blend]<Style.default_blend_orders[e.blend]||!(Style.default_blend_orders[t.blend]>Style.default_blend_orders[e.blend])&&t.name<e.name)?-1:1}},id$1=0,build_id=0,Tile=function(){function t(e){var r=e.coords,i=e.style_zoom,n=e.source,o=e.worker,a=e.view,s=e.sceneId;_classCallCheck(this,t),this.textureManager=getTextureManager(s),this.id=id$1++,this.worker=o,this.view=a,this.source=n,this.generation=null,this.valid=!0,this.proxy_for=null,this.proxy_depth=0,this.proxied_as=null,this.fade_in=!0,this.loading=!1,this.loaded=!1,this.built=!1,this.labeled=!1,this.error=null,this.style_zoom=i,this.coords=t.normalizedCoordinate(r,this.source,this.style_zoom),this.key=t.key(this.coords,this.source,this.style_zoom),this.overzoom=Math.max(this.style_zoom-this.coords.z,0),this.overzoom2=Math.pow(2,this.overzoom),this.min=Geo$1.metersForTile(this.coords),this.max=Geo$1.metersForTile({x:this.coords.x+1,y:this.coords.y+1,z:this.coords.z}),this.span={x:this.max.x-this.min.x,y:this.max.y-this.min.y},this.bounds={sw:{x:this.min.x,y:this.max.y},ne:{x:this.max.x,y:this.min.y}},this.center_dist=0,this.meters_per_pixel=Geo$1.metersPerPixel(this.style_zoom),this.meters_per_pixel_sq=this.meters_per_pixel*this.meters_per_pixel,this.units_per_pixel=Geo$1.units_per_pixel/this.overzoom2,this.units_per_meter_overzoom=Geo$1.unitsPerMeter(this.coords.z)*this.overzoom2,this.meshes={},this.new_mesh_styles=[]}return _createClass(t,[{key:"freeResources",value:function(){for(var t in this.meshes)this.meshes[t].forEach((function(t){return t.destroy()}));this.meshes={}}},{key:"destroy",value:function(){Task.removeForTile(this.id),this.workerMessage("self.removeTile",this.id),this.freeResources(),this.worker=null,this.valid=!1}},{key:"buildAsMessage",value:function(){return{id:this.id,key:this.key,source:this.source.name,coords:this.coords,min:this.min,max:this.max,units_per_pixel:this.units_per_pixel,meters_per_pixel:this.meters_per_pixel,meters_per_pixel_sq:this.meters_per_pixel_sq,units_per_meter_overzoom:this.units_per_meter_overzoom,style_zoom:this.style_zoom,overzoom:this.overzoom,overzoom2:this.overzoom2,generation:this.generation}}},{key:"workerMessage",value:function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return WorkerBroker.postMessage.apply(WorkerBroker,[this.worker].concat(e))}},{key:"build",value:function(t,e){var r=(1<arguments.length&&void 0!==e?e:{}).fade_in,i=void 0===r||r;return this.generation=t,this.fade_in=i,this.loaded||(this.loading=!0,this.built=!1,this.labeled=!1),this.workerMessage("self.buildTile",{tile:this.buildAsMessage()})}},{key:"buildMeshes",value:function(t,e){if(!this.error){this.build_id=build_id++;var r={},i=this.mesh_data;if(i)for(var n in i){for(var o in i[n].meshes){var a=i[n].meshes[o];if(a.vertex_data){if(!t[n]){log("warn","Could not create mesh because style '".concat(n,"' not found, for tile ").concat(this.key,", aborting tile"));break}var s=Object.assign({},i[n]);s.uniforms=Object.assign({},s.uniforms,a.uniforms),s.variant=a.variant,a.textures&&(s.textures=a.textures),a.labels&&(s.retain=!0);var l=t[n].makeMesh(a.vertex_data,a.vertex_elements,s);l.variant=s.variant,l.labels=a.labels,r[n]=r[n]||[],r[n].push(l),null==l.variant.order&&(l.variant.order=r[n].length-1)}}r[n]&&r[n].sort((function(t,e){var r=t.variant.order,i=e.variant.order;return null!=r&&(null==i||r<i)?-1:1}))}for(var c in delete this.mesh_data,r)this.meshes[c]&&this.meshes[c].forEach((function(t){return t.destroy()})),this.meshes[c]=r[c],this.new_mesh_styles.push(c);if(e.done){for(var u in this.meshes)-1===this.new_mesh_styles.indexOf(u)&&(this.meshes[u].forEach((function(t){return t.destroy()})),delete this.meshes[u]);this.new_mesh_styles=[]}}}},{key:"setProxyFor",value:function(t){t?(this.proxy_for=this.proxy_for||[],this.proxy_for.push(t),this.proxy_depth=1,t.proxied_as=t.style_zoom>this.style_zoom?"child":"parent"):(this.proxy_for=null,this.proxy_depth=0)}},{key:"isProxy",value:function(){return null!=this.proxy_for}},{key:"shouldProxyForStyle",value:function(t){return!this.proxy_for||this.proxy_for.some((function(e){return null==e.meshes[t]}))}},{key:"setupProgram",value:function(t,e){var r=t.model,i=t.model32;e.uniform("4fv","u_tile_origin",[this.min.x,this.min.y,this.style_zoom,this.coords.z]),e.uniform("1f","u_tile_proxy_depth",this.proxy_depth),mat4.identity(r),mat4.translate(r,r,vec3.fromValues(this.min.x,this.min.y,0)),mat4.scale(r,r,vec3.fromValues(this.span.x/Geo$1.tile_scale,-1*this.span.y/Geo$1.tile_scale,1)),mat4.copy(i,r),e.uniform("Matrix4fv","u_model",i),e.uniform("1i","u_tile_fade_in",this.fade_in&&"child"!==this.proxied_as)}},{key:"merge",value:function(t){return this.loading=t.loading,this.loaded=t.loaded,this.generation=t.generation,this.error=t.error,this.mesh_data=t.mesh_data,this.selection_data?Object.assign(this.selection_data,t.selection_data):this.selection_data=t.selection_data,this}}],[{key:"coord",value:function(e){return{x:e.x,y:e.y,z:e.z,key:t.coordKey(e)}}},{key:"coordKey",value:function(t){return t.x+"/"+t.y+"/"+t.z}},{key:"key",value:function(t,e,r){if(!(t.y<0||t.y>=1<<t.z||t.z<0))return[e.name,r,t.x,t.y,t.z].join("/")}},{key:"normalizedKey",value:function(e,r,i){return t.key(t.normalizedCoordinate(e,r,i),r,i)}},{key:"normalizedCoordinate",value:function(e,r){return r.zoom_bias&&(e=t.coordinateAtZoom(e,Math.max(0,e.z-r.zoom_bias))),t.coordinateWithMaxZoom(e,r.max_zoom)}},{key:"coordinateAtZoom",value:function(e,r){var i,n=e.x,o=e.y,a=e.z;return a!==r&&(i=Math.pow(2,a-r),n=Math.floor(n/i),o=Math.floor(o/i),a=r),t.coord({x:n,y:o,z:a})}},{key:"coordinateWithMaxZoom",value:function(e,r){var i=e.x,n=e.y,o=e.z;return void 0!==r&&r<o?t.coordinateAtZoom({x:i,y:n,z:o},r):t.coord({x:i,y:n,z:o})}},{key:"childrenForCoordinate",value:function(e){var r=e.x,i=e.y,n=e.z,o=e.key;return t.coord_children[o]||(n++,r*=2,i*=2,t.coord_children[o]=[t.coord({x:r,y:i,z:n}),t.coord({x:r+1,y:i,z:n}),t.coord({x:r,y:i+1,z:n}),t.coord({x:r+1,y:i+1,z:n})]),t.coord_children[o]}},{key:"isDescendant",value:function(e,r){if(r.z>e.z){var i=t.coordinateAtZoom(r,e.z),n=i.x,o=i.y;return e.x===n&&e.y===o}return!1}},{key:"cancel",value:function(e){e&&(e.canceled=!0,e.source_data&&e.source_data.request_id&&(Utils$1.cancelRequest(e.source_data.request_id),e.source_data.request_id=null),t.abortBuild(e))}},{key:"buildGeometry",value:function(e,r){var i=r.scene_id,n=r.layers,o=r.styles,a=r.global,s=r.sources,l=r.meshVariantMaxLife,c=e.source_data;for(var u in Collision.startTile(e.id,{apply_repeat_groups:!0}),n){var h=n[u];if(h&&h.config_data){if(h.config_data.source===e.source)for(var p=t._getDataForSource(c,h.config_data,u),f=0;f<p.length;f++){var d=p[f],y=d.geom;if(y)for(var g=0;g<y.features.length;g++){var v=y.features[g];if(null!=v.geometry){var m=StyleParser.getFeatureParseContext(v,e,a,s);m.winding=e.default_winding,m.source=e.source,m.layer=d.layer;var _=h.buildDrawGroups(m,!0);if(_)for(var b in _){var w=_[b],x=w.style||b,E=o[x];E?null!=(w=E.preprocess(w,e.source))&&!1!==w.visible&&(m.layers=w.layers,E.addFeature(v,w,m)):log("warn","Style '".concat(x,"' not found, skipping layer '").concat(u,"':"),w,v)}}}}}else log("warn","Layer ".concat(u," was defined without a geometry data source and will not be rendered."))}var T=t._stylesForTile(e,o);t._sendStyleGroups(e,T,{scene_id:i,meshVariantMaxLife:l},(function(t){return t.collision?"collision":"non-collision"}))}},{key:"_stylesForTile",value:function(t,e){var r=[];for(var i in e)e[i].hasDataForTile(t)&&r.push(e[i]);return r}},{key:"_sendStyleGroups",value:function(e,r,i,n){var o=i.scene_id,a=i.meshVariantMaxLife,s={};r.forEach((function(t){var e=n(t);s[e]=s[e]||[],s[e].push(t)})),0<Object.keys(s).length?function(){var r={start:!0};for(var i in e.mesh_data={},s)!function(i){var n=s[i];Promise.all(n.map((function(t){return t.endData(e)}))).then((function(){log("trace","Finished style group '".concat(i,"' for tile ").concat(e.key)),s[i]=[],Object.keys(s).every((function(t){return 0===s[t].length}))&&(r.done=!0),WorkerBroker.postMessage("TileManager_".concat(o,".buildTileStylesCompleted"),WorkerBroker.withTransferables({tile:t.slice(e,["mesh_data","selection_data"]),progress:r})),r.start=null,e.mesh_data={},e.selection_data={},r.done&&Collision.resetTile(e.id)}),(function(t){log("error","Error for style group '".concat(i,"' for tile ").concat(e.key),t)}))}(i);Style.updateMeshVariantTypeCache(a)}():(WorkerBroker.postMessage("TileManager_".concat(o,".buildTileStylesCompleted"),WorkerBroker.withTransferables({tile:t.slice(e),progress:{start:!0,done:!0}})),Collision.resetTile(e.id))}},{key:"_getDataForSource",value:function(t,e,r){var i=2<arguments.length&&void 0!==r?r:null,n=[];return null!=e&&null!=t&&null!=t.layers&&(!e.layer&&t.layers._default||"string"==typeof e.layer&&!t.layers[e.layer]&&new RegExp("^\\d+_"+e.layer+"$").test(i)&&t.layers._default?n.push({geom:t.layers._default}):!e.layer&&i?n.push({layer:i,geom:t.layers[i]}):"string"==typeof e.layer?n.push({layer:e.layer,geom:t.layers[e.layer]}):Array.isArray(e.layer)&&e.layer.forEach((function(e){t.layers[e]&&t.layers[e].features&&n.push({layer:e,geom:t.layers[e]})}))),n}},{key:"abortBuild",value:function(t,e){if(Task.removeForTile(t.id),Collision.abortTile(t.id),t.mesh_data)for(var r in t.mesh_data){var i=t.mesh_data[r].textures;i&&i.forEach((function(r){var i=getTextureManager(e).textures[r];i&&(log("trace","releasing texture ".concat(r," for tile ").concat(t.key)),i.release())}))}}},{key:"slice",value:function(t,e){var r=["id","key","loading","loaded","generation","error","debug"];Array.isArray(e)&&r.push.apply(r,_toConsumableArray(e));for(var i={},n=0;n<r.length;n++){var o=r[n];i[o]=t[o]}return i}}]),t}();Tile.coord_children={};var RasterTileSource=function(){_inherits(e,NetworkTileSource);var t=_createSuper(e);function e(r,i){var n;return _classCallCheck(this,e),-1===(n=t.call(this,r,i)).rasters.indexOf(n.name)&&n.rasters.unshift(n.name),n.filtering=r.filtering,n.textures={},n}return _createClass(e,[{key:"load",value:function(t){t.source_data={},t.source_data.layers={},t.pad_scale=this.pad_scale,t.rasters=_toConsumableArray(this.rasters);var e=Geo$1.tile_scale;return t.source_data.layers={_default:{type:"FeatureCollection",features:[{geometry:{type:"Polygon",coordinates:[[[0,0],[e,0],[e,-e],[0,-e],[0,0]]]},properties:{}}]}},t.default_winding="CW",Promise.resolve(t)}},{key:"tileTexture",value:function(t){var e,r,i=t.coords.key;return this.textures[i]||(e=Tile.coordinateWithMaxZoom(t.coords,this.max_zoom),r=this.formatUrl(this.url,{coords:e}),this.textures[i]={url:r,filtering:this.filtering,coords:e}),this.textures[i]}}]),e}(),ArrayUtils;DataSource.register(RasterTileSource,"Raster");var ArrayUtils$1=ArrayUtils={};function simplify(t,e,r,i){for(var n,o=i,a=r-e>>1,s=r-e,l=t[e],c=t[e+1],u=t[r],h=t[r+1],p=e+3;p<r;p+=3){var f,d=getSqSegDist(t[p],t[p+1],l,c,u,h);o<d?(n=p,o=d):d!==o||(f=Math.abs(p-a))<s&&(n=p,s=f)}i<o&&(3<n-e&&simplify(t,e,n,i),t[n+2]=o,3<r-n&&simplify(t,n,r,i))}function getSqSegDist(t,e,r,i,n,o){var a,s=n-r,l=o-i;return 0===s&&0===l||(1<(a=((t-r)*s+(e-i)*l)/(s*s+l*l))?(r=n,i=o):0<a&&(r+=s*a,i+=l*a)),(s=t-r)*s+(l=e-i)*l}function createFeature(t,e,r,i){var n={id:void 0===t?null:t,type:e,geometry:r,tags:i,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return calcBBox(n),n}function calcBBox(t){var e=t.geometry,r=t.type;if("Point"===r||"MultiPoint"===r||"LineString"===r)calcLineBBox(t,e);else if("Polygon"===r||"MultiLineString"===r)for(var i=0;i<e.length;i++)calcLineBBox(t,e[i]);else if("MultiPolygon"===r)for(i=0;i<e.length;i++)for(var n=0;n<e[i].length;n++)calcLineBBox(t,e[i][n])}function calcLineBBox(t,e){for(var r=0;r<e.length;r+=3)t.minX=Math.min(t.minX,e[r]),t.minY=Math.min(t.minY,e[r+1]),t.maxX=Math.max(t.maxX,e[r]),t.maxY=Math.max(t.maxY,e[r+1])}function convert(t,e){var r=[];if("FeatureCollection"===t.type)for(var i=0;i<t.features.length;i++)convertFeature(r,t.features[i],e,i);else"Feature"===t.type?convertFeature(r,t,e):convertFeature(r,{geometry:t},e);return r}function convertFeature(t,e,r,i){if(e.geometry){var n=e.geometry.coordinates,o=e.geometry.type,a=Math.pow(r.tolerance/((1<<r.maxZoom)*r.extent),2),s=[],l=e.id;if(r.promoteId?l=e.properties[r.promoteId]:r.generateId&&(l=i||0),"Point"===o)convertPoint(n,s);else if("MultiPoint"===o)for(var c=0;c<n.length;c++)convertPoint(n[c],s);else if("LineString"===o)convertLine(n,s,a,!1);else if("MultiLineString"===o){if(r.lineMetrics){for(c=0;c<n.length;c++)s=[],convertLine(n[c],s,a,!1),t.push(createFeature(l,"LineString",s,e.properties));return}convertLines(n,s,a,!1)}else if("Polygon"===o)convertLines(n,s,a,!0);else{if("MultiPolygon"!==o){if("GeometryCollection"!==o)throw new Error("Input data is not a valid GeoJSON object.");for(c=0;c<e.geometry.geometries.length;c++)convertFeature(t,{id:l,geometry:e.geometry.geometries[c],properties:e.properties},r,i);return}for(c=0;c<n.length;c++){var u=[];convertLines(n[c],u,a,!0),s.push(u)}}t.push(createFeature(l,o,s,e.properties))}}function convertPoint(t,e){e.push(projectX(t[0])),e.push(projectY(t[1])),e.push(0)}function convertLine(t,e,r,i){for(var n,o,a=0,s=0;s<t.length;s++){var l=projectX(t[s][0]),c=projectY(t[s][1]);e.push(l),e.push(c),e.push(0),0<s&&(a+=i?(n*c-l*o)/2:Math.sqrt(Math.pow(l-n,2)+Math.pow(c-o,2))),n=l,o=c}var u=e.length-3;e[2]=1,simplify(e,0,u,r),e[2+u]=1,e.size=Math.abs(a),e.start=0,e.end=e.size}function convertLines(t,e,r,i){for(var n=0;n<t.length;n++){var o=[];convertLine(t[n],o,r,i),e.push(o)}}function projectX(t){return t/360+.5}function projectY(t){var e=Math.sin(t*Math.PI/180),r=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return r<0?0:1<r?1:r}function clip(t,e,r,i,n,o,a,s){if(i/=e,(r/=e)<=o&&a<i)return t;if(a<r||i<=o)return null;for(var l=[],c=0;c<t.length;c++){var u=t[c],h=u.geometry,p=u.type,f=0===n?u.minX:u.minY,d=0===n?u.maxX:u.maxY;if(r<=f&&d<i)l.push(u);else if(!(d<r||i<=f)){var y=[];if("Point"===p||"MultiPoint"===p)clipPoints(h,y,r,i,n);else if("LineString"===p)clipLine(h,y,r,i,n,!1,s.lineMetrics);else if("MultiLineString"===p)clipLines(h,y,r,i,n,!1);else if("Polygon"===p)clipLines(h,y,r,i,n,!0);else if("MultiPolygon"===p)for(var g=0;g<h.length;g++){var v=[];clipLines(h[g],v,r,i,n,!0),v.length&&y.push(v)}if(y.length){if(s.lineMetrics&&"LineString"===p){for(g=0;g<y.length;g++)l.push(createFeature(u.id,p,y[g],u.tags));continue}"LineString"!==p&&"MultiLineString"!==p||(1===y.length?(p="LineString",y=y[0]):p="MultiLineString"),"Point"!==p&&"MultiPoint"!==p||(p=3===y.length?"Point":"MultiPoint"),l.push(createFeature(u.id,p,y,u.tags))}}}return l.length?l:null}function clipPoints(t,e,r,i,n){for(var o=0;o<t.length;o+=3){var a=t[o+n];r<=a&&a<=i&&(e.push(t[o]),e.push(t[o+1]),e.push(t[o+2]))}}function clipLine(t,e,r,i,n,o,a){for(var s,l,c=newSlice(t),u=0===n?intersectX:intersectY,h=t.start,p=0;p<t.length-3;p+=3){var f=t[p],d=t[p+1],y=t[p+2],g=t[p+3],v=t[p+4],m=0===n?f:d,_=0===n?g:v,b=!1;a&&(s=Math.sqrt(Math.pow(f-g,2)+Math.pow(d-v,2))),m<r?r<_&&(l=u(c,f,d,g,v,r),a&&(c.start=h+s*l)):i<m?_<i&&(l=u(c,f,d,g,v,i),a&&(c.start=h+s*l)):addPoint(c,f,d,y),_<r&&r<=m&&(l=u(c,f,d,g,v,r),b=!0),i<_&&m<=i&&(l=u(c,f,d,g,v,i),b=!0),!o&&b&&(a&&(c.end=h+s*l),e.push(c),c=newSlice(t)),a&&(h+=s)}var w=t.length-3;f=t[w],d=t[w+1],y=t[w+2],r<=(m=0===n?f:d)&&m<=i&&addPoint(c,f,d,y),w=c.length-3,o&&3<=w&&(c[w]!==c[0]||c[w+1]!==c[1])&&addPoint(c,c[0],c[1],c[2]),c.length&&e.push(c)}function newSlice(t){var e=[];return e.size=t.size,e.start=t.start,e.end=t.end,e}function clipLines(t,e,r,i,n,o){for(var a=0;a<t.length;a++)clipLine(t[a],e,r,i,n,o,!1)}function addPoint(t,e,r,i){t.push(e),t.push(r),t.push(i)}function intersectX(t,e,r,i,n,o){var a=(o-e)/(i-e);return t.push(o),t.push(r+(n-r)*a),t.push(1),a}function intersectY(t,e,r,i,n,o){var a=(o-r)/(n-r);return t.push(e+(i-e)*a),t.push(o),t.push(1),a}function wrap(t,e){var r=e.buffer/e.extent,i=t,n=clip(t,1,-1-r,r,0,-1,2,e),o=clip(t,1,1-r,2+r,0,-1,2,e);return(n||o)&&(i=clip(t,1,-r,1+r,0,-1,2,e)||[],n&&(i=shiftFeatureCoords(n,1).concat(i)),o&&(i=i.concat(shiftFeatureCoords(o,-1)))),i}function shiftFeatureCoords(t,e){for(var r=[],i=0;i<t.length;i++){var n,o=t[i],a=o.type;if("Point"===a||"MultiPoint"===a||"LineString"===a)n=shiftCoords(o.geometry,e);else if("MultiLineString"===a||"Polygon"===a){n=[];for(var s=0;s<o.geometry.length;s++)n.push(shiftCoords(o.geometry[s],e))}else if("MultiPolygon"===a)for(n=[],s=0;s<o.geometry.length;s++){for(var l=[],c=0;c<o.geometry[s].length;c++)l.push(shiftCoords(o.geometry[s][c],e));n.push(l)}r.push(createFeature(o.id,a,n,o.tags))}return r}function shiftCoords(t,e){var r=[];r.size=t.size,void 0!==t.start&&(r.start=t.start,r.end=t.end);for(var i=0;i<t.length;i+=3)r.push(t[i]+e,t[i+1],t[i+2]);return r}function transformTile(t,e){if(t.transformed)return t;for(var r,i=1<<t.z,n=t.x,o=t.y,a=0;a<t.features.length;a++){var s=t.features[a],l=s.geometry,c=s.type;if(s.geometry=[],1===c)for(r=0;r<l.length;r+=2)s.geometry.push(transformPoint(l[r],l[r+1],e,i,n,o));else for(r=0;r<l.length;r++){for(var u=[],h=0;h<l[r].length;h+=2)u.push(transformPoint(l[r][h],l[r][h+1],e,i,n,o));s.geometry.push(u)}}return t.transformed=!0,t}function transformPoint(t,e,r,i,n,o){return[Math.round(r*(t*i-n)),Math.round(r*(e*i-o))]}function createTile(t,e,r,i,n){for(var o=e===n.maxZoom?0:n.tolerance/((1<<e)*n.extent),a={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:r,y:i,z:e,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},s=0;s<t.length;s++){a.numFeatures++,addFeature(a,t[s],o,n);var l=t[s].minX,c=t[s].minY,u=t[s].maxX,h=t[s].maxY;l<a.minX&&(a.minX=l),c<a.minY&&(a.minY=c),u>a.maxX&&(a.maxX=u),h>a.maxY&&(a.maxY=h)}return a}function addFeature(t,e,r,i){var n=e.geometry,o=e.type,a=[];if("Point"===o||"MultiPoint"===o)for(var s=0;s<n.length;s+=3)a.push(n[s]),a.push(n[s+1]),t.numPoints++,t.numSimplified++;else if("LineString"===o)addLine(a,n,t,r,!1,!1);else if("MultiLineString"===o||"Polygon"===o)for(s=0;s<n.length;s++)addLine(a,n[s],t,r,"Polygon"===o,0===s);else if("MultiPolygon"===o)for(var l=0;l<n.length;l++){var c=n[l];for(s=0;s<c.length;s++)addLine(a,c[s],t,r,!0,0===s)}if(a.length){var u=e.tags||null;if("LineString"===o&&i.lineMetrics){for(var h in u={},e.tags)u[h]=e.tags[h];u.mapbox_clip_start=n.start/n.size,u.mapbox_clip_end=n.end/n.size}var p={geometry:a,type:"Polygon"===o||"MultiPolygon"===o?3:"LineString"===o||"MultiLineString"===o?2:1,tags:u};null!==e.id&&(p.id=e.id),t.features.push(p)}}function addLine(t,e,r,i,n,o){var a=i*i;if(0<i&&e.size<(n?a:i))r.numPoints+=e.length/3;else{for(var s=[],l=0;l<e.length;l+=3)(0===i||e[l+2]>a)&&(r.numSimplified++,s.push(e[l]),s.push(e[l+1])),r.numPoints++;n&&rewind(s,o),t.push(s)}}function rewind(t,e){for(var r=0,i=0,n=t.length,o=n-2;i<n;o=i,i+=2)r+=(t[i]-t[o])*(t[i+1]+t[o+1]);if(0<r===e)for(i=0,n=t.length;i<n/2;i+=2){var a=t[i],s=t[i+1];t[i]=t[n-2-i],t[i+1]=t[n-1-i],t[n-2-i]=a,t[n-1-i]=s}}ArrayUtils.deepClone=function(t){return Array.isArray(t)?t.map(ArrayUtils.deepClone):t};var defaults={maxZoom:14,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1};function createGeoJsonTile(t,e,r,i,n){var o=Object.assign({},defaults,n),a=convert(t,o),s=getBBox(a=wrap(a,o)),l=s.minX,c=s.minY,u=s.maxX,h=s.maxY,p=1<<e,f=o.buffer/o.extent,d=1+f;return a=clip(a,p,r-f,r+d,0,l,u,o)||[],transformTile(createTile(a=clip(a,p,i-f,i+d,1,c,h,o)||[],e,r,i,o),o.extent)}function getBBox(t){var e,r=2,i=-1,n=1,o=0,a=_createForOfIteratorHelper(t);try{for(a.s();!(e=a.n()).done;){var s=e.value;s.minX<r&&(r=s.minX),s.maxX>i&&(i=s.maxX),s.minY<n&&(n=s.minY),s.maxY>o&&(o=s.maxY)}}catch(t){a.e(t)}finally{a.f()}return{minX:r,maxX:i,minY:n,maxY:o}}function PackingSmith(t,e){this.items=[],this.algorithm=t;var r=void 0===(e=e||{}).sort||e.sort;this.sort=r}PackingSmith.prototype={addItem:function(t){this.items.push(t)},normalizeCoordinates:function(){var t=this.items,e=1/0,r=1/0;t.forEach((function(t){var i=t;e=Math.min(e,i.x),r=Math.min(r,i.y)})),t.forEach((function(t){var i=t;i.x-=e,i.y-=r}))},getStats:function(){var t=this.items.map((function(t){return t})),e=t.map((function(t){return t.x})),r=t.map((function(t){return t.y})),i=t.map((function(t){return t.x+t.width})),n=t.map((function(t){return t.y+t.height}));return{minX:Math.max.apply(Math,e),minY:Math.max.apply(Math,r),maxX:Math.max.apply(Math,i),maxY:Math.max.apply(Math,n)}},getItems:function(){return this.items},processItems:function(){var t=this.items;return this.sort&&(t=this.algorithm.sort(t)),t=this.algorithm.placeItems(t),this.items=t},exportItems:function(){return this.processItems(),this.normalizeCoordinates(),this.items},export:function(){var t=this.exportItems(),e=this.getStats();return{height:e.maxY,width:e.maxX,items:t}}};var packing_smith=PackingSmith,lookup=[],revLookup=[],Arr="undefined"!=typeof Uint8Array?Uint8Array:Array,inited=!1;function init(){inited=!0;for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e=0;e<64;++e)lookup[e]=t[e],revLookup[t.charCodeAt(e)]=e;revLookup["-".charCodeAt(0)]=62,revLookup["_".charCodeAt(0)]=63}function toByteArray(t){var e,r,i,n;inited||init();var o=t.length;if(0<o%4)throw new Error("Invalid string. Length must be a multiple of 4");i="="===t[o-2]?2:"="===t[o-1]?1:0,n=new Arr(3*o/4-i),e=0<i?o-4:o;for(var a=0,s=0;s<e;s+=4,0)r=revLookup[t.charCodeAt(s)]<<18|revLookup[t.charCodeAt(s+1)]<<12|revLookup[t.charCodeAt(s+2)]<<6|revLookup[t.charCodeAt(s+3)],n[a++]=r>>16&255,n[a++]=r>>8&255,n[a++]=255&r;return 2==i?(r=revLookup[t.charCodeAt(s)]<<2|revLookup[t.charCodeAt(s+1)]>>4,n[a++]=255&r):1==i&&(r=revLookup[t.charCodeAt(s)]<<10|revLookup[t.charCodeAt(s+1)]<<4|revLookup[t.charCodeAt(s+2)]>>2,n[a++]=r>>8&255,n[a++]=255&r),n}function tripletToBase64(t){return lookup[t>>18&63]+lookup[t>>12&63]+lookup[t>>6&63]+lookup[63&t]}function encodeChunk(t,e,r){for(var i,n=[],o=e;o<r;o+=3)i=(t[o]<<16)+(t[o+1]<<8)+t[o+2],n.push(tripletToBase64(i));return n.join("")}function fromByteArray(t){var e;inited||init();for(var r=t.length,i=r%3,n="",o=[],a=0,s=r-i;a<s;a+=16383)o.push(encodeChunk(t,a,s<a+16383?s:a+16383));return 1==i?(e=t[r-1],n+=lookup[e>>2],n+=lookup[e<<4&63],n+="=="):2==i&&(e=(t[r-2]<<8)+t[r-1],n+=lookup[e>>10],n+=lookup[e>>4&63],n+=lookup[e<<2&63],n+="="),o.push(n),o.join("")}var base64$1=Object.freeze({toByteArray,fromByteArray});function read$1(t,e,r,i,n){var o,a,s=8*n-i-1,l=(1<<s)-1,c=l>>1,u=-7,h=r?n-1:0,p=r?-1:1,f=t[e+h];for(h+=p,o=f&(1<<-u)-1,f>>=-u,u+=s;0<u;o=256*o+t[e+h],h+=p,u-=8);for(a=o&(1<<-u)-1,o>>=-u,u+=i;0<u;a=256*a+t[e+h],h+=p,u-=8);if(0===o)o=1-c;else{if(o===l)return a?NaN:1/0*(f?-1:1);a+=Math.pow(2,i),o-=c}return(f?-1:1)*a*Math.pow(2,o-i)}function write$1(t,e,r,i,n,o){var a,s,l,c=8*o-n-1,u=(1<<c)-1,h=u>>1,p=23===n?Math.pow(2,-24)-Math.pow(2,-77):0,f=i?0:o-1,d=i?1:-1,y=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=u):(a=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-a))<1&&(a--,l*=2),2<=(e+=1<=a+h?p/l:p*Math.pow(2,1-h))*l&&(a++,l/=2),u<=a+h?(s=0,a=u):1<=a+h?(s=(e*l-1)*Math.pow(2,n),a+=h):(s=e*Math.pow(2,h-1)*Math.pow(2,n),a=0));8<=n;t[r+f]=255&s,f+=d,s/=256,n-=8);for(a=a<<n|s,c+=n;0<c;t[r+f]=255&a,f+=d,a/=256,c-=8);t[r+f-d]|=128*y}var toString$1={}.toString,isArray=Array.isArray||function(t){return"[object Array]"==toString$1.call(t)},INSPECT_MAX_BYTES=50;Buffer.TYPED_ARRAY_SUPPORT=void 0===global$1.TYPED_ARRAY_SUPPORT||global$1.TYPED_ARRAY_SUPPORT;var _kMaxLength=kMaxLength();function kMaxLength(){return Buffer.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function createBuffer(t,e){if(kMaxLength()<e)throw new RangeError("Invalid typed array length");return Buffer.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=Buffer.prototype:(null===t&&(t=new Buffer(e)),t.length=e),t}function Buffer(t,e,r){if(!(Buffer.TYPED_ARRAY_SUPPORT||this instanceof Buffer))return new Buffer(t,e,r);if("number"!=typeof t)return from(this,t,e,r);if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return allocUnsafe(this,t)}function from(t,e,r,i){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?fromArrayBuffer(t,e,r,i):"string"==typeof e?fromString$1(t,e,r):fromObject(t,e)}function assertSize(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function alloc(t,e,r,i){return assertSize(e),e<=0||void 0===r?createBuffer(t,e):"string"==typeof i?createBuffer(t,e).fill(r,i):createBuffer(t,e).fill(r)}function allocUnsafe(t,e){if(assertSize(e),t=createBuffer(t,e<0?0:0|checked(e)),!Buffer.TYPED_ARRAY_SUPPORT)for(var r=0;r<e;++r)t[r]=0;return t}function fromString$1(t,e,r){if("string"==typeof r&&""!==r||(r="utf8"),!Buffer.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var i=0|byteLength(e,r),n=(t=createBuffer(t,i)).write(e,r);return n!==i&&(t=t.slice(0,n)),t}function fromArrayLike(t,e){var r=e.length<0?0:0|checked(e.length);t=createBuffer(t,r);for(var i=0;i<r;i+=1)t[i]=255&e[i];return t}function fromArrayBuffer(t,e,r,i){if(e.byteLength,r<0||e.byteLength<r)throw new RangeError("'offset' is out of bounds");if(e.byteLength<r+(i||0))throw new RangeError("'length' is out of bounds");return e=void 0===r&&void 0===i?new Uint8Array(e):void 0===i?new Uint8Array(e,r):new Uint8Array(e,r,i),Buffer.TYPED_ARRAY_SUPPORT?(t=e).__proto__=Buffer.prototype:t=fromArrayLike(t,e),t}function fromObject(t,e){if(internalIsBuffer(e)){var r=0|checked(e.length);return 0===(t=createBuffer(t,r)).length||e.copy(t,0,0,r),t}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||isnan(e.length)?createBuffer(t,0):fromArrayLike(t,e);if("Buffer"===e.type&&isArray(e.data))return fromArrayLike(t,e.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function checked(t){if(t>=kMaxLength())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+kMaxLength().toString(16)+" bytes");return 0|t}function SlowBuffer(t){return+t!=t&&(t=0),Buffer.alloc(+t)}function internalIsBuffer(t){return null!=t&&t._isBuffer}function byteLength(t,e){if(internalIsBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var r=t.length;if(0===r)return 0;for(var i=!1;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return utf8ToBytes(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return base64ToBytes(t).length;default:if(i)return utf8ToBytes(t).length;e=(""+e).toLowerCase(),i=!0}}function slowToString(t,e,r){var i=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(e>>>=0))return"";for(t=t||"utf8";;)switch(t){case"hex":return hexSlice(this,e,r);case"utf8":case"utf-8":return utf8Slice(this,e,r);case"ascii":return asciiSlice(this,e,r);case"latin1":case"binary":return latin1Slice(this,e,r);case"base64":return base64Slice(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return utf16leSlice(this,e,r);default:if(i)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),i=!0}}function swap(t,e,r){var i=t[e];t[e]=t[r],t[r]=i}function bidirectionalIndexOf(t,e,r,i,n){if(0===t.length)return-1;if("string"==typeof r?(i=r,r=0):2147483647<r?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=n?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(n)return-1;r=t.length-1}else if(r<0){if(!n)return-1;r=0}if("string"==typeof e&&(e=Buffer.from(e,i)),internalIsBuffer(e))return 0===e.length?-1:arrayIndexOf$1(t,e,r,i,n);if("number"==typeof e)return e&=255,Buffer.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?n?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):arrayIndexOf$1(t,[e],r,i,n);throw new TypeError("val must be string, number or Buffer")}function arrayIndexOf$1(t,e,r,i,n){var o=1,a=t.length,s=e.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(t.length<2||e.length<2)return-1;a/=o=2,s/=2,r/=2}function l(t,e){return 1===o?t[e]:t.readUInt16BE(e*o)}if(n)for(var c=-1,u=r;u<a;u++)if(l(t,u)===l(e,-1===c?0:u-c)){if(-1===c&&(c=u),u-c+1===s)return c*o}else-1!==c&&(u-=u-c),c=-1;else for(a<r+s&&(r=a-s),u=r;0<=u;u--){for(var h=!0,p=0;p<s;p++)if(l(t,u+p)!==l(e,p)){h=!1;break}if(h)return u}return-1}function hexWrite(t,e,r,i){r=Number(r)||0;var n=t.length-r;(!i||n<(i=Number(i)))&&(i=n);var o=e.length;if(o%2!=0)throw new TypeError("Invalid hex string");o/2<i&&(i=o/2);for(var a=0;a<i;++a){var s=parseInt(e.substr(2*a,2),16);if(isNaN(s))return a;t[r+a]=s}return a}function utf8Write(t,e,r,i){return blitBuffer(utf8ToBytes(e,t.length-r),t,r,i)}function asciiWrite(t,e,r,i){return blitBuffer(asciiToBytes(e),t,r,i)}function latin1Write(t,e,r,i){return asciiWrite(t,e,r,i)}function base64Write(t,e,r,i){return blitBuffer(base64ToBytes(e),t,r,i)}function ucs2Write(t,e,r,i){return blitBuffer(utf16leToBytes(e,t.length-r),t,r,i)}function base64Slice(t,e,r){return 0===e&&r===t.length?fromByteArray(t):fromByteArray(t.slice(e,r))}function utf8Slice(t,e,r){r=Math.min(t.length,r);for(var i=[],n=e;n<r;){var o,a,s,l,c=t[n],u=null,h=239<c?4:223<c?3:191<c?2:1;if(n+h<=r)switch(h){case 1:c<128&&(u=c);break;case 2:128==(192&(o=t[n+1]))&&127<(l=(31&c)<<6|63&o)&&(u=l);break;case 3:o=t[n+1],a=t[n+2],128==(192&o)&&128==(192&a)&&2047<(l=(15&c)<<12|(63&o)<<6|63&a)&&(l<55296||57343<l)&&(u=l);break;case 4:o=t[n+1],a=t[n+2],s=t[n+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&65535<(l=(15&c)<<18|(63&o)<<12|(63&a)<<6|63&s)&&l<1114112&&(u=l)}null===u?(u=65533,h=1):65535<u&&(u-=65536,i.push(u>>>10&1023|55296),u=56320|1023&u),i.push(u),n+=h}return decodeCodePointsArray(i)}Buffer.poolSize=8192,Buffer._augment=function(t){return t.__proto__=Buffer.prototype,t},Buffer.from=function(t,e,r){return from(null,t,e,r)},Buffer.TYPED_ARRAY_SUPPORT&&(Buffer.prototype.__proto__=Uint8Array.prototype,Buffer.__proto__=Uint8Array),Buffer.alloc=function(t,e,r){return alloc(null,t,e,r)},Buffer.allocUnsafe=function(t){return allocUnsafe(null,t)},Buffer.allocUnsafeSlow=function(t){return allocUnsafe(null,t)},Buffer.isBuffer=isBuffer,Buffer.compare=function(t,e){if(!internalIsBuffer(t)||!internalIsBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var r=t.length,i=e.length,n=0,o=Math.min(r,i);n<o;++n)if(t[n]!==e[n]){r=t[n],i=e[n];break}return r<i?-1:i<r?1:0},Buffer.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Buffer.concat=function(t,e){if(!isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return Buffer.alloc(0);if(void 0===e)for(n=e=0;n<t.length;++n)e+=t[n].length;for(var r=Buffer.allocUnsafe(e),i=0,n=0;n<t.length;++n){var o=t[n];if(!internalIsBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(r,i),i+=o.length}return r},Buffer.byteLength=byteLength,Buffer.prototype._isBuffer=!0,Buffer.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)swap(this,e,e+1);return this},Buffer.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)swap(this,e,e+3),swap(this,e+1,e+2);return this},Buffer.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)swap(this,e,e+7),swap(this,e+1,e+6),swap(this,e+2,e+5),swap(this,e+3,e+4);return this},Buffer.prototype.toString=function(){var t=0|this.length;return 0==t?"":0===arguments.length?utf8Slice(this,0,t):slowToString.apply(this,arguments)},Buffer.prototype.equals=function(t){if(!internalIsBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===Buffer.compare(this,t)},Buffer.prototype.inspect=function(){var t="",e=INSPECT_MAX_BYTES;return 0<this.length&&(t=this.toString("hex",0,e).match(/.{2}/g).join(" "),this.length>e&&(t+=" ... ")),"<Buffer "+t+">"},Buffer.prototype.compare=function(t,e,r,i,n){if(!internalIsBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===r&&(r=t?t.length:0),void 0===i&&(i=0),void 0===n&&(n=this.length),e<0||r>t.length||i<0||n>this.length)throw new RangeError("out of range index");if(n<=i&&r<=e)return 0;if(n<=i)return-1;if(r<=e)return 1;if(this===t)return 0;for(var o=(n>>>=0)-(i>>>=0),a=(r>>>=0)-(e>>>=0),s=Math.min(o,a),l=this.slice(i,n),c=t.slice(e,r),u=0;u<s;++u)if(l[u]!==c[u]){o=l[u],a=c[u];break}return o<a?-1:a<o?1:0},Buffer.prototype.includes=function(t,e,r){return-1!==this.indexOf(t,e,r)},Buffer.prototype.indexOf=function(t,e,r){return bidirectionalIndexOf(this,t,e,r,!0)},Buffer.prototype.lastIndexOf=function(t,e,r){return bidirectionalIndexOf(this,t,e,r,!1)},Buffer.prototype.write=function(t,e,r,i){if(void 0===e)i="utf8",r=this.length,e=0;else if(void 0===r&&"string"==typeof e)i=e,r=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(r)?(r|=0,void 0===i&&(i="utf8")):(i=r,r=void 0)}var n=this.length-e;if((void 0===r||n<r)&&(r=n),0<t.length&&(r<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");i=i||"utf8";for(var o=!1;;)switch(i){case"hex":return hexWrite(this,t,e,r);case"utf8":case"utf-8":return utf8Write(this,t,e,r);case"ascii":return asciiWrite(this,t,e,r);case"latin1":case"binary":return latin1Write(this,t,e,r);case"base64":return base64Write(this,t,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ucs2Write(this,t,e,r);default:if(o)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),o=!0}},Buffer.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var MAX_ARGUMENTS_LENGTH=4096;function decodeCodePointsArray(t){var e=t.length;if(e<=MAX_ARGUMENTS_LENGTH)return String.fromCharCode.apply(String,t);for(var r="",i=0;i<e;)r+=String.fromCharCode.apply(String,t.slice(i,i+=MAX_ARGUMENTS_LENGTH));return r}function asciiSlice(t,e,r){var i="";r=Math.min(t.length,r);for(var n=e;n<r;++n)i+=String.fromCharCode(127&t[n]);return i}function latin1Slice(t,e,r){var i="";r=Math.min(t.length,r);for(var n=e;n<r;++n)i+=String.fromCharCode(t[n]);return i}function hexSlice(t,e,r){var i=t.length;(!e||e<0)&&(e=0),(!r||r<0||i<r)&&(r=i);for(var n="",o=e;o<r;++o)n+=toHex(t[o]);return n}function utf16leSlice(t,e,r){for(var i=t.slice(e,r),n="",o=0;o<i.length;o+=2)n+=String.fromCharCode(i[o]+256*i[o+1]);return n}function checkOffset(t,e,r){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(r<t+e)throw new RangeError("Trying to access beyond buffer length")}function checkInt(t,e,r,i,n,o){if(!internalIsBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(n<e||e<o)throw new RangeError('"value" argument is out of bounds');if(r+i>t.length)throw new RangeError("Index out of range")}function objectWriteUInt16(t,e,r,i){e<0&&(e=65535+e+1);for(var n=0,o=Math.min(t.length-r,2);n<o;++n)t[r+n]=(e&255<<8*(i?n:1-n))>>>8*(i?n:1-n)}function objectWriteUInt32(t,e,r,i){e<0&&(e=4294967295+e+1);for(var n=0,o=Math.min(t.length-r,4);n<o;++n)t[r+n]=e>>>8*(i?n:3-n)&255}function checkIEEE754(t,e,r,i,n,o){if(r+i>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function writeFloat(t,e,r,i,n){return n||checkIEEE754(t,e,r,4,34028234663852886e22,-34028234663852886e22),write$1(t,e,r,i,23,4),r+4}function writeDouble(t,e,r,i,n){return n||checkIEEE754(t,e,r,8,17976931348623157e292,-17976931348623157e292),write$1(t,e,r,i,52,8),r+8}Buffer.prototype.slice=function(t,e){var r=this.length;if((t=~~t)<0?(t+=r)<0&&(t=0):r<t&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):r<e&&(e=r),e<t&&(e=t),Buffer.TYPED_ARRAY_SUPPORT)(n=this.subarray(t,e)).__proto__=Buffer.prototype;else for(var i=e-t,n=new Buffer(i,void 0),o=0;o<i;++o)n[o]=this[o+t];return n},Buffer.prototype.readUIntLE=function(t,e,r){t|=0,e|=0,r||checkOffset(t,e,this.length);for(var i=this[t],n=1,o=0;++o<e&&(n*=256);)i+=this[t+o]*n;return i},Buffer.prototype.readUIntBE=function(t,e,r){t|=0,e|=0,r||checkOffset(t,e,this.length);for(var i=this[t+--e],n=1;0<e&&(n*=256);)i+=this[t+--e]*n;return i},Buffer.prototype.readUInt8=function(t,e){return e||checkOffset(t,1,this.length),this[t]},Buffer.prototype.readUInt16LE=function(t,e){return e||checkOffset(t,2,this.length),this[t]|this[t+1]<<8},Buffer.prototype.readUInt16BE=function(t,e){return e||checkOffset(t,2,this.length),this[t]<<8|this[t+1]},Buffer.prototype.readUInt32LE=function(t,e){return e||checkOffset(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},Buffer.prototype.readUInt32BE=function(t,e){return e||checkOffset(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},Buffer.prototype.readIntLE=function(t,e,r){t|=0,e|=0,r||checkOffset(t,e,this.length);for(var i=this[t],n=1,o=0;++o<e&&(n*=256);)i+=this[t+o]*n;return(n*=128)<=i&&(i-=Math.pow(2,8*e)),i},Buffer.prototype.readIntBE=function(t,e,r){t|=0,e|=0,r||checkOffset(t,e,this.length);for(var i=e,n=1,o=this[t+--i];0<i&&(n*=256);)o+=this[t+--i]*n;return(n*=128)<=o&&(o-=Math.pow(2,8*e)),o},Buffer.prototype.readInt8=function(t,e){return e||checkOffset(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},Buffer.prototype.readInt16LE=function(t,e){e||checkOffset(t,2,this.length);var r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},Buffer.prototype.readInt16BE=function(t,e){e||checkOffset(t,2,this.length);var r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},Buffer.prototype.readInt32LE=function(t,e){return e||checkOffset(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},Buffer.prototype.readInt32BE=function(t,e){return e||checkOffset(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},Buffer.prototype.readFloatLE=function(t,e){return e||checkOffset(t,4,this.length),read$1(this,t,!0,23,4)},Buffer.prototype.readFloatBE=function(t,e){return e||checkOffset(t,4,this.length),read$1(this,t,!1,23,4)},Buffer.prototype.readDoubleLE=function(t,e){return e||checkOffset(t,8,this.length),read$1(this,t,!0,52,8)},Buffer.prototype.readDoubleBE=function(t,e){return e||checkOffset(t,8,this.length),read$1(this,t,!1,52,8)},Buffer.prototype.writeUIntLE=function(t,e,r,i){t=+t,e|=0,r|=0,i||checkInt(this,t,e,r,Math.pow(2,8*r)-1,0);var n=1,o=0;for(this[e]=255&t;++o<r&&(n*=256);)this[e+o]=t/n&255;return e+r},Buffer.prototype.writeUIntBE=function(t,e,r,i){t=+t,e|=0,r|=0,i||checkInt(this,t,e,r,Math.pow(2,8*r)-1,0);var n=r-1,o=1;for(this[e+n]=255&t;0<=--n&&(o*=256);)this[e+n]=t/o&255;return e+r},Buffer.prototype.writeUInt8=function(t,e,r){return t=+t,e|=0,r||checkInt(this,t,e,1,255,0),Buffer.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},Buffer.prototype.writeUInt16LE=function(t,e,r){return t=+t,e|=0,r||checkInt(this,t,e,2,65535,0),Buffer.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):objectWriteUInt16(this,t,e,!0),e+2},Buffer.prototype.writeUInt16BE=function(t,e,r){return t=+t,e|=0,r||checkInt(this,t,e,2,65535,0),Buffer.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):objectWriteUInt16(this,t,e,!1),e+2},Buffer.prototype.writeUInt32LE=function(t,e,r){return t=+t,e|=0,r||checkInt(this,t,e,4,4294967295,0),Buffer.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):objectWriteUInt32(this,t,e,!0),e+4},Buffer.prototype.writeUInt32BE=function(t,e,r){return t=+t,e|=0,r||checkInt(this,t,e,4,4294967295,0),Buffer.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):objectWriteUInt32(this,t,e,!1),e+4},Buffer.prototype.writeIntLE=function(t,e,r,i){var n;t=+t,e|=0,i||checkInt(this,t,e,r,(n=Math.pow(2,8*r-1))-1,-n);var o=0,a=1,s=0;for(this[e]=255&t;++o<r&&(a*=256);)t<0&&0===s&&0!==this[e+o-1]&&(s=1),this[e+o]=(t/a>>0)-s&255;return e+r},Buffer.prototype.writeIntBE=function(t,e,r,i){var n;t=+t,e|=0,i||checkInt(this,t,e,r,(n=Math.pow(2,8*r-1))-1,-n);var o=r-1,a=1,s=0;for(this[e+o]=255&t;0<=--o&&(a*=256);)t<0&&0===s&&0!==this[e+o+1]&&(s=1),this[e+o]=(t/a>>0)-s&255;return e+r},Buffer.prototype.writeInt8=function(t,e,r){return t=+t,e|=0,r||checkInt(this,t,e,1,127,-128),Buffer.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},Buffer.prototype.writeInt16LE=function(t,e,r){return t=+t,e|=0,r||checkInt(this,t,e,2,32767,-32768),Buffer.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):objectWriteUInt16(this,t,e,!0),e+2},Buffer.prototype.writeInt16BE=function(t,e,r){return t=+t,e|=0,r||checkInt(this,t,e,2,32767,-32768),Buffer.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):objectWriteUInt16(this,t,e,!1),e+2},Buffer.prototype.writeInt32LE=function(t,e,r){return t=+t,e|=0,r||checkInt(this,t,e,4,2147483647,-2147483648),Buffer.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):objectWriteUInt32(this,t,e,!0),e+4},Buffer.prototype.writeInt32BE=function(t,e,r){return t=+t,e|=0,r||checkInt(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),Buffer.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):objectWriteUInt32(this,t,e,!1),e+4},Buffer.prototype.writeFloatLE=function(t,e,r){return writeFloat(this,t,e,!0,r)},Buffer.prototype.writeFloatBE=function(t,e,r){return writeFloat(this,t,e,!1,r)},Buffer.prototype.writeDoubleLE=function(t,e,r){return writeDouble(this,t,e,!0,r)},Buffer.prototype.writeDoubleBE=function(t,e,r){return writeDouble(this,t,e,!1,r)},Buffer.prototype.copy=function(t,e,r,i){if(r=r||0,i||0===i||(i=this.length),e>=t.length&&(e=t.length),e=e||0,0<i&&i<r&&(i=r),i===r)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),t.length-e<i-r&&(i=t.length-e+r);var n,o=i-r;if(this===t&&r<e&&e<i)for(n=o-1;0<=n;--n)t[n+e]=this[n+r];else if(o<1e3||!Buffer.TYPED_ARRAY_SUPPORT)for(n=0;n<o;++n)t[n+e]=this[n+r];else Uint8Array.prototype.set.call(t,this.subarray(r,r+o),e);return o},Buffer.prototype.fill=function(t,e,r,i){if("string"==typeof t){var n;if("string"==typeof e?(i=e,e=0,r=this.length):"string"==typeof r&&(i=r,r=this.length),1!==t.length||(n=t.charCodeAt(0))<256&&(t=n),void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!Buffer.isEncoding(i))throw new TypeError("Unknown encoding: "+i)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<r)throw new RangeError("Out of range index");if(r<=e)return this;if(e>>>=0,r=void 0===r?this.length:r>>>0,"number"==typeof(t=t||0))for(s=e;s<r;++s)this[s]=t;else for(var o=internalIsBuffer(t)?t:utf8ToBytes(new Buffer(t,i).toString()),a=o.length,s=0;s<r-e;++s)this[s+e]=o[s%a];return this};var INVALID_BASE64_RE=/[^+\/0-9A-Za-z-_]/g;function base64clean(t){if((t=stringtrim(t).replace(INVALID_BASE64_RE,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}function stringtrim(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function toHex(t){return t<16?"0"+t.toString(16):t.toString(16)}function utf8ToBytes(t,e){var r;e=e||1/0;for(var i=t.length,n=null,o=[],a=0;a<i;++a){if(55295<(r=t.charCodeAt(a))&&r<57344){if(!n){if(56319<r){-1<(e-=3)&&o.push(239,191,189);continue}if(a+1===i){-1<(e-=3)&&o.push(239,191,189);continue}n=r;continue}if(r<56320){-1<(e-=3)&&o.push(239,191,189),n=r;continue}r=65536+(n-55296<<10|r-56320)}else n&&-1<(e-=3)&&o.push(239,191,189);if(n=null,r<128){if(--e<0)break;o.push(r)}else if(r<2048){if((e-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((e-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function asciiToBytes(t){for(var e=[],r=0;r<t.length;++r)e.push(255&t.charCodeAt(r));return e}function utf16leToBytes(t,e){for(var r,i,n,o=[],a=0;a<t.length&&!((e-=2)<0);++a)i=(r=t.charCodeAt(a))>>8,n=r%256,o.push(n),o.push(i);return o}function base64ToBytes(t){return toByteArray(base64clean(t))}function blitBuffer(t,e,r,i){for(var n=0;n<i&&!(n+r>=e.length||n>=t.length);++n)e[n+r]=t[n];return n}function isnan(t){return t!=t}function isBuffer(t){return null!=t&&(!!t._isBuffer||isFastBuffer(t)||isSlowBuffer(t))}function isFastBuffer(t){return!!t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}function isSlowBuffer(t){return"function"==typeof t.readFloatLE&&"function"==typeof t.slice&&isFastBuffer(t.slice(0,0))}var bufferEs6=Object.freeze({INSPECT_MAX_BYTES,kMaxLength:_kMaxLength,Buffer,SlowBuffer,isBuffer});global$1.setTimeout,global$1.clearTimeout;var performance$1=global$1.performance||{},performanceNow=performance$1.now||performance$1.mozNow||performance$1.msNow||performance$1.oNow||performance$1.webkitNow||function(){return(new Date).getTime()},inherits,inherits="function"==typeof Object.create?function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:function(t,e){function r(){}t.super_=e,r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t},inherits$1=inherits;function inspect(t,e){var r={seen:[],stylize:stylizeNoColor};return 3<=arguments.length&&(r.depth=arguments[2]),4<=arguments.length&&(r.colors=arguments[3]),isBoolean(e)?r.showHidden=e:e&&_extend(r,e),isUndefined(r.showHidden)&&(r.showHidden=!1),isUndefined(r.depth)&&(r.depth=2),isUndefined(r.colors)&&(r.colors=!1),isUndefined(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=stylizeWithColor),formatValue(r,t,r.depth)}function stylizeWithColor(t,e){var r=inspect.styles[e];return r?"["+inspect.colors[r][0]+"m"+t+"["+inspect.colors[r][1]+"m":t}function stylizeNoColor(t,e){return t}function arrayToHash(t){var e={};return t.forEach((function(t,r){e[t]=!0})),e}function formatValue(t,e,r){if(t.customInspect&&e&&isFunction(e.inspect)&&e.inspect!==inspect&&(!e.constructor||e.constructor.prototype!==e)){var i=e.inspect(r,t);return isString(i)||(i=formatValue(t,i,r)),i}var n=formatPrimitive(t,e);if(n)return n;var o=Object.keys(e),a=arrayToHash(o);if(t.showHidden&&(o=Object.getOwnPropertyNames(e)),isError(e)&&(0<=o.indexOf("message")||0<=o.indexOf("description")))return formatError(e);if(0===o.length){if(isFunction(e)){var s=e.name?": "+e.name:"";return t.stylize("[Function"+s+"]","special")}if(isRegExp(e))return t.stylize(RegExp.prototype.toString.call(e),"regexp");if(isDate(e))return t.stylize(Date.prototype.toString.call(e),"date");if(isError(e))return formatError(e)}var l,c="",u=!1,h=["{","}"];return isArray$1(e)&&(u=!0,h=["[","]"]),isFunction(e)&&(c=" [Function"+(e.name?": "+e.name:"")+"]"),isRegExp(e)&&(c=" "+RegExp.prototype.toString.call(e)),isDate(e)&&(c=" "+Date.prototype.toUTCString.call(e)),isError(e)&&(c=" "+formatError(e)),0!==o.length||u&&0!=e.length?r<0?isRegExp(e)?t.stylize(RegExp.prototype.toString.call(e),"regexp"):t.stylize("[Object]","special"):(t.seen.push(e),l=u?formatArray(t,e,r,a,o):o.map((function(i){return formatProperty(t,e,r,a,i,u)})),t.seen.pop(),reduceToSingleString(l,c,h)):h[0]+c+h[1]}function formatPrimitive(t,e){if(isUndefined(e))return t.stylize("undefined","undefined");if(isString(e)){var r="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(r,"string")}return isNumber(e)?t.stylize(""+e,"number"):isBoolean(e)?t.stylize(""+e,"boolean"):isNull(e)?t.stylize("null","null"):void 0}function formatError(t){return"["+Error.prototype.toString.call(t)+"]"}function formatArray(t,e,r,i,n){for(var o=[],a=0,s=e.length;a<s;++a)hasOwnProperty$1(e,String(a))?o.push(formatProperty(t,e,r,i,String(a),!0)):o.push("");return n.forEach((function(n){n.match(/^\d+$/)||o.push(formatProperty(t,e,r,i,n,!0))})),o}function formatProperty(t,e,r,i,n,o){var a,s,l=Object.getOwnPropertyDescriptor(e,n)||{value:e[n]};if(l.get?s=l.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):l.set&&(s=t.stylize("[Setter]","special")),hasOwnProperty$1(i,n)||(a="["+n+"]"),s||(t.seen.indexOf(l.value)<0?-1<(s=isNull(r)?formatValue(t,l.value,null):formatValue(t,l.value,r-1)).indexOf("\n")&&(s=o?s.split("\n").map((function(t){return"  "+t})).join("\n").substr(2):"\n"+s.split("\n").map((function(t){return"   "+t})).join("\n")):s=t.stylize("[Circular]","special")),isUndefined(a)){if(o&&n.match(/^\d+$/))return s;a=(a=JSON.stringify(""+n)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),t.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),t.stylize(a,"string"))}return a+": "+s}function reduceToSingleString(t,e,r){return 60<t.reduce((function(t,e){return e.indexOf("\n"),t+e.replace(/\u001b\[\d\d?m/g,"").length+1}),0)?r[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+r[1]:r[0]+e+" "+t.join(", ")+" "+r[1]}function isArray$1(t){return Array.isArray(t)}function isBoolean(t){return"boolean"==typeof t}function isNull(t){return null===t}function isNumber(t){return"number"==typeof t}function isString(t){return"string"==typeof t}function isUndefined(t){return void 0===t}function isRegExp(t){return isObject$1(t)&&"[object RegExp]"===objectToString$1(t)}function isObject$1(t){return"object"==typeof t&&null!==t}function isDate(t){return isObject$1(t)&&"[object Date]"===objectToString$1(t)}function isError(t){return isObject$1(t)&&("[object Error]"===objectToString$1(t)||t instanceof Error)}function isFunction(t){return"function"==typeof t}function isPrimitive(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t}function objectToString$1(t){return Object.prototype.toString.call(t)}function _extend(t,e){if(!e||!isObject$1(e))return t;for(var r=Object.keys(e),i=r.length;i--;)t[r[i]]=e[r[i]];return t}function hasOwnProperty$1(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function compare(t,e){if(t===e)return 0;for(var r=t.length,i=e.length,n=0,o=Math.min(r,i);n<o;++n)if(t[n]!==e[n]){r=t[n],i=e[n];break}return r<i?-1:i<r?1:0}inspect.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},inspect.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};var hasOwn=Object.prototype.hasOwnProperty,objectKeys$1=Object.keys||function(t){var e=[];for(var r in t)hasOwn.call(t,r)&&e.push(r);return e},pSlice=Array.prototype.slice,_functionsHaveNames;function functionsHaveNames(){return void 0!==_functionsHaveNames?_functionsHaveNames:_functionsHaveNames="foo"===function(){}.name}function pToString(t){return Object.prototype.toString.call(t)}function isView(t){if(!isBuffer(t)&&"function"==typeof global$1.ArrayBuffer){if("function"==typeof ArrayBuffer.isView)return ArrayBuffer.isView(t);if(t)return t instanceof DataView||!!(t.buffer&&t.buffer instanceof ArrayBuffer)}}function assert(t,e){t||fail(t,!0,e,"==",ok)}var regex=/\s*function\s+([^\(\s]*)\s*/;function getName(t){if(isFunction(t)){if(functionsHaveNames())return t.name;var e=t.toString().match(regex);return e&&e[1]}}function AssertionError(t){this.name="AssertionError",this.actual=t.actual,this.expected=t.expected,this.operator=t.operator,t.message?(this.message=t.message,this.generatedMessage=!1):(this.message=getMessage(this),this.generatedMessage=!0);var e,r,i,n,o,a=t.stackStartFunction||fail;Error.captureStackTrace?Error.captureStackTrace(this,a):(e=new Error).stack&&(o=e.stack,r=getName(a),0<=(i=o.indexOf("\n"+r))&&(n=o.indexOf("\n",i+1),o=o.substring(n+1)),this.stack=o)}function truncate(t,e){return"string"!=typeof t||t.length<e?t:t.slice(0,e)}function inspect$1(t){if(functionsHaveNames()||!isFunction(t))return inspect(t);var e=getName(t);return"[Function"+(e?": "+e:"")+"]"}function getMessage(t){return truncate(inspect$1(t.actual),128)+" "+t.operator+" "+truncate(inspect$1(t.expected),128)}function fail(t,e,r,i,n){throw new AssertionError({message:r,actual:t,expected:e,operator:i,stackStartFunction:n})}function ok(t,e){t||fail(t,!0,e,"==",ok)}function equal(t,e,r){t!=e&&fail(t,e,r,"==",equal)}function notEqual(t,e,r){t==e&&fail(t,e,r,"!=",notEqual)}function deepEqual(t,e,r){_deepEqual(t,e,!1)||fail(t,e,r,"deepEqual",deepEqual)}function deepStrictEqual(t,e,r){_deepEqual(t,e,!0)||fail(t,e,r,"deepStrictEqual",deepStrictEqual)}function _deepEqual(t,e,r,i){if(t===e)return!0;if(isBuffer(t)&&isBuffer(e))return 0===compare(t,e);if(isDate(t)&&isDate(e))return t.getTime()===e.getTime();if(isRegExp(t)&&isRegExp(e))return t.source===e.source&&t.global===e.global&&t.multiline===e.multiline&&t.lastIndex===e.lastIndex&&t.ignoreCase===e.ignoreCase;if(null!==t&&"object"==typeof t||null!==e&&"object"==typeof e){if(isView(t)&&isView(e)&&pToString(t)===pToString(e)&&!(t instanceof Float32Array||t instanceof Float64Array))return 0===compare(new Uint8Array(t.buffer),new Uint8Array(e.buffer));if(isBuffer(t)!==isBuffer(e))return!1;var n=(i=i||{actual:[],expected:[]}).actual.indexOf(t);return-1!==n&&n===i.expected.indexOf(e)||(i.actual.push(t),i.expected.push(e),objEquiv(t,e,r,i))}return r?t===e:t==e}function isArguments(t){return"[object Arguments]"==Object.prototype.toString.call(t)}function objEquiv(t,e,r,i){if(null==t||null==e)return!1;if(isPrimitive(t)||isPrimitive(e))return t===e;if(r&&Object.getPrototypeOf(t)!==Object.getPrototypeOf(e))return!1;var n=isArguments(t),o=isArguments(e);if(n&&!o||!n&&o)return!1;if(n)return _deepEqual(t=pSlice.call(t),e=pSlice.call(e),r);var a,s,l=objectKeys$1(t),c=objectKeys$1(e);if(l.length!==c.length)return!1;for(l.sort(),c.sort(),s=l.length-1;0<=s;s--)if(l[s]!==c[s])return!1;for(s=l.length-1;0<=s;s--)if(!_deepEqual(t[a=l[s]],e[a],r,i))return!1;return!0}function notDeepEqual(t,e,r){_deepEqual(t,e,!1)&&fail(t,e,r,"notDeepEqual",notDeepEqual)}function notDeepStrictEqual(t,e,r){_deepEqual(t,e,!0)&&fail(t,e,r,"notDeepStrictEqual",notDeepStrictEqual)}function strictEqual(t,e,r){t!==e&&fail(t,e,r,"===",strictEqual)}function notStrictEqual(t,e,r){t===e&&fail(t,e,r,"!==",notStrictEqual)}function expectedException(t,e){if(t&&e){if("[object RegExp]"==Object.prototype.toString.call(e))return e.test(t);try{if(t instanceof e)return 1}catch(t){}if(!Error.isPrototypeOf(e))return!0===e.call({},t)}}function _tryBlock(t){var e;try{t()}catch(t){e=t}return e}function _throws(t,e,r,i){var n;if("function"!=typeof e)throw new TypeError('"block" argument must be a function');"string"==typeof r&&(i=r,r=null),n=_tryBlock(e),i=(r&&r.name?" ("+r.name+").":".")+(i?" "+i:"."),t&&!n&&fail(n,r,"Missing expected exception"+i);var o="string"==typeof i,a=!t&&n&&!r;if((!t&&isError(n)&&o&&expectedException(n,r)||a)&&fail(n,r,"Got unwanted exception"+i),t&&n&&r&&!expectedException(n,r)||!t&&n)throw n}function throws(t,e,r){_throws(!0,t,e,r)}function doesNotThrow(t,e,r){_throws(!1,t,e,r)}function ifError(t){if(t)throw t}assert.AssertionError=AssertionError,inherits$1(AssertionError,Error),assert.fail=fail,assert.ok=ok,assert.equal=equal,assert.notEqual=notEqual,assert.deepEqual=deepEqual,assert.deepStrictEqual=deepStrictEqual,assert.notDeepEqual=notDeepEqual,assert.notDeepStrictEqual=notDeepStrictEqual,assert.strictEqual=strictEqual,assert.notStrictEqual=notStrictEqual,assert.throws=throws,assert.doesNotThrow=doesNotThrow,assert.ifError=ifError;var sort=function(t){return t.sort((function(t,e){return t.height-e.height})),t},placeItems=function(t){var e=0;return t.forEach((function(t){t.x=0,t.y=e,e+=t.height})),t},topDown_algorithm={sort,placeItems},sort$1=function(t){return t.sort((function(t,e){return t.width-e.width})),t},placeItems$1=function(t){var e=0;return t.forEach((function(t){t.x=e,t.y=0,e+=t.width})),t},leftRight_algorithm={sort:sort$1,placeItems:placeItems$1},sort$2=function(t){return t.sort((function(t,e){return Math.sqrt(Math.pow(t.height,2)+Math.pow(t.width,2))-Math.sqrt(Math.pow(e.height,2)+Math.pow(e.width,2))})),t},placeItems$2=function(t){var e=0,r=0;return t.forEach((function(t){t.x=e,t.y=r,e+=t.width,r+=t.height})),t},diagonal_algorithm={sort:sort$2,placeItems:placeItems$2},sort$3=function(t){return t.sort((function(t,e){return Math.sqrt(Math.pow(t.height,2)+Math.pow(t.width,2))-Math.sqrt(Math.pow(e.height,2)+Math.pow(e.width,2))})),t},placeItems$3=function(t){var e=0,r=0;return t.forEach((function(t){var i=t.width;t.x=e-i,t.y=r,e-=i,r+=t.height})),t},altDiagonal_algorithm={sort:sort$3,placeItems:placeItems$3},GrowingPacker=function(){};GrowingPacker.prototype={fit:function(t){var e,r,i,n,o=t.length,a=0<o?t[0].width:0,s=0<o?t[0].height:0;for(this.root={x:0,y:0,width:a,height:s},e=0;e<o;e++)i=t[e],n=(r=this.findNode(this.root,i.width,i.height))?this.splitNode(r,i.width,i.height):this.growNode(i.width,i.height),i.x=n.x,i.y=n.y},findNode:function(t,e,r){return t.used?this.findNode(t.right,e,r)||this.findNode(t.down,e,r):e<=t.width&&r<=t.height?t:null},splitNode:function(t,e,r){return t.used=!0,t.down={x:t.x,y:t.y+r,width:t.width,height:t.height-r},t.right={x:t.x+e,y:t.y,width:t.width-e,height:r},t},growNode:function(t,e){var r=t<=this.root.width,i=e<=this.root.height,n=i&&this.root.height>=this.root.width+t,o=r&&this.root.width>=this.root.height+e;return n?this.growRight(t,e):o?this.growDown(t,e):i?this.growRight(t,e):r?this.growDown(t,e):null},growRight:function(t,e){var r;return this.root={used:!0,x:0,y:0,width:this.root.width+t,height:this.root.height,down:this.root,right:{x:this.root.width,y:0,width:t,height:this.root.height}},(r=this.findNode(this.root,t,e))?this.splitNode(r,t,e):null},growDown:function(t,e){var r;return this.root={used:!0,x:0,y:0,width:this.root.width,height:this.root.height+e,down:{x:0,y:this.root.height,width:this.root.width,height:e},right:this.root},(r=this.findNode(this.root,t,e))?this.splitNode(r,t,e):null}};var packer_growing=GrowingPacker,binPack=function(t,e){e=e||{};var r=new packer_growing,i=e.inPlace||!1,n=(n=t.map((function(t){return i?t:{width:t.width,height:t.height,item:t}}))).sort((function(t,e){return e.width*e.height-t.width*t.height}));r.fit(n);var o={width:n.reduce((function(t,e){return Math.max(t,e.x+e.width)}),0),height:n.reduce((function(t,e){return Math.max(t,e.y+e.height)}),0)};return i||(o.items=n),o},sort$4=function(t){return t},placeItems$4=function(t){return binPack(t,{inPlace:!0}),t},binaryTree_algorithm={sort:sort$4,placeItems:placeItems$4},algorithms={};function Layout(t,e){var r=t||"top-down";return"string"==typeof r&&assert(r=algorithms[t],"Sorry, the '"+t+"' algorithm could not be loaded."),new packing_smith(r,e)}function addAlgorithm(t,e){algorithms[t]=e}Layout.PackingSmith=packing_smith,Layout.addAlgorithm=addAlgorithm,Layout.algorithms=algorithms,addAlgorithm("top-down",topDown_algorithm),addAlgorithm("left-right",leftRight_algorithm),addAlgorithm("diagonal",diagonal_algorithm),addAlgorithm("alt-diagonal",altDiagonal_algorithm),addAlgorithm("binary-tree",binaryTree_algorithm);var layout=Layout;function isTainting(t){var e;try{t.getContext("2d",{willReadFrequently:!0}).getImageData(0,0,1,1)}catch(t){e=t.message}return e}function bitmapToCanvas(t,e,r){var i;return t instanceof HTMLImageElement&&((i=t.ownerDocument.createElement("canvas")).width=e,i.height=r,i.getContext("2d").drawImage(t,0,0,e,r),t=i),t}var MAX_LNG_LAT=Geo$1.metersToLatLng([Geo$1.half_circumference_meters,Geo$1.half_circumference_meters]),TILE_EXPONENT=Math.log(Geo$1.tile_size)/Math.LN2,ICON_READY=1,DOM_MARKER_TYPE=8,GROUP_TYPE=16,TILE_MARGIN=100,AFFECTED_BBOX_CALC_THRESHOLD=10,ObjectSource=function(){_inherits(e,MapsJsSource);var t=_createSuper(e);function e(r,i){var n;return _classCallCheck(this,e),n=t.call(this,r,i),Thread.is_worker&&(n._quad_tree=new ns.H.geo.QuadTree,n._marker_quad_tree=new ns.H.geo.QuadTree,n._tree_entries_by_object_id={},n._groups_by_id={},n._layersCache=new ns.H.util.Cache(100)),Thread.is_main&&(n._objects_by_id={},n._commands=[],n._sendCommands=debounce(n._sendCommands,100,200),n.dispatchUpdate=n.dispatchUpdate.bind(_assertThisInitialized(n))),n}return _createClass(e,[{key:"hasLabeledData",value:function(){return!1}},{key:"onReady",value:function(){this._synced_at=this.provider.getInvalidations().getMark();var t,e,r=this.provider.getRootGroup(),i=r.getObjects(!0),n=[];for(i.push(r),t=i.length;t--;)e=i[t],this._isObjectSupported(e)&&this._shouldBeStored(e)&&(this._objects_by_id[e.getId()]=e,n.push(e.forWorkerMessage()));var o=[{method_name:"addObjects",arguments:[n]}];this._sendImmediateCommands(o)}},{key:"onProviderUpdate",value:function(t){var e,r,i,n,o=t.target,a=t.currentTarget.getInvalidations(o.type);this._isObjectSupported(o)&&(e=this._synced_at,r=o.getId(),a.isRemove(e)?(delete this._objects_by_id[r],this._commands.push({method_name:"removeObjectsByIds",arguments:[[r],!0]})):a.isAdd(e)?this._shouldBeStored(o)&&(this._objects_by_id[r]=o,this._commands.push({method_name:"addObjects",arguments:[[o.forWorkerMessage()]]})):a.isSpatial(e)||a.isZOrder(e)?this._shouldBeStored(o)&&(i=[{method_name:"removeObjectsByIds",arguments:[[r],!0]},{method_name:"addObjects",arguments:[[(this._objects_by_id[r]=o).forWorkerMessage()]]}],this.has_volatile_data&&!this.hasPendingCommands()?this._sendImmediateCommands(i):this._commands.push(i[0],i[1])):a.isVisual(e)?this._shouldBeStored(o)&&(n={method_name:"updateObjectProperties",arguments:[(this._objects_by_id[r]=o).forWorkerMessage()]},this.has_volatile_data&&!this.hasPendingCommands()?this._sendImmediateCommands([n]):this._commands.push(n)):a.isVolatility(e)&&(delete this._objects_by_id[r],this._commands.push({method_name:"removeObjectsByIds",arguments:[[r],!0]}),this._shouldBeStored(o)&&(this._objects_by_id[r]=o,this._commands.push({method_name:"addObjects",arguments:[[o.forWorkerMessage()]]}))),this._commands.length&&this._sendCommands()),this._synced_at=a.getMark()}},{key:"_shouldBeStored",value:function(t){return t.type===GROUP_TYPE||(!t.getIcon||t.getIcon().getState()===ICON_READY)&&this._hasSameVolatility(t)}},{key:"_hasSameVolatility",value:function(t){return t.getVolatility(!0)===this.has_volatile_data}},{key:"hasPendingCommands",value:function(){return 0<this._commands.length}},{key:"_sendCommands",value:function(){this._sendImmediateCommands(this._commands),this._commands=[]}},{key:"_sendImmediateCommands",value:function(t){t.length&&WorkerBroker.postMessage(this.worker,this.target_name+".executeCommands",t).then(this.dispatchUpdate)}},{key:"_isObjectSupported",value:function(t){return t.forWorkerMessage&&t.type!==DOM_MARKER_TYPE}},{key:"getSyncedAt",value:function(){return this._synced_at}},{key:"getMapObjectById",value:function(t){return this._objects_by_id[t]}},{key:"getIconBitmapByObjectId",value:function(t,e){var r=this.getMapObjectById(t);if(r){var i=r.getIcon();if(i.uid===e&&i.getState()===ICON_READY){var n=i.getSize();return bitmapToCanvas(i.getBitmap(),n.w,n.h)}}}},{key:"_getRastersForMarkers",value:function(t){for(var e={},r=layout("binary-tree"),i=0;i<t.length;i++){var n=t[i],o=n.properties.icon;e[o.id]||(r.addItem({width:o.size.w,height:o.size.h,meta:{objectId:n.id,id:o.id}}),e[o.id]=!0)}return r.export()}},{key:"fetchFeaturesForTile",value:function(t){var r=[],i=[],n=[],o=[],a=[],s=this._marker_quad_tree.intersectBoundingBox(Geo$1.getTileBoundingBox(t.coords,this.tile_size));t.source_data.error=null;for(var l=0;l<s.length;l++){var c={id:s[l].$feature$.id,properties:Object.assign({},s[l].$feature$.properties),geometry:{type:s[l].$feature$.geometry.type,coordinates:ArrayUtils$1.deepClone(s[l].$feature$.geometry.coordinates)}};r.push(c)}s=this._quad_tree.intersectBoundingBox(Geo$1.getTileBoundingBox(t.coords,this.tile_size,TILE_MARGIN));for(var u=0;u<s.length;u++){var h,p={id:s[u].$feature$.id,properties:Object.assign({},s[u].$feature$.properties),geometry:{type:s[u].$feature$.geometry.type,coordinates:ArrayUtils$1.deepClone(s[u].$feature$.geometry.coordinates)}};p.properties.overlay?i.push(p):p.geometry.type.includes("LineString")?n.push(p):p.geometry.type.includes("Polygon")&&(o.push(p),h={id:p.id,properties:p.properties,geometry:{type:p.geometry.type,coordinates:ArrayUtils$1.deepClone(p.geometry.coordinates)}},a.push(h))}r.sort(e._compareZInfo),o.sort(e._compareZInfo),i.sort(e._compareZInfo);var f=this.has_volatile_data?4096:0;a.sort(e._compareZInfo);for(var d=0;d<a.length;d++)a[d].properties.effectiveZIdx=f++;n.sort(e._compareZInfo);for(var y=0;y<n.length;y++)n[y].properties.effectiveZIdx=f++;t.source_data.layers.markers={type:"FeatureCollection",features:r},t.source_data.layers.polylines={type:"FeatureCollection",features:n},t.source_data.layers.polygons={type:"FeatureCollection",features:o},t.source_data.layers.outlines={type:"FeatureCollection",features:a},t.source_data.layers.overlays={type:"FeatureCollection",features:i}}},{key:"tileTexture",value:function(t){var e=t.source_data.layers.overlays;if(e){var r=this.name+"_"+t.coords.key,i=Tile.coordinateWithMaxZoom(t.coords,this.max_zoom),n=e.features[0].properties.overlays_config;return{name:r,filtering:this.filtering,coords:i,width:Geo$1.tile_size,height:Geo$1.tile_size,overlays_config:n,source:this.name}}}},{key:"_load",value:function(t){var e=Geo$1.wrapTile(t.coords,{x:!0}),r=e.z,i=e.x,n=e.y,o="".concat(r,"_").concat(i,"_").concat(n),a=this._layersCache.get(o),s=!1;if(a)t.source_data.layers=a;else{this.fetchFeaturesForTile(t);var l={maxZoom:this.max_zoom,tolerance:1.5,extent:Geo$1.tile_scale},c=t.source_data.layers.overlays;c.features.length&&delete t.source_data.layers.overlays;var u=t.source_data.layers.markers;for(var h in u.features.length&&delete t.source_data.layers.markers,t.source_data.layers){var p,f=t.source_data.layers[h];f.features.length&&(l.buffer=h.includes("lines")?TILE_MARGIN*Geo$1.units_per_pixel:0,p=createGeoJsonTile(f,r,i,n,l),t.source_data.layers[h]=parseGeoJSONVectorTile(p))}t.source_data.layers.overlays=this._processOverlays(t,c);for(var d=t.source_data.layers.overlays.features.length;d--;)if(!t.source_data.layers.overlays.features[d].id){s=!0,this._layersCache.drop(o);break}t.source_data.layers.markers=this._processMarkers(t,u),this._postProcessTile(t),s||this._layersCache.add(o,t.source_data.layers,1)}return t.rasters=this._getRastersForMarkers(t.source_data.layers.markers.features),Promise.resolve(t)}},{key:"_processMarkers",value:function(t,e){var r=e.features.length;if(r){for(var i=Geo$1.unitsPerMeter(t.coords.z),n=Geo$1.wrapTile(t.coords,{x:!0}),o=Geo$1.metersForTile(n),a=Geo$1.isLastTile(n),s=Geo$1.wrapMeters(t.min),l=Geo$1.wrapMeters(t.max),c=function(e){DataSource.coordsToMeters(e);var r=_slicedToArray(e,2),n=r[0],c=r[1],u=n>=s.x&&(a.column||n<l.x)&&c>=l.y&&(a.row||!t.coords.y||c<s.y);return DataSource.metersToTileUnits(i,o,e),u},u=[],h=0;h<r;h++){var p,f=e.features[h].geometry,d=!1;"Point"===f.type?c(p=f.coordinates)?f.coordinates=p:d=!0:"MultiPoint"===f.type&&(f.coordinates=f.coordinates.filter(c),0===f.coordinates.length&&(d=!0)),d||u.push(e.features[h])}e.features=u}return e}},{key:"_processOverlays",value:function(t,e){var r=this;if(!e.features.length)return e;var i={coords:t.coords,min:Geo$1.metersForTile(Geo$1.wrapTile(t.coords,{x:!0}))},n={coords:t.coords,source_data:{layers:{_default:{type:"FeatureCollection",features:e.features}}}},o=Math.pow(2,t.coords.z+TILE_EXPONENT);MapsJsSource.projectData(n.source_data),MapsJsSource.scaleData(n.source_data,i);var a=e.features.map((function(t){var e=t.geometry.coordinates[0],r=e[0],i=e[5===e.length?2:3],n=Math.floor(r[0]/Geo$1.tile_scale*Geo$1.tile_size),a=Math.floor(r[1]/Geo$1.tile_scale*Geo$1.tile_size),s=Math.floor(i[0]/Geo$1.tile_scale*Geo$1.tile_size),l=Math.floor(i[1]/Geo$1.tile_scale*Geo$1.tile_size)-a,c=s<=n,u=c?o-(n-s):s-n,h=[];return n<=Geo$1.tile_size&&h.push([n,a,u,l]),c&&0<s&&h.push([n-o,a,u,l]),{id:t.id,properties:t.properties,texcoords:h}})).filter((function(e){return r._isVisible(e.properties)&&r.isInMinMaxRange(e.properties,t.style_zoom)})),s=Geo$1.tile_scale;return t.pad_scale=this.pad_scale,t.default_winding="CW",e.features=a.length?[{geometry:{type:"Polygon",coordinates:[[[0,0],[s,0],[s,s],[0,s],[0,0]]]},properties:{overlays_config:a}}]:a,e}},{key:"executeCommands",value:function(t){for(var e,r=t.length<AFFECTED_BBOX_CALC_THRESHOLD,i=0;i<t.length;i++){var n=t[i];n.arguments.push(r);var o=this[n.method_name].apply(this,n.arguments);r&&(o&&e?e.mergeRect(o,!0,e):o&&(e=o))}return e?e.forWorkerMessage():void 0}},{key:"_getClampedGeoRectForFeature",value:function(t){var e=t.geometry.boundingBox;return new ns.H.geo.Rect(MathUtils$1.clamp(e[0],-MAX_LNG_LAT[1],MAX_LNG_LAT[1]),e[1],MathUtils$1.clamp(e[2],-MAX_LNG_LAT[1],MAX_LNG_LAT[1]),e[3])}},{key:"addObjects",value:function(t,r){for(var i,n=1<arguments.length&&void 0!==r&&r,o=0;o<t.length;o++){var a,s,l,c=t[o];"Group"===c.type?(c.$children_ids$={},this._groups_by_id[c.id]=c):(e._preprocessGeometry(c.geometry),a=this._getClampedGeoRectForFeature(c),n&&(i?i.mergeRect(a,!0,i):i=a),(l=(s=-1!==c.geometry.type.indexOf("Point")?this._marker_quad_tree:this._quad_tree).insertBoundingBox(a)).$tree=s,l.$feature$=c,this._tree_entries_by_object_id[c.id]=l)}for(var u=0;u<t.length;u++){var h=t[u];h.properties.parent&&(this._groups_by_id[h.properties.parent].$children_ids$[h.id]=h.id),h.properties.ref={effectiveVisibility:this._isVisible(h.properties),zInfo:this._getZInfo([],h)}}return this._layersCache.removeAll(),i}},{key:"removeObjectsByIds",value:function(t,e,r){for(var i,n=2<arguments.length&&void 0!==r&&r,o=0;o<t.length;o++){var a,s=t[o],l=void 0,c=void 0;(l=this._tree_entries_by_object_id[s])?(n&&(a=this._getClampedGeoRectForFeature(l.$feature$),i?i.mergeRect(a,!0,i):i=a),delete this._groups_by_id[l.$feature$.properties.parent].$children_ids$[s],l.$tree.remove(l),delete this._tree_entries_by_object_id[s]):(c=this._groups_by_id[s])&&(c.properties.parent&&delete this._groups_by_id[c.properties.parent].$children_ids$[s],e&&this.removeObjectsByIds(Object.keys(c.$children_ids$),!0),delete this._groups_by_id[s])}return this._layersCache.removeAll(),i}},{key:"updateObjectProperties",value:function(t,e){var r,i=1<arguments.length&&void 0!==e&&e;return"Group"===t.type?(mergeObjects(this._groups_by_id[t.id].properties,t.properties),this._groups_by_id[t.id].properties.ref.effectiveVisibility=this._isVisible(t.properties)):(this._tree_entries_by_object_id[t.id]||this.addObjects([t]),mergeObjects(this._tree_entries_by_object_id[t.id].$feature$.properties,t.properties),this._tree_entries_by_object_id[t.id].$feature$.properties.ref.effectiveVisibility=this._isVisible(t.properties),i&&(r=this._getClampedGeoRectForFeature(t))),r}},{key:"_getZInfo",value:function(t,e){var r=e.properties.zIdx,i=e.properties.sIdx;return t[0]|=void 0!==r,t.splice(1,0,r||0,i<0?e.id:i),0===e.properties.parent?t:this._getZInfo(t,this._groups_by_id[e.properties.parent])}},{key:"_isVisible",value:function(t){var e=t.visible,r=!t.parent||this._isVisible(this._groups_by_id[t.parent].properties);return e&&r}},{key:"isInMinMaxRange",value:function(t,e){var r=t.min<=e&&t.max>=e,i=!t.parent||this.isInMinMaxRange(this._groups_by_id[t.parent].properties,e);return r&&i}},{key:"dispose",value:function(){this._commands=[],_get(_getPrototypeOf(e.prototype),"dispose",this).call(this)}}],[{key:"_compareZInfo",value:function(t,e){for(var r,i=t.properties.ref.zInfo,n=e.properties.ref.zInfo,o=i.length,a=n.length,s=Math.min(o,a),l=1;l<s;l++)if(r=i[l]-n[l])return r;return o-a}},{key:"_preprocessGeometry",value:function(t){var r=t.type;t.coordinates="Point"===r?e._processPointCoordinates(t.coordinates):"MultiPoint"===r?t.coordinates.map(e._processPointCoordinates):"LineString"===r?e._processLineStringCoordinates(t.coordinates):"MultiLineString"===r?t.coordinates.map(e._processLineStringCoordinates):"Polygon"===r?t.coordinates.map(e._processPolygonCoordinates):"MultiPolygon"===r?t.coordinates.map(e._processMultiPolygonCoordinates):[]}},{key:"_processPointCoordinates",value:function(t){return[t[1],t[0],t[2]]}},{key:"_processLineStringCoordinates",value:function(t){return e._latLngAltArrayToLineString(t,!1)}},{key:"_processPolygonCoordinates",value:function(t){return e._latLngAltArrayToLineString(t,!0)}},{key:"_processMultiPolygonCoordinates",value:function(t){return t.map(e._processPolygonCoordinates)}},{key:"_latLngAltArrayToLineString",value:function(t,e){for(var r=[],i=t.length,n=0;n<i;n+=3)r.push([t[n+1],t[n]]);return e&&r.push([t[1],t[0]]),r}}]),e}();MapsJsSource.register(ObjectSource,"ObjectSource");var GEOMETRY_TYPE={POLYGON:1,POLYLINE:2,OUTLINE:3},IconMap=function(){function t(){_classCallCheck(this,t),this._map={}}return _createClass(t,[{key:"set",value:function(t,e,r){var i;this._map[t]?this._map[t].accumulator.add(r):((i=new Set).add(r),this._map[t]={value:e,accumulator:i})}},{key:"get",value:function(t){return this._map[t]&&this._map[t].value}},{key:"delete",value:function(t,e){var r=this._map[t];r&&r.accumulator&&(r.accumulator.delete(e),0===r.accumulator.size&&delete this._map[t])}}]),t}(),ObjectTileSource=function(){_inherits(e,MapsJsSource);var t=_createSuper(e);function e(r,i){var n;return _classCallCheck(this,e),n=t.call(this,r,i),Thread.is_worker||(n._icons=new IconMap),n}return _createClass(e,[{key:"onProviderUpdate",value:function(t){t.target instanceof H.map.provider.Tile?this.dispatchUpdate(t.target,t.data):this.dispatchUpdate(void 0,t.data)}},{key:"onReady",value:function(){var t=this.provider;t.setTileCanvasRendering&&t.setTileCanvasRendering(!1),t.providesMarkers()&&(this._onCacheDrop=this._onCacheDrop.bind(this),t.getCache().registerOnDrop(this._onCacheDrop)),this.dispatchUpdate()}},{key:"dispose",value:function(){_get(_getPrototypeOf(e.prototype),"dispose",this).call(this);var t=this.provider;t.providesMarkers()&&t.getCache().deRegisterOnDrop(this._onCacheDrop)}},{key:"_onCacheDrop",value:function(t,e){this.provider.cacheFilter(t)&&this._deleteIcons(t,e.data)}},{key:"_deleteIcons",value:function(t,e){for(var r=0,i=e.length;r<i;r++){var n=e[r].getIcon();this._icons.delete(n.uid,t)}}},{key:"getIconBitmapByObjectId",value:function(t,e){var r=this._icons.get(e);return r&&r.getBitmap()}},{key:"requestMarkerTile",value:function(t){var e=this;return new Promise((function(r,i){e.provider?e.provider.requestTileAsPromise(t.x,t.y,t.z,!1).then((function(t){var i,n,o=[];if(t.data)for(n=(i=t.data).length;n--;){var a=i[n],s=a.getIcon();e._icons.set(s.uid,s,t.key),o.push(a.forWorkerMessage())}r(o)})):r([])}))}},{key:"requestSpatialTile",value:function(t){var e=this;return new Promise((function(r,i){e.provider?e.provider.requestTileAsPromise(t.x,t.y,t.z,!1).then((function(t){var e,i=[];if(t.getObjects){e=t.getObjects();for(var n=0;n<e.length;n++){var o=e[n];i.push({id:o.getId(),geometries:o.getGeometriesForTile(t),isClosed:o.isClosed(),style:o.getStyle().forWorkerMessage()})}}r(i)})):r([])}))}},{key:"_pointToArray",value:function(t){var e=Geo$1.tile_scale/this.tile_size;return[t.x*e,t.y*e]}},{key:"_getGeoJsonMultiPolygon",value:function(t){for(var e=t.geometries,r=e.length,i=[],n={coordinates:i,type:"MultiPolygon"},o=0;o<r;o++){var a=e[o],s=a.paths,l=s.length,c=a.interiorsIndex,u=a.outlinesIndex,h=Math.min(c,u,l),p=void 0,f=void 0;for(f=0;f<h;f++)p=[s[f].map(this._pointToArray,this)],i.push(p);if(1===h)for(h=Math.min(u,l),f=c;f<h;f++)p.push(s[f].map(this._pointToArray,this))}return n}},{key:"_getGeoJsonMultiLineString",value:function(t,e){for(var r=1<arguments.length&&void 0!==e&&e,i={coordinates:[],type:"MultiLineString"},n=t.geometries,o=0;o<n.length;o++)for(var a=n[o],s=r?a.outlinesIndex:0,l=r?a.paths.length:Math.min(a.interiorsIndex,a.outlinesIndex,a.paths.length),c=s;c<l;c++){var u=a.paths[c].map(this._pointToArray,this);i.coordinates.push(u)}return i}},{key:"_getGeoJsonGeometry",value:function(t,e){var r=e===GEOMETRY_TYPE.POLYGON?this._getGeoJsonMultiPolygon(t):this._getGeoJsonMultiLineString(t,e===GEOMETRY_TYPE.OUTLINE);return r.coordinates.length?r:null}},{key:"_load",value:function(t){var e=this;return new Promise((function(r,i){var n=WorkerBroker.postMessage(e.target_name+".requestMarkerTile",t.coords).then(e._prepareTileData.bind(e,t)),o=new Promise((function(r,i){WorkerBroker.postMessage(e.target_name+".requestSpatialTile",t.coords).then((function(i){for(var n=[],o=[],a=[],s=0;s<i.length;s++){var l,c=i[s],u=void 0,h=c.isClosed?(u=o,GEOMETRY_TYPE.POLYGON):(u=n,GEOMETRY_TYPE.POLYLINE),p=e._getGeoJsonGeometry(c,h);p&&(l={id:c.id,type:"Feature",properties:{height:0,style:c.style},geometry:p},h===GEOMETRY_TYPE.POLYLINE&&(l.properties.effectiveZIdx=n.length),u.push(l));var f=e._getGeoJsonGeometry(c,GEOMETRY_TYPE.OUTLINE);f&&a.push({id:c.id,type:"Feature",properties:{height:0,style:c.style,effectiveZIdx:a.length},geometry:f})}t.source_data.layers.polylines={type:"FeatureCollection",features:n},t.source_data.layers.polygons={type:"FeatureCollection",features:o},t.source_data.layers.outlines={type:"FeatureCollection",features:a},r(t)}))}));Promise.all([n,o]).then((function(i){e._postProcessTile(t),r(t)}))}))}},{key:"_prepareTileData",value:function(t,e){var r=Geo$1.wrapTile(t.coords,{x:!0,y:!0}),i=Geo$1.metersForTile(r);t.source_data.layers={markers:{features:e,type:"FeatureCollection"}};var n={coords:r,min:i},o=t.source_data,a=layout("binary-tree"),s={};for(var l in o.layers)for(var c=o.layers[l].features.length,u=0;u<c;u++){var h=o.layers[l].features[u],p=h.properties.icon;s[p.id]||(a.addItem({width:p.size.w,height:p.size.h,meta:{objectId:h.id,id:p.id}}),s[p.id]=!0),Geo$1.transformGeometry(h.geometry,(function(t){var e=t[0];t[0]=t[1],t[1]=e}))}return t.rasters=a.export(),MapsJsSource.projectData(t.source_data),MapsJsSource.scaleData(t.source_data,n),t}}]),e}();MapsJsSource.register(ObjectTileSource,"ObjectTileSource");var RemoteRasterTileSource=function(){_inherits(e,RasterTileSource);var t=_createSuper(e);function e(r,i){var n;return _classCallCheck(this,e),(n=t.call(this,r,i)).uid_=r.uid,n}return _createClass(e,[{key:"initialize",value:function(t,e){this.provider=t,this._on_update=e,this._onProviderUpdate=this._onProviderUpdate.bind(this),t.addEventListener("update",this._onProviderUpdate)}},{key:"_onProviderUpdate",value:function(){this._on_update(this.name)}},{key:"tileTexture",value:function(t){return Object.assign(_get(_getPrototypeOf(e.prototype),"tileTexture",this).call(this,t),{uid:this.uid_,url:this.uid_+"_"+t.coords.key,coords:t.coords})}},{key:"dispose",value:function(){this.provider.removeEventListener("update",this._onProviderUpdate)}}]),e}();function geojsonvt(t,e){return new GeoJSONVT(t,e)}function GeoJSONVT(t,e){var r=(e=this.options=extend(Object.create(this.options),e)).debug;if(r&&console.time("preprocess data"),e.maxZoom<0||24<e.maxZoom)throw new Error("maxZoom should be in the 0-24 range");if(e.promoteId&&e.generateId)throw new Error("promoteId and generateId cannot be used together.");var i=convert(t,e);this.tiles={},this.tileCoords=[],r&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",e.indexMaxZoom,e.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(i=wrap(i,e)).length&&this.splitTile(i,0,0,0),r&&(i.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function toID(t,e,r){return 32*((1<<t)*r+e)+t}function extend(t,e){for(var r in e)t[r]=e[r];return t}DataSource.register(RemoteRasterTileSource,"RemoteRasterTileSource"),GeoJSONVT.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},GeoJSONVT.prototype.splitTile=function(t,e,r,i,n,o,a){for(var s=[t,e,r,i],l=this.options,c=l.debug;s.length;){i=s.pop(),r=s.pop(),e=s.pop(),t=s.pop();var u,h,p,f,d,y,g,v,m,_,b,w=1<<e,x=toID(e,r,i),E=this.tiles[x];if(E||(1<c&&console.time("creation"),E=this.tiles[x]=createTile(t,e,r,i,l),this.tileCoords.push({z:e,x:r,y:i}),c&&(1<c&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",e,r,i,E.numFeatures,E.numPoints,E.numSimplified),console.timeEnd("creation")),u="z"+e,this.stats[u]=(this.stats[u]||0)+1,this.total++)),E.source=t,n){if(e===l.maxZoom||e===n)continue;var T=1<<n-e;if(r!==Math.floor(o/T)||i!==Math.floor(a/T))continue}else if(e===l.indexMaxZoom||E.numPoints<=l.indexMaxPoints)continue;E.source=null,0!==t.length&&(1<c&&console.time("clipping"),p=.5-(h=.5*l.buffer/l.extent),d=1+h,m=y=g=v=null,_=clip(t,w,r-h,r+(f=.5+h),0,E.minX,E.maxX,l),b=clip(t,w,r+p,r+d,0,E.minX,E.maxX,l),t=null,_&&(m=clip(_,w,i-h,i+f,1,E.minY,E.maxY,l),y=clip(_,w,i+p,i+d,1,E.minY,E.maxY,l),_=null),b&&(g=clip(b,w,i-h,i+f,1,E.minY,E.maxY,l),v=clip(b,w,i+p,i+d,1,E.minY,E.maxY,l),b=null),1<c&&console.timeEnd("clipping"),s.push(m||[],e+1,2*r,2*i),s.push(y||[],e+1,2*r,2*i+1),s.push(g||[],e+1,2*r+1,2*i),s.push(v||[],e+1,2*r+1,2*i+1))}},GeoJSONVT.prototype.getTile=function(t,e,r){var i=this.options,n=i.extent,o=i.debug;if(t<0||24<t)return null;var a=1<<t,s=toID(t,e=(e%a+a)%a,r);if(this.tiles[s])return transformTile(this.tiles[s],n);1<o&&console.log("drilling down to z%d-%d-%d",t,e,r);for(var l,c=t,u=e,h=r;!l&&0<c;)c--,u=Math.floor(u/2),h=Math.floor(h/2),l=this.tiles[toID(c,u,h)];return l&&l.source?(1<o&&console.log("found parent tile z%d-%d-%d",c,u,h),1<o&&console.time("drilling down"),this.splitTile(l.source,c,u,h,t,e,r),1<o&&console.timeEnd("drilling down"),this.tiles[s]?transformTile(this.tiles[s],n):null):null};var EMPTY_FEATURE_COLLECTION$1={type:"FeatureCollection",features:[]},GeoJSONTileSource=function(){_inherits(e,MapsJsSource);var t=_createSuper(e);function e(r,i){return _classCallCheck(this,e),r.tiled=!0,r.url="",t.call(this,r,i)}return _createClass(e,[{key:"fetchTile",value:function(t,e,r){return this.provider?this.provider.requestTileAsPromise(t,e,r).then((function(t){return t.data})):Promise.resolve(EMPTY_FEATURE_COLLECTION$1)}},{key:"_load",value:function(t){var e=this,r=Geo$1.wrapTile(t.coords,{x:!0,y:!0}),i={indexMaxZoom:0,maxZoom:this.max_zoom,tolerance:1.5,extent:Geo$1.tile_scale};return WorkerBroker.postMessage(this.target_name+".fetchTile",r.x,r.y,r.z).then((function(n){for(var o in t.source_data.layers="FeatureCollection"===n.type?{_default:n}:n,t.source_data.layers){var a=geojsonvt(t.source_data.layers[o],i).getTile(r.z,r.x,r.y);t.source_data.layers[o]=parseGeoJSONVectorTile(a)}return e._postProcessTile(t),t}))}},{key:"onReady",value:function(){this.dispatchUpdate()}}]),e}();DataSource.register(GeoJSONTileSource,"GeoJSONTileSource");var DEFAULT_RESPONSE={layers:{_default:{type:"FeatureCollection",features:[{type:"Point",geometry:{}}]}}},SkyBoxSource=function(){_inherits(e,DataSource);var t=_createSuper(e);function e(r,i){return _classCallCheck(this,e),r.max_zoom=0,t.call(this,r,i)}return _createClass(e,[{key:"load",value:function(t){return t.source_data="0/0/0"===t.coords.key?DEFAULT_RESPONSE:void 0,Promise.resolve(t)}}]),e}(),debugSettings;DataSource.register(SkyBoxSource,"SkyBox");var debugSettings$1=debugSettings={draw_label_collision_boxes:!1,draw_label_texture_boxes:!1,suppress_label_fade_in:!1,suppress_snap_animation:!1,show_hidden_labels:!1,layer_stats:!1};function mergeDebugSettings(t){Object.assign(debugSettings,t)}var WorkerType={NATIVE:0,FAKE:1},Context;function sliceObject(t,e){var r={};return e.forEach((function(e){return r[e]=t[e]})),r}var Context$1=Context={},context_id=0,gl;Context.getContext=function(t,e){var r=!1;null==t&&((t=document.createElement("canvas")).style.position="absolute",t.style.top=0,t.style.left=0,t.style.zIndex=-1,document.body.appendChild(t),r=!0);var i=t.getContext("webgl",e)||t.getContext("experimental-webgl",e);if(!i)throw new Error("Couldn't create WebGL context.");return i._tangram_id=context_id++,r?(Context.resize(i,window.innerWidth,window.innerHeight,e.device_pixel_ratio),window.addEventListener("resize",(function(){Context.resize(i,window.innerWidth,window.innerHeight,e.device_pixel_ratio)}))):Context.resize(i,parseFloat(t.style.width),parseFloat(t.style.height),e.device_pixel_ratio),i},Context.resize=function(t,e,r,i){t.canvas.style.width=e+"px",t.canvas.style.height=r+"px",t.canvas.width=Math.round(e*i),t.canvas.height=Math.round(r*i),t.bindFramebuffer(t.FRAMEBUFFER,null),t.viewport(0,0,t.canvas.width,t.canvas.height)};var gl$1=gl={};gl.BYTE=5120,gl.UNSIGNED_BYTE=5121,gl.SHORT=5122,gl.UNSIGNED_SHORT=5123,gl.INT=5124,gl.UNSIGNED_INT=5125,gl.FLOAT=5126;var MAX_VALUE$1=Math.pow(2,16)-1,DEFAULT_SIZE=1024,HAS_ELEMENT_INDEX_UINT=!1,VertexElements=function(){function t(e){_classCallCheck(this,t),this.size_=e||DEFAULT_SIZE,this.position_=0,this.ArrayType_=Uint16Array,this.buffer_=new this.ArrayType_(this.size_),this.overflows_=!1}return _createClass(t,[{key:"push",value:function(t){if(!this.overflows_||HAS_ELEMENT_INDEX_UINT){if(MAX_VALUE$1<t){if(this.overflows_=!0,!HAS_ELEMENT_INDEX_UINT)return;this.ArrayType_===Uint16Array&&(this.ArrayType_=Uint32Array,this.buffer_=new this.ArrayType_(this.buffer_))}this.position_===this.size_&&this.expand_(),this.buffer_[this.position_]=t,this.position_+=1}}},{key:"end",value:function(){if(0===this.position_)return!1;var t=this.buffer_,e=this.position_;return this.buffer_=new this.ArrayType_(this.size_),this.position_=0,this.overflows_=!1,t.subarray(0,e)}},{key:"expand_",value:function(){this.size_=this.size_<<1;var t=new this.ArrayType_(this.size_);t.set(this.buffer_),this.buffer_=t}}]),t}(),_array_types;VertexElements.setElementIndexUint=function(t){HAS_ELEMENT_INDEX_UINT=t};var array_types=(_array_types={},_defineProperty(_array_types,gl$1.FLOAT,Float32Array),_defineProperty(_array_types,gl$1.BYTE,Int8Array),_defineProperty(_array_types,gl$1.UNSIGNED_BYTE,Uint8Array),_defineProperty(_array_types,gl$1.INT,Int32Array),_defineProperty(_array_types,gl$1.UNSIGNED_INT,Uint32Array),_defineProperty(_array_types,gl$1.SHORT,Int16Array),_defineProperty(_array_types,gl$1.UNSIGNED_SHORT,Uint16Array),_array_types),VertexData=function(){function t(e){var r=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).prealloc,i=void 0===r?500:r;_classCallCheck(this,t),this.vertex_layout=e,this.vertex_elements=new VertexElements,this.stride=this.vertex_layout.stride,0<t.array_pool.length?(this.vertex_buffer=t.array_pool.pop(),this.byte_length=this.vertex_buffer.byteLength,this.size=Math.floor(this.byte_length/this.stride),log("trace","VertexData: reused buffer of bytes ".concat(this.byte_length,", ").concat(this.size," vertices"))):(this.size=i,this.byte_length=this.stride*this.size,this.vertex_buffer=new Uint8Array(this.byte_length)),this.offset=0,this.vertex_count=0,this.realloc_count=0,this.setBufferViews(),this.setAddVertexFunction()}return _createClass(t,[{key:"setBufferViews",value:function(){var t=this;this.views={},this.views[gl$1.UNSIGNED_BYTE]=this.vertex_buffer,this.vertex_layout.dynamic_attribs.forEach((function(e){var r;null==t.views[e.type]&&(r=array_types[e.type],t.views[e.type]=new r(t.vertex_buffer.buffer))}))}},{key:"checkBufferSize",value:function(){var e;this.offset+this.stride>this.byte_length&&(this.size=Math.floor(1.5*this.size),this.size-=this.size%4,this.byte_length=this.stride*this.size,(e=new Uint8Array(this.byte_length)).set(this.vertex_buffer),t.array_pool.push(this.vertex_buffer),this.vertex_buffer=e,this.setBufferViews(),this.realloc_count++)}},{key:"setAddVertexFunction",value:function(){this.vertexLayoutAddVertex=this.vertex_layout.getAddVertexFunction()}},{key:"addVertex",value:function(t){this.checkBufferSize(),this.vertexLayoutAddVertex(t,this.views,this.offset),this.offset+=this.stride,this.vertex_count++}},{key:"end",value:function(){return this.vertex_buffer=this.vertex_buffer.subarray(0,this.offset),this.element_buffer=this.vertex_elements.end(),log("trace","VertexData: ".concat(this.size," vertices total, realloc count ").concat(this.realloc_count)),this}}]),t}();VertexData.array_pool=[];var VertexLayout=function(){function t(e){_classCallCheck(this,t),this.attribs=e,this.dynamic_attribs=this.attribs.filter((function(t){return!t.static})),this.components=[],this.index={},this.offset={};for(var r=this.stride=0,i=0,n=0;n<this.attribs.length;n++){var o=this.attribs[n];if(null==o.static){o.offset=this.stride,o.byte_size=o.size;var a=0;switch(o.type){case gl$1.FLOAT:case gl$1.INT:case gl$1.UNSIGNED_INT:o.byte_size*=4,a=2;break;case gl$1.SHORT:case gl$1.UNSIGNED_SHORT:o.byte_size*=2,a=1}3&o.byte_size&&(o.byte_size+=4-(3&o.byte_size)),this.stride+=o.byte_size;for(var s=o.offset>>a,l=0;l<o.size;l++)this.components.push({type:o.type,shift:a,offset:s++,index:i++});this.index[o.name]=r,r+=o.size,this.offset[o.name]=o.offset}else o.static=Array.isArray(o.static)?o.static:[o.static],o.method="vertexAttrib".concat(o.static.length,"fv")}}return _createClass(t,[{key:"enable",value:function(e,r,i){for(var n,o,a=0;a<this.attribs.length;a++)n=this.attribs[a],-1!==(o=r.attribute(n.name).location)&&(null==n.static?(t.enabled_attribs[o]&&!i||e.enableVertexAttribArray(o),e.vertexAttribPointer(o,n.size,n.type,n.normalized,this.stride,n.offset),t.enabled_attribs[o]=r):e[n.method]instanceof Function&&(e.enableVertexAttribArray(o),e[n.method](o,n.static),e.disableVertexAttribArray(o),delete t.enabled_attribs[o]));for(o in t.enabled_attribs)this.disableUnusedAttribute(e,o,r)}},{key:"disableUnusedAttribute",value:function(e,r,i){t.enabled_attribs[r]!==i&&(e.disableVertexAttribArray(r),delete t.enabled_attribs[r])}},{key:"createVertexData",value:function(){return new VertexData(this)}},{key:"getAddVertexFunction",value:function(){return null==this.addVertex&&this.createAddVertexFunction(),this.addVertex}},{key:"createAddVertexFunction",value:function(){var e=hashString(JSON.stringify(this.attribs));if(null==t.add_vertex_funcs[e]){var r,i=["var t, o;"],n=_toConsumableArray(this.components);n.sort((function(t,e){return t.type!==e.type?t.type-e.type:t.index-e.index}));for(var o=0;o<n.length;o++){var a=n[o];r!==a.type&&(i.push("t = vs[".concat(a.type,"];")),i.push("o = off".concat(a.shift?" >> "+a.shift:"",";")),r=a.type),i.push("t[o + ".concat(a.offset,"] = v[").concat(a.index,"];"))}i=i.join("\n");var s=new Function("v","vs","off",i);t.add_vertex_funcs[e]=s}this.addVertex=t.add_vertex_funcs[e]}}]),t}();VertexLayout.enabled_attribs={},VertexLayout.add_vertex_funcs={};var tile_bounds=[{x:0,y:0},{x:Geo$1.tile_scale,y:-Geo$1.tile_scale}],default_uvs=[0,0,1,1];function outsideTile(t,e,r){var i=tile_bounds[0],n=tile_bounds[1];return t[0]<=i.x+r&&e[0]<=i.x+r||t[0]>=n.x-r&&e[0]>=n.x-r||t[1]>=i.y-r&&e[1]>=i.y-r||t[1]<=n.y+r&&e[1]<=n.y+r}function isCoordOutsideTile(t,e){e=e||0;var r=tile_bounds[0],i=tile_bounds[1];return t[0]<=r.x+e||t[0]>=i.x-e||t[1]>=r.y-e||t[1]<=i.y+e}var earcut_1=earcut;function earcut(t,e,r){r=r||2;var i,n,o,a,s,l,c,u=e&&e.length,h=u?e[0]*r:t.length,p=linkedList(t,0,h,r,!0),f=[];if(!p)return f;if(u&&(p=eliminateHoles(t,e,p,r)),t.length>80*r){i=o=t[0],n=a=t[1];for(var d=r;d<h;d+=r)(s=t[d])<i&&(i=s),(l=t[d+1])<n&&(n=l),o<s&&(o=s),a<l&&(a=l);c=Math.max(o-i,a-n)}return earcutLinked(p,f,r,i,n,c),f}function linkedList(t,e,r,i,n){var o,a;if(n===0<signedArea$1(t,e,r,i))for(o=e;o<r;o+=i)a=insertNode(o,t[o],t[o+1],a);else for(o=r-i;e<=o;o-=i)a=insertNode(o,t[o],t[o+1],a);return a&&equals(a,a.next)&&(removeNode(a),a=a.next),a}function filterPoints(t,e){if(!t)return t;e=e||t;var r,i=t;do{if(r=!1,i.steiner||!equals(i,i.next)&&0!==area(i.prev,i,i.next))i=i.next;else{if(removeNode(i),(i=e=i.prev)===i.next)return null;r=!0}}while(r||i!==e);return e}function earcutLinked(t,e,r,i,n,o,a){if(t){!a&&o&&indexCurve(t,i,n,o);for(var s,l,c=t;t.prev!==t.next;)if(s=t.prev,l=t.next,o?isEarHashed(t,i,n,o):isEar(t))e.push(s.i/r),e.push(t.i/r),e.push(l.i/r),removeNode(t),t=l.next,c=l.next;else if((t=l)===c){a?1===a?earcutLinked(t=cureLocalIntersections(t,e,r),e,r,i,n,o,2):2===a&&splitEarcut(t,e,r,i,n,o):earcutLinked(filterPoints(t),e,r,i,n,o,1);break}}}function isEar(t){var e=t.prev,r=t,i=t.next;if(!(0<=area(e,r,i))){for(var n=t.next.next;n!==t.prev;){if(pointInTriangle(e.x,e.y,r.x,r.y,i.x,i.y,n.x,n.y)&&0<=area(n.prev,n,n.next))return;n=n.next}return 1}}function isEarHashed(t,e,r,i){var n=t.prev,o=t,a=t.next;if(!(0<=area(n,o,a))){for(var s=n.x<o.x?n.x<a.x?n.x:a.x:o.x<a.x?o.x:a.x,l=n.y<o.y?n.y<a.y?n.y:a.y:o.y<a.y?o.y:a.y,c=n.x>o.x?n.x>a.x?n.x:a.x:o.x>a.x?o.x:a.x,u=n.y>o.y?n.y>a.y?n.y:a.y:o.y>a.y?o.y:a.y,h=zOrder(s,l,e,r,i),p=zOrder(c,u,e,r,i),f=t.nextZ;f&&f.z<=p;){if(f!==t.prev&&f!==t.next&&pointInTriangle(n.x,n.y,o.x,o.y,a.x,a.y,f.x,f.y)&&0<=area(f.prev,f,f.next))return;f=f.nextZ}for(f=t.prevZ;f&&f.z>=h;){if(f!==t.prev&&f!==t.next&&pointInTriangle(n.x,n.y,o.x,o.y,a.x,a.y,f.x,f.y)&&0<=area(f.prev,f,f.next))return;f=f.prevZ}return 1}}function cureLocalIntersections(t,e,r){var i=t;do{var n=i.prev,o=i.next.next;!equals(n,o)&&intersects(n,i,i.next,o)&&locallyInside(n,o)&&locallyInside(o,n)&&(e.push(n.i/r),e.push(i.i/r),e.push(o.i/r),removeNode(i),removeNode(i.next),i=t=o),i=i.next}while(i!==t);return i}function splitEarcut(t,e,r,i,n,o){var a=t;do{for(var s=a.next.next;s!==a.prev;){if(a.i!==s.i&&isValidDiagonal(a,s)){var l=splitPolygon(a,s);return a=filterPoints(a,a.next),l=filterPoints(l,l.next),earcutLinked(a,e,r,i,n,o),void earcutLinked(l,e,r,i,n,o)}s=s.next}a=a.next}while(a!==t)}function eliminateHoles(t,e,r,i){for(var n,o=[],a=0,s=e.length;a<s;a++)(n=linkedList(t,e[a]*i,a<s-1?e[a+1]*i:t.length,i,!1))===n.next&&(n.steiner=!0),o.push(getLeftmost(n));for(o.sort(compareX),a=0;a<o.length;a++)eliminateHole(o[a],r),r=filterPoints(r,r.next);return r}function compareX(t,e){return t.x-e.x}function eliminateHole(t,e){var r;(e=findHoleBridge(t,e))&&filterPoints(r=splitPolygon(e,t),r.next)}function findHoleBridge(t,e){var r,i=e,n=t.x,o=t.y,a=-1/0;do{if(o<=i.y&&o>=i.next.y){var s=i.x+(o-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(s<=n&&a<s){if((a=s)===n){if(o===i.y)return i;if(o===i.next.y)return i.next}r=i.x<i.next.x?i:i.next}}i=i.next}while(i!==e);if(!r)return null;if(n===a)return r.prev;var l,c=r,u=r.x,h=r.y,p=1/0;for(i=r.next;i!==c;)n>=i.x&&i.x>=u&&pointInTriangle(o<h?n:a,o,u,h,o<h?a:n,o,i.x,i.y)&&((l=Math.abs(o-i.y)/(n-i.x))<p||l===p&&i.x>r.x)&&locallyInside(i,t)&&(r=i,p=l),i=i.next;return r}function indexCurve(t,e,r,i){for(var n=t;null===n.z&&(n.z=zOrder(n.x,n.y,e,r,i)),n.prevZ=n.prev,n.nextZ=n.next,(n=n.next)!==t;);n.prevZ.nextZ=null,n.prevZ=null,sortLinked(n)}function sortLinked(t){var e,r,i,n,o,a,s,l,c=1;do{for(r=t,o=t=null,a=0;r;){for(a++,i=r,e=s=0;e<c&&(s++,i=i.nextZ);e++);for(l=c;0<s||0<l&&i;)0!==s&&(0===l||!i||r.z<=i.z)?(r=(n=r).nextZ,s--):(i=(n=i).nextZ,l--),o?o.nextZ=n:t=n,n.prevZ=o,o=n;r=i}o.nextZ=null,c*=2}while(1<a);return t}function zOrder(t,e,r,i,n){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)/n)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)/n)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function getLeftmost(t){for(var e=t,r=t;e.x<r.x&&(r=e),(e=e.next)!==t;);return r}function pointInTriangle(t,e,r,i,n,o,a,s){return 0<=(n-a)*(e-s)-(t-a)*(o-s)&&0<=(t-a)*(i-s)-(r-a)*(e-s)&&0<=(r-a)*(o-s)-(n-a)*(i-s)}function isValidDiagonal(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!intersectsPolygon(t,e)&&locallyInside(t,e)&&locallyInside(e,t)&&middleInside(t,e)}function area(t,e,r){return(e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y)}function equals(t,e){return t.x===e.x&&t.y===e.y}function intersects(t,e,r,i){return equals(t,e)&&equals(r,i)||equals(t,i)&&equals(r,e)||0<area(t,e,r)!=0<area(t,e,i)&&0<area(r,i,t)!=0<area(r,i,e)}function intersectsPolygon(t,e){var r=t;do{if(r.i!==t.i&&r.next.i!==t.i&&r.i!==e.i&&r.next.i!==e.i&&intersects(r,r.next,t,e))return 1;r=r.next}while(r!==t)}function locallyInside(t,e){return area(t.prev,t,t.next)<0?0<=area(t,e,t.next)&&0<=area(t,t.prev,e):area(t,e,t.prev)<0||area(t,t.next,e)<0}function middleInside(t,e){for(var r=t,i=!1,n=(t.x+e.x)/2,o=(t.y+e.y)/2;r.y>o!=r.next.y>o&&n<(r.next.x-r.x)*(o-r.y)/(r.next.y-r.y)+r.x&&(i=!i),(r=r.next)!==t;);return i}function splitPolygon(t,e){var r=new Node(t.i,t.x,t.y),i=new Node(e.i,e.x,e.y),n=t.next,o=e.prev;return(t.next=e).prev=t,(r.next=n).prev=r,(i.next=r).prev=i,(o.next=i).prev=o,i}function insertNode(t,e,r,i){var n=new Node(t,e,r);return i?(n.next=i.next,(n.prev=i).next.prev=n,i.next=n):(n.prev=n).next=n,n}function removeNode(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Node(t,e,r){this.i=t,this.x=e,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function signedArea$1(t,e,r,i){for(var n=0,o=e,a=r-i;o<r;o+=i)n+=(t[a]-t[o])*(t[o+1]+t[a+1]),a=o;return n}earcut.deviation=function(t,e,r,i){var n=e&&e.length,o=n?e[0]*r:t.length,a=Math.abs(signedArea$1(t,0,o,r));if(n)for(var s=0,l=e.length;s<l;s++){var c=e[s]*r,u=s<l-1?e[s+1]*r:t.length;a-=Math.abs(signedArea$1(t,c,u,r))}var h=0;for(s=0;s<i.length;s+=3){var p=i[s]*r,f=i[s+1]*r,d=i[s+2]*r;h+=Math.abs((t[p]-t[d])*(t[1+f]-t[1+p])-(t[p]-t[f])*(t[1+d]-t[1+p]))}return 0===a&&0===h?0:Math.abs((h-a)/a)},earcut.flatten=function(t){for(var e=t[0][0].length,r={vertices:[],holes:[],dimensions:e},i=0,n=0;n<t.length;n++){for(var o=0;o<t[n].length;o++)for(var a=0;a<e;a++)r.vertices.push(t[n][o][a]);0<n&&(i+=t[n-1].length,r.holes.push(i))}return r};var up_vec3=[0,0,1];function buildPolygons(t,e,r,i){var n,o,a,s,l,c=i.texcoord_index,u=i.texcoord_scale,h=i.texcoord_normalize,p=e.vertex_elements;c&&(h=h||1,o=(n=_slicedToArray(u||default_uvs,4))[0],a=n[1],s=n[2],l=n[3]);for(var f=0,d=t.length,y=0;y<d;y++){var g,v,m,_,b,w=e.vertex_count,x=t[y];c&&(v=(g=_slicedToArray(Geo$1.findBoundingBox(x),4))[0],m=g[1],_=(s-o)/(g[2]-v),b=(l-a)/(g[3]-m));for(var E=0;E<x.length;E++)for(var T=x[E],A=0;A<T.length;A++){var S=T[A];r[0]=S[0],r[1]=S[1],c&&(r[c+0]=((S[0]-v)*_+o)*h,r[c+1]=((S[1]-m)*b+a)*h),e.addVertex(r)}for(var k=triangulatePolygon(earcut_1.flatten(x)),O=0;O<k.length;O++)p.push(w+k[O]);f+=k.length/3}return f}function buildExtrudedPolygons(t,e,r,i,n,o,a,s,l){var c=l.remove_tile_edges,u=l.tile_edge_tolerance,h=l.texcoord_index,p=l.texcoord_scale,f=l.texcoord_normalize,d=l.winding,y=e+(i||0),g=e+r;o[2]=g;var v,m,_,b,w,x,E=buildPolygons(t,n,o,{texcoord_index:h,texcoord_scale:p,texcoord_normalize:f}),T=n.vertex_elements,A=n.vertex_count;h&&(f=f||1,m=(v=_slicedToArray(p||default_uvs,4))[0],_=v[1],b=v[2],x=[[m,w=v[3]],[m,_],[b,_],[b,w]]);for(var S=t.length,k=0;k<S;k++)for(var O=t[k],L=0;L<O.length;L++)for(var P=O[L],R=0;R<P.length-1;R++)if(!c||!outsideTile(P[R],P[R+1],u)){var I,C=void 0,M=[[P[I="CCW"===d?(C=R)+1:(C=R+1,R)][0],P[I][1],g],[P[I][0],P[I][1],y],[P[C][0],P[C][1],y],[P[C][0],P[C][1],g]],N=Vector$1.normalize([P[I][0]-P[C][0],P[I][1]-P[C][1],0]),j=Vector$1.cross(up_vec3,N);o[a+0]=j[0]*s,o[a+1]=j[1]*s,o[a+2]=j[2]*s;for(var D=0;D<M.length;D++)o[0]=M[D][0],o[1]=M[D][1],o[2]=M[D][2],h&&(o[h+0]=x[D][0]*f,o[h+1]=x[D][1]*f),n.addVertex(o);T.push(A+0),T.push(A+1),T.push(A+2),T.push(A+2),T.push(A+3),T.push(A+0),A+=4,E+=2}return E}function triangulatePolygon(t){return earcut_1(t.vertices,t.holes,t.dimensions)}var shaderSrc_polygonsVertex="uniform vec2 u_resolution;uniform vec3 u_map_position;uniform vec4 u_tile_origin;uniform float u_tile_proxy_depth;uniform float u_meters_per_pixel;uniform float u_device_pixel_ratio;uniform mat4 u_model;uniform mat4 u_modelView;uniform mat3 u_normalMatrix;uniform mat3 u_inverseNormalMatrix;attribute vec4 a_position;attribute vec4 a_color;\n#ifdef TANGRAM_NORMAL_ATTRIBUTE\nattribute vec3 a_normal;\n#define TANGRAM_NORMAL a_normal\n#else\n#define TANGRAM_NORMAL vec3(0., 0., 1.)\n#endif\n#ifdef TANGRAM_EXTRUDE_LINES\nattribute vec2 a_extrude;attribute vec2 a_offset;attribute vec2 a_scaling;uniform float u_v_scale_adjust;\n#endif\nvarying vec4 v_position;varying vec4 v_local_space_position;varying vec3 v_normal;varying vec4 v_color;varying vec4 v_world_position;\n#if defined(TANGRAM_TEXTURE_COORDS) || defined(TANGRAM_EXTRUDE_LINES)\nattribute vec2 a_texcoord;varying vec2 v_texcoord;\n#endif\n#ifdef TANGRAM_MODEL_POSITION_BASE_ZOOM_VARYING\nvarying vec4 v_modelpos_base_zoom;\n#endif\n#if defined(TANGRAM_LIGHTING_VERTEX)\nvarying vec4 v_lighting;\n#endif\n#define UNPACK_SCALING(x) (x / 1024.)\n#pragma tangram: camera\n#pragma tangram: material\n#pragma tangram: lighting\n#pragma tangram: raster\n#pragma tangram: global\nvoid main(){\n#pragma tangram: setup\n#ifdef TANGRAM_TEXTURE_COORDS\nv_texcoord=a_texcoord;\n#ifdef TANGRAM_EXTRUDE_LINES\nv_texcoord.y*=u_v_scale_adjust;\n#endif\n#endif\n#ifdef TANGRAM_MODEL_POSITION_BASE_ZOOM_VARYING\nv_modelpos_base_zoom=modelPositionBaseZoom();\n#endif\nvec4 position=vec4(a_position.xy,a_position.z/TANGRAM_HEIGHT_SCALE,1.);\n#ifdef TANGRAM_EXTRUDE_LINES\nvec2 extrude=a_extrude.xy;vec2 offset=a_offset.xy;float dz=clamp(u_map_position.z-u_tile_origin.z,0.,4.);dz+=step(1.,dz)*(1.-dz)+mix(0.,2.,clamp((dz-2.)/2.,0.,1.));float mdz=(dz-0.5)*2.;extrude-=extrude*UNPACK_SCALING(a_scaling.x)*mdz;float dwdz=UNPACK_SCALING(a_scaling.y);float sdwdz=sign(step(0.,dwdz)-0.5);offset-=offset*abs(dwdz)*((1.-step(0.,sdwdz))-(dz*-sdwdz));float ssz=exp2(-dz-(u_tile_origin.z-u_tile_origin.w));extrude*=ssz;offset*=ssz;\n#ifdef TANGRAM_BLOCK_WIDTH\nfloat width=1.;\n#pragma tangram: width\nextrude*=width;\n#endif\nposition.xy+=extrude+offset;\n#endif\nv_world_position=wrapWorldPosition(u_model*position);v_local_space_position=position;position=u_modelView*position;\n#pragma tangram: position\nv_position=position;v_normal=normalize(u_normalMatrix*TANGRAM_NORMAL);v_color=a_color;\n#if defined(TANGRAM_LIGHTING_VERTEX)\nvec3 normal=v_normal;\n#pragma tangram: normal\nv_lighting=calculateLighting(position.xyz-u_eye,normal,vec4(1.));\n#endif\ncameraProjection(position);applyLayerOrder(a_position.w+u_tile_proxy_depth+1.,position);\n#if defined(SNAP_TO_PIXEL_GRID)\nsnapToPixelGrid(position);\n#endif\ngl_Position=position;}",shaderSrc_polygonsFragment="uniform vec2 u_resolution;uniform vec3 u_map_position;uniform vec4 u_tile_origin;uniform float u_meters_per_pixel;uniform float u_device_pixel_ratio;uniform mat3 u_normalMatrix;uniform mat3 u_inverseNormalMatrix;varying vec4 v_position;varying vec4 v_local_space_position;varying vec3 v_normal;varying vec4 v_color;varying vec4 v_world_position;\n#ifdef TANGRAM_EXTRUDE_LINES\nuniform bool u_has_line_texture;uniform sampler2D u_texture;uniform float u_texture_ratio;uniform vec4 u_dash_background_color;\n#endif\n#define TANGRAM_NORMAL v_normal\n#if defined(TANGRAM_TEXTURE_COORDS) || defined(TANGRAM_EXTRUDE_LINES)\nvarying vec2 v_texcoord;\n#endif\n#ifdef TANGRAM_MODEL_POSITION_BASE_ZOOM_VARYING\nvarying vec4 v_modelpos_base_zoom;\n#endif\n#if defined(TANGRAM_LIGHTING_VERTEX)\nvarying vec4 v_lighting;\n#endif\n#pragma tangram: camera\n#pragma tangram: material\n#pragma tangram: lighting\n#pragma tangram: raster\n#pragma tangram: global\n#pragma tangram: utils\nvoid main(void){\n#pragma tangram: setup\nvec4 color=v_color;vec3 normal=TANGRAM_NORMAL;\n#ifdef TANGRAM_CROP_BY_TILE\nif(isLocalSpacePixelOutsideTile(v_local_space_position,TANGRAM_TILE_SCALE.x)){discard;}\n#endif\n#ifdef TANGRAM_RASTER_TEXTURE_COLOR\ncolor*=sampleRaster();\n#endif\n#ifdef TANGRAM_EXTRUDE_LINES\nif(u_has_line_texture){vec2 _line_st=vec2(v_texcoord.x,fract(v_texcoord.y/u_texture_ratio));vec4 _line_color=texture2D(u_texture,_line_st);if(_line_color.a<TANGRAM_ALPHA_TEST){\n#if !defined(TANGRAM_BLEND_OVERLAY) && !defined(TANGRAM_BLEND_INLAY)\nif(u_dash_background_color.a==0.){discard;}color=u_dash_background_color;\n#else\ncolor=vec4(u_dash_background_color.rgb,color.a*step(TANGRAM_EPSILON,u_dash_background_color.a));\n#endif\n}else{color*=_line_color;}}\n#endif\n#ifdef TANGRAM_RASTER_TEXTURE_NORMAL\nnormal=normalize(sampleRaster().rgb*2.-1.);\n#endif\n#if defined(TANGRAM_LIGHTING_FRAGMENT) && defined(TANGRAM_MATERIAL_NORMAL_TEXTURE)\ncalculateNormal(normal);\n#endif\n#if !defined(TANGRAM_LIGHTING_VERTEX)\n#pragma tangram: normal\n#endif\n#pragma tangram: color\n#if defined(TANGRAM_LIGHTING_FRAGMENT)\ncolor=calculateLighting(v_position.xyz-u_eye,normal,color);\n#elif defined(TANGRAM_LIGHTING_VERTEX)\ncolor*=v_lighting;\n#endif\n#pragma tangram: filter\ngl_FragColor=color;}",Polygons=Object.create(Style);Object.assign(Polygons,{name:"polygons",built_in:!0,vertex_shader_src:shaderSrc_polygonsVertex,fragment_shader_src:shaderSrc_polygonsFragment,selection:!0,init:function(){Style.init.apply(this,arguments),this.defines.TANGRAM_NORMAL_ATTRIBUTE=!0,this.defines.TANGRAM_LAYER_ORDER=!0,this.defines.TANGRAM_CROP_BY_TILE=this.crop_by_tile,this.texcoords&&(this.defines.TANGRAM_TEXTURE_COORDS=!0)},vertexLayoutForMeshVariant:function(){var t;return this.vertex_layout||(t=[{name:"a_position",size:4,type:gl$1.SHORT,normalized:!1},{name:"a_normal",size:3,type:gl$1.BYTE,normalized:!0},{name:"a_color",size:4,type:gl$1.UNSIGNED_BYTE,normalized:!0},{name:"a_selection_color",size:4,type:gl$1.UNSIGNED_BYTE,normalized:!0}],this.texcoords&&t.push({name:"a_texcoord",size:2,type:gl$1.UNSIGNED_SHORT,normalized:!0}),this.vertex_layout=new VertexLayout(t)),this.vertex_layout},_parseFeature:function(t,e,r){var i=this.feature_style;return i.color=this.parseColor(e.color,r),i.color?(i.z=e.z&&StyleParser.evalCachedDistanceProperty(e.z,r)||StyleParser.defaults.z,i.z*=Geo$1.height_scale,i.extrude=StyleParser.evalProperty(e.extrude,r),i.extrude&&(!0===i.extrude?(i.height=void 0!==t.properties.height?t.properties.height:StyleParser.defaults.height,i.min_height=void 0!==t.properties.min_height?t.properties.min_height:StyleParser.defaults.min_height):"number"==typeof i.extrude?(i.height=i.extrude,i.min_height=0):Array.isArray(i.extrude)&&(i.min_height=i.extrude[0],i.height=i.extrude[1]),i.height*=Geo$1.height_scale,i.min_height*=Geo$1.height_scale),i.tile_edges=e.tile_edges,i):null},_preprocess:function(t){return t.color=StyleParser.createColorPropertyCache(t.color),t.z=StyleParser.createPropertyCache(t.z,StyleParser.parseUnits),t},makeVertexTemplate:function(t){var e=0;return this.vertex_template[e++]=0,this.vertex_template[e++]=0,this.vertex_template[e++]=t.z||0,this.vertex_template[e++]=this.scaleOrder(t.order),this.vertex_template[e++]=0,this.vertex_template[e++]=0,this.vertex_template[e++]=127,this.vertex_template[e++]=255*t.color[0],this.vertex_template[e++]=255*t.color[1],this.vertex_template[e++]=255*t.color[2],this.vertex_template[e++]=255*t.color[3],this.selection&&(this.vertex_template[e++]=255*t.selection_color[0],this.vertex_template[e++]=255*t.selection_color[1],this.vertex_template[e++]=255*t.selection_color[2],this.vertex_template[e++]=255*t.selection_color[3]),this.texcoords&&(this.vertex_template[e++]=0,this.vertex_template[e++]=0),this.vertex_template},buildPolygons:function(t,e,r,i){var n=this.makeVertexTemplate(e),o={texcoord_index:this.vertex_layout.index.a_texcoord,texcoord_normalize:65535,remove_tile_edges:!e.tile_edges,tile_edge_tolerance:Geo$1.tile_scale*i.tile.pad_scale*4,winding:i.winding};return e.extrude&&e.height?buildExtrudedPolygons(t,e.z,e.height,e.min_height,r.vertex_data,n,this.vertex_layout.index.a_normal,127,o):buildPolygons(t,r.vertex_data,n,o)}});var zero_vec2=[0,0],CAP_TYPE={butt:0,square:1,round:2},JOIN_TYPE={miter:0,bevel:1,round:2},DEFAULT={MITER_LIMIT:3,TEXCOORD_NORMALIZE:1,TEXCOORD_RATIO:1,MIN_FAN_WIDTH:5},v_scale_adjust=Geo$1.tile_scale,zero_v=[0,0],one_v=[1,0],mid_v=[.5,0];function buildPolylines(t,e,r,i,n){var o,a,s=n.closed_polygon,l=n.remove_tile_edges,c=n.tile_edge_tolerance,u=n.texcoord_index,h=(n.texcoord_scale,n.texcoord_width),p=n.texcoord_ratio,f=n.texcoord_normalize,d=n.extrude_index,y=n.offset_index,g=n.join,v=n.cap,m=n.miter_limit,_=n.offset,b=n.crop_by_tile,w=v?CAP_TYPE[v]:CAP_TYPE.butt,x=g?JOIN_TYPE[g]:JOIN_TYPE.miter;x===JOIN_TYPE.miter&&(o=(m=m||DEFAULT.MITER_LIMIT)*m),u&&(f=f||DEFAULT.TEXCOORD_NORMALIZE,a=1/(h*(p=p||DEFAULT.TEXCOORD_RATIO)*v_scale_adjust));for(var E={closed_polygon:s,remove_tile_edges:l,tile_edge_tolerance:c,miter_len_sq:o,join_type:x,cap_type:w,vertex_data:r,vertex_template:i,half_width:e/2,extrude_index:d,offset_index:y,v_scale:a,texcoord_index:u,texcoord_width:h,texcoord_normalize:f,offset:_,geom_count:0,crop_by_tile:b},T=0;T<t.length;T++)buildPolyline(t[T],E);if(E.extra_lines)for(var A=0;A<E.extra_lines.length;A++)buildPolyline(E.extra_lines[A],E);return E.geom_count}function buildPolyline(t,e){if(!(t.length<2)){var r,i,n=e.join_type,o=e.cap_type,a=e.closed_polygon,s=e.remove_tile_edges,l=e.tile_edge_tolerance,c=e.v_scale,u=e.miter_len_sq,h=e.crop_by_tile,p=null!=e.texcoord_index,f=0;if(a&&n===JOIN_TYPE.miter){var d=getTileBoundaryIndex(t);if(0!==d){var y=permuteLine(t,d);return e.extra_lines=e.extra_lines||[],void e.extra_lines.push(y)}}var g=0,v=t.length-1,m=0;for(E=t[g],T=t[g+1];Vector$1.isEqual(E,T);)if(E=T,T=t[1+ ++g],m++,g===t.length-1)return;for(;Vector$1.isEqual(t[v],t[v-1]);)if(m++,0==--v)return;if(!(t.length<2+m))if(i=Vector$1.normalize(Vector$1.perp(E,T)),s&&outsideTile(E,T,l)){var _=getNextNonBoundarySegment(t,g,l);_&&(e.extra_lines=e.extra_lines||[],e.extra_lines.push(_))}else{a?startPolygon(E,r=Vector$1.normalize(Vector$1.perp(t[v-1],E)),i,n,e):(!h&&isCoordOutsideTile(E)||(addCap(E,f,i,o,!0,e),p&&o!==CAP_TYPE.butt&&(f+=.5*c*e.texcoord_width)),addVertex(E,i,i,1,f,e,1),addVertex(E,i,i,0,f,e,-1)),p&&(f+=c*Vector$1.length(Vector$1.sub(T,E)));for(var b=g+1;b<v;b++){var w=b,x=b+1,E=t[w],T=t[x];if(!Vector$1.isEqual(E,T)){if(s&&outsideTile(E,T,l)){addVertex(E,i,i,1,f,e,1),addVertex(E,i,i,0,f,e,-1),indexPairs(1,e);var A=getNextNonBoundarySegment(t,w+1,l);return void(A&&(e.extra_lines=e.extra_lines||[],e.extra_lines.push(A)))}r=i,i=Vector$1.normalize(Vector$1.perp(E,T)),n===JOIN_TYPE.miter?addMiter(f,E,r,i,u,!1,e):addJoin(n,f,E,r,i,!1,e),p&&(f+=c*Vector$1.length(Vector$1.sub(T,E)))}}E=T,r=i,a?endPolygon(E,r,i=Vector$1.normalize(Vector$1.perp(E,t[1])),n,f,e):(addVertex(E,r,i,1,f,e,1),addVertex(E,r,i,0,f,e,-1),indexPairs(1,e),!h&&isCoordOutsideTile(E)||addCap(E,f,r,o,!1,e))}}}function getTileBoundaryIndex(t){if(isCoordOutsideTile(t[0]))return 0;for(var e=0;e<t.length;e++)if(isCoordOutsideTile(t[t.length-1-e]))return t.length-1-e;return 0}function getNextNonBoundarySegment(t,e,r){for(var i=e;t[i+1]&&outsideTile(t[i],t[i+1],r);)i++;return 2<=t.length-i&&t.slice(i)}function startPolygon(t,e,r,i,n){void 0===i||isCoordOutsideTile(t)&&!n.crop_by_tile?(addVertex(t,r,r,1,0,n,1),addVertex(t,r,r,0,0,n,-1)):i===JOIN_TYPE.miter?addMiter(0,t,e,r,n.miter_len_sq,!0,n):addJoin(i,0,t,e,r,!0,n)}function endPolygon(t,e,r,i,n,o){var a;isCoordOutsideTile(t)&&!o.crop_by_tile?(addVertex(t,e,e,1,n,o,1),addVertex(t,e,e,0,n,o,-1)):(a=createMiterVec(e,r),i===JOIN_TYPE.miter&&Vector$1.lengthSq(a)>o.miter_len_sq&&(i=JOIN_TYPE.bevel),i===JOIN_TYPE.miter?(addVertex(t,a,e,1,n,o,1),addVertex(t,a,e,0,n,o,-1)):(addVertex(t,e,e,1,n,o,1),addVertex(t,e,e,0,n,o,-1))),indexPairs(1,o)}function createMiterVec(t,e){var r=Vector$1.normalize(Vector$1.add(t,e)),i=2/(1+Math.abs(Vector$1.dot(t,r)));return Vector$1.mult(r,i*i)}function addMiter(t,e,r,i,n,o,a){var s=createMiterVec(r,i);Vector$1.lengthSq(s)>n?addJoin(JOIN_TYPE.bevel,t,e,r,i,o,a):(addVertex(e,s,s,1,t,a,1),addVertex(e,s,s,0,t,a,-1),o||indexPairs(1,a))}function addJoin(t,e,r,i,n,o,a){var s=createMiterVec(i,n),l=0<n[0]*i[1]-n[1]*i[0];null!=a.texcoord_index&&(zero_v[1]=e,one_v[1]=e),l?(addVertex(r,s,s,1,e,a,1),addVertex(r,i,s,0,e,a,-1),o||indexPairs(1,a),addFan(r,Vector$1.neg(i),s,Vector$1.neg(n),s,zero_v,one_v,zero_v,!1,t===JOIN_TYPE.bevel,a),addVertex(r,s,s,1,e,a,1),addVertex(r,n,s,0,e,a,-1)):(addVertex(r,i,s,1,e,a,1),addVertex(r,s,s,0,e,a,-1),o||indexPairs(1,a),addFan(r,i,Vector$1.neg(s),n,s,one_v,zero_v,one_v,!1,t===JOIN_TYPE.bevel,a),addVertex(r,n,s,1,e,a,1),addVertex(r,s,s,0,e,a,-1))}function indexPairs(t,e){for(var r=e.vertex_data.vertex_elements,i=e.vertex_data.vertex_count-2*t-2,n=0;n<t;n++)r.push(i+2*n+2),r.push(i+2*n+1),r.push(i+2*n),r.push(i+2*n+2),r.push(i+2*n+3),r.push(i+2*n+1),e.geom_count+=2}function addVertex(t,e,r,i,n,o,a){var s=o.vertex_template,l=o.vertex_data;s[0]=t[0],s[1]=t[1];var c=o.half_width*a;s[o.extrude_index+0]=e[0]*c,s[o.extrude_index+1]=e[1]*c,o.offset&&(s[o.offset_index+0]=r[0]*o.offset,s[o.offset_index+1]=r[1]*o.offset),null!=o.texcoord_index&&(s[o.texcoord_index+0]=i*o.texcoord_normalize,s[o.texcoord_index+1]=n*o.texcoord_normalize),l.addVertex(s)}var uvCurr=[0,0];function addFan(t,e,r,i,n,o,a,s,l,c,u){for(var h=e[0]*i[1]-e[1]*i[0],p=Vector$1.dot(e,i),f=Math.atan2(h,p);f>=Math.PI;)f-=2*Math.PI;if(c)d=1;else{var d=trianglesPerArc(f,u.half_width);if(d<1)return}var y=u.vertex_data.vertex_count,g=u.vertex_data.vertex_elements;addVertex(t,r,n,a[0],a[1],u,1),addVertex(t,e,n,o[0],o[1],u,1);var v,m,_=e,b=null!=u.texcoord_index;b&&(l?v=Vector$1.sub(o,a):(uvCurr=Vector$1.copy(o),m=Vector$1.div(Vector$1.sub(s,o),d)));for(var w,x=f/d,E=f<0?-1:1,T=0<h?(w=2,1):(w=1,2),A=0;A<d;A++)0===A&&f<0&&(_=Vector$1.neg(_)),_=Vector$1.rot(_,x),b&&(l?(v=Vector$1.rot(v,x),uvCurr[0]=v[0]+a[0],uvCurr[1]=v[1]*u.texcoord_width*u.v_scale+a[1]):uvCurr=Vector$1.add(uvCurr,m)),addVertex(t,_,n,uvCurr[0],uvCurr[1],u,E),g.push(y+A+w),g.push(y),g.push(y+A+T)}function addCap(t,e,r,i,n,o){var a,s=Vector$1.neg(r),l=null!=o.texcoord_index;switch(i){case CAP_TYPE.square:n?(a=[r[1],-r[0]],addVertex(t,Vector$1.add(r,a),r,1,e,o,1),addVertex(t,Vector$1.add(s,a),r,0,e,o,1),l&&(e+=.5*o.texcoord_width*o.v_scale),addVertex(t,r,r,1,e,o,1),addVertex(t,s,r,0,e,o,1)):(a=[-r[1],r[0]],addVertex(t,r,r,1,e,o,1),addVertex(t,s,r,0,e,o,1),l&&(e+=.5*o.texcoord_width*o.v_scale),addVertex(t,Vector$1.add(r,a),r,1,e,o,1),addVertex(t,Vector$1.add(s,a),r,0,e,o,1)),indexPairs(1,o);break;case CAP_TYPE.round:var c,u,h=zero_v,p=one_v,f=mid_v;n?(c=r,u=s,l&&(e+=.5*o.texcoord_width*o.v_scale,h=one_v,p=zero_v,f=mid_v)):(c=s,u=r),l&&(zero_v[1]=e,one_v[1]=e,mid_v[1]=e),addFan(t,c,zero_vec2,u,r,h,f,p,!0,!1,o);break;case CAP_TYPE.butt:return}}function trianglesPerArc(t,e){t<0&&(t=-t);var r=e>2*DEFAULT.MIN_FAN_WIDTH?Math.log2(e/DEFAULT.MIN_FAN_WIDTH):1;return Math.ceil(t/Math.PI*r)}function permuteLine(t,e){for(var r=[],i=0;i<t.length;i++){var n=(i+e)%t.length;0!=n&&r.push(t[n])}return r.push(r[0]),r}var default_dash_color=[255,255,255,255],default_background_color=[0,0,0,0];function renderDashArray(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=e.dash_color||default_dash_color,i=e.background_color||default_background_color,n=t,o=e.scale||1;n.length%2==1&&Array.prototype.push.apply(n,n);for(var a=!0,s=[],l=0;l<n.length;l++){for(var c=Math.floor(n[l]*o),u=0;u<c;u++)Array.prototype.push.apply(s,a?r:i);a=!a}return{pixels:s=new Uint8Array(s),length:s.length/4}}var Lines=Object.create(Style);Lines.vertex_layouts=[[],[]],Lines.dash_textures={};var DASH_SCALE=20;function buildPolylines$1(t,e,r,i,n,o){for(var a={closed:o,vertex_data:r,vertex_template:i,half_width:e/2,vertex_layout_index:n,geom_count:0},s=0,l=t.length;s<l;s++)buildPolyline$1(t[s],a);return a.geom_count}function buildPolyline$1(t,e){if(!(t.length<2)){for(var r,i,n=[t[0]],o=0,a=[],s=[],l=1,c=t.length;l<c;l++)t[l][0]===t[l-1][0]&&t[l][1]===t[l-1][1]||(n.push(t[l]),r=Vector$1.sub(t[l],t[l-1]),i=Vector$1.length(r),a.push(r),s.push([o,o+i]),o+=i);if(!(n.length<2)){var u=0,h=a[a.length-1],p=a[0],f=a[1],d=[0,0];2<n.length&&(e.closed&&(d[0]=Vector$1.signedAngleBetween(h,p)),d[1]=Vector$1.signedAngleBetween(p,f));var y=n[0],g=s[0];e.closed?(addVertex$1(y,e,u++,g,o,d,[h,p]),addVertex$1(y,e,u++,g,o,d,[h,p])):(addVertex$1(y,e,u++,g,o,d,[p,p]),addVertex$1(y,e,u++,g,o,d,[p,p]));for(var v=1,m=n.length-1;v<m;v++)y=n[v],h=a[v-1],p=a[v],f=a[v+1],addVertex$1(y,e,u++,g=s[v-1],o,d,[h,p]),addVertex$1(y,e,u++,g,o,d,[h,p]),triangulate(e),g=s[v],d[0]=d[1],d[1]=v!==m-1?Vector$1.signedAngleBetween(p,f):e.closed?Vector$1.signedAngleBetween(p,a[0]):0,addVertex$1(y,e,u++,g,o,d,[h,p]),addVertex$1(y,e,u++,g,o,d,[h,p]);y=n[n.length-1],g=s[s.length-1],p=a[a.length-1],e.closed?(addVertex$1(y,e,u++,g,o,d,[p,a[0]]),addVertex$1(y,e,u++,g,o,d,[p,a[0]])):(addVertex$1(y,e,u++,g,o,d,[p,p]),addVertex$1(y,e,u++,g,o,d,[p,p])),triangulate(e)}}}function triangulate(t){var e=t.vertex_data.vertex_elements,r=t.vertex_data.vertex_count-4;e.push(2+r),e.push(1+r),e.push(r),e.push(2+r),e.push(3+r),e.push(1+r),t.geom_count+=2}Object.assign(Lines,{name:"lines",built_in:!0,vertex_shader_src:shaderSrc_polygonsVertex,fragment_shader_src:shaderSrc_polygonsFragment,selection:!0,init:function(){Style.init.apply(this,arguments),this.styles=this.styles||{},this.defines.TANGRAM_LAYER_ORDER=!0,this.defines.TANGRAM_EXTRUDE_LINES=!0,this.defines.TANGRAM_CROP_BY_TILE=this.crop_by_tile,this.defines.TANGRAM_TEXTURE_COORDS=!0,this.outline_feature_style={},this.inline_feature_style=this.feature_style},calcDistance:function(t,e){return t&&StyleParser.evalCachedDistanceProperty(t,e)||0},calcDistanceNextZoom:function(t,e){e.zoom++;var r=this.calcDistance(t,e);return e.zoom--,r},calcWidth:function(t,e,r){var i=this.calcDistance(t.width,r);if(!(i<0)){var n,o=t.next_width?this.calcDistanceNextZoom(t.next_width,r):i/2;return!(0===i&&0===o||o<0||(e.width_unscaled=i,e.next_width_unscaled=o,t.next_width?(n=.5*(i+(o*=2)),e.width=n*r.units_per_meter_overzoom,e.width_scale=1-o/n):(e.width=i*r.units_per_meter_overzoom,e.width_scale=0),t.texcoords&&(t.inline_texcoord_width?e.texcoord_width=t.inline_texcoord_width:e.texcoord_width=(e.width_unscaled||e.next_width_unscaled)*r.units_per_meter_overzoom/r.tile.overzoom2),0))}},calcOffset:function(t,e,r){var i,n;t.offset_precalc?(e.offset=t.offset_precalc,e.offset_scale=t.offset_scale_precalc):t.offset?(i=this.calcDistance(t.offset,r),t.next_offset?(n=2*this.calcDistanceNextZoom(t.next_offset,r),Math.abs(i)>=Math.abs(n)?(e.offset=i*r.units_per_meter_overzoom,e.offset_scale=0!==i?1-n/i:0):(e.offset=n*r.units_per_meter_overzoom,e.offset_scale=0!=n?-1*(1-i/n):0)):(e.offset=i*r.units_per_meter_overzoom,e.offset_scale=0)):(e.offset=0,e.offset_scale=0),StyleParser.evalProperty(t.offset_reverse,r)&&(e.offset*=-1)},_parseFeature:function(t,e,r){var i,n,o=this.feature_style;if(!1!==this.calcWidth(e,o,r)&&(this.calcOffset(e,o,r),o.color=this.parseColor(e.color,r),o.color))return o.variantKey=e.variantKey,o.z=e.z&&StyleParser.evalCachedDistanceProperty(e.z||0,r)||StyleParser.defaults.z,o.height=t.properties.height||StyleParser.defaults.height,o.extrude=StyleParser.evalProperty(e.extrude,r),o.extrude&&("number"==typeof o.extrude?o.height=o.extrude:Array.isArray(o.extrude)&&(o.height=o.extrude[1])),o.extrude&&o.height&&(o.z+=o.height),o.z*=Geo$1.height_scale,o.height*=Geo$1.height_scale,o.cap=StyleParser.evalProperty(e.cap,r),o.join=StyleParser.evalProperty(e.join,r),o.miter_limit=StyleParser.evalProperty(e.miter_limit,r),o.tile_edges=e.tile_edges,o.outline=o.outline||{width:{},next_width:{},preprocessed:!0},e.outline&&!1!==e.outline.visible&&e.outline.color&&e.outline.width?(i=2*this.calcDistance(e.outline.width,r),n=2*this.calcDistanceNextZoom(e.outline.next_width,r),0==i&&0==n||i<0||n<0?(o.outline.width.value=null,o.outline.next_width.value=null,o.outline.color=null,o.outline.inline_texcoord_width=null,o.outline.texcoords=!1):(o.outline.width.value=i+o.width_unscaled,o.outline.next_width.value=n+o.next_width_unscaled,o.outline.inline_texcoord_width=o.texcoord_width,o.outline.offset_precalc=o.offset,o.outline.offset_scale_precalc=o.offset_scale,o.outline.color=e.outline.color,o.outline.cap=e.outline.cap,o.outline.join=e.outline.join,o.outline.miter_limit=e.outline.miter_limit,o.outline.texcoords=e.outline.texcoords,o.outline.style=e.outline.style,o.outline.variantKey=e.outline.variantKey,e.outline.order?o.outline.order=this.parseOrder(e.outline.order,r):o.outline.order=o.order,o.outline.order>o.order&&(o.outline.order=o.order),o.outline.order-=.5,o.outline.variant_order=0)):(o.outline.width.value=null,o.outline.next_width.value=null,o.outline.color=null,o.outline.inline_texcoord_width=null),o},_preprocess:function(t,e){var r,i=this.sources[e]?this.sources[e].config.uid:"";return t.color=StyleParser.createColorPropertyCache(t.color),t.width=StyleParser.createPropertyCache(t.width,StyleParser.parseUnits),t.width&&t.width.type!==StyleParser.CACHE_TYPE.STATIC&&(t.next_width=StyleParser.createPropertyCache(t.width,StyleParser.parseUnits)),t.offset=t.offset&&StyleParser.createPropertyCache(t.offset,StyleParser.parseUnits),t.offset&&t.offset.type!==StyleParser.CACHE_TYPE.STATIC&&(t.next_offset=StyleParser.createPropertyCache(t.offset,StyleParser.parseUnits)),t.z=StyleParser.createPropertyCache(t.z,StyleParser.parseUnits),t.dash=void 0!==t.dash?t.dash:this.dash,t.dash_key=t.dash&&this.dashTextureKey(t.dash,i),t.dash_background_color=void 0!==t.dash_background_color?t.dash_background_color:this.dash_background_color,t.dash_background_color=t.dash_background_color&&StyleParser.parseColor(t.dash_background_color),t.texture_merged=t.dash_key||(void 0!==t.texture?t.texture:this.texture),t.texcoords=this.texcoords||t.texture_merged?1:0,this.addMeshVariantForDraw(this.base,t),t.outline&&(t.outline.style=t.outline.style||this.name,t.outline.color=StyleParser.createColorPropertyCache(t.outline.color),t.outline.width=StyleParser.createPropertyCache(t.outline.width,StyleParser.parseUnits),t.outline.next_width=StyleParser.createPropertyCache(t.outline.width,StyleParser.parseUnits),t.outline.cap=t.outline.cap||t.cap,t.outline.join=t.outline.join||t.join,t.outline.miter_limit=t.outline.miter_limit||t.miter_limit,t.outline.offset=t.offset,(r=this.styles[t.outline.style])?(t.outline.dash=void 0!==t.outline.dash?t.outline.dash:r.dash,t.outline.texture=void 0!==t.outline.texture?t.outline.texture:r.texture,null!=t.outline.dash?(t.outline.dash_key=t.outline.dash&&this.dashTextureKey(t.outline.dash,i),t.outline.texture_merged=t.outline.dash_key):null===t.outline.dash||null!=t.outline.texture?(t.outline.dash_key=null,t.outline.texture_merged=t.outline.texture):(t.outline.dash=t.dash,t.outline.dash_key=t.outline.dash&&this.dashTextureKey(t.outline.dash,i),t.outline.texture_merged=t.outline.dash_key),t.outline.dash_background_color=void 0!==t.outline.dash_background_color?t.outline.dash_background_color:r.dash_background_color,t.outline.dash_background_color=void 0!==t.outline.dash_background_color?t.outline.dash_background_color:t.dash_background_color,t.outline.dash_background_color=t.outline.dash_background_color&&StyleParser.parseColor(t.outline.dash_background_color),t.outline.texcoords=r.texcoords||t.outline.texture_merged?1:0,this.addMeshVariantForDraw(this.base,t.outline)):(log({level:"warn",once:!0},"Layer '".concat(t.layers[t.layers.length-1],"': ")+"line 'outline' specifies non-existent draw style '".concat(t.outline.style,"' (or maybe the style is ")+"defined but is missing a 'base' or has another error), skipping outlines in layer"),t.outline=null)),t},dashTextureKey:function(t,e){return"__dash_"+e+"_"+this.scene_id+"_"+JSON.stringify(t)},getDashTexture:function(t,e){var r,i=this.dashTextureKey(t,this.sources[e].config.uid);null==Lines.dash_textures[i]&&(Lines.dash_textures[i]=!0,r=renderDashArray(t,{scale:DASH_SCALE}),this.textureManager.create(this.gl,i,{data:r.pixels,height:r.length,width:1,filtering:"nearest"}))},endData:function(t){var e=this;return Style.endData.call(this,t).then((function(r){if(r){r.uniforms.u_has_line_texture=!1,r.uniforms.u_texture=e.textureManager.default,r.uniforms.u_v_scale_adjust=Geo$1.tile_scale;var i=[];for(var n in r.meshes)!function(n){var o,a,s=r.meshes[n].variant;s.texture&&((o=r.meshes[n].uniforms=r.meshes[n].uniforms||{}).u_has_line_texture=!0,o.u_texture=s.texture,o.u_texture_ratio=1,s.dash&&(o.u_v_scale_adjust=Geo$1.tile_scale*DASH_SCALE,o.u_dash_background_color=s.dash_background_color||[0,0,0,0]),s.dash_key&&null==Lines.dash_textures[s.dash_key]&&(Lines.dash_textures[s.dash_key]=!0,WorkerBroker.postMessage(e.main_thread_target+".getDashTexture",s.dash,t.source)),null==e.textureManager.textures[s.texture]?i.push(e.textureManager.syncTexturesToWorker([s.texture]).then((function(t){var e=t[s.texture];e&&(o.u_texture_ratio=e.height/e.width)}))):(a=e.textureManager.textures[s.texture],o.u_texture_ratio=a.height/a.width))}(n);return t.mesh_data[e.name]=r,Promise.all(i).then((function(){return r}))}return r}))},computeVariantForDraw:function(t){var e=t.offset?1:0;return t.dash_key&&(e+=t.dash_key,t.dash_background_color&&(e+=t.dash_background_color)),t.texture_merged&&(e+=t.texture_merged),e=hashString(e+="/"+t.texcoords),{key:t.variantKey=e,order:t.variant_order,offset:t.offset?1:0,texcoords:t.texcoords,texture:t.texture_merged,dash:t.dash,dash_key:t.dash_key,dash_background_color:t.dash_background_color}},vertexLayoutForMeshVariant:function(t){var e;return null==Lines.vertex_layouts[t.key]&&(e=[{name:"a_position",size:4,type:gl$1.SHORT,normalized:!1},{name:"a_extrude",size:2,type:gl$1.SHORT,normalized:!1},{name:"a_offset",size:2,type:gl$1.SHORT,normalized:!1,static:t.offset?null:[0,0]},{name:"a_scaling",size:2,type:gl$1.SHORT,normalized:!1},{name:"a_texcoord",size:2,type:gl$1.UNSIGNED_SHORT,normalized:!0,static:t.texcoords?null:[0,0]},{name:"a_color",size:4,type:gl$1.UNSIGNED_BYTE,normalized:!0},{name:"a_selection_color",size:4,type:gl$1.UNSIGNED_BYTE,normalized:!0}],Lines.vertex_layouts[t.key]=new VertexLayout(e)),Lines.vertex_layouts[t.key]},makeVertexTemplate:function(t,e){var r=0;return this.vertex_template[r++]=0,this.vertex_template[r++]=0,this.vertex_template[r++]=t.z||0,this.vertex_template[r++]=this.scaleOrder(t.order),this.vertex_template[r++]=0,this.vertex_template[r++]=0,e.variant.offset&&(this.vertex_template[r++]=0,this.vertex_template[r++]=0),this.vertex_template[r++]=1024*t.width_scale,this.vertex_template[r++]=1024*t.offset_scale,e.variant.texcoords&&(this.vertex_template[r++]=0,this.vertex_template[r++]=0),this.vertex_template[r++]=255*t.color[0],this.vertex_template[r++]=255*t.color[1],this.vertex_template[r++]=255*t.color[2],this.vertex_template[r++]=255*t.color[3],this.selection&&(this.vertex_template[r++]=255*t.selection_color[0],this.vertex_template[r++]=255*t.selection_color[1],this.vertex_template[r++]=255*t.selection_color[2],this.vertex_template[r++]=255*t.selection_color[3]),this.vertex_template},buildLines:function(t,e,r,i,n){var o;this.feature_style=this.outline_feature_style,!e.outline||null==e.outline.color||null==e.outline.width.value||(o=this.styles[e.outline.style])&&o.addFeature(i.feature,e.outline,i),this.feature_style=this.inline_feature_style;var a=r.vertex_data,s=a.vertex_layout,l=this.makeVertexTemplate(e,r);return buildPolylines(t,e.width,a,l,{cap:e.cap,join:e.join,miter_limit:e.miter_limit,extrude_index:s.index.a_extrude,offset_index:s.index.a_offset,texcoord_index:s.index.a_texcoord,texcoord_width:e.texcoord_width,texcoord_normalize:65535,closed_polygon:n&&n.closed_polygon,remove_tile_edges:!e.tile_edges&&n&&n.remove_tile_edges,tile_edge_tolerance:Geo$1.tile_scale*i.tile.pad_scale*2,offset:e.offset,crop_by_tile:this.crop_by_tile})},buildPolygons:function(t,e,r,i){for(var n=0,o=0;o<t.length;o++)n+=this.buildLines(t[o],e,r,i,{closed_polygon:!0,remove_tile_edges:!this.crop_by_tile});return n}});var TEX_COORDS=[[1,1],[1,-1],[-1,1],[-1,-1]];function addVertex$1(t,e,r,i,n,o,a){var s,l=e.vertex_template,c=e.vertex_data;setAttribute(e,"a_position",t),setAttribute(e,"a_width",e.half_width),e.vertex_layout_index.a_barycentric&&((s=[0,0,0])[r%3]=1,setAttribute(e,"a_barycentric",s)),setAttribute(e,"a_tangents",a[0].concat(a[1])),setAttribute(e,"a_segment",i),setAttribute(e,"a_texcoord",TEX_COORDS[r%4]),setAttribute(e,"a_length",n),setAttribute(e,"a_closed",e.closed?1:0),setAttribute(e,"a_angles",o),c.addVertex(l)}function setAttribute(t,e,r){var i=r.length,n=t.vertex_template,o=t.vertex_layout_index[e],a=0;if(i)for(;a!==i;)n[o+a]=r[a],a++;else n[o+a]=r}function buildPatternBuffer(t,e){for(var r=t.reduce((function(t,e){return t+e})),i=0,n=[],o=0,a=t.length;o<=a;o+=2){var s=Math.max(1e-4,t[o%a]),l=Math.max(1e-4,t[(o+1)%a]);n.push(i,i+s),i+=s+l}for(var c=new Uint8Array(4*e),u=0,h=0;h<e;h++)!function(t){var i=r*t/(e-1),o=minIdx(n.map((function(t){return Math.abs(t-i)}))),a=void 0,s=void 0,l=o%2==0?(a=i<=n[o]?1:0,s=n[o],n[o+1]):(a=i>n[o]?2:0,s=n[o-1],n[o]);c[u++]=n[o],c[u++]=a,c[u++]=s,c[u++]=l}(h);return c}function minIdx(t){for(var e=t[0],r=0,i=1,n=t.length;i<n;i++)t[i]<e&&(e=t[r=i]);return r}var vertex_shader_src="uniform vec2 u_resolution;uniform vec4 u_tile_origin;uniform float u_tile_proxy_depth;uniform float u_meters_per_pixel;uniform float u_device_pixel_ratio;uniform sampler2D u_uniforms;uniform mat4 u_model;uniform mat4 u_modelView;uniform mat3 u_normalMatrix;uniform mat3 u_inverseNormalMatrix;uniform vec3 u_map_position;uniform float u_antialias;uniform vec2 u_linecaps;uniform float u_linejoin;uniform float u_miter_limit;uniform float u_dash_index;uniform vec2 u_dash_caps;uniform float u_dash_phase;uniform float u_dash_period;attribute vec4 a_position;attribute vec4 a_color;attribute float a_width;\n#ifdef TANGRAM_DEBUG_TRIANGLES\nattribute vec3 a_barycentric;\n#endif\nattribute vec2 a_normal;attribute float a_length;attribute vec2 a_segment;attribute vec2 a_texcoord;attribute vec2 a_angles;attribute vec4 a_tangents;attribute float a_closed;varying vec4 v_position;varying vec4 v_local_space_position;varying vec3 v_normal;varying vec4 v_color;varying vec4 v_world_position;\n#ifdef TANGRAM_DEBUG_TRIANGLES\nvarying vec3 v_barycentric;\n#endif\nvarying vec2 v_segment;varying vec2 v_angles;varying vec2 v_texcoord;varying vec2 v_distances;varying vec2 v_miter;varying float v_length;varying float v_linewidth_and_closed;varying float v_joinIndicator;\n#define TANGRAM_NORMAL vec3(0., 0., 1.)\n#ifdef TANGRAM_MODEL_POSITION_BASE_ZOOM_VARYING\nvarying vec4 v_modelpos_base_zoom;\n#endif\n#if defined(TANGRAM_LIGHTING_VERTEX)\nvarying vec4 v_lighting;\n#endif\n#ifndef TANGRAM_HEIGHT_SCALE\nfloat TANGRAM_HEIGHT_SCALE=16.0;\n#endif\n#define UNPACK_SCALING(x) (x / 1024.)\n#pragma tangram: camera\n#pragma tangram: material\n#pragma tangram: lighting\n#pragma tangram: global\nconst float PI=3.141592653589793;const float THETA=15.0*PI/180.0;float cross(in vec2 v1,in vec2 v2){return v1.x*v2.y-v1.y*v2.x;}float signed_distance(in vec2 v1,in vec2 v2,in vec2 v3){return cross(v2-v1,v1-v3)/length(v2-v1);}void rotate(in vec2 v,in float angle,out vec2 result){float cosine=cos(angle);float sine=sin(angle);result=vec2(cosine*v.x-sine*v.y,sine*v.x+cosine*v.y);}void main(){\n#pragma tangram: setup\n#ifdef TANGRAM_MODEL_POSITION_BASE_ZOOM_VARYING\nv_modelpos_base_zoom=modelPositionBaseZoom();\n#endif\nfloat linewidth=a_width*2.0;v_angles=a_angles;v_segment=a_segment;v_color=a_color;v_length=a_length;v_texcoord=a_texcoord;\n#ifdef TANGRAM_DEBUG_TRIANGLES\nv_barycentric=a_barycentric;\n#endif\nv_color.a=min(linewidth,v_color.a);linewidth=max(linewidth,1.0);linewidth/=exp2(u_map_position.z-u_tile_origin.w);v_linewidth_and_closed=linewidth*(a_closed>0.0 ?-1.0 : 1.0);if(v_color.a<=0.0){gl_Position=vec4(0.0,0.0,0.0,1.0);return;}float width=ceil(1.25*u_antialias+linewidth)/2.0;vec2 t1=normalize(a_tangents.xy);vec2 t2=normalize(a_tangents.zw);float u=a_texcoord.x;u*=-1.0;float v=a_texcoord.y;vec4 position=vec4(a_position.xy,a_position.z/TANGRAM_HEIGHT_SCALE,1.0);if(t1!=t2){float angle=a_texcoord.x==1.0 ? a_angles.x : a_angles.y;vec2 t=normalize(t1+t2);vec2 o=vec2(+t.y,-t.x);float segmentLength=a_segment.y-a_segment.x;float magnitude=width/cos(angle/2.0);float sqMagnitude=magnitude*magnitude;float seg1SqMagnitude=dot(a_tangents.xy,a_tangents.xy);float seg2SqMagnitude=dot(a_tangents.zw,a_tangents.zw);if((abs(magnitude)>linewidth)&&(sqMagnitude>=min(seg1SqMagnitude,seg2SqMagnitude))){if(u==1.0){o=vec2(-t2.y,+t2.x);}else{o=vec2(-t1.y,+t1.x);}magnitude=width;angle=0.0;v_angles.x=0.0;v_angles.y=0.0;}if(u_dash_index>0.0){if((abs(angle)>THETA)){position.xy+=v*width*o/cos(angle/2.0);float s=sign(angle);if(angle<0.0){if(u==+1.0){u=v_segment.y+v*width*tan(angle/2.0);if(v==1.0){position.xy-=2.0*width*t1/sin(angle);u-=2.0*width/sin(angle);}}else{u=v_segment.x-v*width*tan(angle/2.0);if(v==1.0){position.xy+=2.0*width*t2/sin(angle);u+=2.0*width/sin(angle);}}}else{if(u==+1.0){u=v_segment.y+v*width*tan(angle/2.0);if(v==-1.0){position.xy+=2.0*width*t1/sin(angle);u+=2.0*width/sin(angle);}}else{u=v_segment.x-v*width*tan(angle/2.0);if(v==-1.0){position.xy-=2.0*width*t2/sin(angle);u-=2.0*width/sin(angle);}}}}else{position.xy+=v*width*o/cos(angle/2.0);if(u==+1.0){u=v_segment.y;}else{u=v_segment.x;}}}else{position.xy+=v*o*magnitude;if(u==+1.0){u=v_segment.y+v*width*tan(angle/2.0);}else{u=v_segment.x-v*width*tan(angle/2.0);}}v_joinIndicator=(segmentLength+v*width*tan(angle/2.0))/segmentLength;}else{v_joinIndicator=-1.0;vec2 o=vec2(+t1.y,-t1.x);position.xy+=v*width*o;if(u==-1.0){u=v_segment.x-width;position.xy-=width*t1;}else{u=v_segment.y+width;position.xy+=width*t2;}}vec2 t;vec2 curr=a_position.xy;if(a_texcoord.x>=0.0){vec2 next=curr+t2*(v_segment.y-v_segment.x);rotate(t1,+a_angles.x/2.0,t);v_miter.x=signed_distance(curr,curr+t,position.xy);rotate(t2,+a_angles.y/2.0,t);v_miter.y=signed_distance(next,next+t,position.xy);}else{vec2 prev=curr-t1*(v_segment.y-v_segment.x);rotate(t1,-a_angles.x/2.0,t);v_miter.x=signed_distance(prev,prev+t,position.xy);rotate(t2,-a_angles.y/2.0,t);v_miter.y=signed_distance(curr,curr+t,position.xy);}v_distances=vec2(u,v*width);v_world_position=wrapWorldPosition(u_model*position);v_local_space_position=position;position=u_modelView*position;\n#pragma tangram: position\nv_position=position;v_normal=normalize(u_normalMatrix*TANGRAM_NORMAL);\n#if defined(TANGRAM_LIGHTING_VERTEX)\nvec3 normal=v_normal;\n#pragma tangram: normal\nv_lighting=calculateLighting(position.xyz-u_eye,normal,vec4(1.));\n#endif\ncameraProjection(position);\n#ifdef TANGRAM_LAYER_ORDER\napplyLayerOrder(a_position.w+u_tile_proxy_depth+1.,position);\n#endif\ngl_Position=position;}",fragment_shader_src="uniform vec2 u_resolution;uniform vec4 u_tile_origin;uniform float u_meters_per_pixel;uniform float u_device_pixel_ratio;uniform mat3 u_normalMatrix;uniform mat3 u_inverseNormalMatrix;uniform sampler2D u_dash_atlas;uniform float u_antialias;uniform vec2 u_linecaps;uniform float u_linejoin;uniform float u_miter_limit;uniform float u_dash_phase;uniform float u_dash_period;uniform float u_dash_index;uniform vec2 u_dash_caps;varying vec4 v_position;varying vec4 v_local_space_position;varying vec3 v_normal;varying vec4 v_color;varying vec4 v_world_position;\n#ifdef TANGRAM_DEBUG_TRIANGLES\nvarying vec3 v_barycentric;\n#endif\nvarying vec2 v_segment;varying vec2 v_angles;varying vec2 v_texcoord;varying vec2 v_distances;varying vec2 v_miter;varying float v_length;varying float v_linewidth_and_closed;varying float v_joinIndicator;\n#define TANGRAM_NORMAL v_normal\n#ifdef TANGRAM_MODEL_POSITION_BASE_ZOOM_VARYING\nvarying vec4 v_modelpos_base_zoom;\n#endif\n#if defined(TANGRAM_LIGHTING_VERTEX)\nvarying vec4 v_lighting;\n#endif\n#pragma tangram: camera\n#pragma tangram: material\n#pragma tangram: lighting\n#pragma tangram: global\n#pragma tangram: utils\nconst float PI=3.141592653589793;const float HALF_PI=PI/2.0;const float THETA=15.0*PI/180.0;/***Compute distance to cap.*@param{int}type The Type of the cap(see CAP_TYPE in pattern_lines)*@param{float}dx The distance of the pixel from the beginning of the line(not straight distance,but along the legs)*@param{float}dy The distance of the pixel from the midline(see v_distances in vertex shader,aka 1*half_line_width)*@param{float}aa_radius The distance from the mid-line from where antialiasing starts.*For example for a linewidth 10px width and 2px filter radius it is 10px/2-2px=3px.*@return{float}distance*/float cap(int type,float dx,float dy,float aa_radius){float dist=0.0;dx=abs(dx);dy=abs(dy);if(type==1)dist=sqrt(dx*dx+dy*dy);else if(type==3)dist=(dx+abs(dy));else if(type==2)dist=max(abs(dy),(aa_radius+dx-abs(dy)));else if(type==4)dist=max(dx,dy);else if(type==5)dist=max(dx+aa_radius,dy);return dist;}/***Compute distance to join.*@param{int}type The type of the join(see JOIN_TYPE in pattern_lines)*@param{vec2}segment Interpolated a_segment attribute from the vertex shader*@param{vec2}texcoord Pair of u/v coordinates to identify the 4 different extruded points of the segment.*@param{vec2}distances 2 component vector where:*x is the distance of the pixel from the beginning of the line(along the legs)*y is the  distance of the pixel from the midline(see v_distances in vertex shader,1*half_line_width)*@param{vec2}miter Miter point coordiante*@param{float}miter_limit The miter limit*@param{float}linewidth The width of the line*@return{float}computed distance*/float join(in int type,in vec2 segment,in vec2 texcoord,in vec2 distances,in vec2 miter,in float miter_limit,in float linewidth){float dx=distances.x;float result=abs(distances.y);if((dx<segment.x)||(dx>segment.y)){if(type==1){float s=dx<segment.x ? segment.x : segment.y;result=max(result,length(distances-vec2(s,0.0)));}else{float m=abs(texcoord.x>=0.0 ? miter.x : miter.y);if(type==2){result=max(result,m);}else if(type==0){result=max(result,m-miter_limit*linewidth/2.0);}}}return result;}void main(void){\n#pragma tangram: setup\nvec4 color=v_color;vec3 normal=TANGRAM_NORMAL;\n#ifdef TANGRAM_CROP_BY_TILE\nif(isLocalSpacePixelOutsideTile(v_local_space_position,TANGRAM_TILE_SCALE.x)){discard;}\n#endif\n#if defined(TANGRAM_LIGHTING_FRAGMENT) && defined(TANGRAM_MATERIAL_NORMAL_TEXTURE)\ncalculateNormal(normal);\n#endif\n#if !defined(TANGRAM_LIGHTING_VERTEX)\n#pragma tangram: normal\n#endif\n#pragma tangram: color\n#if defined(TANGRAM_LIGHTING_FRAGMENT)\ncolor=calculateLighting(v_position.xyz-u_eye,normal,color);\n#elif defined(TANGRAM_LIGHTING_VERTEX)\ncolor*=v_lighting;\n#endif\n#pragma tangram: filter\nif(v_color.a<=0.0){discard;}bool solid=(u_dash_index==0.0);bool closed=v_linewidth_and_closed<0.0;float dx=v_distances.x;float dy=v_distances.y;float linewidth=abs(v_linewidth_and_closed);float aa_radius=linewidth/2.0-u_antialias;float dist=0.0;vec2 linecaps=u_linecaps;vec2 dash_caps=u_dash_caps;float line_start=0.0;float line_stop=v_length;if(solid){dist=abs(dy);bool potentialCap=!closed&&v_joinIndicator<0.0;if(potentialCap&&dx<line_start){dist=cap(int(u_linecaps.x),abs(dx),abs(dy),aa_radius);}else if(potentialCap&&dx>line_stop){dist=cap(int(u_linecaps.y),abs(dx)-line_stop,abs(dy),aa_radius);}else{dist=join(int(u_linejoin),v_segment,v_texcoord,v_distances,v_miter,u_miter_limit,linewidth);}}else{float segment_start=v_segment.x;float segment_stop=v_segment.y;float segment_center=(segment_start+segment_stop)/2.0;float freq=u_dash_period*linewidth;float dash_phase=u_dash_phase-1e-5;float u=mod(dx+dash_phase*linewidth,freq);vec4 tex=texture2D(u_dash_atlas,vec2(u/freq,u_dash_index));float dash_center=float(tex.x)*255.0*linewidth;float dash_type=floor(float(tex.y)*255.0+0.5);float _start=float(tex.z)*255.0*linewidth;float _stop=float(tex.a)*255.0*linewidth;float dash_start=dx-u+_start;float dash_stop=dx-u+_stop;if((dash_stop<segment_start)&&(dash_caps.x!=5.0)){float u=mod(segment_start+dash_phase*linewidth,freq);vec4 tex=texture2D(u_dash_atlas,vec2(u/freq,u_dash_index));dash_center=float(tex.x)*255.0*linewidth;float _start=float(tex.z)*255.0*linewidth;float _stop=float(tex.a)*255.0*linewidth;dash_start=segment_start-u+_start;dash_stop=segment_start-u+_stop;}else if((dash_start>segment_stop)&&(dash_caps.y!=5.0)){float u=mod(segment_stop+dash_phase*linewidth,freq);vec4 tex=texture2D(u_dash_atlas,vec2(u/freq,u_dash_index));dash_center=float(tex.x)*255.0*linewidth;float _start=float(tex.z)*255.0*linewidth;float _stop=float(tex.a)*255.0*linewidth;dash_start=segment_stop-u+_start;dash_stop=segment_stop-u+_stop;}bool discontinuous=((dx<segment_center)&&abs(v_angles.x)>THETA)||((dx>=segment_center)&&abs(v_angles.y)>THETA);float d_join=join(int(u_linejoin),v_segment,v_texcoord,v_distances,v_miter,u_miter_limit,linewidth);if(closed){line_start+=linewidth/2.0;line_stop-=linewidth/2.0;}if(dash_stop<=line_start){discard;}if(dash_start>=line_stop){discard;}if(discontinuous){if((dash_start>segment_stop)){discard;}if((dash_stop<segment_start)){discard;}if(dash_caps.x==1.0){if((u>_stop)&&(dash_stop>segment_stop)&&(abs(v_angles.y)<HALF_PI)){discard;}}if(dash_caps.y==1.0){if((u<_start)&&(dash_start<segment_start)&&(abs(v_angles.x)<HALF_PI)){discard;}}if((dash_caps.x!=1.0)&&(dash_caps.x!=5.0)){if((dash_start<segment_start)&&(abs(v_angles.x)<HALF_PI)){float a=v_angles.x/2.0;float cos_a=cos(a);float sin_a=sin(a);float x=(segment_start-dx)*cos_a-dy*sin_a;float y=(segment_start-dx)*sin_a+dy*cos_a;if(x>0.0){discard;}dash_caps.x=4.0;}}if((dash_caps.y!=1.0)&&(dash_caps.y!=5.0)){if((dash_stop>segment_stop)&&(abs(v_angles.y)<HALF_PI)){float a=v_angles.y/2.0;float cos_a=cos(a);float sin_a=sin(a);float x=(dx-segment_stop)*cos_a-dy*sin_a;float y=(dx-segment_stop)*sin_a+dy*cos_a;if(x>0.0){discard;}dash_caps.y=4.0;}}}if((dx<line_start)&&(dash_start<=line_start)&&(dash_stop>line_start)){dist=cap(int(linecaps.x),dx-line_start,dy,aa_radius);}else if((dx>line_stop)&&(dash_stop>line_stop)&&(dash_start<line_stop)){dist=cap(int(linecaps.y),dx-line_stop,dy,aa_radius);}else if(dash_type==1.0){dist=cap(int(dash_caps.x),abs(dash_center-u),dy,aa_radius);if((dx>line_start)&&(dx<line_stop)){dist=max(dist,d_join);}}else if(dash_type==0.0){dist=abs(dy);}else if(dash_type==2.0){dist=cap(int(dash_caps.y),abs(u-dash_center),dy,aa_radius);if((dx>line_start)&&(dx<line_stop)){dist=max(dist,d_join);}}if((dx>line_start)&&(dx<line_stop)){if((dx<=segment_start)&&(dash_start<=segment_start)&&(dash_stop>=segment_start)){dist=d_join;float angle=HALF_PI+v_angles.x;float f=abs((segment_start-dx)*cos(angle)-dy*sin(angle));dist=max(f,dist);}else if((dx>segment_stop)&&(dash_start<=segment_stop)&&(dash_stop>=segment_stop)){dist=d_join;float angle=HALF_PI+v_angles.y;float f=abs((dx-segment_stop)*cos(angle)-dy*sin(angle));dist=max(f,dist);}else if(dx<(segment_start-linewidth/2.)){discard;}else if(dx>(segment_stop+linewidth/2.)){discard;}}else if(dx<(segment_start-linewidth/2.)){discard;}else if(dx>(segment_stop+linewidth/2.)){discard;}}dist=dist-aa_radius;if(dist>=0.0){if(u_antialias==0.0){discard;}else{color=vec4(color.rgb,exp(-dist*dist)*color.a);}}\n#ifdef TANGRAM_DEBUG_TRIANGLES\nif(any(lessThan(v_barycentric,vec3(0.0085)))){color=vec4(0.0,1.0,0.0,1.0);}\n#endif\ngl_FragColor=color;}",PatternLines=Object.create(Style),CAP_TYPE$1={round:1,"arrow-tail":2,"arrow-head":3,square:4,butt:5},JOIN_TYPE$1={miter:0,round:1,bevel:2},PATTERN_MAX_WIDTH=1024,DEFAULT_LINE_CAP=CAP_TYPE$1.round,DEFAULT_JOIN_TYPE=JOIN_TYPE$1.miter,DEFAULT_DASH_PATTERN=[0,0],VARIANT_UNIQUE_PROP_NAMES="antialias join linecaps miter_limit dash_index dash dash_caps dash_phase".split(" ");function getHashForStyle(t){for(var e=[],r=0,i=VARIANT_UNIQUE_PROP_NAMES.length;r<i;r++){var n=t[VARIANT_UNIQUE_PROP_NAMES[r]];Array.isArray(n)?e.push(n.join("_")):"boolean"==typeof n?e.push(n?1:0):n&&e.push(n.toString())}return e.join("/")}Object.assign(PatternLines,{name:"pattern-lines",built_in:!0,vertex_shader_src,fragment_shader_src,selection:!0,init:function(){Style.init.apply(this,arguments),this.defines.TANGRAM_LAYER_ORDER=!0,this.defines.TANGRAM_CROP_BY_TILE=this.crop_by_tile,this.defines.TANGRAM_DEBUG_TRIANGLES=!1,this.defines.TANGRAM_DEBUG_NO_TEXTURE_FLOAT_SUPPORT=!1,this.styles=this.styles||{},PatternLines.vertex_layouts=[]},calcDistance:function(t,e){return t&&StyleParser.evalCachedDistanceProperty(t,e)||0},calcDash:function(t,e){var r=StyleParser.evalProperty(t.dash,e),i=0;return r&&((r=Array.isArray(r)&&r.length?r:DEFAULT_DASH_PATTERN).length%2==1&&(r=r.concat(r)),i=+(i=r.reduce((function(t,e){return t+e})))||0),{dash:r,dash_period:i}},calcWidth:function(t,e,r){var i=this.calcDistance(t.width,r);return!(i<0||(e.width=i*r.units_per_meter_overzoom,0))},getCapType:function(t,e,r){var i=StyleParser.evalProperty(t,e);return void 0!==CAP_TYPE$1[i]?CAP_TYPE$1[i]:r},_parseFeature:function(t,e,r){if(!1!==this.calcWidth(e,this.feature_style,r)){var i=this.parseColor(e.color,r);if(i&&0!==i[3]){var n=this.getCapType(e.cap,r,DEFAULT_LINE_CAP),o=StyleParser.evalProperty(e.join,r),a=+StyleParser.evalProperty(e.miter_limit,r),s=this.calcDash(e,r),l=s.dash,c=s.dash_period,u=Object.assign({color:i,antialias:e.antialias,linecaps:[this.getCapType(e.tail_cap,r,n),this.getCapType(e.head_cap,r,n)],join:void 0!==JOIN_TYPE$1[o]?JOIN_TYPE$1[o]:DEFAULT_JOIN_TYPE,miter_limit:0<=a?a:3,dash_index:0===c?0:1,dash:l,dash_caps:[this.getCapType(e.tail_cap,r,n),this.getCapType(e.head_cap,r,n)],dash_phase:+StyleParser.evalProperty(e.dash_phase,r)||0,dash_period:c},this.feature_style);return u.z=e.z&&StyleParser.evalCachedDistanceProperty(e.z||0,r)||StyleParser.defaults.z,u.z*=Geo$1.height_scale,u.extrude=StyleParser.evalProperty(e.extrude,r),u.extrude&&(!0===u.extrude?(u.height=void 0!==t.properties.height?t.properties.height:StyleParser.defaults.height,u.min_height=void 0!==t.properties.min_height?t.properties.min_height:StyleParser.defaults.min_height):"number"==typeof u.extrude?(u.height=u.extrude,u.min_height=0):Array.isArray(u.extrude)&&(u.min_height=u.extrude[0],u.height=u.extrude[1]),u.height*=Geo$1.height_scale,u.min_height*=Geo$1.height_scale),this.addMeshVariantForDraw(this.base,u),u}}},_preprocess:function(t){t.color=StyleParser.createColorPropertyCache(t.color),t.width=StyleParser.createPropertyCache(t.width,StyleParser.parseUnits),t.width&&t.width.type!==StyleParser.CACHE_TYPE.STATIC&&(t.next_width=StyleParser.createPropertyCache(t.width,StyleParser.parseUnits)),t.z=StyleParser.createPropertyCache(t.z,StyleParser.parseUnits);var e=+t.antialias;return t.antialias=isNaN(e)?0:e,t},buildRasterTextures:function(t,e){var r=[];for(var i in e.meshes){var n,o=this.getMeshVariantTypeForDraw({variantKey:i}),a=o.uniforms,s=o.pattern;a.u_dash_index&&(n="__dash_"+s.join("_")+"_"+t.key+"_"+t.id,r.push({name:n,data:buildPatternBuffer(s,PATTERN_MAX_WIDTH)}),a.u_dash_atlas=n,e.meshes[i].textures=[n]),e.meshes[i].uniforms=a}return e.uniforms=e.uniforms||{},r.length?WorkerBroker.postMessage(this.main_thread_target+".loadTextures",r).then((function(t){return e})):Promise.resolve(e)},loadTextures:function(t){for(var e=[],r=0;r<t.length;r++){var i=t[r],n=(n=this.textureManager.textures[i.name])||this.textureManager.create(this.gl,i.name,{filtering:"nearest",repeat:!0,width:PATTERN_MAX_WIDTH,height:1,data:i.data});e.push(n.loading)}return Promise.all(e).then((function(t){return t.map((function(t){return t.retain(),t.name}))}))},computeVariantForDraw:function(t){var e=getHashForStyle(t);return{key:t.variantKey=e,order:t.variant_order,uniforms:{u_antialias:t.antialias,u_linecaps:t.linecaps,u_linejoin:t.join,u_miter_limit:t.miter_limit,u_dash_index:t.dash_index,u_dash_caps:t.dash_caps,u_dash_phase:t.dash_phase,u_dash_period:t.dash_period},pattern:t.dash}},vertexLayoutForMeshVariant:function(t){var e;return null==PatternLines.vertex_layouts[t.key]&&(e=[{name:"a_position",size:4,type:gl$1.SHORT,normalized:!1},{name:"a_color",size:4,type:gl$1.UNSIGNED_BYTE,normalized:!0},{name:"a_width",size:1,type:gl$1.FLOAT,normalized:!1},{name:"a_tangents",size:4,type:gl$1.FLOAT,normalized:!1},{name:"a_segment",size:2,type:gl$1.FLOAT,normalized:!1},{name:"a_angles",size:2,type:gl$1.FLOAT,normalized:!1},{name:"a_texcoord",size:2,type:gl$1.FLOAT,normalized:!0},{name:"a_length",size:1,type:gl$1.FLOAT,normalized:!1},{name:"a_closed",size:1,type:gl$1.FLOAT,normalized:!1},{name:"a_selection_color",size:4,type:gl$1.UNSIGNED_BYTE,normalized:!0}],this.defines.TANGRAM_DEBUG_TRIANGLES&&e.push({name:"a_barycentric",size:3,type:gl$1.SHORT,normalized:!1}),PatternLines.vertex_layouts[t.key]=new VertexLayout(e)),PatternLines.vertex_layouts[t.key]},makeVertexTemplate:function(t){var e=0;return this.vertex_template[e++]=0,this.vertex_template[e++]=0,this.vertex_template[e++]=t.z+t.height||0,this.vertex_template[e++]=this.scaleOrder(t.order),this.vertex_template[e++]=255*t.color[0],this.vertex_template[e++]=255*t.color[1],this.vertex_template[e++]=255*t.color[2],this.vertex_template[e++]=255*t.color[3],this.vertex_template[e++]=0,this.vertex_template[e++]=0,this.vertex_template[e++]=0,this.vertex_template[e++]=0,this.vertex_template[e++]=0,this.vertex_template[e++]=0,this.vertex_template[e++]=0,this.vertex_template[e++]=0,this.vertex_template[e++]=0,this.vertex_template[e++]=0,this.vertex_template[e++]=0,this.vertex_template[e++]=0,this.vertex_template[e++]=0,this.selection&&(this.vertex_template[e++]=255*t.selection_color[0],this.vertex_template[e++]=255*t.selection_color[1],this.vertex_template[e++]=255*t.selection_color[2],this.vertex_template[e++]=255*t.selection_color[3]),this.defines.TANGRAM_DEBUG_TRIANGLES&&(this.vertex_template[e++]=0,this.vertex_template[e++]=0,this.vertex_template[e++]=0),this.vertex_template},buildLines:function(t,e,r,i,n){var o=4<arguments.length&&void 0!==n&&n,a=r.vertex_data,s=a.vertex_layout,l=this.makeVertexTemplate(e,r);return buildPolylines$1(t,e.width,a,l,s.index,o)},buildPolygons:function(t,e,r,i){for(var n=0,o=0,a=t.length;o<a;o++)n+=this.buildLines(t[o],e,r,i,!0);return n}});var STICK_WIDTH=1;function buildQuadsForPoints(t,e,r,i){var n,o,a,s,l,c,u=i.quad,h=i.quad_normalize,p=i.offset,f=i.offsets,d=i.offsets_alt,y=i.pre_angles,g=i.pre_angles_alt,v=i.angle,m=i.angles,_=i.angles_alt,b=i.is_flat,w=i.elevate_by_altitude,x=i.build_stick_points,E=i.color,T=i.stick_color,A=i.curve,S=i.texcoord_scale,k=i.texcoord_normalize,O=i.pre_angles_normalize,L=i.angles_normalize,P=i.offsets_normalize,R=(h=h||1,u[0]/2*h),I=u[1]/2*h,C=[[-R,-I],[R,-I],[R,I],[-R,I]],M=e.vertex_elements,N=e.vertex_count,j=e.vertex_layout.index,D=j.a_texcoord,B=j.a_position,z=j.a_shape,F=j.a_offset,U=j.a_offsets,G=j.a_offsets_alt,H=j.a_pre_angles,V=j.a_pre_angles_alt,q=j.a_angles,$=j.a_angles_alt,W=j.a_is_flat,Y=j.a_is_stick,X=j.a_color;D&&(k=k||1,c=[[o=(n=_slicedToArray(S||default_uvs,4))[0],a=n[1]],[s=n[2],a],[s,l=n[3]],[o,l]]);for(var K=0,Z=t.length,J=0;J<Z;J++){var Q=t[J];if(x){for(var tt=STICK_WIDTH/2*h,et=+h,rt=[[-tt,0],[+tt,0],[+tt,et],[-tt,et]],it=0;it<4;it++)D&&(r[D+0]=c[it][0]*k,r[D+1]=c[it][1]*k),r[B+0]=Q[0],r[B+1]=Q[1],w&&(r[B+2]=MathUtils$1.clamp(Q[2],0,32767)),r[z+0]=rt[it][0],r[z+1]=rt[it][1],r[z+2]=0,r[X+0]=T[0],r[X+1]=T[1],r[X+2]=T[2],r[X+3]=T[3],r[Y+0]=255,e.addVertex(r);M.push(N+0),M.push(N+1),M.push(N+2),M.push(N+2),M.push(N+3),M.push(N+0),N+=4,K+=2}for(var nt=0;nt<4;nt++)D&&(r[D+0]=c[nt][0]*k,r[D+1]=c[nt][1]*k),r[B+0]=Q[0],r[B+1]=Q[1],w&&(r[B+2]=MathUtils$1.clamp(Q[2],0,32767)),r[z+0]=C[nt][0],r[z+1]=C[nt][1],r[z+2]=v,r[X+0]=E[0],r[X+1]=E[1],r[X+2]=E[2],r[X+3]=E[3],r[F+0]=p[0],r[F+1]=p[1],r[W+0]=b?255:0,x&&(r[Y+0]=0),A&&(r[H+0]=O*y[0],r[H+1]=O*y[1],r[H+2]=O*y[2],r[H+3]=O*y[3],r[q+0]=L*m[0],r[q+1]=L*m[1],r[q+2]=L*m[2],r[q+3]=L*m[3],r[U+0]=P*f[0],r[U+1]=P*f[1],r[U+2]=P*f[2],r[U+3]=P*f[3],d&&(r[G+0]=P*d[0],r[G+1]=P*d[1],r[G+2]=P*d[2],r[G+3]=P*d[3],r[V+0]=O*g[0],r[V+1]=O*g[1],r[V+2]=O*g[2],r[V+3]=O*g[3],r[$+0]=L*_[0],r[$+1]=L*_[1],r[$+2]=L*_[2],r[$+3]=L*_[3])),e.addVertex(r);M.push(N+0),M.push(N+1),M.push(N+2),M.push(N+2),M.push(N+3),M.push(N+0),N+=4,K+=2}return K}var id$2=0,Label={id_prefix:"",nextLabelId:function(){return"".concat(Label.id_prefix,"/").concat(id$2++)}};function textLayoutToJSON(t){return{priority:t.priority,collide:t.collide,repeat_distance:t.repeat_distance,repeat_group:t.repeat_group,buffer:t.buffer,italic:t.italic}}var lefts=["left","top-left","bottom-left"],rights=["right","top-right","bottom-right"],tops=["top","top-left","top-right"],bottoms=["bottom","bottom-left","bottom-right"],PointAnchor,PointAnchor$1=PointAnchor={computeOffset:function(t,e,r,i){var n=3<arguments.length&&void 0!==i?i:null;if(!r||"center"===r)return t;var o=[t[0],t[1]];return n=n||this.default_buffer,this.isLeftAnchor(r)?(o[0]-=e[0]/2,"left"===r&&(o[0]-=n[0])):this.isRightAnchor(r)&&(o[0]+=e[0]/2,"right"===r&&(o[0]+=n[1])),this.isTopAnchor(r)?(o[1]-=e[1]/2,"top"===r&&(o[1]-=n[2])):this.isBottomAnchor(r)&&(o[1]+=e[1]/2,"bottom"===r&&(o[1]+=n[3])),o},alignForAnchor:function(t){if(t&&"center"!==t){if(this.isLeftAnchor(t))return"right";if(this.isRightAnchor(t))return"left"}return"center"},isLeftAnchor:function(t){return-1<lefts.indexOf(t)},isRightAnchor:function(t){return-1<rights.indexOf(t)},isTopAnchor:function(t){return-1<tops.indexOf(t)},isBottomAnchor:function(t){return-1<bottoms.indexOf(t)},default_buffer:[2.5,2.5,1.5,.75],zero_buffer:[0,0,0,0]};function encircleLine(t,e,r,i,n){var o=[],a=r-t,s=i-e,l=MathUtils$1.getLineLength(t,e,r,i),c=2*n;if((u=l/c)<=1)o.push(t+a/2,e+s/2,n);else{var u,h=c/l,p=a*h,f=s*h;(u=l/n/2)%1&&o.push(r-p/2,i-f/2,n),u|=0;for(var d=t+p/2,y=e+f/2;u--;)o.push(d,y,n),d+=p,y+=f}return o}var LabelPoint=function(){function t(e,r,i,n){_classCallCheck(this,t),this.id=Label.nextLabelId(),this.position=[e[0],e[1]],void 0!==e[2]&&this.position.push(e[2]),this.size=r,this.layout=n,this.anchor=Array.isArray(this.layout.anchor)?this.layout.anchor[0]:this.layout.anchor,this.placed=null,this.type="point",this.parent=this.layout.parent,this.offset=this.computeOffset(),this.align=this.layout.align||PointAnchor$1.alignForAnchor(this.anchor),this._is_flat=i}return _createClass(t,[{key:"toJSON",value:function(){return{id:this.id,type:this.type,is_flat:this._is_flat,position:this.position,size:this.size,offset:this.offset,align:this.align,sides:this.getSides(),breach:!this.inTileBounds(),layout:textLayoutToJSON(this.layout)}}},{key:"inTileBounds",value:function(){var t=this.getAABB(),e=t.left,r=t.top,i=t.right,n=t.bottom;return Utils$1.pointInTile([e,r])&&Utils$1.pointInTile([i,n])}},{key:"isFlat",value:function(){return this._is_flat}},{key:"setAnchor",value:function(t){this._circles=void 0,this._aabb=void 0,this.anchor=t,this.offset=this.computeOffset()}},{key:"computeOffset",value:function(){var t,e=[this.layout.offset[0],this.layout.offset[1]];return this.parent&&(t=this.parent,e=PointAnchor$1.computeOffset(e,t.size,t.anchor,PointAnchor$1.zero_buffer),e=PointAnchor$1.computeOffset(e,t.size,this.anchor,PointAnchor$1.zero_buffer),t.offset!==StyleParser.zeroPair&&(e===StyleParser.zeroPair?e=t.offset:(e[0]+=t.offset[0],e[1]+=t.offset[1]))),PointAnchor$1.computeOffset(e,this.size,this.anchor)}},{key:"getBoundingCircles",value:function(){return this.angle?(this._circles||(t=this.layout.units_per_pixel,n=-(r=(e=this.size[0]/2*t)*Math.cos(this.angle)),o=-(i=e*Math.sin(this.angle)),s=(a=_slicedToArray(this.position,2))[0],l=a[1],r+=s,i+=l*=-1,n+=s,o+=l,c=this.size[1]/2*t,this._circles=encircleLine(r,i,n,o,c)),this._circles):[];var t,e,r,i,n,o,a,s,l,c}},{key:"getAABB",value:function(){var t,e,r,i,n;return this._aabb||(t=this.layout.units_per_pixel,e=(this.size[0]/2+this.layout.buffer[0])*t,r=(this.size[1]/2+this.layout.buffer[1])*t,i=this.position[0]+this.offset[0]*t,n=this.position[1]-this.offset[1]*t,this._aabb={left:i-e,top:n+r,right:i+e,bottom:n-r}),this._aabb}},{key:"getSides",value:function(){var t=this.getAABB(),e=t.left,r=t.top,i=t.right,n=(r+t.bottom)/2;return[e,n,i,n]}}]),t}();LabelPoint.PLACEMENT={VERTEX:0,MIDPOINT:1,SPACED:2,CENTROID:3};var PLACEMENT=LabelPoint.PLACEMENT,default_spacing=80,TextSettings;function placePointsOnLine(t,e,r,i){var n=[],o=i.placement,a=Math.max(e[0],e[1])*i.placement_min_length_ratio*i.units_per_pixel;switch(o){case PLACEMENT.SPACED:var s=getPositionsAndAngles(t,a,i);if(!s)return[];for(var l=s.positions,c=s.angles,u=0;u<l.length;u++){var h,p=l[u],f=c[u];!0!==i.tile_edges&&isCoordOutsideTile(p)||((h=new LabelPoint(p,e,r,i)).angle=f,n.push(h))}break;case PLACEMENT.VERTEX:for(var d,y,g,v=0;v<t.length-1;v++)d=t[v],y=t[v+1],!0!==i.tile_edges&&isCoordOutsideTile(d)||((g=new LabelPoint(d,e,r,i)).angle=getAngle(d,y,i.angle),n.push(g));(g=new LabelPoint(y,e,r,i)).angle=getAngle(d,y,i.angle),n.push(g);break;case PLACEMENT.MIDPOINT:for(var m=0;m<t.length-1;m++){var _,b=t[m],w=t[m+1],x=[.5*(b[0]+w[0]),.5*(b[1]+w[1])];!0!==i.tile_edges&&isCoordOutsideTile(x)||(!a||norm(b,w)>a)&&((_=new LabelPoint(x,e,r,i)).angle=getAngle(b,w,i.angle),n.push(_))}}return n}function getPositionsAndAngles(t,e,r){var i=r.units_per_pixel,n=(r.placement_spacing||default_spacing)*i,o=getLineLength(t);if(o<=e)return!1;for(var a=Math.max(Math.floor(o/n),1),s=[],l=[],c=.5*(o-(a-1)*n),u=0;u<a;u++){var h=interpolateLine(t,c,e,r),p=h.position,f=h.angle;null!=p&&null!=f&&(s.push(p),l.push(f)),c+=n}return{positions:s,angles:l}}function getAngle(t,e){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;return"auto"===r?Math.atan2(e[0]-t[0],e[1]-t[1]):r}function getLineLength(t){for(var e=0,r=0;r<t.length-1;r++)e+=norm(t[r],t[r+1]);return e}function norm(t,e){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2))}function interpolateLine(t,e,r,i){for(var n,o,a=0,s=0;s<t.length-1;s++){var l=t[s],c=t[s+1],u=norm(l,c);if(!(u<=r)&&e<(a+=u)){n=interpolateSegment(l,c,a-e),o=getAngle(l,c,i.angle);break}}return{position:n,angle:o}}function interpolateSegment(t,e,r){var i=r/norm(t,e);return[i*t[0]+(1-i)*e[0],i*t[1]+(1-i)*e[1]]}var TextSettings$1=TextSettings={key:function(t){return[t.style,t.weight,t.family,t.px_size,t.fill,t.stroke,t.stroke_width,t.transform,t.text_wrap,t.max_lines,t.supersample,t.background_color,t.outline_color,t.outline_width,t.padding,Utils$1.device_pixel_ratio].join("/")},defaults:{style:"normal",weight:null,size:"12px",px_size:12,family:"Helvetica",fill:"white",text_wrap:15,max_lines:5,align:"center",stroke:null,stroke_width:0,background_color:null,outline_color:null,outline_width:0,padding:[0,0,0,0]},compute:function(t,e,r){var i={};if(e.font=e.font||this.defaults,i.can_articulate=e.can_articulate,i.fill=e.font.fill&&Utils$1.toCSSColor(StyleParser.evalCachedColorProperty(e.font.fill,r))||this.defaults.fill,i.style=e.font.style||this.defaults.style,i.weight=e.font.weight||this.defaults.weight,e.font.family?(i.family=e.font.family,i.family!==this.defaults.family&&(i.family+=", "+this.defaults.family)):i.family=this.defaults.family,i.transform=e.font.transform,i.size=e.font.size||this.defaults.size,i.supersample=e.supersample_text?1.5:1,i.px_size=StyleParser.evalCachedProperty(e.font.px_size,r)*i.supersample,0!==i.px_size){e.font.stroke&&e.font.stroke.color&&(i.stroke=Utils$1.toCSSColor(StyleParser.evalCachedColorProperty(e.font.stroke.color,r)||this.defaults.stroke),i.stroke_width=StyleParser.evalCachedProperty(e.font.stroke.width,r)||this.defaults.stroke_width),i.font_css=this.fontCSS(i);var n=e.text_wrap;return null==n&&"line"!==Geo$1.geometryType(t.geometry.type)&&(n=!0),!0===n&&(n=this.defaults.text_wrap),i.text_wrap=n,i.max_lines=e.max_lines||this.defaults.max_lines,i.background_color=e.background&&e.background.color&&!e.can_articulate?Utils$1.toCSSColor(StyleParser.evalCachedColorProperty(e.background.color,r)):this.defaults.background_color,i.outline_color=e.outline&&e.outline.color&&!e.can_articulate?Utils$1.toCSSColor(StyleParser.evalCachedColorProperty(e.outline.color,r)):this.defaults.outline_color,i.outline_width=e.outline&&e.outline.width&&!e.can_articulate?StyleParser.evalCachedProperty(e.outline.width,r):this.defaults.outline_width,i.padding=e.padding&&!e.can_articulate?StyleParser.evalCachedProperty(e.padding,r):this.defaults.padding,i}},fontCSS:function(t){return[t.style,t.weight,t.px_size+"px",t.family].filter((function(t){return t})).join(" ")}},fontfaceobserver_standalone=createCommonjsModule((function(t){function e(t,e){document.addEventListener?t.addEventListener("scroll",e,!1):t.attachEvent("scroll",e)}function r(t){this.a=document.createElement("div"),this.a.setAttribute("aria-hidden","true"),this.a.appendChild(document.createTextNode(t)),this.b=document.createElement("span"),this.c=document.createElement("span"),this.h=document.createElement("span"),this.f=document.createElement("span"),this.g=-1,this.b.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.c.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.f.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.h.style.cssText="display:inline-block;width:200%;height:200%;font-size:16px;max-width:none;",this.b.appendChild(this.h),this.c.appendChild(this.f),this.a.appendChild(this.b),this.a.appendChild(this.c)}function i(t,e){t.a.style.cssText="max-width:none;min-width:20px;min-height:20px;display:inline-block;overflow:hidden;position:absolute;width:auto;margin:0;padding:0;top:-999px;left:-999px;white-space:nowrap;font:"+e+";"}function n(t){var e=t.a.offsetWidth,r=e+100;return t.f.style.width=r+"px",t.c.scrollLeft=r,t.b.scrollLeft=t.b.scrollWidth+100,t.g!==e&&(t.g=e,1)}function o(t,r){function i(){var t=o;n(t)&&t.a.parentNode&&r(t.g)}var o=t;e(t.b,i),e(t.c,i),n(t)}function a(t,e){var r=e||{};this.family=t,this.style=r.style||"normal",this.weight=r.weight||"normal",this.stretch=r.stretch||"normal"}function s(t,e){return[t.style,t.weight,function(){if(null===u){var t=document.createElement("div");try{t.style.font="condensed 100px sans-serif"}catch(t){}u=""!==t.style.font}return u}()?t.stretch:"","100px",e].join(" ")}var l,c,u,h;h=u=c=l=null,a.prototype.load=function(t,e){var n=this,a=t||"BESbswy",u=0,p=e||3e3,f=(new Date).getTime();return new Promise((function(t,e){var d,y,g;null===h&&(h=!!document.fonts),(d=h)&&(null===c&&(c=/OS X.*Version\/10\..*Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor)),d=!c),d?(d=new Promise((function(t,e){!function r(){(new Date).getTime()-f>=p?e():document.fonts.load(s(n,'"'+n.family+'"'),a).then((function(e){1<=e.length?t():setTimeout(r,25)}),(function(){e()}))}()})),y=new Promise((function(t,e){u=setTimeout(e,p)})),Promise.race([y,d]).then((function(){clearTimeout(u),t(n)}),(function(){e(n)}))):(g=function(){function c(){var e;(e=-1!=g&&-1!=v||-1!=g&&-1!=m||-1!=v&&-1!=m)&&((e=g!=v&&g!=m&&v!=m)||(null===l&&(e=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent),l=!!e&&(parseInt(e[1],10)<536||536===parseInt(e[1],10)&&parseInt(e[2],10)<=11)),e=l&&(g==_&&v==_&&m==_||g==b&&v==b&&m==b||g==w&&v==w&&m==w)),e=!e),e&&(x.parentNode&&x.parentNode.removeChild(x),clearTimeout(u),t(n))}var h=new r(a),d=new r(a),y=new r(a),g=-1,v=-1,m=-1,_=-1,b=-1,w=-1,x=document.createElement("div");x.dir="ltr",i(h,s(n,"sans-serif")),i(d,s(n,"serif")),i(y,s(n,"monospace")),x.appendChild(h.a),x.appendChild(d.a),x.appendChild(y.a),document.body.appendChild(x),_=h.a.offsetWidth,b=d.a.offsetWidth,w=y.a.offsetWidth,function t(){var r;(new Date).getTime()-f>=p?(x.parentNode&&x.parentNode.removeChild(x),e(n)):(!0!==(r=document.hidden)&&void 0!==r||(g=h.a.offsetWidth,v=d.a.offsetWidth,m=y.a.offsetWidth,c()),u=setTimeout(t,50))}(),o(h,(function(t){g=t,c()})),i(h,s(n,'"'+n.family+'",sans-serif')),o(d,(function(t){v=t,c()})),i(d,s(n,'"'+n.family+'",serif')),o(y,(function(t){m=t,c()})),i(y,s(n,'"'+n.family+'",monospace'))},document.body?g():document.addEventListener?document.addEventListener("DOMContentLoaded",(function t(){document.removeEventListener("DOMContentLoaded",t),g()})):document.attachEvent("onreadystatechange",(function t(){"interactive"!=document.readyState&&"complete"!=document.readyState||(document.detachEvent("onreadystatechange",t),g())})))}))},t.exports=a})),FontManager={fonts_loaded:Promise.resolve(),last_loaded:null,loadFonts:function(t){var e=this,r=JSON.stringify(t)===this.last_loaded;return t&&!r&&function(){var r=[];for(var i in t)!function(i){Array.isArray(t[i])?t[i].forEach((function(t){return r.push(e.loadFontFace(i,t))})):r.push(e.loadFontFace(i,t[i]))}(i);e.last_loaded=JSON.stringify(t),e.fonts_loaded=Promise.all(r.filter((function(t){return t})))}(),this.fonts_loaded},loadFontFace:function(t,e){if(null!=e&&("object"===_typeof(e)||"external"===e)){var r={family:t},i=Promise.resolve();"object"===_typeof(e)&&(Object.assign(r,e),"string"==typeof e.url&&(i=this.injectFontFace(r)));var n=new fontfaceobserver_standalone(t,r);return i.then((function(){return n.load()})).then((function(){log("debug","Font face '".concat(t,"' is available"),r)}),(function(){log("debug","Font face '".concat(t,"' is NOT available"),r)}))}},injectFontFace:function(t){var e=this,r=t.family,i=t.url,n=t.weight,o=t.style;void 0===this.supports_native_font_loading&&(this.supports_native_font_loading=void 0!==window.FontFace);var a=Promise.resolve(i);return"blob:"===i.slice(0,5)&&(a=Utils$1.io(i,6e4,"arraybuffer").then((function(t){var r=new Uint8Array(t);if(e.supports_native_font_loading)return r;for(var i="",n=0;n<r.length;n++)i+=String.fromCharCode(r[n]);return"data:font/opentype;base64,"+btoa(i)}))),a.then((function(t){var i,a,s;e.supports_native_font_loading?("string"==typeof t?i=new FontFace(r,"url(".concat(encodeURI(t),")"),{weight:n,style:o}):t instanceof Uint8Array&&(i=new FontFace(r,t,{weight:n,style:o})),document.fonts.add(i),log("trace","Adding FontFace to document.fonts:",i)):(a="\n                    @font-face {\n                        font-family: '".concat(r,"';\n                        font-weight: ").concat(n||"normal",";\n                        font-style: ").concat(o||"normal",";\n                        src: url(").concat(encodeURI(t),");\n                    }\n                "),(s=document.createElement("style")).appendChild(document.createTextNode("")),document.head.appendChild(s),s.sheet.insertRule(a,0),log("trace","Injecting CSS font face:",a))}))}},CanvasText=function(){function t(){_classCallCheck(this,t),this.vertical_text_buffer=1,this.horizontal_text_buffer=1,this.layout=layout("binary-tree")}return _createClass(t,[{key:"createCanvas",value:function(t,e){var r=document.createElement("canvas");return t&&e&&(r.width=t,r.height=e),r.style.backgroundColor="transparent",r}},{key:"setFont",value:function(t,e){var r=e.font_css,i=e.fill,n=e.stroke,o=e.stroke_width,a=e.px_size,s=e.supersample;this.px_size=a;var l=Utils$1.device_pixel_ratio*s;n&&0<o&&(t.strokeStyle=n,t.lineWidth=o*l),t.fillStyle=i,t.textBaseline="bottom",t.font=r,t.miterLimit=2}},{key:"textSizes",value:function(t,e,r){var i=this;return FontManager.loadFonts().then((function(){return Task.add({type:"textSizes",run:i.processTextSizesTask.bind(i),texts:e,tile_id:t,cursor:{ctx:r,styles:Object.keys(e),texts:null,style_idx:null,text_idx:null}})}))}},{key:"processTextSizesTask",value:function(t){var e=t.cursor,r=t.texts,i=e.ctx;for(e.style_idx=e.style_idx||0;e.style_idx<e.styles.length;){var n=e.styles[e.style_idx];null==e.text_idx&&(e.text_idx=0,e.texts=Object.keys(r[n]));for(var o=r[n],a=!0;e.text_idx<e.texts.length;){var s=e.texts[e.text_idx],l=o[s],c=l.text_settings;if(a&&(this.setFont(i,c),a=!1),l.size=this.textSize(i,n,s,c).size,c.can_articulate){var u=!1,h=!1;if(isTextRTL(s)&&(isTextNeutral(s)?u=!0:h=!0),l.isRTL=u,l.no_curving=h||isTextCurveBlacklisted(s),l.vertical_buffer=this.vertical_text_buffer+c.outline_width+(c.padding[0]+c.padding[2])/2,l.segment_sizes=[],!l.no_curving){var p=splitLabelText(s,u);l.segments=p;for(var f=0;f<p.length;f++)l.segment_sizes.push(this.textSize(i,n,p[f],c).size)}}if(e.text_idx++,!Task.shouldContinue(t))return!1}e.text_idx=null,e.style_idx++}return Task.finish(t,{texts:r}),!0}},{key:"textSize",value:function(e,r,i,n){var o=n.transform,a=n.text_wrap,s=n.max_lines,l=n.stroke_width,c=void 0===l?0:l,u=n.supersample,h=n.padding,p=n.outline_width,f=n.can_articulate;if(t.cache.text[r]=t.cache.text[r]||{},t.cache.text[r][i])return t.cache.stats.text_hits++,t.cache.text[r][i];t.cache.stats.text_misses++,t.cache.text_count++;var d=Utils$1.device_pixel_ratio*u,y=this.applyTextTransform(i,o),g=d*(this.vertical_text_buffer+p+(h[0]+h[2])/2),v=d*(this.horizontal_text_buffer+p+c+(h[1]+h[3])/2),m=2*d,_=this.px_size+m,b=MultiLine.parse(y,a,s,_,e),w=b.height,x=b.width,E=b.lines,T=[x/d,w/d];f||(T[0]+=2*v/d,T[1]+=2*g/d);var A=[x+2*v,w+2*g],S=[A[0]/d,A[1]/d];return t.cache.text[r][i]={lines:E,size:{collision_size:T,texture_size:A,logical_size:S,line_height:_}},t.cache.text[r][i]}},{key:"drawTextMultiLine",value:function(t,e,r,i,n,o){var a=_slicedToArray(r,2),s=a[0],l=a[1],c=Utils$1.device_pixel_ratio*n.supersample,u=n.stroke_width||0,h=n.stroke;n.background_color&&(t.fillStyle=n.background_color,t.fillRect(s,l,i.texture_size[0],i.texture_size[1]));var p=n.outline_width*c,f=n.outline_color;p&&f&&(t.strokeStyle=f,t.lineWidth=p,t.strokeRect(s+p/2,l+p/2,i.texture_size[0]-p,i.texture_size[1]-p)),(n.background_color||p&&f)&&this.setFont(t,n);for(var d,y,g,v,m=i.line_height,_=l,b=0;b<e.length;b++){var w=e[b];this.drawTextLine(t,w,[s,_],i,n,o),_+=m}debugSettings$1.draw_label_collision_boxes&&(t.save(),d=c*(this.horizontal_text_buffer+n.outline_width+u+(n.padding[1]+n.padding[3])/2),y=c*(this.vertical_text_buffer+n.outline_width+(n.padding[0]+n.padding[2])/2),g=i.collision_size,t.strokeStyle="blue",t.lineWidth=2,t.strokeRect(s+d,l+y,c*g[0],c*g[1]),"curved"===o&&h&&0<u&&t.strokeRect(s+i.texture_size[0]+d,l+y,c*g[0],c*g[1]),t.restore()),debugSettings$1.draw_label_texture_boxes&&(t.save(),v=i.texture_size,t.strokeStyle="green",t.lineWidth=2,t.strokeRect(s+2,l+2,v[0]-4,v[1]-4),"curved"===o&&h&&0<u&&t.strokeRect(s+2+i.texture_size[0],l+2,v[0]-4,v[1]-4),t.restore())}},{key:"drawTextLine",value:function(t,e,r,i,n,o){var a,s=_slicedToArray(r,2),l=s[0],c=s[1],u=n.stroke,h=n.stroke_width,p=void 0===h?0:h,f=n.transform,d=n.align,y=n.supersample,g=n.padding,v=n.outline_width,m=Utils$1.device_pixel_ratio*y,_=(d=d||"center",i.texture_size),b=i.line_height,w=m*(this.vertical_text_buffer+v),x=m*(this.horizontal_text_buffer+v+p),E=this.applyTextTransform(e.text,f);"left"===d?a=l+x+g[3]*m:"center"===d?a=l+_[0]/2-e.width/2-(g[1]-g[3])*m/2:"right"===d&&(a=l+_[0]-e.width-x-g[1]*m);var T,A=c+w+b+g[0]*m;u&&0<p&&(T="curved"===o?_[0]:0,t.strokeText(E,a+T,A)),t.fillText(E,a,A)}},{key:"rasterize",value:function(e,r,i,n,o,a){return Task.removeForTile(i),Task.add({type:"rasterizeLabels",run:this.processRasterizeTask.bind(this),cancel:t.returnNoTextures,pause_factor:2,user_moving_view:!1,texts:e,textures:r,texture_prefix:n,gl:o,tile_id:i,texture_manager:a,cursor:{styles:Object.keys(e),texts:null,style_idx:0,text_idx:null,texture_idx:0,texture_names:[]}})}},{key:"processRasterizeTask",value:function(t){if(!Task.shouldContinue(t))return!1;for(var e=t.cursor,r=t.texts,i=t.textures;e.texture_idx<t.textures.length;){for(var n=!1,o=i[e.texture_idx],a=this.createCanvas.apply(this,_toConsumableArray(o.texture_size)),s=a.getContext("2d");e.style_idx<e.styles.length;){var l=e.styles[e.style_idx];null==e.text_idx&&(e.text_idx=0,e.texts=Object.keys(r[l]));for(var c=r[l],u=!0;e.text_idx<e.texts.length;){var h=e.texts[e.text_idx],p=c[h],f=p.text_settings;if(u&&(this.setFont(s,f),u=!1),f.can_articulate){p.texcoords=p.texcoords||{};for(var d=0;d<p.type.length;d++){var y=p.type[d];switch(y){case"straight":if(p.textures[d]!==e.texture_idx)continue;var g,v,m,_,b=p.isRTL?h.split().reverse().join():h,w=o.texcoord_cache[l][b],x=void 0;w.texcoord?x=w.texcoord:(g=w.texture_position,m=(v=this.textSize(s,l,b,f)).size,_=v.lines,this.drawTextMultiLine(s,_,g,m,f,y),x=t.texture_manager.getTexcoordsForSprite(g,m.texture_size,o.texture_size),w.texcoord=x),p.texcoords[y]={texcoord:x,texture_id:w.texture_id};break;case"curved":var E=p.segments;p.texcoords.curved=[],p.texcoords_stroke=[];for(var T,A,S,k,O,L,P,R,I=0;I<E.length;I++)p.textures[d][I]===e.texture_idx&&(T=E[I],k=S=void 0,(A=o.texcoord_cache[l][T]).texcoord&&A.texcoord_stroke?(S=A.texcoord,k=A.texcoord_stroke):(O=A.texture_position,P=(L=this.textSize(s,l,T,f)).size,R=L.lines,this.drawTextMultiLine(s,R,O,P,f,y),S=t.texture_manager.getTexcoordsForSprite(O,P.texture_size,o.texture_size),k=f.stroke&&0<f.stroke_width?t.texture_manager.getTexcoordsForSprite([O[0]+P.texture_size[0],O[1]],P.texture_size,o.texture_size):(n=!0,t.texture_manager.getTexcoordsForSprite([o.texture_size[0],o.texture_size[1]],[0,0],o.texture_size)),A.texcoord=S,A.texcoord_stroke=k),p.texcoords_stroke.push(k),p.texcoords.curved.push({texcoord:S,texture_id:A.texture_id}))}}}else{var C=this.textSize(s,l,h,f).lines;for(var M in p.align)p.align[M].texture_id===e.texture_idx&&(this.drawTextMultiLine(s,C,p.align[M].texture_position,p.size,{stroke:f.stroke,stroke_width:f.stroke_width,transform:f.transform,supersample:f.supersample,align:M,background_color:f.background_color,outline_width:f.outline_width,outline_color:f.outline_color,padding:f.padding,fill:f.fill,font_css:f.font_css,px_size:f.px_size}),p.align[M].texcoords=t.texture_manager.getTexcoordsForSprite(p.align[M].texture_position,p.size.texture_size,o.texture_size))}e.text_idx++}e.text_idx=null,e.style_idx++}!0===n&&(s.fillStyle="rgba(0, 0, 0, 0)",s.fillRect(a.width-1,a.height-1,1,1));var N=t.texture_prefix+e.texture_idx;t.texture_manager.create(t.gl,N,{element:a,filtering:"linear",UNPACK_PREMULTIPLY_ALPHA_WEBGL:!0}),e.texture_names.push(N),e.texture_idx++,e.style_idx=0,a.width=0,a.height=0}return Task.finish(t,e.texture_names),!0}},{key:"setTextureTextPositions",value:function(t){var e={texture_id:0,texcoord_cache:{}},r=[];for(var i in t){var n=t[i];for(var o in n){var a=n[o],s=a.text_settings,l=s.can_articulate,c=s.stroke,u=s.stroke_width;if(l){a.textures=[],e.texcoord_cache[i]=e.texcoord_cache[i]||{};for(var h=0;h<a.type.length;h++)switch(a.type[h]){case"straight":var p,f=a.isRTL?o.split().reverse().join():o;e.texcoord_cache[i][f]||(p=a.size.texture_size,e.texcoord_cache[i][f]={},this.placeText(p[0],p[1],{can_articulate:l,style:i,word:f})),a.textures[h]=e.texture_id;break;case"curved":a.textures[h]=[];for(var d=0;d<a.segment_sizes.length;d++){var y,g,v=a.segments[d];e.texcoord_cache[i][v]||(g=(y=a.segment_sizes[d].texture_size)[0],c&&0<u&&(g*=2),e.texcoord_cache[i][v]={},this.placeText(g,y[1],{can_articulate:l,style:i,word:v})),a.textures[h].push(e.texture_id)}}}else{var m=a.size.texture_size;this.placeText(m[0],m[1],{can_articulate:l,text_info:a})}}}var _=this.layout.export(),b=_.items,w=_.width,x=_.height;e.texcoord_cache={};for(var E=0,T=b.length;E<T;E++){var A=b[E],S=A.x,k=A.y;if(A.meta.can_articulate){var O=A.meta,L=O.style,P=O.word;e.texcoord_cache[L]=e.texcoord_cache[L]||{},e.texcoord_cache[L][P]||(e.texcoord_cache[L][P]={texture_id:e.texture_id,texture_position:[S,k]})}else{var R=A.meta.text_info;for(var I in R.align)R.align[I].texture_id=e.texture_id,R.align[I].texture_position=[S,k]}}return 0<w&&0<x&&(r[e.texture_id]={texture_size:[w,x],texcoord_cache:e.texcoord_cache}),r}},{key:"placeText",value:function(t,e,r){this.layout.addItem({width:t+this.vertical_text_buffer,height:e+this.vertical_text_buffer,meta:r})}},{key:"applyTextTransform",value:function(t,e){return"capitalize"===e?t.replace(/\w\S*/g,(function(t){return t.charAt(0).toUpperCase()+t.substr(1)})):"uppercase"===e?t.toUpperCase():"lowercase"===e?t.toLowerCase():t}}],[{key:"fontPixelSize",value:function(e){if(null!=e){var r=_slicedToArray((e="string"==typeof e?e:String(e)).match(t.font_size_re)||[],3),i=r[1],n=r[2];return"em"===(n=n||"px")?i*=16:"pt"===n?i/=.75:"%"===n&&(i/=6.25),(i=StyleParser.parsePositiveNumber(i))*Utils$1.device_pixel_ratio}}},{key:"pruneTextCache",value:function(){t.cache.text_count>t.cache.text_count_max&&(t.cache.text={},t.cache.text_count=0,log("debug","CanvasText: pruning text cache")),Object.keys(t.cache.segment).length>t.cache.segment_count_max&&(t.cache.segment={},log("debug","CanvasText: pruning segment cache"))}}]),t}();CanvasText.font_size_re=/((?:[0-9]*\.)?[0-9]+)\s*(px|pt|em|%)?/,CanvasText.cache={text:{},text_count:0,text_count_max:2e3,segment:{},segment_count_max:2e3,stats:{text_hits:0,text_misses:0,segment_hits:0,segment_misses:0}},CanvasText.EMPTY_TEXTURES_ARR=[],CanvasText.returnNoTextures=function(){return CanvasText.EMPTY_TEXTURES_ARR};var rtlDirCheck=new RegExp("[---]");function isTextRTL(t){return rtlDirCheck.test(t)}var neutral_chars="\0-/:-@[-`{----\u2029-",neutralDirCheck=new RegExp("["+neutral_chars+"]+");function isTextNeutral(t){return neutralDirCheck.test(t)}var markRTL="",arabic_range=new RegExp("^["+neutral_chars+"-]+"),arabic_splitters=new RegExp("["+neutral_chars+"-----]"),arabic_vowels=new RegExp("^[-----]+"),accents_and_vowels="[------------------------------------------]",combo_characters="[]",graphemeRegex=new RegExp("^.(?:"+accents_and_vowels+"+)?("+combo_characters+"\\W(?:"+accents_and_vowels+"+)?)*"),curve_blacklist={Mongolian:"-"},curve_blacklist_range=Object.keys(curve_blacklist).map((function(t){return curve_blacklist[t]})).join(""),curve_blacklist_test=new RegExp("["+curve_blacklist_range+"]");function isTextCurveBlacklisted(t){return curve_blacklist_test.test(t)}var default_segment_length=2;function splitLabelText(t,e){var r=e?1:default_segment_length;if(t.length<r)return[t];var i=t;if(CanvasText.cache.segment[i])return CanvasText.cache.stats.segment_hits++,CanvasText.cache.segment[i];var n=[];if(arabic_range.exec(t)){n=t.split(arabic_splitters);for(var o,a=-1,s=0;s<n.length-1;s++)0<s&&(o=arabic_vowels.exec(n[s]))&&(n[s]=n[s].substring(o[0].length),n[s-1]+=o[0],a+=o[0].length),a+=1+n[s].length,n[s]+=t.slice(a,a+1);t=""}for(;t.length;){for(var l="",c=t,u=0;u<r&&c.length;u++){var h=(graphemeRegex.exec(c)||c)[0];l+=h,c=c.substring(h.length)}n.push(l),t=t.substring(l.length)}return e&&n.reverse(),CanvasText.cache.stats.segment_misses++,CanvasText.cache.segment[i]=n}var MultiLine=function(){function t(e){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1/0,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1/0;_classCallCheck(this,t),this.width=0,this.height=0,this.lines=[],this.max_lines=r,this.text_wrap=i,this.context=e}return _createClass(t,[{key:"createLine",value:function(t){return this.lines.length<this.max_lines&&new Line(t,this.text_wrap)}},{key:"push",value:function(t){if(this.lines.length<this.max_lines){var e=this.context.measureText(t.text).width;return(t.width=e)>this.width&&(this.width=Math.ceil(e)),this.lines.push(t),this.height+=t.height,!0}return this.addEllipsis(),!1}},{key:"advance",value:function(t,e){return!!this.push(t)&&this.createLine(e)}},{key:"addEllipsis",value:function(){var e=this.lines[this.lines.length-1],r=Math.ceil(this.context.measureText(t.ellipsis).width);e.append(t.ellipsis),e.width+=r,e.width>this.width&&(this.width=e.width)}},{key:"finish",value:function(t){t?this.push(t):this.addEllipsis()}}],[{key:"parse",value:function(e,r,i,n,o){for(var a="number"==typeof r?e.split(" "):[e],s=new t(o,i,r),l=s.createLine(n),c=0;c<a.length;c++){for(var u=a[c].split("\n"),h=0===c,p=0;p<u.length&&l;p++){var f=u[p];isTextRTL(f)&&isTextNeutral(f[f.length-1])&&(f+=markRTL);var d=h?f:" "+f;if(r&&0<c&&l.exceedsTextwrap(d)){if(!(l=s.advance(l,n)))break;l.append(f),h=!0}else l.append(d);p<u.length-1&&(l=s.advance(l,n),h=!0)}c===a.length-1&&s.finish(l)}return s}}]),t}();MultiLine.ellipsis="...";var Line=function(){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;_classCallCheck(this,t),this.chars=0,this.text="",this.height=Math.ceil(e),this.text_wrap=r}return _createClass(t,[{key:"append",value:function(t){this.chars+=t.length,this.text+=t}},{key:"exceedsTextwrap",value:function(t){return t.length+this.chars>this.text_wrap}}]),t}(),TextLabels={resetText:function(){this.texts={}},freeText:function(t){delete this.texts[t.id]},parseTextFeature:function(t,e,r,i){var n=this.parseTextSource(t,e,r);if(null!=n&&""!==n){var o=TextSettings$1.compute(t,e,r);if(o){var a=TextSettings$1.key(o);this.texts[i.id]=this.texts[i.id]||{};var s=this.texts[i.id][a]=this.texts[i.id][a]||{};if(n instanceof Object){var l=[],c=n.left+"-"+n.right;for(var u in n){var h,p=n[u];p&&(h=this.computeTextLayout({},t,e,r,i,p,o,c,u),s[p]||(s[p]={text_settings:o,ref:0}),l.push({draw:e,text:p,text_settings_key:a,layout:h}))}return 0<l.length&&l}var f=this.computeTextLayout({},t,e,r,i,n,o);return s[n]||(s[n]={text_settings:o,ref:0}),{draw:e,text:n,text_settings_key:a,layout:f}}}},parseTextSource:function(t,e,r){var i,n=e.text_source||"name";if(null!=n&&"object"===_typeof(n))for(var o in i={},n)i[o]=this.parseTextSourceValue(n[o],t,r);else i=this.parseTextSourceValue(n,t,r);return i},parseTextSourceValue:function(t,e,r){var i;if(Array.isArray(t)){for(var n=0;n<t.length;n++)if("string"==typeof t[n]?i=e.properties[t[n]]:"function"==typeof t[n]&&(i=t[n](r)),i)return i}else"string"==typeof t?i=e.properties[t]:t instanceof Function&&(i=t(r));return i},prepareTextLabels:function(t,e,r){var i=this;return 0===Object.keys(this.texts[t.id]||{}).length?Promise.resolve([]):WorkerBroker.postMessage(this.main_thread_target+".calcTextSizes",t.id,this.texts[t.id]).then((function(e){var n=e.texts;return t.canceled?(log("trace","Style ".concat(i.name,": stop tile build because tile was canceled: ").concat(t.key,", post-calcTextSizes()")),[]):(i.texts[t.id]=n||[],n?i.buildTextLabels(t,r):(Collision.abortTile(t.id),[]))}))},collideAndRenderTextLabels:function(t,e,r){var i=this;return this.prepareTextLabels(t,e,r).then((function(r){return 0===r.length?(Collision.collide([],e,t.id),Promise.resolve({})):Collision.collide(r,e,t.id).then((function(e){if(t.canceled)return log("trace","stop tile build because tile was canceled: ".concat(t.key,", post-collide()")),{};var r=i.texts[t.id];return null==r||0===e.length?{}:(i.cullTextStyles(r,e),e.forEach((function(t){var e=t.text_settings_key,i=r[e]&&r[e][t.text];i.text_settings.can_articulate?(i.type||(i.type=[]),-1===i.type.indexOf(t.label.type)&&i.type.push(t.label.type)):(i.align=i.align||{},i.align[t.label.align]={})})),{labels:e,texts:r,textures:[]})}))}))},cullTextStyles:function(t,e){for(var r=0;r<e.length;r++){var i=e[r];t[i.text_settings_key][i.text].ref++}for(var n in t)for(var o in t[n])t[n][o].ref<1&&delete t[n][o];for(var a in t)0===Object.keys(t[a]).length&&delete t[a]},calcTextSizes:function(t,e){return this._canvas_text||(this._canvas_text=new CanvasText,this._canvas_ctx_for_sizes=this._canvas_text.createCanvas().getContext("2d")),this._canvas_text.textSizes(t,e,this._canvas_ctx_for_sizes)},preprocessText:function(t){if(t&&t.font&&"object"===_typeof(t.font))return t.font.fill=StyleParser.createPropertyCache(t.font.fill),t.font.stroke&&(t.font.stroke.color=StyleParser.createPropertyCache(t.font.stroke.color)),t.background&&t.background.color&&(t.background.color=StyleParser.createPropertyCache(t.background.color)),t.outline&&(t.outline.color&&(t.outline.color=StyleParser.createPropertyCache(t.outline.color)),t.outline.width&&(t.outline.width=StyleParser.createPropertyCache(t.outline.width,StyleParser.parsePositiveNumber))),t.padding&&(Array.isArray(t.padding)?2===t.padding.length&&(t.padding=[t.padding[0],t.padding[1],t.padding[0],t.padding[1]]):t.padding=Array(4).fill(t.padding),t.padding=StyleParser.createPropertyCache(t.padding,(function(t){return t.map(StyleParser.parsePositiveNumber)}))),t.font.px_size=StyleParser.createPropertyCache(t.font.size||TextSettings$1.defaults.size,CanvasText.fontPixelSize),t.font.stroke&&null!=t.font.stroke.width&&(t.font.stroke.width=StyleParser.createPropertyCache(t.font.stroke.width,StyleParser.parsePositiveNumber)),t.offset=StyleParser.createPropertyCache(t.offset,(function(t){return Array.isArray(t)&&t.map(StyleParser.parseNumber)})),t.buffer=StyleParser.createPropertyCache(t.buffer,(function(t){return(Array.isArray(t)?t:[t,t]).map(StyleParser.parsePositiveNumber)})),t.repeat_distance=StyleParser.createPropertyCache(t.repeat_distance||Geo$1.tile_size,StyleParser.parsePositiveNumber),t},computeTextLayout:function(t,e,r,i,n,o,a,s,l){var c=t||{};return(c=this.computeLayout(c,e,r,i,n)).repeat_distance&&(s&&(c.repeat_group+="/"+s),c.repeat_group+="/"+o),c.subdiv=n.overzoom2,c.align=r.align,c.italic="normal"!==a.style,"right"===l?c.orientation=1:"left"===l&&(c.orientation=-1),c}};function degToRad(t){return t*Math.PI/180}var PI_OVER_180=Math.PI/180,HORIZON_THRESHOLD_MULTIPLIER=.75,ZOOM_FOR_BOUNDS_EPSILON=.001,NEAR_PLANE=1,LookAtManipulator=function(){function t(e,r){_classCallCheck(this,t),this._min_zoom=H.util.constants.DEFAULT_MIN_ZOOM_LEVEL,this._max_zoom=H.util.constants.DEFAULT_MAX_ZOOM_LEVEL,this._viewport=e,this._center_offset=[],this._center_offset_normalized=[],this._viewport_aspect_ratio=1,this._focal_length=[[16,2],[17,2.5],[18,3],[19,4],[20,6]],this._view_matrix=new Float64Array(16),this._projection_matrix=new Float64Array(16),this._heading_matrix=new Float64Array(16),this._tilt_matrix=new Float64Array(16),this._transformation_matrix=new Float64Array(16),this._camera_matrix=new Float64Array(16),this._lookAtData={position:[0,0,0],zoom:0,tile_level:0,tetragon:void 0,bounds:void 0,unpadded_bounds:void 0,distance:void 0,tilt:0,incline:0,heading:180},this._zoom_direction=0,this._horizon=0,this.handleViewportUpdate(!0),r?this.setLookAtData(r):this._updateMatrices(),ShaderProgram.replaceBlock("camera","\n            uniform mat4 u_projection;\n            uniform vec3 u_eye;\n            uniform vec2 u_center_offset;\n\n            void cameraProjection (inout vec4 position) {\n                position = u_projection * position;\n            }")}return _createClass(t,[{key:"getZoomForBounds",value:function(t,e,r,i){var n,o=this.clone(),a=this._max_zoom,s=this._min_zoom,l=(a-s)/2,c=a-l,u=e,h=MathUtils$1.getBBoxCenter(MathUtils$1.getBBox(t));for(void 0===u?u=h:(n=h[0]-u[0],Math.abs(n)>Geo$1.half_circumference_meters+1e-8&&(u[0]+=Math.round(n/Geo$1.circumference_meters)*Geo$1.circumference_meters));ZOOM_FOR_BOUNDS_EPSILON<l;)!function(){o.setLookAtData({zoom:c,position:u,tilt:r,heading:i});var e,n,h,p,f,d=o.getLookAtData().bounds;t.every((function(t){return MathUtils$1.isPointInsidePolygon(t,d)}))?s=c:(n=(e=_slicedToArray(MathUtils$1.getBBox(d),4))[0],h=e[1],p=e[2],f=e[3],p-n+1e-8>=Geo$1.circumference_meters&&f-h+1e-8>=Geo$1.circumference_meters?s=c:a=c),c=a-(l=(a-s)/2)}();return s}},{key:"setZoomConstraints",value:function(t,e){this._min_zoom=t,this._max_zoom=e,this.setLookAtData(this.getLookAtData())}},{key:"setLookAtData",value:function(t,e){var r,i,n,o,a,s=t.position,l=t.zoom;s===r&&t.bounds!==r&&(s=MathUtils$1.getBBoxCenter(MathUtils$1.getBBox(t.bounds))),l===r&&t.bounds!==r&&(l=this.getZoomForBounds(t.bounds,s,t.tilt,t.heading)),e!==r&&(i=s||this.screenToWorld(e)),l!==r&&(l=MathUtils$1.clamp(l,this._min_zoom,this._max_zoom),(n=Utils$1.zoomToTileLevel(l))!==(o=this._lookAtData.tile_level)&&(this._zoom_direction=o<n?1:-1),this._lookAtData.zoom=l,this._lookAtData.tile_level=n),t.tilt!==r&&(this._lookAtData.tilt=t.tilt),t.heading!==r&&(this._lookAtData.heading=t.heading),e!==r?(this._updateMatrices(),a=this.screenToWorld(e),this._lookAtData.position[0]-=a[0]-i[0],this._lookAtData.position[1]-=a[1]-i[1]):s&&(this._lookAtData.position=s),this._lookAtData.position[2]=0,this._lookAtData.position[1]=MathUtils$1.clamp(this._lookAtData.position[1],-Geo$1.half_circumference_meters,Geo$1.half_circumference_meters),this._updateMatrices(),this._updateVisibleBounds()}},{key:"getZoomDirection",value:function(){return this._zoom_direction}},{key:"resetZoomDirection",value:function(){this._zoom_direction=0}},{key:"getLookAtData",value:function(){return this._lookAtData}},{key:"handleViewportUpdate",value:function(t){var e=0<arguments.length&&void 0!==t&&t,r=this._viewport,i=r.width,n=r.height;this._viewport_aspect_ratio=i/n;var o=this._viewport.center.x-(i/2<<0),a=this._viewport.center.y-(n/2<<0);this._center_offset[0]=o,this._center_offset[1]=a,this._center_offset_normalized[0]=o/i,this._center_offset_normalized[1]=a/-n,e||(this._updateMatrices(),this._updateVisibleBounds())}},{key:"setupMatrices",value:function(t,e){mat4.multiply(t.model_view32,this._view_matrix,t.model),e.uniform("Matrix4fv","u_modelView",t.model_view32),mat3.normalFromMat4(t.normal32,t.model_view32),mat3.invert(t.inverse_normal32,t.normal32),e.uniform("Matrix3fv","u_normalMatrix",t.normal32),e.uniform("Matrix3fv","u_inverseNormalMatrix",t.inverse_normal32)}},{key:"_updateMatrices",value:function(){var t=this._viewport.height*Geo$1.metersPerPixel(this._lookAtData.zoom),e=Utils$1.interpolate(this._lookAtData.zoom,this._focal_length);this._lookAtData.distance=t/2*e;var r=this._lookAtData.position[0],i=this._lookAtData.position[1];mat4.lookAt(this._view_matrix,vec3.fromValues(r,i,0),vec3.fromValues(r,i,-1),vec3.fromValues(0,1,0)),this._heading_matrix=mat4.identity(this._heading_matrix);var n=180-this._lookAtData.heading;n*=PI_OVER_180,this._heading_matrix[0]=Math.cos(n),this._heading_matrix[1]=-Math.sin(n),this._heading_matrix[4]=Math.sin(n),this._heading_matrix[5]=Math.cos(n),this._tilt_matrix=mat4.identity(this._tilt_matrix),n=0<(n=this._lookAtData.tilt?this._lookAtData.tilt*PI_OVER_180:0)?-n:n,this._tilt_matrix[5]=Math.cos(n),this._tilt_matrix[6]=Math.sin(n),this._tilt_matrix[9]=-Math.sin(n),this._tilt_matrix[10]=Math.cos(n),mat4.multiply(this._transformation_matrix,this._tilt_matrix,this._heading_matrix),mat4.multiply(this._view_matrix,this._transformation_matrix,this._view_matrix);var o=2*Math.atan(1/e),a=2*this._lookAtData.distance;this._depth_buffer_adjustment=2/Math.log(a/NEAR_PLANE),mat4.perspective(this._projection_matrix,o,this._viewport_aspect_ratio,NEAR_PLANE,a),this._projection_matrix[8]=2*-this._center_offset_normalized[0],this._projection_matrix[9]=2*-this._center_offset_normalized[1],mat4.translate(this._projection_matrix,this._projection_matrix,vec3.fromValues(0,0,-this._lookAtData.distance)),this._camera_matrix=mat4.multiply(this._camera_matrix,this._projection_matrix,this._view_matrix)}},{key:"_updateVisibleBounds",value:function(){var t,e,r,i,n,o=this._viewport,a=o.width,s=o.height,l=o.padding,c=degToRad(this._lookAtData.tilt);this._horizon=Math.max((l.top+s)/2-Math.cos(c)*(l.top*(1-Math.sin(c))+s*HORIZON_THRESHOLD_MULTIPLIER),0),this._lookAtData.tetragon=[this.screenToWorld([0,this._horizon]),this.screenToWorld([a,this._horizon]),this.screenToWorld([a,s]),this.screenToWorld([0,s])],this._lookAtData.unpadded_bounds=this._clipAgainstGeoBounds(this._lookAtData.tetragon),0===l.left&&0===l.top&&0===l.right&&0===l.bottom?this._lookAtData.bounds=this._lookAtData.unpadded_bounds:(t=l.left,e=Math.max(this._horizon,l.top),r=a-l.right,i=s-l.bottom,n=[this.screenToWorld([t,e]),this.screenToWorld([r,e]),this.screenToWorld([r,i]),this.screenToWorld([t,i])],this._lookAtData.bounds=this._clipAgainstGeoBounds(n))}},{key:"_clipAgainstGeoBounds",value:function(t){var e,r=_slicedToArray(MathUtils$1.getBBox(t),4),i=r[0],n=r[1],o=r[2],a=r[3],s=Geo$1.half_circumference_meters,l=[[i-1,+s],[o+1,+s],[o+1,-s],[i-1,-s]],c=MathUtils$1.clipPolygon(l,t)[0],u=_slicedToArray(MathUtils$1.getBBox(c),4);i=u[0],n=u[1],o=u[2],a=u[3],o-i>=Geo$1.circumference_meters&&(c=[[(e=(o-i)/2)-s,a],[e+s,a],[e+s,n],[e-s,n]]);var h=[];return c&&(h=MathUtils$1.splitLegs(c,s)),h}},{key:"applyPxOffset",value:function(t){var e=_slicedToArray(t,2),r=e[0],i=e[1],n=Math.PI-this._lookAtData.heading*PI_OVER_180,o=Geo$1.metersPerPixel(this._lookAtData.zoom);this._lookAtData.position[0]+=(r*Math.cos(n)+i*Math.sin(n))*o,this._lookAtData.position[1]-=(i*Math.cos(n)-r*Math.sin(n))*o,this._lookAtData.position[1]=MathUtils$1.clamp(this._lookAtData.position[1],-Geo$1.half_circumference_meters,Geo$1.half_circumference_meters),this._updateMatrices(),this._updateVisibleBounds()}},{key:"screenToWorld",value:function(t){var e=_slicedToArray(t,2),r=e[0],i=e[1],n=this._viewport,o=n.width,a=n.height;return 0===o||0===a?[0,0]:(r-=o/2,i-=a/2,this._clipCoordsToWorldPlaneCoords([2*(r+o/2)/o-1,1-2*(i+a/2)/a,-1,1]))}},{key:"_clipToScreenCoords",value:function(t){var e=this._viewport,r=e.width,i=e.height;return[(.5*t[0]+.5)*r,i-(.5*t[1]+.5)*i]}},{key:"_isScreenPointInViewPort",value:function(t){var e=this._viewport,r=e.width,i=e.height;return 0<=t[0]&&t[0]<=r&&0<=t[1]&&t[1]<=i}},{key:"worldToScreen",value:function(t,e){var r,i,n,o,a,s,l=1<arguments.length&&void 0!==e&&e;return t[2]||(t[2]=0),l?(r=this._worldToClipCoords(t),a=this._clipToScreenCoords(r)):(i=Math.sign(this._lookAtData.position[0]),n=Math.trunc(this._lookAtData.position[0]/Geo$1.circumference_meters+i/2),t[0]+=Geo$1.circumference_meters*n,o=this._worldToClipCoords(t),s=a=this._clipToScreenCoords(o),this._isScreenPointInViewPort(a)||(o=this._worldToClipCoords([t[0]+Geo$1.circumference_meters,t[1],t[2]]),a=this._clipToScreenCoords(o),this._isScreenPointInViewPort(a)||(o=this._worldToClipCoords([t[0]-Geo$1.circumference_meters,t[1],t[2]]),a=this._clipToScreenCoords(o)),this._isScreenPointInViewPort(a)||(a=s))),a}},{key:"getHorizon",value:function(){return this._horizon}},{key:"_clipCoordsToWorldPlaneCoords",value:function(t){var e=[],r=this._lookAtData.distance,i=this._lookAtData.position,n=[0,0,r,0],o=0,a=r*Math.sin(PI_OVER_180*this._lookAtData.tilt)*Math.cos(PI_OVER_180*this._lookAtData.heading),s=r*Math.sin(PI_OVER_180*this._lookAtData.tilt)*Math.sin(PI_OVER_180*this._lookAtData.heading),l=new Float64Array(16),c=new Float64Array(16);return mat4.invert(l,this._projection_matrix),vec4.transformMat4(e,t,l),e[2]=-1,e[3]=0,mat4.invert(c,this._view_matrix),vec4.transformMat4(e,e,c),vec4.normalize(e,e),vec4.transformMat4(n,n,this._transformation_matrix),0!==e[2]&&(o=-n[2]/e[2]),vec4.scale(e,e,o),[i[0]+(e[0]+s),i[1]+(e[1]+a)]}},{key:"_worldToClipCoords",value:function(t){var e=[t[0],t[1],t[2],1];return vec4.transformMat4(e,e,this._view_matrix),vec4.transformMat4(e,e,this._projection_matrix),vec4.scale(e,e,1/e[3]),e}},{key:"setupProgram",value:function(t){t.uniform("Matrix4fv","u_projection",this._projection_matrix),t.uniform("3f","u_eye",[0,0,this._lookAtData.distance]),t.uniform("2fv","u_center_offset",this._center_offset_normalized),t.uniform("1f","u_tilt",this._lookAtData.tilt*PI_OVER_180),t.uniform("1f","u_heading",this._lookAtData.heading*PI_OVER_180),t.uniform("1f","u_near_plane",NEAR_PLANE),t.uniform("1f","u_depth_buffer_adjustment",this._depth_buffer_adjustment)}},{key:"getTransformationMatrix",value:function(){return this._transformation_matrix}},{key:"getCameraMatrix",value:function(){return this._camera_matrix}},{key:"clone",value:function(){var e=new t(this._viewport,this._lookAtData);return e.setZoomConstraints(this._min_zoom,this._max_zoom),e}},{key:"getViewport",value:function(){return this._viewport}}]),t}();function getX(t){return void 0===t.x?t[0]:t.x}function getY(t){return void 0===t.y?t[1]:t.y}function xAscendingComparator(t,e){return getX(t)-getX(e)}function yAscendingComparator(t,e){return getY(t)-getY(e)}function sortByX(t){return t.sort(xAscendingComparator)}function sortByY(t){return t.sort(yAscendingComparator)}function getMinMax(t,e){for(var r,i=t[0],n=i,o=0;o<t.length;o+=1)e(r=t[o],i)<0?i=r:0<e(r,n)&&(n=r);return[i,n]}function groupByCoord(t,e){return Object.values(e.reduce((function(e,r){var i=r[+t];return e[i]||(e[i]=[]),e[i].push(r),e}),{}))}function groupByX(t){return groupByCoord(!1,t)}function groupByY(t){return groupByCoord(!0,t)}function createTileRangeByCoord(t,e,r){var i=+t,n=e[i],o=r[i];if(o<n)return[];var a=[e];if(o<n)return a;for(var s=e[(1+i)%2],l=t?function(t){return a.push([s,t])}:function(t){return a.push([t,s])},c=n+1;c<o;c+=1)l(c);return a.push(r),a}function createTileRangeByX(t,e){return createTileRangeByCoord(!1,t,e)}function createTileRangeByY(t,e){return createTileRangeByCoord(!0,t,e)}function deduplicate(t){var e={},r=[];return t.forEach((function(t){var i=t.key||(Array.isArray(t)?"".concat(t[0],"/").concat(t[1]):"".concat(t.x,"/").concat(t.y));e[i]||(e[i]=!0,r.push(t))})),r}function flat(t){return t.reduce((function(t,e){return t.concat(e)}))}function applyMargin(t,e){return e<=0?t:deduplicate((r=groupByY(flat(groupByX(t).map((function(t){var r=_slicedToArray(getMinMax(t,yAscendingComparator),2),i=r[0],n=r[1],o=[i[0],i[1]-e],a=[n[0],n[1]+e];return t.concat(createTileRangeByY(o,i),createTileRangeByY(n,a))})))),flat(r.map((function(t){var r=_slicedToArray(getMinMax(t,xAscendingComparator),2),i=r[0],n=r[1],o=[i[0]-e,i[1]],a=[n[0]+e,n[1]];return t.concat(createTileRangeByX(o,i),createTileRangeByX(n,a))})))));var r}function constructTiles(t,e,r){return t.map((function(t){var i=_slicedToArray(t,2),n=i[0],o=i[1];return Tile.coord(Geo$1.wrapTile({x:n,y:o,z:e},{x:!r,y:!0}))}))}function getTileGrid(t,e,r){function i(e){return Object.values(Geo$1.metersToExactTileCoords(e,t.tile_level))}return deduplicate(constructTiles(applyMargin(rasterizeTetragon(i(t.tetragon[0]),i(t.tetragon[1]),i(t.tetragon[3]),i(t.tetragon[2])),e),t.tile_level,r))}function rasterizeTetragon(t,e,r,i){var n=rasterizeTriangle(e,t,r),o=rasterizeTriangle(r,i,e);return deduplicate(n.concat(o))}function rasterizeTriangle(t,e,r){var i=_slicedToArray(sliceTriangle.apply(void 0,_toConsumableArray(sortByY([t,e,r]))),2),n=i[0],o=i[1];return deduplicate(rasterizeBottomFlatTriangle.apply(void 0,_toConsumableArray(n)).concat(rasterizeTopFlatTriangle.apply(void 0,_toConsumableArray(o))))}function sliceTriangle(t,e,r){var i=_slicedToArray(t,2),n=i[0],o=i[1],a=_slicedToArray(e,2),s=a[0],l=a[1],c=_slicedToArray(r,2),u=c[0],h=c[1],p=n+(l-o)/(h-o)*(u-n);return[[[n,o]].concat(_toConsumableArray(sortByX([[s,l],[p,l]]))),[].concat(_toConsumableArray(sortByX([[s,l],[p,l]])),[[u,h]])]}function rasterizeBottomFlatTriangle(t,e,r){var i=_slicedToArray(t,2),n=i[0],o=i[1],a=_slicedToArray(e,2),s=a[0],l=a[1];return scanFlatTriangle(n,s,_slicedToArray(r,1)[0],o,l)}function rasterizeTopFlatTriangle(t,e,r){var i=_slicedToArray(t,2),n=i[0],o=i[1],a=_slicedToArray(e,1)[0],s=_slicedToArray(r,2);return scanFlatTriangle(s[0],n,a,s[1],o)}var scanStepStatic=.125;function getScanStep(t,e){return scanStepStatic*(e-t)/(Math.ceil(e)-Math.floor(t))}function scanFlatTriangle(t,e,r,i,n){var o=Math.min(t,e),a=Math.max(t,r),s=Math.min(i,n),l=Math.max(i,n);if(Math.floor(i)===Math.floor(n))return scanRow(o,a,i);if(l-s<scanStepStatic)return scanRectangle([o,s],[a,l]);function c(t){d=d.concat(scanRow(y,g,Math.floor(t))),y+=p,g+=f}var u=getScanStep(s,l),h=(l-s)/u,p=(e-t)/h,f=(r-t)/h,d=[],y=t,g=t;if(i<n)for(var v=s;v<=l;v+=u)c(v);else for(var m=l;s<=m;m-=u)c(m);return deduplicate(d)}function xCoordsToPoints(t,e){return t.map((function(t){return[t,e]}))}function createCoordRange(t,e){var r=Math.floor(t),i=Math.floor(e);if(i<r)return[];if(r===i)return[r];for(var n=[],o=r;o<=i;o+=1)n.push(o);return n}function scanRow(t,e,r){return xCoordsToPoints(createCoordRange(t,e),r)}function scanRectangle(t,e){var r=_slicedToArray(t,2),i=r[0],n=r[1],o=_slicedToArray(e,2),a=o[0],s=o[1],l=createCoordRange(i,a),c=xCoordsToPoints(l,n),u=xCoordsToPoints(l,s);return c.concat(u)}var VIEW_PAN_SNAP_TIME=.5,Z_PRECISION=1e5,View=function(){function t(e,r){_classCallCheck(this,t),subscribeMixin(this),this.scene=e,this.createMatrices(),this.bounds=null,this.center_tile=null,this.panning=!1,this.panning_stop_at=0,this.pan_snap_timer=0,this.user_input_at=0,this.user_input_timeout=50,this.user_input_active=!1,this.size={},this.buffer=0,this.wrap=!1!==r.wrapView,this.preserve_tiles_within_zoom=1,this.lookAtManipulator=new LookAtManipulator(r.viewport),this._viewport=r.viewport,this._offset_buffer=[0,0],this.handleViewportUpdate(!0)}return _createClass(t,[{key:"update",value:function(){this.pan_snap_timer=(new Date-this.panning_stop_at)/1e3,this.user_input_active=new Date-this.user_input_at<this.user_input_timeout,this.scene.tile_manager.updateTilesVisibilityCounters()}},{key:"handleViewportUpdate",value:function(t){var e=0<arguments.length&&void 0!==t&&t,r=this._viewport,i=r.width,n=r.height;this.size.css={width:i,height:n},this.size.device={width:Math.round(i*Utils$1.device_pixel_ratio),height:Math.round(n*Utils$1.device_pixel_ratio)},this.lookAtManipulator.handleViewportUpdate(),e||this.updateBounds()}},{key:"setLookAtData",value:function(e,r){t._setLookAtDataForManipulator(this.lookAtManipulator,e,r),this.updateBounds()}},{key:"getLookAtData",value:function(e){var r=0<arguments.length&&void 0!==e&&e;return t._getLookAtDataFromManipulator(this.lookAtManipulator,r)}},{key:"getBestLookAtData",value:function(e,r,i){var n=2<arguments.length&&void 0!==i&&i,o=this.lookAtManipulator.clone();return t._setLookAtDataForManipulator(o,e,r),t._getLookAtDataFromManipulator(o,n)}},{key:"getTileLevel",value:function(){return this.lookAtManipulator.getLookAtData().tile_level}},{key:"applyPxOffset",value:function(t){var e=this._offset_buffer;e[0]+=t[0],e[1]+=t[1];var r,i,n=Math.abs(e[0]),o=Math.abs(e[1]);(1<=n||1<=o)&&(r=~~e[0],i=~~e[1],this.lookAtManipulator.applyPxOffset([n<1?0:r,o<1?0:i]),1<=n&&(e[0]-=r),1<=o&&(e[1]-=i),this.updateBounds())}},{key:"setPanning",value:function(t){this.panning=t,this.panning||(this.panning_stop_at=+new Date)}},{key:"markUserInput",value:function(){this.user_input_at=+new Date}},{key:"ready",value:function(){return"number"==typeof this.size.css.width&&"number"==typeof this.size.css.height}},{key:"updateBounds",value:function(){var t,e;this.markUserInput(),this.ready()&&(this.center_tile=Geo$1.tileForMeters(this.lookAtManipulator.getLookAtData().position,this.lookAtManipulator.getLookAtData().tile_level),t=this.lookAtManipulator.screenToWorld([0,this.size.css.height]),e=this.lookAtManipulator.screenToWorld([this.size.css.width,0]),this.bounds={sw:{x:t[0],y:t[1]},ne:{x:e[0],y:e[1]}},this.scene.tile_manager.updateTilesForView(!0),this.trigger("move"),this.scene.requestRedraw())}},{key:"getTileGridFlatForBBox",value:function(t,e,r,i,n,o){var a,s=4<arguments.length&&void 0!==n?n:0,l=!(5<arguments.length&&void 0!==o)||o,c=this.lookAtManipulator.getLookAtData().tile_level,u=Geo$1.tileForMeters([e,t],c),h=Geo$1.tileForMeters([i,r],c);u.x-=s,u.y-=s,h.x+=s,h.y+=s,!1===l&&(a=(1<<c)-1,u.x=Math.min(Math.max(0,u.x),a),u.y=Math.min(Math.max(0,u.y),a),h.x=Math.min(Math.max(0,h.x),a),h.y=Math.min(Math.max(0,h.y),a));for(var p=[],f={},d=u.x;d<=h.x;d++)for(var y=u.y;y<=h.y;y++){var g=Tile.coord(Geo$1.wrapTile({x:d,y,z:c},{x:!l,y:!0}));f[g.key]||(f[g.key]=!0,p.push(g))}return p}},{key:"getTileGridFlat",value:function(){return this.getTileGridFlatForBBox(this.bounds.ne.y,this.bounds.sw.x,this.bounds.sw.y,this.bounds.ne.x,this.buffer,this.wrap)}},{key:"getTileGridDistorted",value:function(){return getTileGrid(this.lookAtManipulator.getLookAtData(),this.buffer,this.wrap)}},{key:"findVisibleTileCoordinates",value:function(){if(!this.bounds)return[];var t=this.lookAtManipulator.getLookAtData(),e=t.tilt,r=t.heading;return 0===e&&180===r?this.getTileGridFlat():this.getTileGridDistorted()}},{key:"createMatrices",value:function(){this.matrices={},this.matrices.model=new Float64Array(16),this.matrices.model32=new Float32Array(16),this.matrices.model_view=new Float64Array(16),this.matrices.model_view32=new Float32Array(16),this.matrices.normal=new Float64Array(9),this.matrices.normal32=new Float32Array(9),this.matrices.inverse_normal32=new Float32Array(9)}},{key:"setupTile",value:function(t,e){t.setupProgram(this.matrices,e),this.lookAtManipulator.setupMatrices(this.matrices,e)}},{key:"setupProgram",value:function(t){var e=this.lookAtManipulator.getLookAtData();t.uniform("2fv","u_resolution",[this.size.device.width,this.size.device.height]),t.uniform("3fv","u_map_position",[e.position[0],e.position[1],Math.trunc(e.zoom*Z_PRECISION)/Z_PRECISION]),t.uniform("1f","u_meters_per_pixel",Geo$1.metersPerPixel(e.zoom)),t.uniform("1f","u_device_pixel_ratio",Utils$1.device_pixel_ratio),t.uniform("1f","u_view_pan_snap_timer",this.pan_snap_timer),t.uniform("1i","u_view_panning",this.panning),t.uniform("1f","u_horizon",this.lookAtManipulator.getHorizon()/(this.size.css.height/2)),this.lookAtManipulator.setupProgram(t)}},{key:"isAnimating",value:function(){return this.pan_snap_timer<=VIEW_PAN_SNAP_TIME}},{key:"xyToGeo",value:function(t,e){var r=this.lookAtManipulator.screenToWorld([t,e]),i=_slicedToArray(Geo$1.metersToLatLng(r),2),n=i[0];return{lat:i[1],lng:n}}},{key:"geoToPixel",value:function(t){var e=Geo$1.latLngToMeters([t.lng,t.lat]);e.push(t.alt||0);var r=this.lookAtManipulator.worldToScreen(e);return{x:Math.floor(r[0]),y:Math.floor(r[1])}}},{key:"geoToMeters",value:function(t){var e=_slicedToArray(Geo$1.latLngToMeters([t.lng,t.lat]),2);return{x:e[0],y:e[1],z:t.alt||0}}},{key:"metersToGeo",value:function(t){var e=_slicedToArray(Geo$1.metersToLatLng([t.x,t.y]),2),r=e[0];return{lat:e[1],lng:r,alt:t.z||0}}},{key:"setZoomConstraints",value:function(t,e){this.lookAtManipulator.setZoomConstraints(t,e)}}],[{key:"_setLookAtDataForManipulator",value:function(t,e,r){var i=e.position,n=e.zoom,o=e.tilt,a=e.heading,s=e.bounds,l={zoom:n,tilt:o,heading:a};if(i&&"number"==typeof i.lng&&"number"==typeof i.lat&&(l.position=Geo$1.latLngToMeters([i.lng,i.lat])),s){var c=s.getExterior().getLatLngAltArray(),u=c.length/3,h=Array(u);if(s.getBoundingBox().isCDB())for(var p=c[1],f=0,d=0;d<u;d++){var y,g=c[3*d+1];0<d&&(y=g-p,180<Math.abs(y)&&(f+=p<g?-360:360)),p=g,h[d]=Geo$1.latLngToMeters([g+f,c[3*d]])}else for(var v=0;v<u;v++)h[v]=Geo$1.latLngToMeters([c[3*v+1],c[3*v]]);l.bounds=h}t.setLookAtData(l,r)}},{key:"_getLookAtDataFromManipulator",value:function(t,e){var r=1<arguments.length&&void 0!==e&&e,i=t.getLookAtData(),n=i.heading,o=i.incline,a=i.tilt,s=i.zoom,l=i.position,c=i.bounds,u=i.unpadded_bounds,h=_slicedToArray(Geo$1.metersToLatLng(l),2),p=h[0],f=h[1],d=new H.geo.LineString;return(r?u:c).forEach((function(t){var e=Geo$1.metersToLatLng(t);d.pushLatLngAlt(e[1],e[0],0)})),{heading:n,incline:o,tilt:a,zoom:s,bounds:new H.geo.Polygon(d),position:{lat:f,lng:p,alt:l[2]}}}}]),t}(),shaderSrc_pointsVertex="uniform vec2 u_resolution;uniform vec3 u_map_position;uniform vec4 u_tile_origin;uniform float u_tile_proxy_depth;uniform bool u_tile_fade_in;uniform float u_meters_per_pixel;uniform float u_device_pixel_ratio;uniform float u_visible_time;uniform bool u_view_panning;uniform float u_tilt;uniform mat4 u_model;uniform mat4 u_modelView;uniform mat3 u_normalMatrix;uniform mat3 u_inverseNormalMatrix;uniform float u_heading;uniform float u_near_plane;uniform float u_depth_buffer_adjustment;attribute vec4 a_position;attribute vec4 a_shape;attribute vec4 a_color;attribute vec2 a_texcoord;attribute vec2 a_offset;uniform float u_point_type;attribute float a_is_flat;\n#ifdef TANGRAM_IS_TEXT_STYLE\nattribute vec4 a_offsets_alt;attribute vec4 a_pre_angles_alt;attribute vec4 a_angles_alt;attribute vec4 a_offsets;attribute vec4 a_pre_angles;attribute vec4 a_angles;\n#endif\n#ifdef TANGRAM_POINT_DRAW_STICK\nattribute float a_is_stick;attribute float a_stick_height;varying float v_is_stick;\n#endif\nvarying vec4 v_color;varying vec2 v_texcoord;varying vec4 v_world_position;varying float v_alpha_factor;\n#ifdef TANGRAM_HAS_SHADER_POINTS\nattribute float a_outline_edge;attribute vec4 a_outline_color;varying float v_outline_edge;varying vec4 v_outline_color;varying float v_aa_offset;\n#endif\n#ifdef TANGRAM_SHOW_HIDDEN_LABELS\nvarying float v_label_hidden;\n#endif\n#define PI 3.14159265359\n#define TANGRAM_NORMAL vec3(0., 0., 1.)\n#pragma tangram: camera\n#pragma tangram: material\n#pragma tangram: lighting\n#pragma tangram: raster\n#pragma tangram: global\nvec2 rotate2D(vec2 _st,float _angle){return mat2(cos(_angle),-sin(_angle),sin(_angle),cos(_angle))*_st;}vec3 rotateX3D(vec3 _st,float _angle){return mat3(1.,0.,0.,0.,cos(_angle),sin(_angle),0.,-sin(_angle),cos(_angle))*_st;}vec3 rotateZ3D(vec3 _st,float _angle){return mat3(cos(_angle),sin(_angle),0.,-sin(_angle),cos(_angle),0.,0.,0.,1.)*_st;}\n#ifdef TANGRAM_IS_TEXT_STYLE\nfloat mix4linear(float a,float b,float c,float d,float x){return mix(mix(a,b,3.*x),mix(b,mix(c,d,3.*(max(x,.66)-.66)),3.*(clamp(x,.33,.66)-.33)),step(0.33,x));}\n#endif\nvoid main(){\n#pragma tangram: setup\n#ifndef TANGRAM_SHOW_HIDDEN_LABELS\nif(a_shape.w==0.){gl_Position=vec4(0.,0.,0.,1.);return;}\n#else\nif(a_shape.w==0.){v_label_hidden=1.;}else{v_label_hidden=0.;}\n#endif\nv_alpha_factor=1.0;v_color=a_color;v_texcoord=a_texcoord;\n#ifdef TANGRAM_HAS_SHADER_POINTS\nv_outline_color=a_outline_color;v_outline_edge=a_outline_edge;if(u_point_type==TANGRAM_POINT_TYPE_SHADER){v_outline_color=a_outline_color;v_outline_edge=a_outline_edge;float size=abs(a_shape.x/128.);v_texcoord=sign(a_shape.xy)*(size+1.0)/size;size+=2.0;v_aa_offset=2.0/size;}\n#endif\nvec4 position=u_modelView*vec4(a_position.xyz,1.);vec4 shape=vec4(a_shape.xy,0.,0.);vec2 offset=vec2(a_offset.x,-a_offset.y);\n#ifdef TANGRAM_POINT_DRAW_STICK\nv_is_stick=a_is_stick;float scaled_stick_height=(sin(u_tilt+(1.5*PI))+1.0)*a_stick_height;offset.y+=(1.0-a_is_stick)*scaled_stick_height;\n#endif\nfloat zoom=clamp(u_map_position.z-u_tile_origin.z,0.,1.);float theta=a_shape.z/4096.;float heading=u_heading;float delta=(heading-PI);float new_theta=theta-delta;float reversed=abs(new_theta)>PI/2. ? 1. : 0.;if(a_is_flat==1.0){\n#ifdef TANGRAM_IS_TEXT_STYLE\nif(a_offsets[0]!=0.){vec4 angles_scaled;vec4 pre_angles_scaled;vec4 offsets_scaled;if(reversed==1.){offsets_scaled=a_offsets_alt*4.;angles_scaled=(PI/16384.)*a_angles_alt;pre_angles_scaled=(PI/128.)*a_pre_angles_alt;}else{offsets_scaled=a_offsets*4.;angles_scaled=(PI/16384.)*a_angles;pre_angles_scaled=(PI/128.)*a_pre_angles;}float pre_angle=mix4linear(pre_angles_scaled[0],pre_angles_scaled[1],pre_angles_scaled[2],pre_angles_scaled[3],zoom);float angle=mix4linear(angles_scaled[0],angles_scaled[1],angles_scaled[2],angles_scaled[3],zoom);float offset_curve=mix4linear(offsets_scaled[0],offsets_scaled[1],offsets_scaled[2],offsets_scaled[3],zoom);shape.xy=rotate2D(shape.xy,pre_angle+PI*reversed);shape.x+=offset_curve;shape.xy=rotate2D(shape.xy,angle);shape.xy+=rotate2D(offset,theta);}else{shape.xy=rotate2D(shape.xy+offset*256.,theta+(PI*reversed));}\n#else\nshape.xy=rotate2D(shape.xy+offset*256.,theta);\n#endif\nshape.xy/=pow(2.,4.+(u_map_position.z-u_tile_origin.w));shape=u_modelView*shape;position+=shape;}else{shape.xy/=256.;\n#ifdef TANGRAM_POINT_DRAW_STICK\nshape.y*=1.0+(scaled_stick_height-1.0)*a_is_stick;\n#endif\nshape.xy=rotate2D(shape.xy+offset,theta);}\n#ifdef TANGRAM_FADE_IN_RATE\nif(u_tile_fade_in){v_alpha_factor*=clamp(u_visible_time*TANGRAM_FADE_IN_RATE,0.,1.);}\n#endif\n#ifdef TANGRAM_FADE_ON_ZOOM_OUT\nv_alpha_factor*=clamp(1.+TANGRAM_FADE_ON_ZOOM_OUT_RATE*(u_map_position.z-u_tile_origin.z),0.,1.);\n#endif\nv_world_position=u_model*position;v_world_position.xy+=shape.xy*u_meters_per_pixel;v_world_position=wrapWorldPosition(v_world_position);\n#pragma tangram: position\ncameraProjection(position);\n#ifdef TANGRAM_LAYER_ORDER\napplyLayerOrder(a_position.w+u_tile_proxy_depth+1.,position);/***Due to the precision loss on depth buffer,we had a z-fighting of translucent points when the distance to the camera was big.*For more information about the problem see: https:*For more information about the fix see: https:*position.z=(2.0*log(position.w/u_near_plane)/log(u_far_plane/u_near_plane)-1.0)*position.w;*/position.z=(log(position.w/u_near_plane)*u_depth_buffer_adjustment-1.0)*position.w;\n#endif\nif(a_is_flat!=1.){position.xy+=shape.xy*position.w*2.*u_device_pixel_ratio/u_resolution;}\n#ifdef TANGRAM_HAS_SHADER_POINTS\nif(u_point_type==TANGRAM_POINT_TYPE_SHADER){position.xy+=sign(shape.xy)*position.w*u_device_pixel_ratio/u_resolution;}\n#endif\nif(!u_view_panning){snapToPixelGrid(position);}gl_Position=position;}",shaderSrc_pointsFragment="uniform vec2 u_resolution;uniform vec3 u_map_position;uniform vec4 u_tile_origin;uniform float u_meters_per_pixel;uniform float u_device_pixel_ratio;uniform float u_visible_time;uniform mat3 u_normalMatrix;uniform mat3 u_inverseNormalMatrix;uniform sampler2D u_texture;uniform float u_point_type;uniform bool u_apply_color_blocks;varying vec4 v_color;varying vec2 v_texcoord;varying vec4 v_world_position;varying float v_alpha_factor;\n#ifdef TANGRAM_HAS_SHADER_POINTS\nvarying vec4 v_outline_color;varying float v_outline_edge;varying float v_aa_offset;\n#endif\n#ifdef TANGRAM_SHOW_HIDDEN_LABELS\nvarying float v_label_hidden;\n#endif\n#ifdef TANGRAM_POINT_DRAW_STICK\nvarying float v_is_stick;\n#endif\n#define TANGRAM_NORMAL vec3(0., 0., 1.)\n#pragma tangram: camera\n#pragma tangram: material\n#pragma tangram: lighting\n#pragma tangram: raster\n#pragma tangram: global\n#ifdef TANGRAM_HAS_SHADER_POINTS\nfloat _tangram_antialias(float l,float R){float low=R-v_aa_offset;float high=R+v_aa_offset;return 1.-smoothstep(low,high,l);}\n#endif\nvoid mixTextureColor(inout vec4 color){\n#ifdef TANGRAM_HAS_SHADER_POINTS\nif(u_point_type==TANGRAM_POINT_TYPE_TEXTURE){color*=texture2D(u_texture,v_texcoord);}else if(u_point_type==TANGRAM_POINT_TYPE_LABEL){color=texture2D(u_texture,v_texcoord);color.rgb/=max(color.a,0.001);}else if(u_point_type==TANGRAM_POINT_TYPE_SHADER){float outline_edge=v_outline_edge;vec4 outlineColor=v_outline_color;float l=length(v_texcoord);float outer_alpha=_tangram_antialias(l,1.);float fill_alpha=_tangram_antialias(l,1.-v_outline_edge*0.5)*color.a;float stroke_alpha=(outer_alpha-_tangram_antialias(l,1.-v_outline_edge))*outlineColor.a;\n#ifdef TANGRAM_BLEND_ADD\ncolor.a=stroke_alpha+fill_alpha;color.rgb=color.rgb*fill_alpha+outlineColor.rgb*stroke_alpha;\n#else\ncolor.a=stroke_alpha+fill_alpha*(1.-stroke_alpha);color.rgb=mix(color.rgb*fill_alpha,outlineColor.rgb,stroke_alpha)/max(color.a,0.001);\n#endif\n}\n#else\ncolor=texture2D(u_texture,v_texcoord);color.rgb/=max(color.a,0.001);\n#endif\nif(u_apply_color_blocks){\n#pragma tangram: color\n#pragma tangram: filter\n}color.a*=v_alpha_factor;\n#ifdef TANGRAM_SHOW_HIDDEN_LABELS\nif(v_label_hidden>0.){color.a*=0.5;color.rgb=vec3(1.,0.,0.);}\n#endif\n#if !defined(TANGRAM_BLEND_OVERLAY) && !defined(TANGRAM_BLEND_INLAY) && !defined(TANGRAM_BLEND_ADD)\nif(color.a<TANGRAM_ALPHA_TEST){discard;}\n#endif\n}void main(void){\n#pragma tangram: setup\nvec4 color=v_color;\n#ifdef TANGRAM_POINT_DRAW_STICK\nif(v_is_stick==0.0){mixTextureColor(color);}\n#else\nmixTextureColor(color);\n#endif\ngl_FragColor=color;}",PLACEMENT$1=LabelPoint.PLACEMENT,pre_angles_normalize=128/Math.PI,angles_normalize=16384/Math.PI,offsets_normalize=64,texcoord_normalize=65535,Points=Object.create(Style),TANGRAM_POINT_TYPE_TEXTURE=1,TANGRAM_POINT_TYPE_LABEL=2,TANGRAM_POINT_TYPE_SHADER=3,DEFAULT_POINT_SIZE=16;Object.assign(Points,TextLabels),Object.assign(Points,{name:"points",built_in:!0,vertex_shader_src:shaderSrc_pointsVertex,fragment_shader_src:shaderSrc_pointsFragment,selection:!0,collision:!0,blend:"overlay",init:function(t){var e=0<arguments.length&&void 0!==t?t:{};Style.init.call(this,e),this.setupDefines(),this.defines.TANGRAM_HAS_SHADER_POINTS=!0,this.defines.TANGRAM_POINT_TYPE_TEXTURE=TANGRAM_POINT_TYPE_TEXTURE,this.defines.TANGRAM_POINT_TYPE_LABEL=TANGRAM_POINT_TYPE_LABEL,this.defines.TANGRAM_POINT_TYPE_SHADER=TANGRAM_POINT_TYPE_SHADER,this.defines.TANGRAM_POINT_DRAW_STICK=!!this.stick,this.collision_group_points=this.name+"-points",this.collision_group_text=this.name+"-text",this.reset()},setupDefines:function(){"overlay"!==this.blend&&(this.defines.TANGRAM_LAYER_ORDER=!0),this.defines.TANGRAM_FADE_ON_ZOOM_OUT=!0,this.defines.TANGRAM_FADE_ON_ZOOM_OUT_RATE=2,debugSettings$1.suppress_label_fade_in||this.suppress_fade?(this.fade_in_time=0,this.defines.TANGRAM_FADE_IN_RATE=null):(this.fade_in_time=.15,this.defines.TANGRAM_FADE_IN_RATE=1/this.fade_in_time),debugSettings$1.suppress_snap_animation||(this.defines.TANGRAM_VIEW_PAN_SNAP_RATE=1/VIEW_PAN_SNAP_TIME),debugSettings$1.show_hidden_labels&&(this.defines.TANGRAM_SHOW_HIDDEN_LABELS=!0)},reset:function(){this.queues={},this.resetText(),this.texture_missing_sprites={}},addFeature:function(t,e,r){var i,n,o,a=r.tile,s={};if(s.color=this.parseColor(e.color,r),s.texture=e.texture,s.label_texture=null,s.color||s.texture){if(this.hasSprites(s)){if(!(i=this.parseSprite(s,e,r)))return;s.texcoords=i.texcoords}if(s.size=e.size,s.size){if(s.size=StyleParser.evalCachedPointSizeProperty(e.size,i,r),null==s.size)return void log({level:"warn",once:!0},"Layer '".concat(e.layers[e.layers.length-1],"': ")+"'size' includes % and/or ratio-based scaling (".concat(JSON.stringify(e.size.value),"); ")+"these can only applied to sprites, but no sprite was specified, skipping features in layer");"number"==typeof s.size&&(s.size=[s.size,s.size])}else s.size=i&&i.css_size||[DEFAULT_POINT_SIZE,DEFAULT_POINT_SIZE];e.outline&&(s.outline_width=StyleParser.evalCachedProperty(e.outline.width,r)||StyleParser.defaults.outline.width,s.outline_color=this.parseColor(e.outline.color,r)),s.outline_edge_pct=0,s.outline_width&&s.outline_color&&(n=s.outline_width,s.size[0]+=n,s.size[1]+=n,s.outline_edge_pct=n/Math.min(s.size[0],s.size[1])*2),s.size[0]=Math.min(s.size[0],256),s.size[1]=Math.min(s.size[1],256),s.placement=e.placement,s.placement_min_length_ratio=StyleParser.evalCachedProperty(e.placement_min_length_ratio,r),s.placement===PLACEMENT$1.SPACED&&e.placement_spacing&&(s.placement_spacing=StyleParser.evalCachedProperty(e.placement_spacing,r)),s.angle=StyleParser.evalProperty(e.angle,r)||0,s.elevate_by_altitude=!!e.elevate_by_altitude,s.z=e.z?MathUtils$1.clamp(StyleParser.evalCachedDistanceProperty(e.z,r),0,32767):StyleParser.defaults.z,s.flat=e.flat,s.tile_edges=e.tile_edges,this.computeLayout(s,t,e,r,a),e.stick&&!s.flat&&(o=StyleParser.parseNumber(StyleParser.evalProperty(e.stick.height,r)),s.stick={color:this.parseColor(e.stick.color,r)||StyleParser.defaults.color,height:o?Math.max(o,0):0});var l=e.text&&!1!==StyleParser.evalProperty(e.text.visible,r)&&this.parseTextFeature(t,e.text,r,a);Array.isArray(l)&&log({level:"warn",once:!(l=null)},"Layer '".concat(e.layers[e.layers.length-1],"': ")+"cannot use boundary labels (e.g. 'text_source: { left: ..., right: ... }') for 'text' labels attached to 'points'; "+"provided 'text_source' value was ".concat(JSON.stringify(e.text.text_source))),l&&(l.layout.parent=s,l.layout.priority=e.text.priority?Math.max(l.layout.priority,s.priority+.5):s.priority+.5,l.layout.move_into_tile=!1,Collision.addStyle(this.collision_group_text,a.id)),this.queueFeature({feature:t,draw:e,context:r,style:s,text_feature:l},a),Collision.addStyle(this.collision_group_points,a.id)}},hasSprites:function(t){return t.texture&&this.textureManager.textures[t.texture]&&this.textureManager.textures[t.texture].sprites},getSpriteInfo:function(t,e){var r=this.textureManager.textures[t.texture].sprites[e]&&this.textureManager.getSpriteInfo(t.texture,e);return e&&!r?(this.texture_missing_sprites[t.texture]=this.texture_missing_sprites[t.texture]||{},this.texture_missing_sprites[t.texture][e]||(log("debug","Style: in style '".concat(this.name,"', could not find sprite '").concat(e,"' for texture '").concat(t.texture,"'")),this.texture_missing_sprites[t.texture][e]=!0)):r&&(r.sprite=e),r},parseSprite:function(t,e,r){var i=StyleParser.evalProperty(e.sprite,r);return this.getSpriteInfo(t,i)||this.getSpriteInfo(t,e.sprite_default)},queueFeature:function(t,e){this.tile_data[e.id]&&this.queues[e.id]||this.startData(e),this.queues[e.id]=this.queues[e.id]||[],this.queues[e.id].push(t)},endData:function(t){var e=this;if(t.canceled)return log("trace","Style ".concat(this.name,": stop tile build because tile was canceled: ").concat(t.key)),Promise.resolve();var r=this.queues[t.id];delete this.queues[t.id];var i=[],n=[];return r.forEach((function(t){for(var r=t.style,o=t.feature,a=o.geometry,s=e.buildLabels(r.size,a,r),l=0;l<s.length;l++){var c,u=s[l],h={feature:o,draw:t.draw,context:t.context,style:r,label:u};n.push(h),t.text_feature&&(c={feature:o,draw:t.text_feature.draw,context:t.context,text:t.text_feature.text,text_settings_key:t.text_feature.text_settings_key,layout:t.text_feature.layout,point_label:u,linked:h},i.push(c),t.draw.text.optional||(h.linked=c))}})),Promise.all([Collision.collide(n,this.collision_group_points,t.id).then((function(t){t.forEach((function(t){e.feature_style=t.style,e.feature_style.label=t.label,e.feature_style.linked=t.linked,Style.addFeature.call(e,t.feature,t.draw,t.context)}))})),this.collideAndRenderTextLabels(t,this.collision_group_text,i)]).then((function(r){var i=_slicedToArray(r,2)[1],n=i.labels,o=i.texts;return n&&o&&n.forEach((function(t){var r=t.text_settings_key,i=o[r]&&o[r][t.text],n=e.feature_style;n.label=t.label,n.linked=t.linked,n.size=i.size.logical_size,n.angle=0,t.label.text_data={text_info:i,text_settings_key:r,text:t.text},n.label_texture=e.textureManager.default,Style.addFeature.call(e,t.feature,t.draw,t.context)})),e.freeText(t),Style.endData.call(e,t)}))},_preprocess:function(t){t.color=StyleParser.createColorPropertyCache(t.color),t.texture=void 0!==t.texture?t.texture:this.texture,t.outline&&(t.outline.color=StyleParser.createColorPropertyCache(t.outline.color),t.outline.width=StyleParser.createPropertyCache(t.outline.width,StyleParser.parsePositiveNumber)),t.z=StyleParser.createPropertyCache(t.z,StyleParser.parseUnits);try{t.size=StyleParser.createPointSizePropertyCache(t.size)}catch(e){return log({level:"warn",once:!0},"Layer '".concat(t.layers[t.layers.length-1],"': ")+"".concat(e," (").concat(JSON.stringify(t.size),"), skipping features in layer")),null}return t.offset=StyleParser.createPropertyCache(t.offset,(function(t){return Array.isArray(t)&&t.map(StyleParser.parseNumber)})),t.buffer=StyleParser.createPropertyCache(t.buffer,(function(t){return(Array.isArray(t)?t:[t,t]).map(StyleParser.parsePositiveNumber)})),t.repeat_distance=StyleParser.createPropertyCache(t.repeat_distance,StyleParser.parseNumber),null==t.repeat_group&&(t.repeat_group=t.layers.join("-")),t.placement=PLACEMENT$1[t.placement&&t.placement.toUpperCase()],null==t.placement&&(t.placement=PLACEMENT$1.VERTEX),t.placement_spacing=null!=t.placement_spacing?t.placement_spacing:80,t.placement_spacing=StyleParser.createPropertyCache(t.placement_spacing,StyleParser.parsePositiveNumber),t.placement_min_length_ratio=null!=t.placement_min_length_ratio?t.placement_min_length_ratio:1,t.placement_min_length_ratio=StyleParser.createPropertyCache(t.placement_min_length_ratio,StyleParser.parsePositiveNumber),"number"==typeof t.angle?t.angle=t.angle*Math.PI/180:t.angle=t.angle||0,t.text=this.preprocessText(t.text),t.text&&(t.text.variantKey=t.variantKey,t.text.group=t.group,t.text.layers=t.layers,t.text.order=t.order,t.text.repeat_group=t.text.repeat_group||t.repeat_group,t.text.anchor=t.text.anchor||this.default_anchor,t.text.optional="boolean"==typeof t.text.optional&&t.text.optional,t.text.interactive=t.text.interactive||t.interactive),t.stick&&(t.stick.color=StyleParser.createColorPropertyCache(t.stick.color)),t},default_anchor:["bottom","top","right","left"],computeLayout:function(t,e,r,i,n){var o=t||{};o.id=e,o.units_per_pixel=n.units_per_pixel||1,o.collide=!1!==r.collide,o.anchor=r.anchor,o.offset=StyleParser.evalCachedProperty(r.offset,i)||StyleParser.zeroPair,o.buffer=StyleParser.evalCachedProperty(r.buffer,i)||StyleParser.zeroPair,o.repeat_distance=StyleParser.evalCachedProperty(r.repeat_distance,i),o.repeat_distance&&(o.repeat_distance*=o.units_per_pixel,o.repeat_scale=1,"function"==typeof r.repeat_group?o.repeat_group=r.repeat_group(i):o.repeat_group=r.repeat_group);var a=r.priority;return null!=a?"function"==typeof a&&(a=a(i)):a=-1>>>0,o.priority=a,o},buildTextLabels:function(t,e){for(var r=[],i=0;i<e.length;i++){var n=e[i],o=this.texts[t.id][n.text_settings_key][n.text].size.collision_size;n.label=new LabelPoint(n.point_label.position,o,n.point_label.isFlat(),n.layout),r.push(n)}return r},buildLabels:function(t,e,r){var i=!!r.flat,n=[];if("Point"===e.type)n.push(new LabelPoint(e.coordinates,t,i,r));else if("MultiPoint"===e.type)for(var o=e.coordinates,a=0;a<o.length;++a){var s=o[a];n.push(new LabelPoint(s,t,i,r))}else if("LineString"===e.type)for(var l=placePointsOnLine(e.coordinates,t,i,r),c=0;c<l.length;++c)n.push(l[c]);else if("MultiLineString"===e.type)for(var u=e.coordinates,h=0;h<u.length;h++)for(var p=placePointsOnLine(u[h],t,i,r),f=0;f<p.length;++f)n.push(p[f]);else if("Polygon"===e.type)if(r.placement===PLACEMENT$1.CENTROID){var d=Geo$1.centroid(e.coordinates);n.push(new LabelPoint(d,t,i,r))}else for(var y=e.coordinates,g=0;g<y.length;g++)for(var v=placePointsOnLine(y[g],t,i,r),m=0;m<v.length;++m)n.push(v[m]);else if("MultiPolygon"===e.type)if(r.placement===PLACEMENT$1.CENTROID){var _=Geo$1.multiCentroid(e.coordinates);n.push(new LabelPoint(_,t,i,r))}else for(var b=e.coordinates,w=0;w<b.length;w++)for(var x=b[w],E=0;E<x.length;E++)for(var T=placePointsOnLine(x[E],t,i,r),A=0;A<T.length;++A)n.push(T[A]);return n},makeVertexTemplate:function(t,e){var r,i=t.color||StyleParser.defaults.color,n=e.vertex_data.vertex_layout;return this.fillVertexTemplate(n,"a_position",0,{size:2}),this.fillVertexTemplate(n,"a_position",t.z||0,{size:1,offset:2}),this.fillVertexTemplate(n,"a_position",this.scaleOrder(t.order),{size:1,offset:3}),this.fillVertexTemplate(n,"a_shape",0,{size:4}),this.fillVertexTemplate(n,"a_shape",t.label.layout.collide?0:1,{size:1,offset:3}),this.fillVertexTemplate(n,"a_texcoord",0,{size:2}),this.fillVertexTemplate(n,"a_offset",0,{size:2}),this.fillVertexTemplate(n,"a_color",Vector$1.mult(i,255),{size:4}),this.defines.TANGRAM_HAS_SHADER_POINTS&&e.variant.shader_point&&(r=t.outline_color||StyleParser.defaults.outline.color,this.fillVertexTemplate(n,"a_outline_color",Vector$1.mult(r,255),{size:4}),this.fillVertexTemplate(n,"a_outline_edge",t.outline_edge_pct||StyleParser.defaults.outline.width,{size:1})),this.selection&&this.fillVertexTemplate(n,"a_selection_color",Vector$1.mult(t.selection_color,255),{size:4}),this.fillVertexTemplate(n,"a_is_flat",0,{size:1}),this.defines.TANGRAM_POINT_DRAW_STICK&&t.stick&&(this.fillVertexTemplate(n,"a_is_stick",0,{size:1}),this.fillVertexTemplate(n,"a_stick_height",t.stick.height,{size:1})),this.vertex_template},buildQuad:function(t,e,r,i,n,o,a,s,l,c,u,h,p,f,d,y,g,v,m){return e[0]<=0||e[1]<=0?0:buildQuadsForPoints(t,d,y,{quad:e,quad_normalize:256,offset:s,offsets:l,offsets_alt:c,pre_angles:o,pre_angles_alt:a,angle:4096*r,angles:i,angles_alt:n,is_flat:p,elevate_by_altitude:f,build_stick_points:g,stick_color:g&&Vector$1.mult(v,255),color:Vector$1.mult(m||StyleParser.defaults.color,255),curve:h,texcoord_scale:u,texcoord_normalize,pre_angles_normalize,angles_normalize,offsets_normalize})},build:function(t,e,r){var i=t.label;return"curved"===i.type?this.buildCurvedLabel(i,t,e,r):this.buildStraightLabel(i,t,e,r)},buildStraightLabel:function(t,e,r,i){var n,o=this.makeVertexTemplate(e,r),a=t.angle||e.angle,s="point"!==t.type?(n=e.size[t.type],default_uvs):(n=e.size,e.texcoords||default_uvs);r.uniforms=r.uniforms||{},e.label_texture?(r.uniforms.u_texture=e.label_texture,r.uniforms.u_point_type=TANGRAM_POINT_TYPE_LABEL,r.uniforms.u_apply_color_blocks=!1):(e.texture?(r.uniforms.u_texture=e.texture,r.uniforms.u_point_type=TANGRAM_POINT_TYPE_TEXTURE):(r.uniforms.u_texture=this.textureManager.default,r.uniforms.u_point_type=TANGRAM_POINT_TYPE_SHADER),r.uniforms.u_apply_color_blocks=!0);var l=t.offset,c=this.defines.TANGRAM_POINT_DRAW_STICK&&!e.label_texture&&e.stick&&0<e.stick.height,u=this.buildQuad([t.position],n,a,null,null,null,null,l,null,null,s,!1,t.isFlat(),e.elevate_by_altitude,r.vertex_data,o,c,c&&e.stick.color,e.color),h=e.linked&&e.linked.label.id;return this.trackLabel(t,h,r,u,i,c),u},buildCurvedLabel:function(t,e,r,i){for(var n=this.makeVertexTemplate(e,r),o=t.angle,a=0,s=0;s<2;s++)for(var l=0;l<t.num_segments;l++){var c=e.size[t.type][l],u=default_uvs,h=this.getTileMesh(i.tile,this.getMeshVariantTypeForDraw(e));h.uniforms=h.uniforms||{},h.uniforms.u_texture=e.label_texture,h.uniforms.u_point_type=TANGRAM_POINT_TYPE_LABEL,h.uniforms.u_apply_color_blocks=!1;var p=t.offset||[0,0],f=t.position,d=t.angles[l],y=t.offsets[l],g=t.pre_angles[l],v=t.num_segments-l-1,m=t.alt_angles[v],_=t.alt_pre_angles[v],b=t.alt_offsets[v],w=this.buildQuad([f],c,o,d,m,g,_,p,y,b,u,!0,t.isFlat(),e.elevate_by_altitude,h.vertex_data,n,!1,!1,e.color);a+=w;var x=e.linked&&e.linked.label.id;this.trackLabel(t,x,r,w,i,!1)}return a},trackLabel:function(t,e,r,i,n,o){var a=5<arguments.length&&void 0!==o&&o;r.labels=r.labels||{},r.labels.collision=r.labels.collision||{},r.labels["non-collision"]=r.labels["non-collision"]||{};var s=t.layout.collide?r.labels.collision:r.labels["non-collision"];s[t.id]=s[t.id]||{container:{label:t.text_data?Object.assign(t.toJSON(),{text_data:t.text_data}):t.toJSON(),linked:e},ranges:[]};var l=2*i,c=r.vertex_data.offset-r.vertex_data.stride*l;s[t.id].ranges.push([c,l,a])},buildLines:function(t,e,r,i){return this.build(e,r,i)},buildPoints:function(t,e,r,i){return this.build(e,r,i)},buildPolygons:function(t,e,r,i){return this.build(e,r,i)},vertexLayoutForMeshVariant:function(t){var e;return this.vertex_layout||(e=[{name:"a_position",size:4,type:gl$1.SHORT,normalized:!1},{name:"a_shape",size:4,type:gl$1.SHORT,normalized:!1},{name:"a_texcoord",size:2,type:gl$1.UNSIGNED_SHORT,normalized:!0},{name:"a_offset",size:2,type:gl$1.SHORT,normalized:!1},{name:"a_color",size:4,type:gl$1.UNSIGNED_BYTE,normalized:!0},{name:"a_outline_color",size:4,type:gl$1.UNSIGNED_BYTE,normalized:!0,static:[0,0,0,0]},{name:"a_outline_edge",size:1,type:gl$1.FLOAT,normalized:!1,static:0},{name:"a_selection_color",size:4,type:gl$1.UNSIGNED_BYTE,normalized:!0},{name:"a_is_flat",size:1,type:gl$1.UNSIGNED_BYTE,normalized:!0}],this.defines&&this.defines.TANGRAM_POINT_DRAW_STICK&&e.push({name:"a_is_stick",size:1,type:gl$1.UNSIGNED_BYTE,normalized:!0},{name:"a_stick_height",size:1,type:gl$1.FLOAT,normalized:!1}),this.vertex_layout=new VertexLayout(e),(e=e.map((function(t){return Object.assign({},t)}))).forEach((function(t){"a_outline_color"!==t.name&&"a_outline_edge"!==t.name||(t.static=null)})),this.vertex_layout_shader_point=new VertexLayout(e)),t.shader_point?this.vertex_layout_shader_point:this.vertex_layout},computeVariantForDraw:function(t){var e=t.label_texture||t.texture||this.default_mesh_variant.key;return{key:e,shader_point:e===this.default_mesh_variant.key,order:t.label_texture?1:0}},makeMesh:function(t,e,r){var i=2<arguments.length&&void 0!==r?r:{};return i=Object.assign({},i,{fade_in_time:this.fade_in_time}),Style.makeMesh.call(this,t,e,i)}});var STOPS=[0,.33,.66,.99],LINE_EXCEED_STRAIGHT=1.5,LINE_EXCEED_STRAIGHT_NO_CURVE=1.8,LINE_EXCEED_STAIGHT_LOOSE=2.3,STRAIGHT_ANGLE_TOLERANCE=.1,CURVE_MIN_TOTAL_COST=1.3,CURVE_MIN_AVG_COST=.4,CURVE_MAX_ANGLE=1,ORIENTED_LABEL_OFFSET_FACTOR=1.2,VERTICAL_ANGLE_TOLERANCE=.01,LabelLine={create:function(t,e,r,i,n){for(var o=[{type:"straight",tolerance:n.no_curving?LINE_EXCEED_STRAIGHT_NO_CURVE:LINE_EXCEED_STRAIGHT},{type:"curved"},{type:"straight",tolerance:LINE_EXCEED_STAIGHT_LOOSE}],a=0;a<o.length;a++){var s=o[a],l=void 0;if("straight"===s.type?l=new LabelLineStraight(e,r,i,n,s.tolerance):"curved"===s.type&&!n.no_curving&&2<r.length&&(l=new LabelLineCurved(t,r,i,n)),l&&!l.throw_away)return l}return!1}},LabelLineBase=function(){function t(e,r){_classCallCheck(this,t),this.id=Label.nextLabelId(),this.layout=r,this.position=[],this.angle=0,this.offset=r.offset.slice(),this.unit_scale=this.layout.units_per_pixel,this.type="",this.throw_away=!1,this._is_flat=e,this._circles=void 0,this.placed=null}return _createClass(t,[{key:"toJSON",value:function(){return{id:this.id,type:this.type,is_flat:this._is_flat,position:this.position,size:this.size,offset:this.offset,angle:this.angle,breach:this.breach,layout:textLayoutToJSON(this.layout),circles:this.getBoundingCircles()}}},{key:"inTileBounds",value:function(){var t=this.getAABB(),e=t.left,r=t.top,i=t.right,n=t.bottom;return Utils$1.pointInTile([e,r])&&Utils$1.pointInTile([i,n])}},{key:"getAABBForSegment",value:function(t,e,r,i){var n,o=this.unit_scale,a=e/2,s=r/2,l=_slicedToArray(t,2),c=l[0],u=l[1];0===this.offset[0]&&0===this.offset[1]||(c+=(n=Vector$1.rot(this.offset,this.angle))[0]*o,u-=n[1]*o);var h=[[Math.cos(i),-Math.sin(i)],[Math.sin(i),Math.cos(i)]],p=Vector$1.multMatrix(h,[-a,-s]),f=Vector$1.multMatrix(h,[a,-s]),d=Vector$1.multMatrix(h,[a,s]),y=Vector$1.multMatrix(h,[-a,s]);return{left:c+Math.min(p[0],f[0],d[0],y[0]),top:u+Math.max(p[1],f[1],d[1],y[1]),right:c+Math.max(p[0],f[0],d[0],y[0]),bottom:u+Math.min(p[1],f[1],d[1],y[1])}}},{key:"isFlat",value:function(){return this._is_flat}},{key:"getBoundingCircles",value:function(){}},{key:"getAABB",value:function(){}}],[{key:"splitLineByOrientation",value:function(t){for(var e=[t[0]],r=0,i=0,n=0,o=e,a=!1,s=1;s<t.length;s++){var l=t[s],c=t[s-1],u=Vector$1.length(Vector$1.sub(l,c));l[0]>c[0]?1===n?(e.push(l),i<(r+=u)&&(o=e,i=r,a=!1)):(e=[c,l],i<(r=u)&&(o=e,i=r,a=!1),n=1):l[0]<c[0]?-1===n?(e.unshift(l),i<(r+=u)&&(o=e,i=r,a=!0)):(e=[l,c],i<(r=u)&&(o=e,i=r,a=!0),n=-1):(-1===n?e.unshift(l):(e.push(l),n=1),i<(r+=u)&&(o=e,i=r,a=-1===n))}return[o,a]}}]),t}(),LabelLineStraight=function(){_inherits(e,LabelLineBase);var t=_createSuper(e);function e(r,i,n,o,a){var s;return _classCallCheck(this,e),(s=t.call(this,n,o)).type="straight",s.size=r,s.throw_away=!s.fit(r,i,o,a),s}return _createClass(e,[{key:"fit",value:function(t,e,r,i){var n,o=this.unit_scale,a=_slicedToArray(LabelLineBase.splitLineByOrientation(e),2);e=a[0],n=a[1],"number"==typeof r.orientation&&(this.offset[1]+=ORIENTED_LABEL_OFFSET_FACTOR*(t[1]-r.vertical_buffer),n&&(this.offset[1]*=-1),-1===r.orientation&&(this.offset[1]*=-1));for(var s=getLineLengths(e),l=t[0]*o,c=0;c<e.length-1;c++)for(var u=e[c],h=0,p=0,f=c+1,d=void 0;f<e.length;){var y=e[f-1],g=e[f],v=getAngleForSegment(y,g);if(f!==c+1&&(h+=getAbsAngleDiff(v,d)),Math.abs(h)>STRAIGHT_ANGLE_TOLERANCE)break;if(calcFitness(p+=s[f-1],l)<i){var m=Vector$1.mult(Vector$1.add(u,g),.5);return this.angle=-v,Math.abs(this.angle-Math.PI/2)<VERTICAL_ANGLE_TOLERANCE&&(this.angle=-Math.PI/2,"number"==typeof r.orientation&&(this.offset[1]*=-1)),this.position=m,this.breach=!this.inTileBounds(),!0}d=v,f++}return!1}},{key:"getBoundingCircles",value:function(){var t,e,r,i,n,o,a,s,l,c,u,h,p,f;return this._circles||(t=this.unit_scale,n=-(r=(e=this.size[0]/2*t)*Math.cos(this.angle)),o=-(i=e*Math.sin(this.angle)),a=this.offset[0]*t,s=this.offset[1]*t,c=(l=_slicedToArray(this.position,2))[0],u=l[1],u*=-1,a&&(h=[r,i],Vector$1.normalize(h),h[0]*=a,h[1]*=a,c+=h[0],u+=h[1]),s&&(p=[i,-r],Vector$1.normalize(p),p[0]*=s,p[1]*=s,c-=p[0],u-=p[1]),r+=c,i+=u,n+=c,o+=u,f=this.size[1]/2*t,this._circles=encircleLine(r,i,n,o,f)),this._circles}},{key:"getAABB",value:function(){var t,e,r,i,n;return this._aabb||(t=this.unit_scale,e=this.size,r=this.layout.buffer,i=(e[0]+2*r[0])*t,n=(e[1]+2*r[1])*t,this._aabb=this.getAABBForSegment(this.position,i,n,this.angle)),this._aabb}}]),e}(),LabelLineCurved=function(){_inherits(e,LabelLineBase);var t=_createSuper(e);function e(r,i,n,o){var a;return _classCallCheck(this,e),(a=t.call(this,n,o)).type="curved",a.positions=[],a.angles=[],a._aabbs=[],a.pre_angles=[],a.offsets=[],a.num_segments=r.length,a.sizes=r,a.alt_angles=[],a.alt_pre_angles=[],a.alt_offsets=[],a.throw_away=!a.fit(a.sizes,i,o),a}return _createClass(e,[{key:"toJSON",value:function(){return{id:this.id,type:this.type,is_flat:this._is_flat,position:this.position,breach:this.breach,layout:textLayoutToJSON(this.layout),circles:this.getBoundingCircles()}}},{key:"fit",value:function(t,r,i){var n,o=this.unit_scale,a=Math.max.apply(Math,_toConsumableArray(t.map((function(t){return t[1]})))),s=a*o,l=_slicedToArray(LabelLineBase.splitLineByOrientation(r),2);r=l[0],n=l[1],"number"==typeof i.orientation&&(this.offset[1]+=ORIENTED_LABEL_OFFSET_FACTOR*(a-i.vertical_buffer),n&&(this.offset[1]*=-1),-1===i.orientation&&(this.offset[1]*=-1));var c=getLineLengths(r),u=t.map((function(t){return t[0]*o})),h=c.reduce((function(t,e){return t+e}),0),p=u.reduce((function(t,e){return t+e}),0);if(h<p)return!1;var f=r.length-1;if(f<2)return!1;var d=e.curvaturePlacement(r,h,c,p,0,f),y=r[d];if(-1===d||f-d<2)return!1;this.position=y;for(var g=0;g<u.length;g++){this.positions[g]=[],this.offsets[g]=[],this.angles[g]=[],this.pre_angles[g]=[];for(var v=0;v<STOPS.length;v++){var m=STOPS[v],_=_slicedToArray(e.scaleLine(m,r),2),b=_[0],w=_[1],x=(y=b[d],e.placeAtIndex(d,b,w,u)),E=x.positions,T=x.offsets,A=x.angles,S=x.pre_angles,k=T.map((function(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])/o}));if(0===m){this.angle=1/A.length*A.reduce((function(t,e){return t+e}));for(var O=0;O<E.length;O++){var L=E[O],P=S[O],R=u[O],I=P+A[O];this._aabbs.push(this.getAABBForSegment(L,R,s,I))}}this.positions[g].push(E[g]),this.offsets[g].push(k[g]),this.angles[g].push(A[g]),this.pre_angles[g].push(S[g])}}u=t.slice().reverse().map((function(t){return t[0]*o}));for(var C=0;C<u.length;C++){this.alt_offsets[C]=[],this.alt_angles[C]=[],this.alt_pre_angles[C]=[];for(var M=0;M<STOPS.length;M++){var N=STOPS[M],j=_slicedToArray(e.scaleLine(N,r),2),D=j[0],B=j[1];y=D[d];var z=e.placeAtIndex(d,D,B,u),F=z.offsets,U=z.angles,G=z.pre_angles,H=F.map((function(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])/o}));0===N&&(this.alt_angle=1/U.length*U.reduce((function(t,e){return t+e}))),this.alt_offsets[C].push(H[C]),this.alt_angles[C].push(U[C]),this.alt_pre_angles[C].push(G[C])}}return!0}},{key:"getBoundingCircles",value:function(){if(!this._circles){for(var t=[],e=this.unit_scale,r=0;r<this.positions.length;r++){var i=this.sizes[r],n=this.angles[r][0],o=this.positions[r][0],a=i[0]/2*e,s=a*Math.cos(n),l=a*Math.sin(n),c=-s,u=-l,h=_slicedToArray(o,2),p=h[0],f=h[1],d=encircleLine(s+=p,l+=f*=-1,c+=p,u+=f,i[1]/2*e);Array.prototype.push.apply(t,d)}this._circles=t}return this._circles}},{key:"getAABB",value:function(){if(!this._aabb){for(var t=1/0,e=-1/0,r=-1/0,i=1/0,n=0;n<this._aabbs.length;n++){var o=this._aabbs[n];t=Math.min(t,o.left),e=Math.max(e,o.top),r=Math.max(r,o.right),i=Math.min(i,o.bottom)}this._aabb={left:t,top:e,right:r,bottom:i}}return this._aabb}}],[{key:"curvaturePlacement",value:function(t,e,r,i,n,o){n=n||0,o=o||t.length-1;for(var a=[],s=n+1;s<o;s++){var l=t[s-1],c=t[s],u=t[s+1],h=Vector$1.perp(c,l),p=Vector$1.perp(u,c),f=Vector$1.angleBetween(h,p);CURVE_MAX_ANGLE<f&&(f=1/0),a.push(f)}a.push(1/0);for(var d=[],y=[],g=n,v=0,m=0;m<n;m++)v+=r[m];for(;v+i<e;){for(var _=v+i,b=v,w=g,x=0;w<o&&b+r[w]<_&&(x+=a[w])!==1/0;)b+=r[w],w++;if(0===x)return g;var E=x/(w-g);d.push(x),y.push(E),v+=r[g],g++}if(0===d.length)return-1;var T=Math.min.apply(null,d),A=y[d.indexOf(T)];return T<CURVE_MIN_TOTAL_COST&&A<CURVE_MIN_AVG_COST?d.indexOf(T):-1}},{key:"scaleLine",value:function(t,e){var r=[e[0]],i=[];return e.forEach((function(n,o){var a,s;o!==e.length-1&&(a=Vector$1.sub(e[o+1],e[o]),s=Vector$1.mult(a,1+t),r.push(Vector$1.add(r[o],s)),i.push(Vector$1.length(s)))})),[r,i]}},{key:"placeAtIndex",value:function(t,r,i,n){var o=r[t],a=_slicedToArray(e.getIndicesAndOffsets(t,i,n),2),s=a[0],l=a[1],c=e.getPositionsFromIndicesAndOffsets(r,s,l),u=_slicedToArray(e.getAnglesFromIndicesAndOffsets(o,s,r,c),3);return{positions:c,offsets:u[0],angles:u[1],pre_angles:u[2]}}},{key:"getIndicesAndOffsets",value:function(t,e,r){for(var i=r.length,n=[],o=[],a=0,s=0,l=0;a<i;){for(var c=r[a];a<i&&s+.5*c<=l+e[t];){var u=s-l+.5*c;o.push(u),n.push(t),s+=c,c=r[++a]}l+=e[t],t++}return[n,o]}},{key:"getPositionsFromIndicesAndOffsets",value:function(t,e,r){for(var i=[],n=0;n<e.length;n++){var o=e[n],a=r[n],s=getAngleForSegment(t[o],t[o+1]),l=Vector$1.rot([a,0],s),c=Vector$1.add(t[o],l);i.push(c)}return i}},{key:"getAnglesFromIndicesAndOffsets",value:function(t,e,r,i){for(var n=[],o=[],a=[],s=0;s<i.length;s++){var l,c,u=i[s],h=e[s],p=Vector$1.sub(u,t),f=-Vector$1.angle(p),d=getTextAngleForSegment(r[h],r[h+1])-f;0<s&&(l=n[s-1],c=o[s-1],Math.abs(f-l)>Math.PI&&(f+=l<f?-2*Math.PI:2*Math.PI),Math.abs(c-d)>Math.PI&&(d+=c<d?-2*Math.PI:2*Math.PI)),n.push(f),o.push(d),a.push(p)}return[a,n,o]}}]),e}();function calcFitness(t,e){return e/t}function getAngleForSegment(t,e){var r=Vector$1.sub(e,t);return Vector$1.angle(r)}function getTextAngleForSegment(t,e){return-getAngleForSegment(t,e)}function getLineLengths(t){for(var e=[],r=0;r<t.length-1;r++){var i=t[r],n=t[r+1],o=Math.hypot(i[0]-n[0],i[1]-n[1]);e.push(o)}return e}function getAbsAngleDiff(t,e){for(var r,i=e<t?(r=e,t):(r=t,e);i-r>Math.PI;)r+=2*Math.PI;return Math.abs(i-r)}var TextStyle=Object.create(Points);Object.assign(TextStyle,{name:"text",super:Points,built_in:!0,init:function(t){var e=0<arguments.length&&void 0!==t?t:{};Style.init.call(this,e),this.setupDefines(),this.defines.TANGRAM_HAS_SHADER_POINTS=!1,this.defines.TANGRAM_IS_TEXT_STYLE=!0,this.reset()},makeVertexTemplate:function(t,e){this.super.makeVertexTemplate.apply(this,arguments);var r=e.vertex_data.vertex_layout;return this.fillVertexTemplate(r,"a_pre_angles",0,{size:4}),this.fillVertexTemplate(r,"a_offsets",0,{size:4}),this.fillVertexTemplate(r,"a_angles",0,{size:4}),this.fillVertexTemplate(r,"a_offsets_alt",0,{size:4}),this.fillVertexTemplate(r,"a_pre_angles_alt",0,{size:4}),this.fillVertexTemplate(r,"a_angles_alt",0,{size:4}),this.vertex_template},reset:function(){this.queues={},this.resetText()},addFeature:function(t,e,r){var i=this,n=r.tile,o=t.geometry.type;e.can_articulate="LineString"===o||"MultiLineString"===o,e.supersample_text="LineString"===o||"MultiLineString"===o;var a=this.parseTextFeature(t,e,r,n);a&&(a instanceof Array?a.forEach((function(e){e.feature=t,e.context=r,e.layout.vertex=!1,i.queueFeature(e,n)})):(a.feature=t,a.context=r,a.layout.vertex=!1,this.queueFeature(a,n)),Collision.addStyle(this.name,n.id))},endData:function(t){var e=this,r=this.queues[t.id];return delete this.queues[t.id],this.collideAndRenderTextLabels(t,this.name,r).then((function(r){var i=r.labels,n=r.texts;return i&&n&&(e.texts[t.id]=n,i.forEach((function(r){var i=r.text_settings_key,n=e.texts[t.id][i]&&e.texts[t.id][i][r.text],o=e.feature_style;o.label=r.label,r.label.text_data={text_info:n,text_settings_key:i,text:r.text},o.label_texture=e.textureManager.default,n.text_settings.can_articulate?(o.size={},"straight"===r.label.type?o.size.straight=n.size.logical_size:o.size.curved=n.segment_sizes.map((function(t){return t.logical_size}))):o.size=n.size.logical_size,Style.addFeature.call(e,r.feature,r.draw,r.context)}))),e.freeText(t),Style.endData.call(e,t).then((function(r){if(r){for(var i in r.meshes)r.meshes[i].uniforms.u_apply_color_blocks=!0;t.mesh_data[e.name]=r}return r}))}))},_preprocess:function(t){return this.preprocessText(t)},buildTextLabels:function(t,e){for(var r=[],i=0;i<e.length;i++){var n,o,a=e[i],s=this.texts[t.id][a.text_settings_key][a.text];a.layout.vertical_buffer=s.vertical_buffer,o=s.text_settings.can_articulate?(n=s.segment_sizes.map((function(t){return t.collision_size})),a.layout.no_curving=s.no_curving,this.buildLabels(n,a.feature.geometry,a.layout,s.size.collision_size)):this.buildLabels(s.size.collision_size,a.feature.geometry,a.layout);for(var l=0;l<o.length;l++){var c=Object.create(a);c.label=o[l],r.push(c)}}return r},buildLabels:function(t,e,r,i){var n,o,a="Point"!==e.type,s=[];if("LineString"===e.type)Array.prototype.push.apply(s,this.buildLineLabels(e.coordinates,t,a,r,i));else if("MultiLineString"===e.type)for(var l=e.coordinates,c=0;c<l.length;++c)Array.prototype.push.apply(s,this.buildLineLabels(l[c],t,a,r,i));else if("Point"===e.type)s.push(new LabelPoint(e.coordinates,t,a,r));else if("MultiPoint"===e.type)for(var u=e.coordinates,h=0;h<u.length;++h)s.push(new LabelPoint(u[h],t,a,r));else"Polygon"===e.type?(n=Geo$1.centroid(e.coordinates),s.push(new LabelPoint(n,t,a,r))):"MultiPolygon"===e.type&&(o=Geo$1.multiCentroid(e.coordinates),s.push(new LabelPoint(o,t,a,r)));return s},buildLineLabels:function(t,e,r,i,n){var o,a=[],s=Math.min(i.subdiv,t.length-1);if(1<s)for(var l=(t.length-1)/s,c=0;c<s;c++){var u=Math.floor(c*l),h=Math.floor((c+1)*l)+1,p=t.slice(u,h),f=LabelLine.create(e,n,p,r,i);f&&a.push(f)}return a.length<s&&(o=LabelLine.create(e,n,t,r,i))&&a.push(o),a},vertexLayoutForMeshVariant:function(){var t;return this.vertex_layout||(t=[{name:"a_position",size:4,type:gl$1.SHORT,normalized:!1},{name:"a_shape",size:4,type:gl$1.SHORT,normalized:!1},{name:"a_texcoord",size:2,type:gl$1.UNSIGNED_SHORT,normalized:!0},{name:"a_offset",size:2,type:gl$1.SHORT,normalized:!1},{name:"a_color",size:4,type:gl$1.UNSIGNED_BYTE,normalized:!0},{name:"a_angles",size:4,type:gl$1.SHORT,normalized:!1},{name:"a_offsets",size:4,type:gl$1.UNSIGNED_SHORT,normalized:!1},{name:"a_pre_angles",size:4,type:gl$1.BYTE,normalized:!1},{name:"a_selection_color",size:4,type:gl$1.UNSIGNED_BYTE,normalized:!0},{name:"a_is_flat",size:1,type:gl$1.UNSIGNED_BYTE,normalized:!0},{name:"a_offsets_alt",size:4,type:gl$1.UNSIGNED_SHORT,normalized:!1},{name:"a_pre_angles_alt",size:4,type:gl$1.BYTE,normalized:!1},{name:"a_angles_alt",size:4,type:gl$1.SHORT,normalized:!1}],this.vertex_layout=new VertexLayout(t)),this.vertex_layout},getMeshVariantTypeForDraw:Points.getMeshVariantTypeForDraw}),TextStyle.texture_id=0;var RasterStyle=Object.create(Polygons);Object.assign(RasterStyle,{name:"raster",super:Polygons,built_in:!0,init:function(){this.raster=this.raster||"color",this.super.init.apply(this,arguments),this.selection=!1,this.defines.SNAP_TO_PIXEL_GRID=!0},_preprocess:function(t){return t.color=t.color||StyleParser.defaults.color,this.super._preprocess.apply(this,arguments)}});var CustomIcons=Object.create(Points);Object.assign(CustomIcons,{name:"custom_icons",collision:!1,init:function(t){var e=0<arguments.length&&void 0!==t?t:{};Points.init.call(this,e)},loadTexture:function(t,e,r){var i,n=t.width,o=t.height,a=t.items,s=document.createElement("canvas"),l=Utils$1.device_pixel_ratio,c=this.sources[e],u={sprites:{}};if(s.width=n*l,s.height=o*l,c){var h,p=a.length,f=s.getContext("2d");for(f.scale(l,l);h=a[--p];){var d,y=c.getIconBitmapByObjectId(h.meta.objectId,h.meta.id);y&&((d=isTainting(y))?log("error",d):(f.drawImage(y,h.x,h.y,h.width,h.height),u.sprites[h.meta.id]=[h.x,h.y,h.width,h.height]))}}return u.element=s,(i=this.textureManager.create(this.gl,r,u)).retain(),i.loading.then((function(t){return t.name}))},buildRasterTextures:function(t,e){return WorkerBroker.postMessage(this.main_thread_target+".loadTexture",t.rasters,t.source,t.texture_name).then((function(t){return e.textures.push(t),e}))},addFeature:function(t,e,r){var i=r.tile.rasters,n={};i.items.forEach((function(t){n[t.meta.id]=[t.x,t.y,t.width,t.height]}));var o="".concat(r.tile.source,"_dyn_").concat(r.tile.coords.key,"_").concat(this.generation,"_").concat(r.tile.id);e.texture=r.tile.texture_name=o;var a=Object.assign({},DEFAULT_TEXTURE_INFO,{name:o,width:i.width,height:i.height,sprites:n,manager:this.textureManager});Texture.prototype.calculateSprites.apply(a),this.textureManager.textures[o]=a,Points.addFeature.apply(this,arguments),delete this.textureManager.textures[o]}});var DEFAULT_TEXTURE_INFO={filtering:"linear",density:1,valid:!0,power_of_2:!1,texcoords:{},sizes:{},css_sizes:{},aspects:{}},OverlayStyle=Object.create(Polygons);Object.assign(OverlayStyle,{name:"overlays",super:Polygons,init:function(t){var e=0<arguments.length&&void 0!==t?t:{};this.selection=e.selection||!0,this.raster=this.raster||"color",this.super.init.apply(this,arguments)},setupRasters:function(){if(!Thread.is_main)return!1;if(this.super.setupRasters.call(this))return!0;var t=!1;for(var e in this.sources)if(this.sources[e]instanceof ObjectSource){t=!0;break}return!!t&&(this.defines.TANGRAM_MODEL_POSITION_BASE_ZOOM_VARYING=!0,this.replaceShaderBlock("raster",shaderSrc_rasters,"Raster"),!0)},loadTextures:function(t,e){var r,i,n,o=this.sources[e],a=t.name;if(t.overlays_config.forEach((function(e){var a,s=e.texcoords,l=e.id,c=o.getMapObjectById(l),u=c.getBitmap();u&&((a=isTainting(u=bitmapToCanvas(u,u.width,u.height)))?log("error",a):(r||((r=document.createElement("canvas")).width=t.width,r.height=t.height,i=r.getContext("2d")),i.save(),i.globalAlpha=c.getOpacity(),s.forEach((function(t){return i.drawImage(u,t[0],t[1],t[2],t[3])})),i.restore(),n=!0))})),n){t.element=r;var s={};return s[a]=t,this.super.loadTextures.call(this,s)}var l=this.textureManager.textures[this.textureManager.default];return Promise.resolve([{name:l.name,width:l.width,height:l.height,loaded:l.loaded}])},buildRasterTextures:function(t,e){var r=this.sources[t.source].tileTexture(t);return r?WorkerBroker.postMessage(this.main_thread_target+".loadTextures",r,t.source).then((function(t){if(!t||t.length<1)return e;if(t.some((function(t){return!t.loaded})))return null;var r=t[0].name;return e.uniforms=e.uniforms||{},e.textures=e.textures||[],e.uniforms.u_raster=r,e.uniforms.u_raster_offset=[0,0,1],e.textures.push(r),e})):Promise.resolve(e)}});var shaderSrc_Vertex="uniform float u_horizon;uniform float u_tilt;uniform float u_zoom;attribute vec2 a_position;attribute float a_is_sky;attribute float a_is_top;attribute vec4 a_color;varying vec4 v_color;const float SIN_THRESHOLD_ANGLE=0.96126069082;void main(){v_color=a_color;float sin_tilt=sin(u_tilt);float sky_bottom_alpha=1.-max(sin_tilt-SIN_THRESHOLD_ANGLE,0.)*3.;if((a_position.y==1.&&a_is_sky==0.)||(a_position.y==0.&&a_is_sky==1.)){v_color.w=sky_bottom_alpha;}float fog_height=max((22.-u_zoom)*0.04,0.)*(sin_tilt-.7);float position_z=u_zoom<17. ? .942 : .9418;gl_Position=vec4(a_position.x,a_is_sky*(a_position.y+a_is_top)+1.0-u_horizon-(1.0-a_is_sky)*(1.0-a_position.y)*fog_height,position_z,1.0);}",shaderSrc_Fragment="varying vec4 v_color;void main(void){gl_FragColor=v_color;}",STYLE_NAME="skybox",SkyBox=Object.create(Style),positions=[-1,0,1,0,-1,1,-1,1,1,0,1,1,-1,0,1,0,-1,1,-1,1,1,0,1,1];Object.assign(SkyBox,{name:STYLE_NAME,built_in:!0,vertex_shader_src:shaderSrc_Vertex,fragment_shader_src:shaderSrc_Fragment,selection:!1,blend:"inlay",blend_order:1,init:function(){Style.init.apply(this,arguments),this.selection=!1},_preprocess:function(t){return t.color={top:StyleParser.createColorPropertyCache(t.color.zenith),bottom:StyleParser.createColorPropertyCache(t.color.horizon),fog:StyleParser.createColorPropertyCache(t.color.fog)},t},vertexLayoutForMeshVariant:function(){var t;return this.vertex_layout||(t=[{name:"a_position",size:2,type:gl$1.FLOAT,normalized:!1},{name:"a_is_sky",size:1,type:gl$1.FLOAT,normalized:!0},{name:"a_color",size:4,type:gl$1.UNSIGNED_BYTE,normalized:!0},{name:"a_is_top",size:1,type:gl$1.FLOAT,normalized:!0}],this.vertex_layout=new VertexLayout(t)),this.vertex_layout},makeVertexTemplate:function(){var t=0;return this.vertex_template[t++]=0,this.vertex_template[1]=0,this.vertex_template},parseFeature:function(t,e,r){var i=this.feature_style;return e.color&&e.color.top&&e.color.bottom&&(i.color_top=this.parseColor(e.color.top,r),i.color_bottom=this.parseColor(e.color.bottom,r),i.color_fog=this.parseColor(e.color.fog||"white",r),Array.isArray(i.color_fog)&&(i.color_fog=i.color_fog.slice(),i.color_fog[3]=0)),i},buildGeometry:function(t,e,r){for(var i=this.makeVertexTemplate(e),n=r.vertex_data,o=r.vertex_data.vertex_layout,a=n.vertex_layout.index.a_position,s={top:e.color_top,bottom:e.color_bottom},l={top:e.color_bottom,bottom:e.color_fog},c=0,u=positions.length-1;c<u;c+=2){i[a+0]=positions[c],i[a+1]=positions[c+1];var h=c<12,p=0<positions[c+1],f=h?s:l;this.fillVertexTemplate(o,"a_is_sky",h?1:0,{size:1}),this.fillVertexTemplate(o,"a_is_top",p?1:0,{size:1}),this.fillVertexTemplate(o,"a_color",Vector$1.mult(p?f.top:f.bottom,255),{size:4}),n.addVertex(i)}return 4}});var shaderSrc_accessors="#ifdef TANGRAM_VERTEX_SHADER\nvec4 modelPosition(){return vec4(a_position.xyz/TANGRAM_TILE_SCALE*exp2(u_tile_origin.z-u_tile_origin.w),1.)+vec4(0.,1.,0.,0.);}vec4 modelPositionBaseZoom(){return vec4(a_position.xyz/TANGRAM_TILE_SCALE,1.)+vec4(0.,1.,0.,0.);}\n#endif\nvec4 worldPosition(){return v_world_position;}\n#ifdef TANGRAM_VERTEX_SHADER\nvec4 wrapWorldPosition(vec4 world_position){\n#if defined(TANGRAM_WORLD_POSITION_WRAP)\nvec2 anchor=u_tile_origin.xy-mod(u_tile_origin.xy,TANGRAM_WORLD_POSITION_WRAP);world_position.xy-=anchor;\n#endif\nreturn world_position;}\n#endif\n#if defined(TANGRAM_VERTEX_SHADER)\nvec3 worldNormal(){return TANGRAM_NORMAL;}\n#elif defined(TANGRAM_FRAGMENT_SHADER)\nvec3 worldNormal(){return u_inverseNormalMatrix*TANGRAM_NORMAL;}\n#endif\n",shaderSrc_layerOrder="void applyLayerOrder(float layer,inout vec4 position){position.z-=layer*TANGRAM_LAYER_DELTA*position.w;}",shaderSrc_selectionGlobals="\n#if defined(TANGRAM_FEATURE_SELECTION) && defined(TANGRAM_VERTEX_SHADER)\nattribute vec4 a_selection_color;varying vec4 v_selection_color;uniform vec4 u_selection_discard0;uniform vec4 u_selection_discard1;uniform vec4 u_selection_discard2;uniform vec4 u_selection_discard3;uniform vec4 u_selection_discard4;uniform vec4 u_selection_discard5;uniform vec4 u_selection_discard6;uniform vec4 u_selection_discard7;uniform vec4 u_selection_discard8;uniform vec4 u_selection_discard9;\n#endif\n",shaderSrc_selectionVertex="\n#if defined(TANGRAM_FEATURE_SELECTION) && defined(TANGRAM_VERTEX_SHADER)\nif(a_selection_color.rgb==vec3(0.)||a_selection_color==u_selection_discard0||a_selection_color==u_selection_discard1||a_selection_color==u_selection_discard2||a_selection_color==u_selection_discard3||a_selection_color==u_selection_discard4||a_selection_color==u_selection_discard5||a_selection_color==u_selection_discard6||a_selection_color==u_selection_discard7||a_selection_color==u_selection_discard8||a_selection_color==u_selection_discard9){gl_Position=vec4(0.,0.,0.,1.);return;}v_selection_color=a_selection_color;\n#endif\n",shaderSrc_utils="#ifndef UTILS\n#define UTILS\nbool isLocalSpacePixelOutsideTile(vec4 pixel_local_space_position,float tile_scale){return pixel_local_space_position.x<0.||pixel_local_space_position.x>=tile_scale||pixel_local_space_position.y>0.||pixel_local_space_position.y<=-tile_scale;}\n#endif\n",shaderSrc_snapToPixelGrid="uniform float u_view_pan_snap_timer;void snapToPixelGrid(inout vec4 position){vec2 position_fract=fract((((position.xy/position.w)+1.)*.5)*u_resolution);vec2 position_snap=position.xy+((step(0.5,position_fract)-position_fract)*position.w*2./u_resolution);\n#ifdef TANGRAM_VIEW_PAN_SNAP_RATE\nposition.xy=mix(position.xy,position_snap,clamp(u_view_pan_snap_timer*TANGRAM_VIEW_PAN_SNAP_RATE,0.,1.));\n#else\nposition.xy=position_snap;\n#endif\n}",StyleManager=function(){function t(){_classCallCheck(this,t),this.styles={},this.base_styles={},this.register(Object.create(Polygons)),this.register(Object.create(Lines)),this.register(Object.create(PatternLines)),this.register(Object.create(Points)),this.register(Object.create(TextStyle)),this.register(Object.create(RasterStyle)),this.register(Object.create(CustomIcons)),this.register(Object.create(OverlayStyle)),this.register(Object.create(SkyBox))}return _createClass(t,[{key:"init",value:function(){ShaderProgram.removeBlock("global"),ShaderProgram.removeBlock("setup"),ShaderProgram.addBlock("global",shaderSrc_accessors),ShaderProgram.addBlock("global",shaderSrc_layerOrder),ShaderProgram.addBlock("global",shaderSrc_selectionGlobals),ShaderProgram.addBlock("global",shaderSrc_snapToPixelGrid),ShaderProgram.replaceBlock("utils",shaderSrc_utils),ShaderProgram.replaceBlock("setup",shaderSrc_selectionVertex),ShaderProgram.defines.TANGRAM_EPSILON=1e-5,ShaderProgram.defines.TANGRAM_LAYER_DELTA=1/16384,ShaderProgram.defines.TANGRAM_TILE_SCALE="vec3(".concat(Geo$1.tile_scale,"., ").concat(Geo$1.tile_scale,"., u_meters_per_pixel * ").concat(Geo$1.tile_size,".)"),ShaderProgram.defines.TANGRAM_HEIGHT_SCALE=Geo$1.height_scale,ShaderProgram.defines.TANGRAM_ALPHA_TEST=.1,Lines.dash_textures={}}},{key:"destroy",value:function(t){var e=this;Object.keys(this.styles).forEach((function(r){var i=e.styles[r];i.gl===t&&(log("trace","StyleManager.destroy: destroying render style ".concat(i.name)),i.base&&e.remove(i.name),i.destroy())}))}},{key:"register",value:function(t){this.styles[t.name]=t,this.base_styles[t.name]=t}},{key:"remove",value:function(t){delete this.styles[t]}},{key:"mix",value:function(t,e){if(t.mixed)return t;t.mixed={};var r=[];t.mix&&(Array.isArray(t.mix)?r.push.apply(r,_toConsumableArray(t.mix)):r.push(t.mix),(r=r.map((function(t){return e[t]})).filter((function(e){return e&&e!==t}))).forEach((function(e){return t.mixed[e.name]=!0}))),r.push(t),t.animated=r.some((function(t){return t&&t.animated})),t.texcoords=r.some((function(t){return t&&t.texcoords})),t.base=r.map((function(t){return t.base})).filter((function(t){return t})).pop(),t.lighting=r.map((function(t){return t.lighting})).filter((function(t){return null!=t})).pop(),t.texture=r.map((function(t){return t.texture})).filter((function(t){return t})).pop(),t.raster=r.map((function(t){return t.raster})).filter((function(t){return null!=t})).pop(),t.dash=r.map((function(t){return t.dash})).filter((function(t){return null!=t})).pop(),t.dash_background_color=r.map((function(t){return t.dash_background_color})).filter((function(t){return null!=t})).pop(),r.some((function(t){return t.hasOwnProperty("blend")&&t.blend}))&&(t.blend=r.map((function(t){return t.hasOwnProperty("blend")&&t.blend})).filter((function(t){return t})).pop()),t.blend_order=r.map((function(t){return t.blend_order})).filter((function(t){return null!=t})).pop(),t.defines=Object.assign.apply(Object,[{}].concat(_toConsumableArray(r.map((function(t){return t.defines})).filter((function(t){return t}))))),t.material=Object.assign.apply(Object,[{}].concat(_toConsumableArray(r.map((function(t){return t.material})).filter((function(t){return t})))));var i=r.map((function(t){return t.draw})).filter((function(t){return t}));return 0<i.length&&(t.draw=mergeObjects.apply(void 0,[{}].concat(_toConsumableArray(i)))),this.mixShaders(t,e,r),t}},{key:"mixShaders",value:function(t,e,r){var i={},n=r.map((function(t){return t.shaders})).filter((function(t){return t}));if(i.defines=Object.assign.apply(Object,[{}].concat(_toConsumableArray(n.map((function(t){return t.defines})).filter((function(t){return t}))))),i.uniforms={},i._uniforms=t.shaders&&t.shaders.uniforms||{},i._uniform_scopes={},r.filter((function(t){return t.shaders&&t.shaders.uniforms})).forEach((function(t){for(var r in t.shaders.uniforms)!function(r){i._uniform_scopes[r]=t.name,Object.defineProperty(i.uniforms,r,{enumerable:!0,configurable:!0,get:function(){return void 0!==i._uniforms[r]?i._uniforms[r]:e[i._uniform_scopes[r]].shaders.uniforms!==i.uniforms?e[i._uniform_scopes[r]].shaders.uniforms[r]:void 0},set:function(t){i._uniforms[r]=t}})}(r)})),i.extensions=Object.keys(n.map((function(t){return t.extensions})).filter((function(t){return t})).reduce((function(t,e){return"string"==typeof e?t[e]=!0:e.forEach((function(e){return t[e]=!0})),t}),{})||{}),t.shaders&&t.shaders.blocks)for(var o in t.shaders.block_scopes=t.shaders.block_scopes||{},t.shaders.blocks){var a,s=t.shaders.blocks[o];t.shaders.block_scopes[o]=t.shaders.block_scopes[o]||[],Array.isArray(s)?(a=t.shaders.block_scopes[o]).push.apply(a,_toConsumableArray(s.map((function(){return t.name})))):t.shaders.block_scopes[o].push(t.name)}var l={};return n.forEach((function(t){if(t.blocks){i.blocks=i.blocks||{},i.block_scopes=i.block_scopes||{};var e={};for(var r in t.blocks){var n=t.blocks[r],o=t.block_scopes[r];i.blocks[r]=i.blocks[r]||[],i.block_scopes[r]=i.block_scopes[r]||[],n=Array.isArray(n)?n:[n],o=Array.isArray(o)?o:[o];for(var a=0;a<n.length;a++)l[o[a]]||(e[o[a]]=!0,i.blocks[r].push(n[a]),i.block_scopes[r].push(o[a]))}Object.assign(l,e)}})),Object.assign(t.mixed,l),t.shaders=i,t}},{key:"create",value:function(t,e,r){var i=2<arguments.length&&void 0!==r?r:{},n=mergeObjects({},e);return n.name=t,(n=this.mix(n,i)).base&&this.base_styles[n.base]?this.styles[t]=n=Object.assign(Object.create(this.base_styles[n.base]),n):n.base=null,n}},{key:"build",value:function(t){var e=this,r=Object.keys(t).sort((function(r,i){return e.inheritanceDepth(r,t)-e.inheritanceDepth(i,t)}));for(var i in this.styles)this.base_styles[i]?this.styles[i].reset():delete this.styles[i];var n={};return r.forEach((function(r){n[r]=e.create(r,t[r],n)})),this.styles}},{key:"initStyles",value:function(t){var e=0<arguments.length&&void 0!==t?t:{};for(var r in this.styles)this.styles[r].init(e)}},{key:"inheritanceDepth",value:function(t,e){for(var r=this,i=0;;){var n=e[t];if(!n)break;if(!n.mix)break;if(i++,Array.isArray(n.mix)){i+=Math.max.apply(Math,_toConsumableArray(n.mix.map((function(i){if(t!==i)return r.inheritanceDepth(i,e)}))));break}if(t===n.mix)break;t=n.mix}return i}}]),t}();function isNothing(t){return null==t}function isObject$2(t){return"object"==typeof t&&null!==t}function toArray(t){return Array.isArray(t)?t:isNothing(t)?[]:[t]}function extend$1(t,e){var r,i,n,o;if(e)for(r=0,i=(o=Object.keys(e)).length;r<i;r+=1)t[n=o[r]]=e[n];return t}function repeat(t,e){for(var r="",i=0;i<e;i+=1)r+=t;return r}function isNegativeZero(t){return 0===t&&Number.NEGATIVE_INFINITY===1/t}var isNothing_1=isNothing,isObject_1=isObject$2,toArray_1=toArray,repeat_1=repeat,isNegativeZero_1=isNegativeZero,extend_1=extend$1,common={isNothing:isNothing_1,isObject:isObject_1,toArray:toArray_1,repeat:repeat_1,isNegativeZero:isNegativeZero_1,extend:extend_1};function YAMLException(t,e){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack||"",this.name="YAMLException",this.reason=t,this.mark=e,this.message=(this.reason||"(unknown reason)")+(this.mark?" "+this.mark.toString():"")}YAMLException.prototype=Object.create(Error.prototype),YAMLException.prototype.constructor=YAMLException,YAMLException.prototype.toString=function(t){var e=this.name+": ";return e+=this.reason||"(unknown reason)",!t&&this.mark&&(e+=" "+this.mark.toString()),e};var exception=YAMLException;function Mark(t,e,r,i,n){this.name=t,this.buffer=e,this.position=r,this.line=i,this.column=n}Mark.prototype.getSnippet=function(t,e){var r,i,n,o,a;if(!this.buffer)return null;for(t=t||4,e=e||75,r="",i=this.position;0<i&&-1==="\0\r\n\u2028\u2029".indexOf(this.buffer.charAt(i-1));)if(--i,this.position-i>e/2-1){r=" ... ",i+=5;break}for(n="",o=this.position;o<this.buffer.length&&-1==="\0\r\n\u2028\u2029".indexOf(this.buffer.charAt(o));)if((o+=1)-this.position>e/2-1){n=" ... ",o-=5;break}return a=this.buffer.slice(i,o),common.repeat(" ",t)+r+a+n+"\n"+common.repeat(" ",t+this.position-i+r.length)+"^"},Mark.prototype.toString=function(t){var e,r="";return this.name&&(r+='in "'+this.name+'" '),r+="at line "+(this.line+1)+", column "+(this.column+1),t||(e=this.getSnippet())&&(r+=":\n"+e),r};var mark=Mark,TYPE_CONSTRUCTOR_OPTIONS=["kind","resolve","construct","instanceOf","predicate","represent","defaultStyle","styleAliases"],YAML_NODE_KINDS=["scalar","sequence","mapping"];function compileStyleAliases(t){var e={};return null!==t&&Object.keys(t).forEach((function(r){t[r].forEach((function(t){e[String(t)]=r}))})),e}function Type(t,e){if(e=e||{},Object.keys(e).forEach((function(e){if(-1===TYPE_CONSTRUCTOR_OPTIONS.indexOf(e))throw new exception('Unknown option "'+e+'" is met in definition of "'+t+'" YAML type.')})),this.tag=t,this.kind=e.kind||null,this.resolve=e.resolve||function(){return!0},this.construct=e.construct||function(t){return t},this.instanceOf=e.instanceOf||null,this.predicate=e.predicate||null,this.represent=e.represent||null,this.defaultStyle=e.defaultStyle||null,this.styleAliases=compileStyleAliases(e.styleAliases||null),-1===YAML_NODE_KINDS.indexOf(this.kind))throw new exception('Unknown kind "'+this.kind+'" is specified for "'+t+'" YAML type.')}var type=Type;function compileList(t,e,r){var i=[];return t.include.forEach((function(t){r=compileList(t,e,r)})),t[e].forEach((function(t){r.forEach((function(e,r){e.tag===t.tag&&i.push(r)})),r.push(t)})),r.filter((function(t,e){return-1===i.indexOf(e)}))}function compileMap(){var t,e,r={};function i(t){r[t.tag]=t}for(t=0,e=arguments.length;t<e;t+=1)arguments[t].forEach(i);return r}function Schema(t){this.include=t.include||[],this.implicit=t.implicit||[],this.explicit=t.explicit||[],this.implicit.forEach((function(t){if(t.loadKind&&"scalar"!==t.loadKind)throw new exception("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.")})),this.compiledImplicit=compileList(this,"implicit",[]),this.compiledExplicit=compileList(this,"explicit",[]),this.compiledTypeMap=compileMap(this.compiledImplicit,this.compiledExplicit)}Schema.DEFAULT=null,Schema.create=function(t,e){var r,i;switch(arguments.length){case 1:r=Schema.DEFAULT,i=t;break;case 2:r=t,i=e;break;default:throw new exception("Wrong number of arguments for Schema.create function")}if(r=common.toArray(r),i=common.toArray(i),!r.every((function(t){return t instanceof Schema})))throw new exception("Specified list of super schemas (or a single Schema object) contains a non-Schema object.");if(!i.every((function(t){return t instanceof type})))throw new exception("Specified list of YAML types (or a single Type object) contains a non-Type object.");return new Schema({include:r,explicit:i})};var schema=Schema,str=new type("tag:yaml.org,2002:str",{kind:"scalar",construct:function(t){return null!==t?t:""}}),seq=new type("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(t){return null!==t?t:[]}}),map=new type("tag:yaml.org,2002:map",{kind:"mapping",construct:function(t){return null!==t?t:{}}}),failsafe=new schema({explicit:[str,seq,map]});function resolveYamlNull(t){if(null===t)return!0;var e=t.length;return 1===e&&"~"===t||4===e&&("null"===t||"Null"===t||"NULL"===t)}function constructYamlNull(){return null}function isNull$1(t){return null===t}var _null=new type("tag:yaml.org,2002:null",{kind:"scalar",resolve:resolveYamlNull,construct:constructYamlNull,predicate:isNull$1,represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"}},defaultStyle:"lowercase"});function resolveYamlBoolean(t){if(null===t)return!1;var e=t.length;return 4===e&&("true"===t||"True"===t||"TRUE"===t)||5===e&&("false"===t||"False"===t||"FALSE"===t)}function constructYamlBoolean(t){return"true"===t||"True"===t||"TRUE"===t}function isBoolean$1(t){return"[object Boolean]"===Object.prototype.toString.call(t)}var bool=new type("tag:yaml.org,2002:bool",{kind:"scalar",resolve:resolveYamlBoolean,construct:constructYamlBoolean,predicate:isBoolean$1,represent:{lowercase:function(t){return t?"true":"false"},uppercase:function(t){return t?"TRUE":"FALSE"},camelcase:function(t){return t?"True":"False"}},defaultStyle:"lowercase"});function isHexCode(t){return 48<=t&&t<=57||65<=t&&t<=70||97<=t&&t<=102}function isOctCode(t){return 48<=t&&t<=55}function isDecCode(t){return 48<=t&&t<=57}function resolveYamlInteger(t){if(null===t)return!1;var e,r=t.length,i=0,n=!1;if(!r)return!1;if("-"!==(e=t[i])&&"+"!==e||(e=t[++i]),"0"===e){if(i+1===r)return!0;if("b"===(e=t[++i])){for(i++;i<r;i++)if("_"!==(e=t[i])){if("0"!==e&&"1"!==e)return!1;n=!0}return n}if("x"===e){for(i++;i<r;i++)if("_"!==(e=t[i])){if(!isHexCode(t.charCodeAt(i)))return!1;n=!0}return n}for(;i<r;i++)if("_"!==(e=t[i])){if(!isOctCode(t.charCodeAt(i)))return!1;n=!0}return n}for(;i<r;i++)if("_"!==(e=t[i])){if(":"===e)break;if(!isDecCode(t.charCodeAt(i)))return!1;n=!0}return!!n&&(":"!==e||/^(:[0-5]?[0-9])+$/.test(t.slice(i)))}function constructYamlInteger(t){var e,r,i=t,n=1,o=[];return-1!==i.indexOf("_")&&(i=i.replace(/_/g,"")),"-"!==(e=i[0])&&"+"!==e||("-"===e&&(n=-1),e=(i=i.slice(1))[0]),"0"===i?0:"0"===e?"b"===i[1]?n*parseInt(i.slice(2),2):"x"===i[1]?n*parseInt(i,16):n*parseInt(i,8):-1!==i.indexOf(":")?(i.split(":").forEach((function(t){o.unshift(parseInt(t,10))})),i=0,r=1,o.forEach((function(t){i+=t*r,r*=60})),n*i):n*parseInt(i,10)}function isInteger(t){return"[object Number]"===Object.prototype.toString.call(t)&&t%1==0&&!common.isNegativeZero(t)}var int_1=new type("tag:yaml.org,2002:int",{kind:"scalar",resolve:resolveYamlInteger,construct:constructYamlInteger,predicate:isInteger,represent:{binary:function(t){return"0b"+t.toString(2)},octal:function(t){return"0"+t.toString(8)},decimal:function(t){return t.toString(10)},hexadecimal:function(t){return"0x"+t.toString(16).toUpperCase()}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),YAML_FLOAT_PATTERN=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)\\.[0-9_]*(?:[eE][-+][0-9]+)?|\\.[0-9_]+(?:[eE][-+][0-9]+)?|[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+\\.[0-9_]*|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$");function resolveYamlFloat(t){return null!==t&&!!YAML_FLOAT_PATTERN.test(t)}function constructYamlFloat(t){var e,r=t.replace(/_/g,"").toLowerCase(),i="-"===r[0]?-1:1,n=[];return 0<="+-".indexOf(r[0])&&(r=r.slice(1)),".inf"===r?1==i?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:".nan"===r?NaN:0<=r.indexOf(":")?(r.split(":").forEach((function(t){n.unshift(parseFloat(t,10))})),r=0,e=1,n.forEach((function(t){r+=t*e,e*=60})),i*r):i*parseFloat(r,10)}var SCIENTIFIC_WITHOUT_DOT=/^[-+]?[0-9]+e/;function representYamlFloat(t,e){var r;if(isNaN(t))switch(e){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===t)switch(e){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===t)switch(e){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(common.isNegativeZero(t))return"-0.0";return r=t.toString(10),SCIENTIFIC_WITHOUT_DOT.test(r)?r.replace("e",".e"):r}function isFloat(t){return"[object Number]"===Object.prototype.toString.call(t)&&(t%1!=0||common.isNegativeZero(t))}var float_1$1=new type("tag:yaml.org,2002:float",{kind:"scalar",resolve:resolveYamlFloat,construct:constructYamlFloat,predicate:isFloat,represent:representYamlFloat,defaultStyle:"lowercase"}),json=new schema({include:[failsafe],implicit:[_null,bool,int_1,float_1$1]}),core=new schema({include:[json]}),YAML_TIMESTAMP_REGEXP=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?)?$");function resolveYamlTimestamp(t){return null!==t&&null!==YAML_TIMESTAMP_REGEXP.exec(t)}function constructYamlTimestamp(t){var e,r,i,n,o,a,s,l=0,c=null,u=YAML_TIMESTAMP_REGEXP.exec(t);if(null===u)throw new Error("Date resolve error");if(e=+u[1],r=u[2]-1,i=+u[3],!u[4])return new Date(Date.UTC(e,r,i));if(n=+u[4],o=+u[5],a=+u[6],u[7]){for(l=u[7].slice(0,3);l.length<3;)l+="0";l=+l}return u[9]&&(c=6e4*(60*+u[10]+ +(u[11]||0)),"-"===u[9]&&(c=-c)),s=new Date(Date.UTC(e,r,i,n,o,a,l)),c&&s.setTime(s.getTime()-c),s}function representYamlTimestamp(t){return t.toISOString()}var timestamp=new type("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:resolveYamlTimestamp,construct:constructYamlTimestamp,instanceOf:Date,represent:representYamlTimestamp});function resolveYamlMerge(t){return"<<"===t||null===t}var merge=new type("tag:yaml.org,2002:merge",{kind:"scalar",resolve:resolveYamlMerge}),NodeBuffer=bufferEs6.Buffer,BASE64_MAP="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\n\r";function resolveYamlBinary(t){if(null===t)return!1;for(var e,r=0,i=t.length,n=BASE64_MAP,o=0;o<i;o++)if(!(64<(e=n.indexOf(t.charAt(o))))){if(e<0)return!1;r+=6}return r%8==0}function constructYamlBinary(t){for(var e,r=t.replace(/[\r\n=]/g,""),i=r.length,n=BASE64_MAP,o=0,a=[],s=0;s<i;s++)s%4==0&&s&&(a.push(o>>16&255),a.push(o>>8&255),a.push(255&o)),o=o<<6|n.indexOf(r.charAt(s));return 0==(e=i%4*6)?(a.push(o>>16&255),a.push(o>>8&255),a.push(255&o)):18==e?(a.push(o>>10&255),a.push(o>>2&255)):12==e&&a.push(o>>4&255),NodeBuffer?new NodeBuffer(a):a}function representYamlBinary(t){for(var e,r="",i=0,n=t.length,o=BASE64_MAP,a=0;a<n;a++)a%3==0&&a&&(r+=o[i>>18&63],r+=o[i>>12&63],r+=o[i>>6&63],r+=o[63&i]),i=(i<<8)+t[a];return 0==(e=n%3)?(r+=o[i>>18&63],r+=o[i>>12&63],r+=o[i>>6&63],r+=o[63&i]):2==e?(r+=o[i>>10&63],r+=o[i>>4&63],r+=o[i<<2&63],r+=o[64]):1==e&&(r+=o[i>>2&63],r+=o[i<<4&63],r+=o[64],r+=o[64]),r}function isBinary(t){return NodeBuffer&&NodeBuffer.isBuffer(t)}var binary=new type("tag:yaml.org,2002:binary",{kind:"scalar",resolve:resolveYamlBinary,construct:constructYamlBinary,predicate:isBinary,represent:representYamlBinary}),_hasOwnProperty=Object.prototype.hasOwnProperty,_toString=Object.prototype.toString;function resolveYamlOmap(t){if(null===t)return!0;for(var e,r,i,n=[],o=t,a=0,s=o.length;a<s;a+=1){if(e=o[a],i=!1,"[object Object]"!==_toString.call(e))return!1;for(r in e)if(_hasOwnProperty.call(e,r)){if(i)return!1;i=!0}if(!i)return!1;if(-1!==n.indexOf(r))return!1;n.push(r)}return!0}function constructYamlOmap(t){return null!==t?t:[]}var omap=new type("tag:yaml.org,2002:omap",{kind:"sequence",resolve:resolveYamlOmap,construct:constructYamlOmap}),_toString$1=Object.prototype.toString;function resolveYamlPairs(t){if(null===t)return!0;for(var e,r,i=t,n=new Array(i.length),o=0,a=i.length;o<a;o+=1){if(e=i[o],"[object Object]"!==_toString$1.call(e))return!1;if(1!==(r=Object.keys(e)).length)return!1;n[o]=[r[0],e[r[0]]]}return!0}function constructYamlPairs(t){if(null===t)return[];for(var e,r,i=t,n=new Array(i.length),o=0,a=i.length;o<a;o+=1)e=i[o],r=Object.keys(e),n[o]=[r[0],e[r[0]]];return n}var pairs=new type("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:resolveYamlPairs,construct:constructYamlPairs}),_hasOwnProperty$1=Object.prototype.hasOwnProperty;function resolveYamlSet(t){if(null===t)return!0;var e,r=t;for(e in r)if(_hasOwnProperty$1.call(r,e)&&null!==r[e])return!1;return!0}function constructYamlSet(t){return null!==t?t:{}}var set$2=new type("tag:yaml.org,2002:set",{kind:"mapping",resolve:resolveYamlSet,construct:constructYamlSet}),default_safe=new schema({include:[core],implicit:[timestamp,merge],explicit:[binary,omap,pairs,set$2]});function resolveJavascriptUndefined(){return!0}function constructJavascriptUndefined(){}function representJavascriptUndefined(){return""}function isUndefined$1(t){return void 0===t}var _undefined=new type("tag:yaml.org,2002:js/undefined",{kind:"scalar",resolve:resolveJavascriptUndefined,construct:constructJavascriptUndefined,predicate:isUndefined$1,represent:representJavascriptUndefined});function resolveJavascriptRegExp(t){if(null===t)return!1;if(0===t.length)return!1;var e=t,r=/\/([gim]*)$/.exec(t),i="";if("/"===e[0]){if(r&&(i=r[1]),3<i.length)return!1;if("/"!==e[e.length-i.length-1])return!1}return!0}function constructJavascriptRegExp(t){var e=t,r=/\/([gim]*)$/.exec(t),i="";return"/"===e[0]&&(r&&(i=r[1]),e=e.slice(1,e.length-i.length-1)),new RegExp(e,i)}function representJavascriptRegExp(t){var e="/"+t.source+"/";return t.global&&(e+="g"),t.multiline&&(e+="m"),t.ignoreCase&&(e+="i"),e}function isRegExp$1(t){return"[object RegExp]"===Object.prototype.toString.call(t)}var regexp=new type("tag:yaml.org,2002:js/regexp",{kind:"scalar",resolve:resolveJavascriptRegExp,construct:constructJavascriptRegExp,predicate:isRegExp$1,represent:representJavascriptRegExp}),esprima;try{var _require=commonjsRequire,esprima=_require("esprima")}catch(t){"undefined"!=typeof window&&(esprima=window.esprima)}function resolveJavascriptFunction(t){if(null===t)return!1;try{var e="("+t+")",r=esprima.parse(e,{range:!0});return"Program"===r.type&&1===r.body.length&&"ExpressionStatement"===r.body[0].type&&"FunctionExpression"===r.body[0].expression.type}catch(t){return!1}}function constructJavascriptFunction(t){var e,r="("+t+")",i=esprima.parse(r,{range:!0}),n=[];if("Program"!==i.type||1!==i.body.length||"ExpressionStatement"!==i.body[0].type||"FunctionExpression"!==i.body[0].expression.type)throw new Error("Failed to resolve function");return i.body[0].expression.params.forEach((function(t){n.push(t.name)})),e=i.body[0].expression.body.range,new Function(n,r.slice(e[0]+1,e[1]-1))}function representJavascriptFunction(t){return t.toString()}function isFunction$1(t){return"[object Function]"===Object.prototype.toString.call(t)}var _function=new type("tag:yaml.org,2002:js/function",{kind:"scalar",resolve:resolveJavascriptFunction,construct:constructJavascriptFunction,predicate:isFunction$1,represent:representJavascriptFunction}),default_full=schema.DEFAULT=new schema({include:[default_safe],explicit:[_undefined,regexp,_function]}),_hasOwnProperty$2=Object.prototype.hasOwnProperty,CONTEXT_FLOW_IN=1,CONTEXT_FLOW_OUT=2,CONTEXT_BLOCK_IN=3,CONTEXT_BLOCK_OUT=4,CHOMPING_CLIP=1,CHOMPING_STRIP=2,CHOMPING_KEEP=3,PATTERN_NON_PRINTABLE=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,PATTERN_NON_ASCII_LINE_BREAKS=/[\x85\u2028\u2029]/,PATTERN_FLOW_INDICATORS=/[,\[\]\{\}]/,PATTERN_TAG_HANDLE=/^(?:!|!!|![a-z\-]+!)$/i,PATTERN_TAG_URI=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function is_EOL(t){return 10===t||13===t}function is_WHITE_SPACE(t){return 9===t||32===t}function is_WS_OR_EOL(t){return 9===t||32===t||10===t||13===t}function is_FLOW_INDICATOR(t){return 44===t||91===t||93===t||123===t||125===t}function fromHexCode(t){var e;return 48<=t&&t<=57?t-48:97<=(e=32|t)&&e<=102?e-97+10:-1}function escapedHexLen(t){return 120===t?2:117===t?4:85===t?8:0}function fromDecimalCode(t){return 48<=t&&t<=57?t-48:-1}function simpleEscapeSequence(t){return 48===t?"\0":97===t?"":98===t?"\b":116===t||9===t?"\t":110===t?"\n":118===t?"\v":102===t?"\f":114===t?"\r":101===t?"":32===t?" ":34===t?'"':47===t?"/":92===t?"\\":78===t?"":95===t?"":76===t?"\u2028":80===t?"\u2029":""}function charFromCodepoint(t){return t<=65535?String.fromCharCode(t):String.fromCharCode(55296+(t-65536>>10),56320+(t-65536&1023))}for(var simpleEscapeCheck=new Array(256),simpleEscapeMap=new Array(256),i=0;i<256;i++)simpleEscapeCheck[i]=simpleEscapeSequence(i)?1:0,simpleEscapeMap[i]=simpleEscapeSequence(i);function State$1(t,e){this.input=t,this.filename=e.filename||null,this.schema=e.schema||default_full,this.onWarning=e.onWarning||null,this.legacy=e.legacy||!1,this.json=e.json||!1,this.listener=e.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=t.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.documents=[]}function generateError(t,e){return new exception(e,new mark(t.filename,t.input,t.position,t.line,t.position-t.lineStart))}function throwError(t,e){throw generateError(t,e)}function throwWarning(t,e){t.onWarning&&t.onWarning.call(null,generateError(t,e))}var directiveHandlers={YAML:function(t,e,r){var i,n,o;null!==t.version&&throwError(t,"duplication of %YAML directive"),1!==r.length&&throwError(t,"YAML directive accepts exactly one argument"),null===(i=/^([0-9]+)\.([0-9]+)$/.exec(r[0]))&&throwError(t,"ill-formed argument of the YAML directive"),n=parseInt(i[1],10),o=parseInt(i[2],10),1!==n&&throwError(t,"unacceptable YAML version of the document"),t.version=r[0],t.checkLineBreaks=o<2,1!==o&&2!==o&&throwWarning(t,"unsupported YAML version of the document")},TAG:function(t,e,r){var i,n;2!==r.length&&throwError(t,"TAG directive accepts exactly two arguments"),i=r[0],n=r[1],PATTERN_TAG_HANDLE.test(i)||throwError(t,"ill-formed tag handle (first argument) of the TAG directive"),_hasOwnProperty$2.call(t.tagMap,i)&&throwError(t,'there is a previously declared suffix for "'+i+'" tag handle'),PATTERN_TAG_URI.test(n)||throwError(t,"ill-formed tag prefix (second argument) of the TAG directive"),t.tagMap[i]=n}};function captureSegment(t,e,r,i){var n,o,a,s;if(e<r){if(s=t.input.slice(e,r),i)for(n=0,o=s.length;n<o;n+=1)9===(a=s.charCodeAt(n))||32<=a&&a<=1114111||throwError(t,"expected valid JSON character");else PATTERN_NON_PRINTABLE.test(s)&&throwError(t,"the stream contains non-printable characters");t.result+=s}}function mergeMappings(t,e,r,i){var n,o,a,s;for(common.isObject(r)||throwError(t,"cannot merge mappings; the provided source object is unacceptable"),a=0,s=(n=Object.keys(r)).length;a<s;a+=1)o=n[a],_hasOwnProperty$2.call(e,o)||(e[o]=r[o],i[o]=!0)}function storeMappingPair(t,e,r,i,n,o){var a,s;if(n=String(n),null===e&&(e={}),"tag:yaml.org,2002:merge"===i)if(Array.isArray(o))for(a=0,s=o.length;a<s;a+=1)mergeMappings(t,e,o[a],r);else mergeMappings(t,e,o,r);else t.json||_hasOwnProperty$2.call(r,n)||!_hasOwnProperty$2.call(e,n)||throwError(t,"duplicated mapping key"),e[n]=o,delete r[n];return e}function readLineBreak(t){var e=t.input.charCodeAt(t.position);10===e?t.position++:13===e?(t.position++,10===t.input.charCodeAt(t.position)&&t.position++):throwError(t,"a line break is expected"),t.line+=1,t.lineStart=t.position}function skipSeparationSpace(t,e,r){for(var i=0,n=t.input.charCodeAt(t.position);0!==n;){for(;is_WHITE_SPACE(n);)n=t.input.charCodeAt(++t.position);if(e&&35===n)for(;10!==(n=t.input.charCodeAt(++t.position))&&13!==n&&0!==n;);if(!is_EOL(n))break;for(readLineBreak(t),n=t.input.charCodeAt(t.position),i++,t.lineIndent=0;32===n;)t.lineIndent++,n=t.input.charCodeAt(++t.position)}return-1!==r&&0!==i&&t.lineIndent<r&&throwWarning(t,"deficient indentation"),i}function testDocumentSeparator(t){var e=t.position,r=t.input.charCodeAt(e);return 45!==r&&46!==r||r!==t.input.charCodeAt(e+1)||r!==t.input.charCodeAt(e+2)||(e+=3,0!==(r=t.input.charCodeAt(e))&&!is_WS_OR_EOL(r))?void 0:1}function writeFoldedLines(t,e){1===e?t.result+=" ":1<e&&(t.result+=common.repeat("\n",e-1))}function readPlainScalar(t,e,r){var i,n,o,a,s,l,c,u=t.kind,h=t.result,p=t.input.charCodeAt(t.position);if(!is_WS_OR_EOL(p)&&!is_FLOW_INDICATOR(p)&&35!==p&&38!==p&&42!==p&&33!==p&&124!==p&&62!==p&&39!==p&&34!==p&&37!==p&&64!==p&&96!==p&&(63!==p&&45!==p||!(is_WS_OR_EOL(i=t.input.charCodeAt(t.position+1))||r&&is_FLOW_INDICATOR(i)))){for(t.kind="scalar",t.result="",n=o=t.position,a=!1;0!==p;){if(58===p){if(is_WS_OR_EOL(i=t.input.charCodeAt(t.position+1))||r&&is_FLOW_INDICATOR(i))break}else if(35===p){if(is_WS_OR_EOL(t.input.charCodeAt(t.position-1)))break}else{if(t.position===t.lineStart&&testDocumentSeparator(t)||r&&is_FLOW_INDICATOR(p))break;if(is_EOL(p)){if(s=t.line,l=t.lineStart,c=t.lineIndent,skipSeparationSpace(t,!1,-1),t.lineIndent>=e){a=!0,p=t.input.charCodeAt(t.position);continue}t.position=o,t.line=s,t.lineStart=l,t.lineIndent=c;break}}a&&(captureSegment(t,n,o,!1),writeFoldedLines(t,t.line-s),n=o=t.position,a=!1),is_WHITE_SPACE(p)||(o=t.position+1),p=t.input.charCodeAt(++t.position)}if(captureSegment(t,n,o,!1),t.result)return 1;t.kind=u,t.result=h}}function readSingleQuotedScalar(t,e){var r,i,n=t.input.charCodeAt(t.position);if(39===n){for(t.kind="scalar",t.result="",t.position++,r=i=t.position;0!==(n=t.input.charCodeAt(t.position));)if(39===n){if(captureSegment(t,r,t.position,!0),39!==(n=t.input.charCodeAt(++t.position)))return 1;r=i=t.position,t.position++}else is_EOL(n)?(captureSegment(t,r,i,!0),writeFoldedLines(t,skipSeparationSpace(t,!1,e)),r=i=t.position):t.position===t.lineStart&&testDocumentSeparator(t)?throwError(t,"unexpected end of the document within a single quoted scalar"):(t.position++,i=t.position);throwError(t,"unexpected end of the stream within a single quoted scalar")}}function readDoubleQuotedScalar(t,e){var r,i,n,o,a,s=t.input.charCodeAt(t.position);if(34===s){for(t.kind="scalar",t.result="",t.position++,r=i=t.position;0!==(s=t.input.charCodeAt(t.position));){if(34===s)return captureSegment(t,r,t.position,!0),t.position++,1;if(92===s){if(captureSegment(t,r,t.position,!0),is_EOL(s=t.input.charCodeAt(++t.position)))skipSeparationSpace(t,!1,e);else if(s<256&&simpleEscapeCheck[s])t.result+=simpleEscapeMap[s],t.position++;else if(0<(a=escapedHexLen(s))){for(n=a,o=0;0<n;n--)0<=(a=fromHexCode(s=t.input.charCodeAt(++t.position)))?o=(o<<4)+a:throwError(t,"expected hexadecimal character");t.result+=charFromCodepoint(o),t.position++}else throwError(t,"unknown escape sequence");r=i=t.position}else is_EOL(s)?(captureSegment(t,r,i,!0),writeFoldedLines(t,skipSeparationSpace(t,!1,e)),r=i=t.position):t.position===t.lineStart&&testDocumentSeparator(t)?throwError(t,"unexpected end of the document within a double quoted scalar"):(t.position++,i=t.position)}throwError(t,"unexpected end of the stream within a double quoted scalar")}}function readFlowCollection(t,e){var r,i,n,o,a,s,l,c,u,h=!0,p=t.tag,f=t.anchor,d={},y=t.input.charCodeAt(t.position);if(91===y)s=!(n=93),i=[];else{if(123!==y)return;n=125,s=!0,i={}}for(null!==t.anchor&&(t.anchorMap[t.anchor]=i),y=t.input.charCodeAt(++t.position);0!==y;){if(skipSeparationSpace(t,!0,e),(y=t.input.charCodeAt(t.position))===n)return t.position++,t.tag=p,t.anchor=f,t.kind=s?"mapping":"sequence",t.result=i,1;h||throwError(t,"missed comma between flow collection entries"),u=null,o=a=!1,63===y&&is_WS_OR_EOL(t.input.charCodeAt(t.position+1))&&(o=a=!0,t.position++,skipSeparationSpace(t,!0,e)),r=t.line,composeNode(t,e,CONTEXT_FLOW_IN,!1,!0),c=t.tag,l=t.result,skipSeparationSpace(t,!0,e),y=t.input.charCodeAt(t.position),!a&&t.line!==r||58!==y||(o=!0,y=t.input.charCodeAt(++t.position),skipSeparationSpace(t,!0,e),composeNode(t,e,CONTEXT_FLOW_IN,!1,!0),u=t.result),s?storeMappingPair(t,i,d,c,l,u):o?i.push(storeMappingPair(t,null,d,c,l,u)):i.push(l),skipSeparationSpace(t,!0,e),44===(y=t.input.charCodeAt(t.position))?(h=!0,y=t.input.charCodeAt(++t.position)):h=!1}throwError(t,"unexpected end of the stream within a flow collection")}function readBlockScalar(t,e){var r,i,n,o=CHOMPING_CLIP,a=!1,s=e,l=0,c=!1,u=t.input.charCodeAt(t.position);if(124===u)i=!1;else{if(62!==u)return;i=!0}for(t.kind="scalar",t.result="";0!==u;)if(43===(u=t.input.charCodeAt(++t.position))||45===u)CHOMPING_CLIP===o?o=43===u?CHOMPING_KEEP:CHOMPING_STRIP:throwError(t,"repeat of a chomping mode identifier");else{if(!(0<=(n=fromDecimalCode(u))))break;0===n?throwError(t,"bad explicit indentation width of a block scalar; it cannot be less than one"):a?throwError(t,"repeat of an indentation width identifier"):(s=e+n-1,a=!0)}if(is_WHITE_SPACE(u)){for(;is_WHITE_SPACE(u=t.input.charCodeAt(++t.position)););if(35===u)for(;!is_EOL(u=t.input.charCodeAt(++t.position))&&0!==u;);}for(;0!==u;){for(readLineBreak(t),t.lineIndent=0,u=t.input.charCodeAt(t.position);(!a||t.lineIndent<s)&&32===u;)t.lineIndent++,u=t.input.charCodeAt(++t.position);if(!a&&t.lineIndent>s&&(s=t.lineIndent),is_EOL(u))l++;else{if(t.lineIndent<s){o===CHOMPING_KEEP?t.result+=common.repeat("\n",l):o===CHOMPING_CLIP&&a&&(t.result+="\n");break}for(i?is_WHITE_SPACE(u)?(c=!0,t.result+=common.repeat("\n",l+1)):c?(c=!1,t.result+=common.repeat("\n",l+1)):0===l?a&&(t.result+=" "):t.result+=common.repeat("\n",l):t.result+=a?common.repeat("\n",l+1):common.repeat("\n",l),a=!0,l=0,r=t.position;!is_EOL(u)&&0!==u;)u=t.input.charCodeAt(++t.position);captureSegment(t,r,t.position,!1)}}return 1}function readBlockSequence(t,e){var r,i,n=t.tag,o=t.anchor,a=[],s=!1;for(null!==t.anchor&&(t.anchorMap[t.anchor]=a),i=t.input.charCodeAt(t.position);0!==i&&45===i&&is_WS_OR_EOL(t.input.charCodeAt(t.position+1));)if(s=!0,t.position++,skipSeparationSpace(t,!0,-1)&&t.lineIndent<=e)a.push(null),i=t.input.charCodeAt(t.position);else if(r=t.line,composeNode(t,e,CONTEXT_BLOCK_IN,!1,!0),a.push(t.result),skipSeparationSpace(t,!0,-1),i=t.input.charCodeAt(t.position),(t.line===r||t.lineIndent>e)&&0!==i)throwError(t,"bad indentation of a sequence entry");else if(t.lineIndent<e)break;return!!s&&(t.tag=n,t.anchor=o,t.kind="sequence",t.result=a,!0)}function readBlockMapping(t,e,r){var i,n,o,a,s=t.tag,l=t.anchor,c={},u={},h=null,p=null,f=null,d=!1,y=!1;for(null!==t.anchor&&(t.anchorMap[t.anchor]=c),a=t.input.charCodeAt(t.position);0!==a;){if(i=t.input.charCodeAt(t.position+1),o=t.line,63!==a&&58!==a||!is_WS_OR_EOL(i)){if(!composeNode(t,r,CONTEXT_FLOW_OUT,!1,!0))break;if(t.line===o){for(a=t.input.charCodeAt(t.position);is_WHITE_SPACE(a);)a=t.input.charCodeAt(++t.position);if(58===a)is_WS_OR_EOL(a=t.input.charCodeAt(++t.position))||throwError(t,"a whitespace character is expected after the key-value separator within a block mapping"),d&&(storeMappingPair(t,c,u,h,p,null),h=p=f=null),n=d=!(y=!0),h=t.tag,p=t.result;else{if(!y)return t.tag=s,t.anchor=l,1;throwError(t,"can not read an implicit mapping pair; a colon is missed")}}else{if(!y)return t.tag=s,t.anchor=l,1;throwError(t,"can not read a block mapping entry; a multiline key may not be an implicit key")}}else 63===a?(d&&(storeMappingPair(t,c,u,h,p,null),h=p=f=null),n=d=y=!0):d?n=!(d=!1):throwError(t,"incomplete explicit mapping pair; a key node is missed"),t.position+=1,a=i;if((t.line===o||t.lineIndent>e)&&(composeNode(t,e,CONTEXT_BLOCK_OUT,!0,n)&&(d?p=t.result:f=t.result),d||(storeMappingPair(t,c,u,h,p,f),h=p=f=null),skipSeparationSpace(t,!0,-1),a=t.input.charCodeAt(t.position)),t.lineIndent>e&&0!==a)throwError(t,"bad indentation of a mapping entry");else if(t.lineIndent<e)break}return d&&storeMappingPair(t,c,u,h,p,null),y&&(t.tag=s,t.anchor=l,t.kind="mapping",t.result=c),y}function readTagProperty(t){var e,r,i,n=!1,o=!1,a=t.input.charCodeAt(t.position);if(33===a){if(null!==t.tag&&throwError(t,"duplication of a tag property"),60===(a=t.input.charCodeAt(++t.position))?(n=!0,a=t.input.charCodeAt(++t.position)):33===a?(o=!0,r="!!",a=t.input.charCodeAt(++t.position)):r="!",e=t.position,n){for(;0!==(a=t.input.charCodeAt(++t.position))&&62!==a;);t.position<t.length?(i=t.input.slice(e,t.position),a=t.input.charCodeAt(++t.position)):throwError(t,"unexpected end of the stream within a verbatim tag")}else{for(;0!==a&&!is_WS_OR_EOL(a);)33===a&&(o?throwError(t,"tag suffix cannot contain exclamation marks"):(r=t.input.slice(e-1,t.position+1),PATTERN_TAG_HANDLE.test(r)||throwError(t,"named tag handle cannot contain such characters"),o=!0,e=t.position+1)),a=t.input.charCodeAt(++t.position);i=t.input.slice(e,t.position),PATTERN_FLOW_INDICATORS.test(i)&&throwError(t,"tag suffix cannot contain flow indicator characters")}return i&&!PATTERN_TAG_URI.test(i)&&throwError(t,"tag name cannot contain such characters: "+i),n?t.tag=i:_hasOwnProperty$2.call(t.tagMap,r)?t.tag=t.tagMap[r]+i:"!"===r?t.tag="!"+i:"!!"===r?t.tag="tag:yaml.org,2002:"+i:throwError(t,'undeclared tag handle "'+r+'"'),1}}function readAnchorProperty(t){var e,r=t.input.charCodeAt(t.position);if(38===r){for(null!==t.anchor&&throwError(t,"duplication of an anchor property"),r=t.input.charCodeAt(++t.position),e=t.position;0!==r&&!is_WS_OR_EOL(r)&&!is_FLOW_INDICATOR(r);)r=t.input.charCodeAt(++t.position);return t.position===e&&throwError(t,"name of an anchor node must contain at least one character"),t.anchor=t.input.slice(e,t.position),1}}function readAlias(t){var e,r,i=t.input.charCodeAt(t.position);if(42===i){for(i=t.input.charCodeAt(++t.position),e=t.position;0!==i&&!is_WS_OR_EOL(i)&&!is_FLOW_INDICATOR(i);)i=t.input.charCodeAt(++t.position);return t.position===e&&throwError(t,"name of an alias node must contain at least one character"),r=t.input.slice(e,t.position),t.anchorMap.hasOwnProperty(r)||throwError(t,'unidentified alias "'+r+'"'),t.result=t.anchorMap[r],skipSeparationSpace(t,!0,-1),1}}function composeNode(t,e,r,i,n){var o,a,s,l,c,u,h,p,f=1,d=!1,y=!1;if(null!==t.listener&&t.listener("open",t),t.tag=null,t.anchor=null,t.kind=null,t.result=null,o=a=s=CONTEXT_BLOCK_OUT===r||CONTEXT_BLOCK_IN===r,i&&skipSeparationSpace(t,!0,-1)&&(d=!0,t.lineIndent>e?f=1:t.lineIndent===e?f=0:t.lineIndent<e&&(f=-1)),1===f)for(;readTagProperty(t)||readAnchorProperty(t);)skipSeparationSpace(t,!0,-1)?(d=!0,s=o,t.lineIndent>e?f=1:t.lineIndent===e?f=0:t.lineIndent<e&&(f=-1)):s=!1;if(s=s&&(d||n),1!==f&&CONTEXT_BLOCK_OUT!==r||(h=CONTEXT_FLOW_IN===r||CONTEXT_FLOW_OUT===r?e:e+1,p=t.position-t.lineStart,1===f?s&&(readBlockSequence(t,p)||readBlockMapping(t,p,h))||readFlowCollection(t,h)?y=!0:(a&&readBlockScalar(t,h)||readSingleQuotedScalar(t,h)||readDoubleQuotedScalar(t,h)?y=!0:readAlias(t)?(y=!0,null===t.tag&&null===t.anchor||throwError(t,"alias node should not have any properties")):readPlainScalar(t,h,CONTEXT_FLOW_IN===r)&&(y=!0,null===t.tag&&(t.tag="?")),null!==t.anchor&&(t.anchorMap[t.anchor]=t.result)):0===f&&(y=s&&readBlockSequence(t,p))),null!==t.tag&&"!"!==t.tag)if("?"===t.tag){for(l=0,c=t.implicitTypes.length;l<c;l+=1)if((u=t.implicitTypes[l]).resolve(t.result)){t.result=u.construct(t.result),t.tag=u.tag,null!==t.anchor&&(t.anchorMap[t.anchor]=t.result);break}}else _hasOwnProperty$2.call(t.typeMap,t.tag)?(u=t.typeMap[t.tag],null!==t.result&&u.kind!==t.kind&&throwError(t,"unacceptable node kind for !<"+t.tag+'> tag; it should be "'+u.kind+'", not "'+t.kind+'"'),u.resolve(t.result)?(t.result=u.construct(t.result),null!==t.anchor&&(t.anchorMap[t.anchor]=t.result)):throwError(t,"cannot resolve a node with !<"+t.tag+"> explicit tag")):throwError(t,"unknown tag !<"+t.tag+">");return null!==t.listener&&t.listener("close",t),null!==t.tag||null!==t.anchor||y}function readDocument(t){var e,r,i,n,o=t.position,a=!1;for(t.version=null,t.checkLineBreaks=t.legacy,t.tagMap={},t.anchorMap={};0!==(n=t.input.charCodeAt(t.position))&&(skipSeparationSpace(t,!0,-1),n=t.input.charCodeAt(t.position),!(0<t.lineIndent||37!==n));){for(a=!0,n=t.input.charCodeAt(++t.position),e=t.position;0!==n&&!is_WS_OR_EOL(n);)n=t.input.charCodeAt(++t.position);for(i=[],(r=t.input.slice(e,t.position)).length<1&&throwError(t,"directive name must not be less than one character in length");0!==n;){for(;is_WHITE_SPACE(n);)n=t.input.charCodeAt(++t.position);if(35===n){for(;0!==(n=t.input.charCodeAt(++t.position))&&!is_EOL(n););break}if(is_EOL(n))break;for(e=t.position;0!==n&&!is_WS_OR_EOL(n);)n=t.input.charCodeAt(++t.position);i.push(t.input.slice(e,t.position))}0!==n&&readLineBreak(t),_hasOwnProperty$2.call(directiveHandlers,r)?directiveHandlers[r](t,r,i):throwWarning(t,'unknown document directive "'+r+'"')}skipSeparationSpace(t,!0,-1),0===t.lineIndent&&45===t.input.charCodeAt(t.position)&&45===t.input.charCodeAt(t.position+1)&&45===t.input.charCodeAt(t.position+2)?(t.position+=3,skipSeparationSpace(t,!0,-1)):a&&throwError(t,"directives end mark is expected"),composeNode(t,t.lineIndent-1,CONTEXT_BLOCK_OUT,!1,!0),skipSeparationSpace(t,!0,-1),t.checkLineBreaks&&PATTERN_NON_ASCII_LINE_BREAKS.test(t.input.slice(o,t.position))&&throwWarning(t,"non-ASCII line breaks are interpreted as content"),t.documents.push(t.result),t.position===t.lineStart&&testDocumentSeparator(t)?46===t.input.charCodeAt(t.position)&&(t.position+=3,skipSeparationSpace(t,!0,-1)):t.position<t.length-1&&throwError(t,"end of the stream or a document separator is expected")}function loadDocuments(t,e){e=e||{},0!==(t=String(t)).length&&(10!==t.charCodeAt(t.length-1)&&13!==t.charCodeAt(t.length-1)&&(t+="\n"),65279===t.charCodeAt(0)&&(t=t.slice(1)));var r=new State$1(t,e);for(r.input+="\0";32===r.input.charCodeAt(r.position);)r.lineIndent+=1,r.position+=1;for(;r.position<r.length-1;)readDocument(r);return r.documents}function loadAll(t,e,r){for(var i=loadDocuments(t,r),n=0,o=i.length;n<o;n+=1)e(i[n])}function load(t,e){var r=loadDocuments(t,e);if(0!==r.length){if(1===r.length)return r[0];throw new exception("expected a single document in the stream, but found more")}}function safeLoadAll(t,e,r){loadAll(t,e,common.extend({schema:default_safe},r))}function safeLoad(t,e){return load(t,common.extend({schema:default_safe},e))}var loadAll_1=loadAll,load_1=load,safeLoadAll_1=safeLoadAll,safeLoad_1=safeLoad,loader={loadAll:loadAll_1,load:load_1,safeLoadAll:safeLoadAll_1,safeLoad:safeLoad_1},_toString$2=Object.prototype.toString,_hasOwnProperty$3=Object.prototype.hasOwnProperty,CHAR_TAB=9,CHAR_LINE_FEED=10,CHAR_CARRIAGE_RETURN=13,CHAR_SPACE=32,CHAR_EXCLAMATION=33,CHAR_DOUBLE_QUOTE=34,CHAR_SHARP=35,CHAR_PERCENT=37,CHAR_AMPERSAND=38,CHAR_SINGLE_QUOTE=39,CHAR_ASTERISK=42,CHAR_COMMA=44,CHAR_MINUS=45,CHAR_COLON=58,CHAR_GREATER_THAN=62,CHAR_QUESTION=63,CHAR_COMMERCIAL_AT=64,CHAR_LEFT_SQUARE_BRACKET=91,CHAR_RIGHT_SQUARE_BRACKET=93,CHAR_GRAVE_ACCENT=96,CHAR_LEFT_CURLY_BRACKET=123,CHAR_VERTICAL_LINE=124,CHAR_RIGHT_CURLY_BRACKET=125,ESCAPE_SEQUENCES={0:"\\0",7:"\\a",8:"\\b",9:"\\t",10:"\\n",11:"\\v",12:"\\f",13:"\\r",27:"\\e",34:'\\"',92:"\\\\",133:"\\N",160:"\\_",8232:"\\L",8233:"\\P"},DEPRECATED_BOOLEANS_SYNTAX=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"];function compileStyleMap(t,e){var r,i,n,o,a,s,l;if(null===e)return{};for(r={},n=0,o=(i=Object.keys(e)).length;n<o;n+=1)a=i[n],s=String(e[a]),"!!"===a.slice(0,2)&&(a="tag:yaml.org,2002:"+a.slice(2)),(l=t.compiledTypeMap[a])&&_hasOwnProperty$3.call(l.styleAliases,s)&&(s=l.styleAliases[s]),r[a]=s;return r}function encodeHex(t){var e,r,i=t.toString(16).toUpperCase();if(t<=255)e="x",r=2;else if(t<=65535)e="u",r=4;else{if(!(t<=4294967295))throw new exception("code point within a string may not be greater than 0xFFFFFFFF");e="U",r=8}return"\\"+e+common.repeat("0",r-i.length)+i}function State$2(t){this.schema=t.schema||default_full,this.indent=Math.max(1,t.indent||2),this.skipInvalid=t.skipInvalid||!1,this.flowLevel=common.isNothing(t.flowLevel)?-1:t.flowLevel,this.styleMap=compileStyleMap(this.schema,t.styles||null),this.sortKeys=t.sortKeys||!1,this.lineWidth=t.lineWidth||80,this.noRefs=t.noRefs||!1,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}function indentString(t,e){for(var r,i=common.repeat(" ",e),n=0,o=-1,a="",s=t.length;n<s;)n=-1===(o=t.indexOf("\n",n))?(r=t.slice(n),s):(r=t.slice(n,o+1),o+1),r.length&&"\n"!==r&&(a+=i),a+=r;return a}function generateNextLine(t,e){return"\n"+common.repeat(" ",t.indent*e)}function testImplicitResolving(t,e){for(var r=0,i=t.implicitTypes.length;r<i;r+=1)if(t.implicitTypes[r].resolve(e))return 1}function StringBuilder(t){this.source=t,this.result="",this.checkpoint=0}function writeScalar(t,e,r,i){var n,o,a,s,l,c,u,h,p,f,d,y,g,v,m,_,b,w,x,E;if(0!==e.length)if(-1===DEPRECATED_BOOLEANS_SYNTAX.indexOf(e)){for(n=!0,o=e.length?e.charCodeAt(0):0,a=CHAR_SPACE===o||CHAR_SPACE===e.charCodeAt(e.length-1),CHAR_MINUS!==o&&CHAR_QUESTION!==o&&CHAR_COMMERCIAL_AT!==o&&CHAR_GRAVE_ACCENT!==o||(n=!1),l=s=a||-1<t.flowLevel&&t.flowLevel<=r?(a&&(n=!1),!1):!i,c=!0,u=new StringBuilder(e),h=!1,f=p=0,d=t.indent*r,-1===(y=t.lineWidth)&&(y=9007199254740991),d<40?y-=d:y=40,v=0;v<e.length;v++){if(g=e.charCodeAt(v),n){if(simpleChar(g))continue;n=!1}c&&g===CHAR_SINGLE_QUOTE&&(c=!1),m=ESCAPE_SEQUENCES[g],_=needsHexEscape(g),(m||_)&&(g!==CHAR_LINE_FEED&&g!==CHAR_DOUBLE_QUOTE&&g!==CHAR_SINGLE_QUOTE?l=s=!1:g===CHAR_LINE_FEED&&(c=!(h=!0),0<v&&e.charCodeAt(v-1)===CHAR_SPACE&&(s=l=!1),s&&(b=v-p,p=v,f<b&&(f=b))),g!==CHAR_DOUBLE_QUOTE&&(c=!1),u.takeUpTo(v),u.escapeChar())}if(n&&testImplicitResolving(t,e)&&(n=!1),w="",(s||l)&&(x=0,e.charCodeAt(e.length-1)===CHAR_LINE_FEED&&(x+=1,e.charCodeAt(e.length-2)===CHAR_LINE_FEED&&(x+=1)),0===x?w="-":2===x&&(w="+")),(l&&f<y||null!==t.tag)&&(s=!1),h||(l=!1),n)t.dump=e;else if(c)t.dump="'"+e+"'";else if(s)E=fold(e,y),t.dump=">"+w+"\n"+indentString(E,d);else if(l)w||(e=e.replace(/\n$/,"")),t.dump="|"+w+"\n"+indentString(e,d);else{if(!u)throw new Error("Failed to dump scalar value");u.finish(),t.dump='"'+u.result+'"'}}else t.dump="'"+e+"'";else t.dump="''"}function fold(t,e){var r,i="",n=0,o=t.length,a=/\n+$/.exec(t);for(a&&(o=a.index+1);n<o;)n=o<(r=t.indexOf("\n",n))||-1===r?(i&&(i+="\n\n"),i+=foldLine(t.slice(n,o),e),o):(i&&(i+="\n\n"),i+=foldLine(t.slice(n,r),e),r+1);return a&&"\n"!==a[0]&&(i+=a[0]),i}function foldLine(t,e){if(""===t)return t;for(var r,i,n=/[^\s] [^\s]/g,o="",a=0,s=0,l=n.exec(t);l;)e<(r=l.index)-s&&(i=a!==s?a:r,o&&(o+="\n"),o+=t.slice(s,i),s=i+1),a=r+1,l=n.exec(t);return o&&(o+="\n"),s!==a&&t.length-s>e?o+=t.slice(s,a)+"\n"+t.slice(a+1):o+=t.slice(s),o}function simpleChar(t){return CHAR_TAB!==t&&CHAR_LINE_FEED!==t&&CHAR_CARRIAGE_RETURN!==t&&CHAR_COMMA!==t&&CHAR_LEFT_SQUARE_BRACKET!==t&&CHAR_RIGHT_SQUARE_BRACKET!==t&&CHAR_LEFT_CURLY_BRACKET!==t&&CHAR_RIGHT_CURLY_BRACKET!==t&&CHAR_SHARP!==t&&CHAR_AMPERSAND!==t&&CHAR_ASTERISK!==t&&CHAR_EXCLAMATION!==t&&CHAR_VERTICAL_LINE!==t&&CHAR_GREATER_THAN!==t&&CHAR_SINGLE_QUOTE!==t&&CHAR_DOUBLE_QUOTE!==t&&CHAR_PERCENT!==t&&CHAR_COLON!==t&&!ESCAPE_SEQUENCES[t]&&!needsHexEscape(t)}function needsHexEscape(t){return!(32<=t&&t<=126||133===t||160<=t&&t<=55295||57344<=t&&t<=65533||65536<=t&&t<=1114111)}function writeFlowSequence(t,e,r){for(var i="",n=t.tag,o=0,a=r.length;o<a;o+=1)writeNode(t,e,r[o],!1,!1)&&(0!==o&&(i+=", "),i+=t.dump);t.tag=n,t.dump="["+i+"]"}function writeBlockSequence(t,e,r,i){for(var n="",o=t.tag,a=0,s=r.length;a<s;a+=1)writeNode(t,e+1,r[a],!0,!0)&&(i&&0===a||(n+=generateNextLine(t,e)),n+="- "+t.dump);t.tag=o,t.dump=n||"[]"}function writeFlowMapping(t,e,r){for(var i,n,o,a="",s=t.tag,l=Object.keys(r),c=0,u=l.length;c<u;c+=1)o="",0!==c&&(o+=", "),n=r[i=l[c]],writeNode(t,e,i,!1,!1)&&(1024<t.dump.length&&(o+="? "),o+=t.dump+": ",writeNode(t,e,n,!1,!1)&&(a+=o+=t.dump));t.tag=s,t.dump="{"+a+"}"}function writeBlockMapping(t,e,r,i){var n,o,a,s,l,c,u="",h=t.tag,p=Object.keys(r);if(!0===t.sortKeys)p.sort();else if("function"==typeof t.sortKeys)p.sort(t.sortKeys);else if(t.sortKeys)throw new exception("sortKeys must be a boolean or a function");for(n=0,o=p.length;n<o;n+=1)c="",i&&0===n||(c+=generateNextLine(t,e)),s=r[a=p[n]],writeNode(t,e+1,a,!0,!0,!0)&&((l=null!==t.tag&&"?"!==t.tag||t.dump&&1024<t.dump.length)&&(t.dump&&CHAR_LINE_FEED===t.dump.charCodeAt(0)?c+="?":c+="? "),c+=t.dump,l&&(c+=generateNextLine(t,e)),writeNode(t,e+1,s,!0,l)&&(t.dump&&CHAR_LINE_FEED===t.dump.charCodeAt(0)?c+=":":c+=": ",u+=c+=t.dump));t.tag=h,t.dump=u||"{}"}function detectType(t,e,r){for(var i,n,o,a=r?t.explicitTypes:t.implicitTypes,s=0,l=a.length;s<l;s+=1)if(((n=a[s]).instanceOf||n.predicate)&&(!n.instanceOf||"object"==typeof e&&e instanceof n.instanceOf)&&(!n.predicate||n.predicate(e))){if(t.tag=r?n.tag:"?",n.represent){if(o=t.styleMap[n.tag]||n.defaultStyle,"[object Function]"===_toString$2.call(n.represent))i=n.represent(e,o);else{if(!_hasOwnProperty$3.call(n.represent,o))throw new exception("!<"+n.tag+'> tag resolver accepts not "'+o+'" style');i=n.represent[o](e,o)}t.dump=i}return 1}}function writeNode(t,e,r,i,n,o){t.tag=null,t.dump=r,detectType(t,r,!1)||detectType(t,r,!0);var a=_toString$2.call(t.dump);i=i&&(t.flowLevel<0||t.flowLevel>e);var s,l,c="[object Object]"===a||"[object Array]"===a;if(c&&(l=-1!==(s=t.duplicates.indexOf(r))),(null!==t.tag&&"?"!==t.tag||l||2!==t.indent&&0<e)&&(n=!1),l&&t.usedDuplicates[s])t.dump="*ref_"+s;else{if(c&&l&&!t.usedDuplicates[s]&&(t.usedDuplicates[s]=!0),"[object Object]"===a)i&&0!==Object.keys(t.dump).length?(writeBlockMapping(t,e,t.dump,n),l&&(t.dump="&ref_"+s+t.dump)):(writeFlowMapping(t,e,t.dump),l&&(t.dump="&ref_"+s+" "+t.dump));else if("[object Array]"===a)i&&0!==t.dump.length?(writeBlockSequence(t,e,t.dump,n),l&&(t.dump="&ref_"+s+t.dump)):(writeFlowSequence(t,e,t.dump),l&&(t.dump="&ref_"+s+" "+t.dump));else{if("[object String]"!==a){if(t.skipInvalid)return;throw new exception("unacceptable kind of an object to dump "+a)}"?"!==t.tag&&writeScalar(t,t.dump,e,o)}null!==t.tag&&"?"!==t.tag&&(t.dump="!<"+t.tag+"> "+t.dump)}return 1}function getDuplicateReferences(t,e){var r,i,n=[],o=[];for(inspectNode(t,n,o),r=0,i=o.length;r<i;r+=1)e.duplicates.push(n[o[r]]);e.usedDuplicates=new Array(i)}function inspectNode(t,e,r){var i,n,o;if(null!==t&&"object"==typeof t)if(-1!==(n=e.indexOf(t)))-1===r.indexOf(n)&&r.push(n);else if(e.push(t),Array.isArray(t))for(n=0,o=t.length;n<o;n+=1)inspectNode(t[n],e,r);else for(n=0,o=(i=Object.keys(t)).length;n<o;n+=1)inspectNode(t[i[n]],e,r)}function dump(t,e){var r=new State$2(e=e||{});return r.noRefs||getDuplicateReferences(t,r),writeNode(r,0,t,!0,!0)?r.dump+"\n":""}function safeDump(t,e){return dump(t,common.extend({schema:default_safe},e))}StringBuilder.prototype.takeUpTo=function(t){var e;if(t<this.checkpoint)throw(e=new Error("position should be > checkpoint")).position=t,e.checkpoint=this.checkpoint,e;return this.result+=this.source.slice(this.checkpoint,t),this.checkpoint=t,this},StringBuilder.prototype.escapeChar=function(){var t=this.source.charCodeAt(this.checkpoint),e=ESCAPE_SEQUENCES[t]||encodeHex(t);return this.result+=e,this.checkpoint+=1,this},StringBuilder.prototype.finish=function(){this.source.length>this.checkpoint&&this.takeUpTo(this.source.length)};var dump_1=dump,safeDump_1=safeDump,dumper={dump:dump_1,safeDump:safeDump_1};function deprecated(t){return function(){throw new Error("Function "+t+" is deprecated and cannot be used.")}}var Type$1=type,Schema$1=schema,FAILSAFE_SCHEMA=failsafe,JSON_SCHEMA=json,CORE_SCHEMA=core,DEFAULT_SAFE_SCHEMA=default_safe,DEFAULT_FULL_SCHEMA=default_full,load$1=loader.load,loadAll$1=loader.loadAll,safeLoad$1=loader.safeLoad,safeLoadAll$1=loader.safeLoadAll,dump$1=dumper.dump,safeDump$1=dumper.safeDump,YAMLException$1=exception,MINIMAL_SCHEMA=failsafe,SAFE_SCHEMA=default_safe,DEFAULT_SCHEMA=default_full,scan=deprecated("scan"),parse=deprecated("parse"),compose=deprecated("compose"),addConstructor=deprecated("addConstructor"),jsYaml={Type:Type$1,Schema:Schema$1,FAILSAFE_SCHEMA,JSON_SCHEMA,CORE_SCHEMA,DEFAULT_SAFE_SCHEMA,DEFAULT_FULL_SCHEMA,load:load$1,loadAll:loadAll$1,safeLoad:safeLoad$1,safeLoadAll:safeLoadAll$1,dump:dump$1,safeDump:safeDump$1,YAMLException:YAMLException$1,MINIMAL_SCHEMA,SAFE_SCHEMA,DEFAULT_SCHEMA,scan,parse,compose,addConstructor},jsYaml$1=jsYaml,SceneBundle=function(){function t(e,r){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;_classCallCheck(this,t),this.url=e,!r||isRelativeURL(r)&&!isRelativeURL(this.url)?this.path=pathForURL(this.url):this.path=r,this.path_for_parent=r||this.path,this.parent=i,this.container=null,this.parent&&(this.parent.container?this.container=this.parent.container:this.parent.isContainer()&&(this.container=this.parent))}return _createClass(t,[{key:"load",value:function(){return loadResource(this.url)}},{key:"resourceFor",value:function(t){return{url:this.urlFor(t),path:this.pathFor(t),type:this.typeFor(t)}}},{key:"urlFor",value:function(t){return isGlobal(t)?t:isRelativeURL(t)&&this.container?this.parent.urlFor(this.path_for_parent+t):addBaseURL(t,this.path)}},{key:"pathFor",value:function(t){return pathForURL(t)}},{key:"typeFor",value:function(t){return extensionForURL(t)}},{key:"isContainer",value:function(){return!1}}]),t}();function createSceneBundle(t,e,r){return new SceneBundle(t,e,r)}function isGlobal(t){return!(!t||"global."!==t.slice(0,7))}function parseResource(t){var e;try{e=jsYaml$1.safeLoad(t,{json:!0})}catch(t){throw t}return e}function loadResource(t){return new Promise((function(e,r){"string"==typeof t?Utils$1.io(t).then((function(t){try{var i=parseResource(t);e(i)}catch(t){r(t)}}),r):(t=Object.assign({},t),e(t))}))}function notNull(t){return null!=t}function wrap$1(t){return"("+t+")"}function maybeQuote(t){return"string"==typeof t?'"'+t+'"':t}function lookUp(t){return"$"===t[0]?"context['"+t.substring(1)+"']":"context.feature.properties['"+t+"']"}function nullValue(t,e){return" true "}function propertyEqual(t,e){return wrap$1(maybeQuote(e)+" === "+lookUp(t))}function propertyOr(t,e){return wrap$1(e.map((function(e){return propertyEqual(t,e)})).join(" || "))}function printNested(t,e){return wrap$1(t.filter(notNull).map((function(t){return wrap$1(t.join(" && "))})).join(" "+e+" "))}function any(t,e,r){return e&&0<e.length?printNested(e.map((function(t){return parseFilter(t,r)})),"||"):"true"}function all(t,e,r){return e&&0<e.length?printNested(e.map((function(t){return parseFilter(t,r)})),"&&"):"true"}function not(t,e,r){return"!"+wrap$1(parseFilter(e,r).join(" && "))}function none(t,e,r){return"!"+wrap$1(any(null,e,r))}function propertyMatchesBoolean(t,e){return wrap$1(lookUp(t)+(e?" != ":" == ")+"null")}function rangeMatch(t,e,r){var i,n,o=[],a=r&&"function"==typeof r.rangeTransform&&r.rangeTransform;return e.max&&(i=a?a(e.max):e.max,o.push(lookUp(t)+" < "+i)),e.min&&(n=a?n=a(e.min):e.min,o.push(lookUp(t)+" >= "+n)),wrap$1(o.join(" && "))}function parseFilter(t,e){var r=[];if("function"==typeof t)return[wrap$1(t.toString()+"(context)")];if(Array.isArray(t))return[any(null,t,e)];if(null==t)return["true"];for(var i=Object.keys(t),n=0;n<i.length;n++){var o=i[n],a=t[o],s=_typeof(a);if("string"===s||"number"===s)r.push(propertyEqual(o,a));else if("boolean"===s)r.push(propertyMatchesBoolean(o,a));else if("not"===o)r.push(not(o,a,e));else if("any"===o)r.push(any(o,a,e));else if("all"===o)r.push(all(o,a,e));else if("none"===o)r.push(none(o,a,e));else if(Array.isArray(a))r.push(propertyOr(o,a));else if("object"===s&&null!=a)(a.max||a.min)&&r.push(rangeMatch(o,a,e));else{if(null!=a)throw new Error("Unknown Query syntax: "+a);r.push(nullValue(o,a))}}return 0===i.length?["true"]:r}function filterToString(t){return wrap$1(t.join(" && "))}function buildFilter(t,e){return null==t?function(){return!0}:new Function("context","return "+filterToString(parseFilter(t,e))+";")}var reserved=["filter","draw","visible","enabled","data"],layer_cache={};function cacheKey(t){if(1<t.length){for(var e=t[0],r=1;r<t.length;r++)e+="/"+t[r];return e}return t[0]}function mergeTrees(t,e){for(var r,i=0,n=0;n<t.length;n++)t[n].length>i&&(i=t[n].length);if(0===i)return null;for(var o={visible:!0},a=0;a<i;a++)!function(i){r=[],t.forEach((function(t){t[i]&&t[i][e]&&-1===r.indexOf(t[i][e])&&r.push(t[i][e])})),0!==r.length&&(r.sort((function(t,e){return(t&&t.layer_name)>(e&&e.layer_name)?1:-1})),mergeObjects.apply(void 0,[o].concat(_toConsumableArray(r))),delete o.layer_name)}(a);return!1===o.visible?null:o}var blacklist=["any","all","not","none"],Layer=function(){function t(e){var r,i=e.layer,n=e.name,o=e.parent,a=e.draw,s=e.visible,l=e.enabled,c=e.filter,u=e.styles;if(_classCallCheck(this,t),this.id=t.id++,this.config_data=i.data,this.parent=o,this.name=n,this.full_name=this.parent?this.parent.full_name+":"+this.name:this.name,this.draw=a,this.filter=c,this.styles=u,this.is_built=!1,l=void 0===l?s:l,this.parent&&!1===this.parent.visible?this.enabled=!1:this.enabled=!1!==l,this.draw)for(var h in this.draw)this.draw[h]=null==this.draw[h]?{}:this.draw[h],"object"!==_typeof(this.draw[h])?(r="Draw group '".concat(h,"' for layer ").concat(this.full_name," is invalid, must be an object, "),log("warn",r+="but was set to `".concat(h,": ").concat(this.draw[h],"` instead")),delete this.draw[h]):this.draw[h].layer_name=this.full_name}return _createClass(t,[{key:"build",value:function(){log("trace","Building layer '".concat(this.full_name,"'")),this.buildFilter(),this.buildDraw(),this.is_built=!0}},{key:"buildDraw",value:function(){this.draw=Utils$1.stringsToFunctions(this.draw,StyleParser.wrapFunction),this.calculatedDraw=calculateDraw(this)}},{key:"buildFilter",value:function(){this.filter_original=this.filter,this.filter=Utils$1.stringsToFunctions(this.filter,StyleParser.wrapFunction);var t=_typeof(this.filter);if(null==this.filter||"object"===t||"function"===t)try{this.buildZooms(),this.buildPropMatches(),null!=this.filter&&("function"==typeof this.filter||0<Object.keys(this.filter).length)?this.filter=buildFilter(this.filter,FilterOptions):this.filter=null}catch(t){var e="Filter for layer ".concat(this.full_name," is invalid, `filter: ").concat(JSON.stringify(this.filter),"` ");log("warn",e+="failed with error '".concat(t.message,"', stack trace: ").concat(t.stack))}else{var r="Filter for layer ".concat(this.full_name," is invalid, filter value must be an object or function, ");log("warn",r+="but was set to `filter: ".concat(this.filter,"` instead"))}}},{key:"buildZooms",value:function(){var t=this.filter&&this.filter.$zoom,e=_typeof(t);if(null!=t&&"function"!==e){if(this.zooms={},"number"===e)this.zooms[t]=!0;else if(Array.isArray(t))for(var r=0;r<t.length;r++)this.zooms[t[r]]=!0;else if("object"===e&&(null!=t.min||null!=t.max))for(var i=t.min||0,n=t.max||25,o=i;o<n;o++)this.zooms[o]=!0;delete this.filter.$zoom}}},{key:"buildPropMatches",value:function(){var t=this;this.filter&&!Array.isArray(this.filter)&&"function"!=typeof this.filter&&Object.keys(this.filter).forEach((function(e){if(-1===blacklist.indexOf(e)){var r=t.filter[e],i=_typeof(r),n=Array.isArray(r);if(!n&&"string"!==i&&"number"!==i)return;"$"===e[0]?(t.context_prop_matches=t.context_prop_matches||[],t.context_prop_matches.push([e.substring(1),n?r:[r]])):(t.feature_prop_matches=t.feature_prop_matches||[],t.feature_prop_matches.push([e,n?r:[r]])),delete t.filter[e]}}))}},{key:"doPropMatches",value:function(t){if(this.feature_prop_matches)for(var e=0;e<this.feature_prop_matches.length;e++){var r=this.feature_prop_matches[e],i=t.feature.properties[r[0]];if(null==i||-1===r[1].indexOf(i))return!1}if(this.context_prop_matches)for(var n=0;n<this.context_prop_matches.length;n++){var o=this.context_prop_matches[n],a=t[o[0]];if(null==a||-1===o[1].indexOf(a))return!1}return!0}},{key:"doesMatch",value:function(t){if(!this.enabled)return!1;if(this.is_built||this.build(),null!=this.zooms&&!this.zooms[t.zoom])return!1;if(!this.doPropMatches(t))return!1;var e;if(this.filter instanceof Function)try{e=this.filter(t)}catch(e){var r="Filter for this ".concat(this.full_name,": `filter: ").concat(this.filter_original,"` ");log("error",r+="failed with error '".concat(e.message,"', stack trace: ").concat(e.stack),t.feature)}else e=null==this.filter;return!!e&&(this.children_to_parse&&(parseLayerChildren(this,this.children_to_parse,this.styles),delete this.children_to_parse),!0)}}]),t}();Layer.id=0;var LayerLeaf=function(){_inherits(e,Layer);var t=_createSuper(e);function e(r){var i;return _classCallCheck(this,e),(i=t.call(this,r)).is_leaf=!0,i}return e}(),LayerTree=function(){_inherits(e,Layer);var t=_createSuper(e);function e(r){var i;return _classCallCheck(this,e),(i=t.call(this,r)).is_tree=!0,i.layers=r.layers||[],i}return _createClass(e,[{key:"addLayer",value:function(t){this.layers.push(t)}},{key:"buildDrawGroups",value:function(t){var e=[],r=[];if(matchFeature(t,[this],e,r),0<e.length){var i=cacheKey(r);if(void 0===layer_cache[i]){for(var n=e.map((function(t){return t&&!1!==t.visible&&t.calculatedDraw})),o={},a=0;a<n.length;a++){var s=n[a];if(s)for(var l=0;l<s.length;l++){var c=s[l];for(var u in c)o[u]=!0}}for(var h in o)layer_cache[i]=layer_cache[i]||{},layer_cache[i][h]=mergeTrees(n,h),layer_cache[i][h]?(layer_cache[i][h].key=i+"/"+h,layer_cache[i][h].layers=e.map((function(t){return t&&t.full_name})),layer_cache[i][h].group=h):delete layer_cache[i][h];layer_cache[i]&&0===Object.keys(layer_cache[i]).length&&(layer_cache[i]=null)}return layer_cache[i]}}}]),e}(),FilterOptions={rangeTransform:function(t){return"string"==typeof t&&"px2"===t.trim().slice(-3)?"".concat(parseFloat(t)," * context.meters_per_pixel_sq"):t}},SceneLoader;function isReserved(t){return-1<reserved.indexOf(t)}function isEmpty(t){return 0===Object.keys(t).length}function groupProps(t){var e={},r={};for(var i in t)isReserved(i)?e[i]=t[i]:r[i]=t[i];return[e,r]}function calculateDraw(t){var e,r=[];return t.parent&&(e=t.parent.calculatedDraw||[],r.push.apply(r,_toConsumableArray(e))),r.push(t.draw),r}function parseLayerNode(t,e,r,i){var n={name:t,layer:e=null==e?{}:e,parent:r,styles:i},o=_slicedToArray(groupProps(e),2),a=o[0],s=o[1],l=isEmpty(s),c=new(l&&null!=r?LayerLeaf:LayerTree)(Object.assign(n,a));return c.enabled&&(r&&r.addLayer(c),c.children_to_parse=l?null:s),c}function parseLayerChildren(t,e,r){for(var i in e){var n,o=e[i];"object"!==_typeof(o)||Array.isArray(o)?(n="Layer value must be an object: cannot create layer '".concat(i,": ").concat(JSON.stringify(o),"'"),n+=", under parent layer '".concat(t.full_name,"'."),r[t.name]&&(n+=" The parent name '".concat(t.name,"' is also the name of a style, did you mean to create a 'draw' group"),t.parent&&(n+=" under '".concat(t.parent.name,"'")),n+=" instead?"),log("warn",n)):parseLayerNode(i,o,t,r)}}function parseLayers(t,e){layer_cache={};var r={};for(var i in t){var n=t[i];n&&(r[i]=parseLayerNode(i,n,null,e))}return r}function matchFeature(t,e,r,i){var n=!1;if(0!==e.length){for(var o=0;o<e.length;o++){var a=e[o];a.is_leaf?a.doesMatch(t)&&(n=!0,r.push(a),i.push(a.id)):a.is_tree&&a.doesMatch(t)&&(n=!0,matchFeature(t,a.layers,r,i)||(r.push(a),i.push(a.id)))}return n}}var GLOBAL_PROP_RGX=/^global\.(.+)$/,SceneLoader$1=SceneLoader={loadScene:function(t,e){var r=this,i=1<arguments.length&&void 0!==e?e:{},n=i.path,o=i.type,a=[];return this.loadSceneRecursive({url:t,path:n,type:o},null,a).then((function(t){return r.finalize(t)})).then((function(t){var e=t.config,i=t.bundle;return e?(0<a.length&&a.forEach((function(t){var e="Failed to import scene: ".concat(t.url);log("error",e,t),r.trigger("error",{type:"scene_import",message:e,error:t,url:t.url})})),{config:e,bundle:i}):Promise.reject(a[0])}))},loadSceneRecursive:function(t,e,r){var i=this,n=t.url,o=t.path,a=t.type,s=2<arguments.length&&void 0!==r?r:[];if(!n)return Promise.resolve({});var l=createSceneBundle(n,o,e,a);return l.load().then((function(t){if(null==t.import)return i.normalize(t,l),{config:t,bundle:l};Array.isArray(t.import)||(t.import=[t.import]);var e=[];return t.import.forEach((function(t){"object"===_typeof(t)&&(t=createObjectURL(new Blob([JSON.stringify(t)]))),e.push(l.resourceFor(t))})),delete t.import,Promise.all(e.map((function(t){return i.loadSceneRecursive(t,l,s)}))).then((function(e){e.forEach((function(t){return i.normalize(t.config,t.bundle)}));var r=e.map((function(t){return t.config}));return t=mergeObjects.apply(void 0,_toConsumableArray(r).concat([t])),i.normalize(t,l),{config:t,bundle:l}}))})).catch((function(t){return t.url=n,s.push(t),{}}))},normalize:function(t,e){return this.normalizeDataSources(t,e),this.normalizeFonts(t,e),this.normalizeTextures(t,e),this.hoistTextures(t,e),{config:t,bundle:e}},normalizeDataSources:function(t,e){for(var r in t.sources=t.sources||{},t.sources)this.normalizeDataSource(t.sources[r],e);return t},normalizeDataSource:function(t,e){if(t.url&&(t.url=e.urlFor(t.url)),t.scripts)for(var r in Array.isArray(t.scripts)&&(t.scripts=t.scripts.reduce((function(t,e){return t[e]=e,t}),{})),t.scripts)t.scripts[r]=e.urlFor(t.scripts[r]);return t},normalizeFonts:function(t,e){for(var r in t.fonts=t.fonts||{},t.fonts){var i;Array.isArray(t.fonts[r])?t.fonts[r].forEach((function(t){t.url=t.url&&e.urlFor(t.url)})):(i=t.fonts[r]).url=i.url&&e.urlFor(i.url)}return t},normalizeTextures:function(t,e){if(t.textures=t.textures||{},t.textures)for(var r in t.textures){var i=t.textures[r];i.url&&(i.url=e.urlFor(i.url))}},hoistTextures:function(t,e){var r=this;if(t.styles)for(var i in t.styles)!function(i){var n=t.styles[i],o=n.texture;"string"!=typeof o||t.textures[o]||(n.texture=r.hoistTexture(o,t,e)),n.material&&["emission","ambient","diffuse","specular","normal"].forEach((function(i){var o=null!=n.material[i]&&n.material[i].texture;"string"!=typeof o||t.textures[o]||(n.material[i].texture=r.hoistTexture(o,t,e))}))}(i);if(this.hoistStyleShaderUniformTextures(t,e,{include_globals:!1}),t.layers)for(var n=[t.layers];0<n.length;){var o=n.pop();if("object"===_typeof(o)&&!Array.isArray(o))for(var a in o)if("draw"===a){var s,l,c=o[a];for(var u in c)c[u].texture&&("string"!=typeof(s=c[u].texture)||t.textures[s]||(c[u].texture=this.hoistTexture(s,t,e))),c[u].outline&&c[u].outline.texture&&("string"!=typeof(l=c[u].outline.texture)||t.textures[l]||(c[u].outline.texture=this.hoistTexture(l,t,e)))}else{if(isReserved(a))continue;n.push(o[a])}}},hoistStyleShaderUniformTextures:function(t,e,r){var i=this,n=r.include_globals;if(t.styles)for(var o in t.styles){var a=t.styles[o];a.shaders&&a.shaders.uniforms&&GLSL.parseUniforms(a.shaders.uniforms).forEach((function(r){var o=r.type,a=r.value,s=r.key,l=r.uniforms;"sampler2D"!==o||"string"!=typeof a||t.textures[a]||!n&&isGlobal(a)||(l[s]=i.hoistTexture(a,t,e))}))}},hoistTexture:function(t,e,r){var i=isGlobal(t),n=i?t:r.urlFor(t),o=i?"texture-".concat(n):n;return e.textures[o]={url:n},o},applyGlobalProperties:function(t){if(!t.global||0===Object.keys(t.global).length)return t;var e=flattenProperties(t.global);return function t(r){if("string"==typeof r){var i=function t(e,r,i){var n=2<arguments.length&&void 0!==i?i:[];if(-1<n.indexOf(e))log({level:"warn",once:!0},"Global properties: cyclical reference detected",n);else{n.push(e);var o=GLOBAL_PROP_RGX.exec(e);if(o){var a=o[1];if(a){var s=r[a];if(void 0!==s)return"string"==typeof s&&GLOBAL_PROP_RGX.exec(s)?t(s,r,n):s;log({level:"warn",once:!0},"Global property not found: "+e)}else log({level:"warn",once:!0},"Invalid global property reference: "+e)}}}(r,e);void 0!==i&&(r=i)}else if(Array.isArray(r))for(var n=0;n<r.length;n++)r[n]=t(r[n]);else if("object"===_typeof(r))for(var o in r)r[o]=t(r[o]);return r}(t)},finalize:function(t){var e=t.config,r=t.bundle;return e?(e.global=e.global||{},e.scene=e.scene||{},e.cameras=e.cameras||{},e.lights=e.lights||{},e.styles=e.styles||{},e.layers=e.layers||{},e.camera&&(e.cameras.default=e.camera),0===Object.keys(e.cameras).length&&(e.cameras.default={}),0!==Object.keys(e.lights).length&&!Object.keys(e.lights).every((function(t){return!1===e.lights[t].visible}))||(e.lights.default_light={type:"directional"}),{config:e,bundle:r}):{}}};function flattenProperties(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:".",r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{},i=(i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null)?i+e:"";for(var n in t){var o=i+n,a=t[n];"object"!==_typeof(r[o]=a)||Array.isArray(a)||flattenProperties(a,e,o,r)}return r}subscribeMixin(SceneLoader);var TilePyramid=function(){function t(){_classCallCheck(this,t),this.coords={},this.max_proxy_descendant_depth=6,this.max_proxy_ancestor_depth=10}return _createClass(t,[{key:"sourceTiles",value:function(t,e){return this.coords[t.key]&&this.coords[t.key].sources&&this.coords[t.key].sources[e.name]}},{key:"addTile",value:function(t){var e=t.coords.key,r=this.coords[e];(r=r||(this.coords[e]={descendants:0})).sources||(r.sources={}),r.sources[t.source.name]||(r.sources[t.source.name]={});for(var i=(r.sources[t.source.name][t.style_zoom]=t).coords.z-1;0<=i;i--){var n=Tile.coordinateAtZoom(t.coords,i);this.coords[n.key]||(this.coords[n.key]={descendants:0}),this.coords[n.key].descendants++}}},{key:"removeTile",value:function(t){var e=this.sourceTiles(t.coords,t.source),r=t.coords.key;e&&(delete e[t.style_zoom],0===Object.keys(e).length&&(delete this.coords[r].sources[t.source.name],0===Object.keys(this.coords[r].sources).length&&(delete this.coords[r].sources,0===this.coords[r].descendants&&delete this.coords[r])));for(var i=t.coords.z-1;0<=i;i--){var n=Tile.coordinateAtZoom(t.coords,i);this.coords[n.key]&&0<this.coords[n.key].descendants&&(this.coords[n.key].descendants--,0!==this.coords[n.key].descendants||this.coords[n.key].sources||delete this.coords[n.key])}}},{key:"getAncestor",value:function(t,e){var r=t.coords,i=t.style_zoom,n=t.source,o=1<arguments.length&&void 0!==e?e:1;if(!(o>this.max_proxy_ancestor_depth)){if(i>n.max_coord_zoom){var a=this.sourceTiles(r,n);if(a)for(var s=i-1;s>=n.max_coord_zoom;s--)if(a[s]&&a[s].loaded)return a[s];i=n.max_coord_zoom}i--;var l=Tile.coordinateAtZoom(r,r.z-1),c=this.sourceTiles(l,n);return c&&c[i]&&c[i].loaded?c[i]:0<l.z?this.getAncestor({coords:l,style_zoom:i,source:n},o+1):void 0}}},{key:"getDescendants",value:function(t,e){var r=t.coords,i=t.style_zoom,n=t.source,o=1<arguments.length&&void 0!==e?e:1,a=[];if(i>=n.max_coord_zoom){var s=this.sourceTiles(r,n);if(s)for(var l=Math.max(Geo$1.default_view_max_zoom,i+this.max_proxy_descendant_depth),c=i+1;c<=l;c++)if(s[c]&&s[c].loaded)return a.push(s[c]),a;return a}if(this.coords[r.key]&&0<this.coords[r.key].descendants){i++;for(var u=Tile.childrenForCoordinate(r),h=0;h<u.length;h++){var p=u[h],f=this.sourceTiles(p,n);f&&f[i]&&f[i].loaded?a.push(f[i]):o<=this.max_proxy_descendant_depth&&p.z<=n.max_coord_zoom&&a.push.apply(a,_toConsumableArray(this.getDescendants({coords:p,source:n,style_zoom:i},o+1)))}}return a}}]),t}(),LabelMainPass=function(){function t(e,r,i,n){_classCallCheck(this,t),Object.assign(this,e),this.placed=null,this._tile=n;var o=Geo$1.unitsPerMeter(n.coords.z)*Math.pow(2,i-n.style_zoom);this.layout=Object.assign({},e.layout),this.layout.repeat_scale=.75,this.layout.repeat_distance=this.layout.repeat_distance||0,this.layout.repeat_distance/=o,this.position=Geo$1.tileSpaceToMeters(this.position,n.coords.z,n.min),this._worldToScreen=r,this._screenSpaceBoundingBox=void 0,this._boundingCircles=void 0}return _createClass(t,[{key:"getTile",value:function(){return this._tile}},{key:"isFlat",value:function(){return this.is_flat}},{key:"getScreenSpaceBoundingBox",value:function(){var t,e,r,i,n,o,a;return this._screenSpaceBoundingBox||((t=this._worldToScreen(this.position,!0))[0]+=this.offset[0],t[1]+=this.offset[1],e=this.size[0]/2+this.layout.buffer[0],r=this.size[1]/2+this.layout.buffer[1],i=t[0]-e,n=t[0]+e,o=t[1]-r,a=t[1]+r,this._screenSpaceBoundingBox={left:i,bottom:a,right:n,top:o}),this._screenSpaceBoundingBox}},{key:"getBoundingCircles",value:function(){return this._boundingCircles||(this._boundingCircles="point"===this.type?this._convertSidesToScreenSpaceCircles():this._convertCirclesToScreenSpace()),this._boundingCircles}},{key:"_convertSidesToScreenSpaceCircles",value:function(){var t=this._tile.coords.z,e=this._tile.min,r=Geo$1.tileSpaceToMeters([this.sides[0],this.sides[1]],t,e),i=Geo$1.tileSpaceToMeters([this.sides[2],this.sides[3]],t,e),n=_slicedToArray(this._worldToScreen(r,!0),2),o=n[0],a=n[1],s=_slicedToArray(this._worldToScreen(i,!0),2);return encircleLine(o,a,s[0],s[1],this.size[1]/2+this.layout.buffer[1])}},{key:"_convertCirclesToScreenSpace",value:function(){for(var t=[],e=this.circles,r=this._tile.coords.z,i=this._tile.min,n=0;n<e.length-2;n+=3){var o=Geo$1.tileSpaceToMeters([e[n],-e[n+1]],r,i),a=e[n+2]/Geo$1.unitsPerMeter(r),s=[o[0]+a,o[1]],l=this._worldToScreen(o,!0),c=this._worldToScreen(s,!0),u=MathUtils$1.getLineLength(l[0],l[1],c[0],c[1]);t.push(l[0],l[1],u)}return t}}]),t}(),labelsMainPass={mainThreadLabelCollisionPass},visible={},prev_visible={},IS_LITTLE_ENDIAN=120===new Uint8Array(new Uint32Array([305419896]).buffer)[0];function _createContainer(t,e,r,i,n){var o=t.container,a=o.label,s=o.linked,l=t.ranges;return{label:new LabelMainPass(a,r,i,n),linked:s,ranges:l,mesh:e}}function mainThreadLabelCollisionPass(t,e,r,i,n,o){prev_visible=visible,visible={};var a={},s={},l=[],c=r.worldToScreen.bind(r),u=new TextMeshHelper(o);for(var h in t.forEach((function(t){for(var r in t.meshes)t.meshes[r].forEach((function(r){if(r.labels){for(var i in u.trackMesh(r),r.labels["non-collision"]){var n=_createContainer(r.labels["non-collision"][i],r,c,e,t);n.label.text_data&&u.insertLabel(n,t)}for(var o in r.labels.collision){var l;a[o]||(l=_createContainer(r.labels.collision[o],r,c,e,t),a[o]=l.label,s[o]=l)}}}))})),s){var p=s[h];p.linked&&(p.linked=s[p.linked]),l.push(p)}var f=r.getViewport(),d=f.width,y=f.height;return Collision.startTile("main",{apply_repeat_groups:!0,return_hidden:!0,grid_index:new GridIndex(d,y,30)}),Collision.addStyle("main","main"),Collision.collide(l,"main","main").then((function(t){return t.forEach((function(t){var e,r,n,o,a,s,l=t.mesh,c=t.label.getTile();l.valid&&(!(e=0)!==t.show||i&&t.label.breach&&!prev_visible[t.label.id]||(e=1),e&&(visible[t.label.id]=!0),t.label.text_data&&u.insertLabel(t,c),r=l.vertex_layout.offset.a_shape,n=l.vertex_layout.stride,a=(o=l.vertex_layout.attribs.find((function(t){return"a_shape"===t.name}))).byte_size/o.size,r+=3*a,s=!0,t.ranges.forEach((function(t){if(s){for(var i=0;i<t[1];i++){if(l.vertex_data[t[0]+i*n+r]===e)return void(s=!1);l.vertex_data[t[0]+i*n+r]=e}u.trackMesh(l)}})))})),u.createTextures(n).then((function(){return u.updateMeshes()}))})).then((function(e){e.forEach((function(t){return t.valid&&t.upload()})),t.forEach((function(t){t.labeled=!0})),l=[],s={},a={}}))}var TextMeshHelper=function(){function t(e){_classCallCheck(this,t),this.textureManager=getTextureManager(e),this.tiles={},this.meshes=[],this.containers=[]}return _createClass(t,[{key:"insertLabel",value:function(t,e){var r=t.label.text_data,i=r.text_settings_key,n=r.text,o=r.text_info;this.containers.push(t);var a=this._ensureTextSection(e,i);a[n]?t.label.text_data.text_info=a[n]:a[n]=o}},{key:"trackMesh",value:function(t){-1===this.meshes.indexOf(t)&&this.meshes.push(t)}},{key:"updateMeshes",value:function(){var t=this;return this.containers.forEach((function(e){var r,i,n,o,a,s,l,c,u,h;e.label.text_data&&(r=e.label.getTile(),(i=e.mesh).valid?(n=e.label.type,o=e.label.text_data.text_info,t.tiles[r.id]&&t.tiles[r.id].textures&&(a=t.tiles[r.id].textures[0],i.uniforms.u_texture=a,-1===i.textures.indexOf(a)&&i.textures.push(a),"point"===n||"straight"===n?(s="point"===n?o.align[e.label.align].texcoords:o.texcoords[n].texcoord,t.setTexCoords(i,e,s)):"curved"===n&&(l=o.segments.length,c=o.texcoords_stroke,u=o.texcoords.curved,t.setTexCoords(i,e,(function(t){return t<l?c[t]:u[t-l].texcoord}))))):t.tiles[r.id]&&t.tiles[r.id].textures&&(h=t.tiles[r.id].textures[0],t.textureManager.release(h)))})),this.meshes}},{key:"setTexCoords",value:function(t,e,r){var i,n,o,a,s,l,c=r instanceof Function;c||(n=(i=_slicedToArray(r,4))[0],o=i[1],a=i[2],s=i[3],l=[[n,o],[a,o],[a,s],[n,s]]);var u=t.vertex_layout.stride,h=new DataView(t.vertex_data.buffer),p=t.vertex_layout.offset.a_texcoord;e.ranges.forEach((function(t,e){var i,n,o,a,s,f=_slicedToArray(t,3),d=f[0],y=f[1],g=f[2];c&&(n=(i=_slicedToArray(r(e),4))[0],o=i[1],a=i[2],s=i[3],l=[[n,o],[a,o],[a,s],[n,s]]);for(var v=g?y/2:0;v<y;v++){var m=l[v%4],_=d+v*u;h.setUint16(_+p,m[0]*texcoord_normalize,IS_LITTLE_ENDIAN),h.setUint16(_+p+2,m[1]*texcoord_normalize,IS_LITTLE_ENDIAN)}}))}},{key:"createTextures",value:function(t){var e=this;return Promise.all(Object.values(this.tiles).map((function(r){var i=r.id,n=r.key,o=r.texts;return e._createTexturesForTile(t,o,"labels-".concat(n,"-").concat(i),i,e.textureManager).then((function(t){t.length&&(t.forEach((function(t){e.textureManager.retain(t),1<e.textureManager.getRetainCount(t)&&e.textureManager.release(t)})),e.tiles[i].textures=t)}))})))}},{key:"_createTexturesForTile",value:function(t,e,r,i,n){var o=new CanvasText,a=o.setTextureTextPositions(e);return o.rasterize(e,a,i,r,t,n)}},{key:"_ensureTile",value:function(t){var e=t.id,r=t.key;return this.tiles[e]||(this.tiles[e]={id:e,key:r,texts:{}}),this.tiles[e]}},{key:"_ensureTextSection",value:function(t,e){var r=this._ensureTile(t).texts;return r[e]||(r[e]={}),r[e]}}]),t}(),TILE_VISIBILITY_COUNTER_THRESHOLD=30,TileManager=function(){function t(e){var r=this,i=e.scene,n=e.view;_classCallCheck(this,t),this._scene=i,this._view=n,this._visible_tiles={},this._pyramid=new TilePyramid,this._visible_coords={},this._building_tiles=null,this._renderable_tiles=[],this._active_styles=[],this._tile_visibility_counters={},this._update_labels_on_queue_check=!1,this._all_visible_tiles_are_cached=!1,this._debouncedUpdateLabels=debounce(this._updateLabels.bind(this),100,200),this._main_thread_target=["TileManager",this._scene.id].join("_"),WorkerBroker.addTarget(this._main_thread_target,this),this._keepCoordinate=this._keepCoordinate.bind(this),this._removeTilesFilter=this._removeTilesFilter.bind(this),this._removeCachedTilesFilter=this._removeCachedTilesFilter.bind(this),this._is_labeled=!1,this._tile_cache=new H.util.Cache(getMaxTileCacheSize(),(function(t,e,i){r._visible_tiles[t]&&r._visible_tiles[t]===e||e.destroy()}))}return _createClass(t,[{key:"destroy",value:function(){this._tile_cache.removeAll(),this.forEachVisibleTile((function(t){return t.destroy()})),this._visible_tiles={},this._pyramid=null,this._visible_coords={},this._scene=null,this._view=null}},{key:"keepTile",value:function(t){this._visible_tiles[t.key]=t,this._pyramid.addTile(t)}},{key:"hasTile",value:function(t){return void 0!==this._visible_tiles[t]}},{key:"_forgetTile",value:function(t){var e,r;this.hasTile(t)&&(e=this._visible_tiles[t],this._pyramid.removeTile(e),delete this._visible_tiles[t],e.loaded?this._tile_cache.add(e.key,e,getTileByteLength(e)):(r=this._tile_cache.get(e.key))?this._tile_cache.drop(r.key):e.destroy(),this._tileBuildStop(e))}},{key:"removeTile",value:function(t){this._forgetTile(t),this._scene.requestRedraw()}},{key:"forEachVisibleTile",value:function(t){for(var e in this._visible_tiles)t(this._visible_tiles[e])}},{key:"removeTiles",value:function(t){for(var e in this._visible_tiles)t(this._visible_tiles[e])&&this.removeTile(e)}},{key:"removeCachedTiles",value:function(t){var e=this;this._tile_cache.forEach((function(r,i){t(i)&&e._tile_cache.drop(r)}))}},{key:"updateTilesForView",value:function(t){var e=0<arguments.length&&void 0!==t&&t;this._visible_coords={};for(var r=this._view.findVisibleTileCoordinates(),i=0;i<r.length;i++){var n=r[i];this._visible_coords[n.key]=n}this.updateTileStates(e)}},{key:"updateTileStates",value:function(t){var e=0<arguments.length&&void 0!==t&&t;for(var r in this._all_visible_tiles_are_cached=!0,this._visible_coords)this._keepCoordinate(r,e);this._all_visible_tiles_are_cached&&(this._is_labeled=!1,this._debouncedUpdateLabels()),this._tile_cache.removeAll(this._removeCachedTilesFilter),this._updateProxyTiles(),this.removeTiles(this._removeTilesFilter),this._updateRenderableTiles(),this._updateActiveStyles()}},{key:"_removeTilesFilter",value:function(t){if(t.style_zoom===this._view.lookAtManipulator.getLookAtData().tile_level){if(this._visible_coords[t.coords.key])return!1;for(var e in this._visible_coords)if(Tile.isDescendant(t.coords,this._visible_coords[e]))return!1}return!t.isProxy()}},{key:"_updateLabels",value:function(){var t,e=this;this._building_tiles&&0!==Object.keys(this._building_tiles).length||(CanvasText.pruneTextCache(),t=this._renderable_tiles.sort(compareTileCoords),labelsMainPass.mainThreadLabelCollisionPass(t,roundPrecision(this._view.lookAtManipulator.getLookAtData().zoom,2),this._view.lookAtManipulator,this.isLoadingVisibleTiles(),this._scene.gl,this._scene.id).then((function(){e._is_labeled=!Task.hasPendingTasks(),e._scene&&e._scene.immediateRedraw(),e._update_labels_on_queue_check=!1})))}},{key:"_updateProxyTiles",value:function(){var t,e=this,r=this._view.lookAtManipulator.getZoomDirection();0!==r&&(t=!1,this.forEachVisibleTile((function(i){var n;if(i.setProxyFor(null),1===r)i.built||(n=e._pyramid.getAncestor(i))&&(n.setProxyFor(i),t=!0);else if(-1===r&&!i.built)for(var o=e._pyramid.getDescendants(i),a=0;a<o.length;a++)o[a].setProxyFor(i),t=!0})),t||this._view.lookAtManipulator.resetZoomDirection())}},{key:"getRenderableTiles",value:function(){return this._renderable_tiles}},{key:"_updateRenderableTiles",value:function(){for(var t in this._renderable_tiles=[],this._visible_tiles){var e=this._visible_tiles[t],r=this._tile_cache.get(t);e.loaded?(this._renderable_tiles.push(e),r&&r!==e&&this._tile_cache.drop(t)):r&&(r.generation===this._scene.generation?this._renderable_tiles.push(r):this._tile_cache.drop(t))}return this._renderable_tiles}},{key:"getWorkerForTile",value:function(t,e){return e.has_volatile_data?this._scene.getWorkers(WorkerType.FAKE)[0]:e.tiled?this._scene.getWorkers(WorkerType.NATIVE)[Math.abs(t.x+t.y+t.z)%this._scene.num_workers]:this._scene.getWorkers(WorkerType.NATIVE)[e.id%this._scene.num_workers]}},{key:"getActiveStyles",value:function(){return this._active_styles}},{key:"_updateActiveStyles",value:function(){for(var t=this._renderable_tiles,e={},r=0;r<t.length;r++){var i=t[r];Object.keys(i.meshes).forEach((function(t){return e[t]=!0}))}return this._active_styles=Object.keys(e),this._active_styles}},{key:"isLoadingVisibleTiles",value:function(){var t=!1;for(var e in this._visible_tiles)if(!this._visible_tiles[e].built){t=!0;break}return t}},{key:"updateTilesVisibilityCounters",value:function(){var t=this;Object.keys(this._visible_coords).forEach((function(e){e in t._tile_visibility_counters||(t._tile_visibility_counters[e]=0)}));var e=Object.keys(this._tile_visibility_counters),r=[];e.forEach((function(e){e in t._visible_coords?(t._tile_visibility_counters[e]++,t._tile_visibility_counters[e]>=TILE_VISIBILITY_COUNTER_THRESHOLD&&r.push(t._visible_coords[e])):(t._tile_visibility_counters[e]--,t._tile_visibility_counters[e]<=0&&delete t._tile_visibility_counters[e])})),r.length&&this.loadCoordinates(r)}},{key:"loadCoordinates",value:function(t){var e=this;t.sort((function(t,r){var i=e._view.lookAtManipulator.getLookAtData().position,n=Geo$1.metersPerTile(t.z)/2,o=Geo$1.metersForTile(t);o.x+=n,o.y-=n;var a=Geo$1.metersForTile(r);a.x+=n,a.y-=n;var s=Math.abs(i[0]-o.x)+Math.abs(i[1]-o.y),l=Math.abs(i[0]-a.x)+Math.abs(i[1]-a.y);return(t.center_dist=s)<(r.center_dist=l)?-1:l===s?0:1})),t.forEach((function(t){return e.loadCoordinate(t)}))}},{key:"_keepCoordinate",value:function(t,e){var r=1<arguments.length&&void 0!==e&&e,i=this._visible_coords[t];if(i.z===this._view.center_tile.z)for(var n in this._scene.sources){var o,a,s,l=this._scene.sources[n];l.builds_geometry_tiles&&l.includesTile(i,this._view.lookAtManipulator.getLookAtData().tile_level)&&(o=Tile.normalizedKey(i,l,this._view.lookAtManipulator.getLookAtData().tile_level))&&!this.hasTile(o)&&((a=r&&this._tile_cache.get(o))||(this._all_visible_tiles_are_cached=!1),s=a||new Tile({source:l,coords:i,worker:this.getWorkerForTile(i,l),style_zoom:Utils$1.zoomToTileLevel(i.z),view:this._view,sceneId:this._scene.id}),"ObjectSource"===l.config.type&&(s.syncedAt=l.getSyncedAt()),this.keepTile(s))}}},{key:"loadCoordinate",value:function(t){if(t.z===this._view.center_tile.z)for(var e in this._scene.sources){var r,i=this._scene.sources[e];i.builds_geometry_tiles&&i.includesTile(t,this._view.lookAtManipulator.getLookAtData().tile_level)&&(r=Tile.normalizedKey(t,i,this._view.lookAtManipulator.getLookAtData().tile_level),this.hasTile(r)&&this.buildTile(this._visible_tiles[r]))}}},{key:"buildTile",value:function(t,e){this._building_tiles&&this._building_tiles[t.key]||t.built&&t.generation===this._scene.generation||(this._tileBuildStart(t.key),t.build(this._scene.generation,e))}},{key:"buildTileStylesCompleted",value:function(t){var e=t.tile,r=t.progress;if(null==this._visible_tiles[e.key])Tile.abortBuild(e,this._scene.id);else if(e.generation!==this._scene.generation)Tile.abortBuild(e,this._scene.id);else{if(e.id<this._visible_tiles[e.key].id)return void Tile.abortBuild(e,this._scene.id);e=this._visible_tiles[e.key].merge(e),r.done&&(e.built=!0),e.buildMeshes(this._scene.styles,r),this.updateTileStates(),this._scene.requestRedraw()}r.done&&this._tileBuildStop(e)}},{key:"buildTileError",value:function(t){this._forgetTile(t.key),Tile.abortBuild(t,this._scene.id)}},{key:"_tileBuildStart",value:function(t){this._is_labeled=!1,this._building_tiles=this._building_tiles||{},this._building_tiles[t]=!0}},{key:"_tileBuildStop",value:function(t){this._building_tiles&&(t.source&&t.source.hasLabeledData()&&(this._update_labels_on_queue_check=!0),delete this._building_tiles[t.key],Task.removeForTile(t.id),this.checkBuildQueue())}},{key:"isReady",value:function(){return this._is_labeled&&!this.isLoadingVisibleTiles()}},{key:"checkBuildQueue",value:function(){this._building_tiles&&0!==Object.keys(this._building_tiles).length||(this._building_tiles=null,this._update_labels_on_queue_check?this._updateLabels():(this._is_labeled=!Task.hasPendingTasks(),this._scene.immediateRedraw()))}},{key:"_removeCachedTilesFilter",value:function(t,e){var r=e.source;return!this._visible_tiles[t]&&(e.generation!==this._scene.generation||"ObjectSource"===r.config.type&&r.getSyncedAt()>e.syncedAt)}}]),t}();function compareTileCoords(t,e){var r=t.coords,i=e.coords;return r.z-i.z||r.x-i.x||r.y-i.y}function roundPrecision(t,e){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:2,i=Math.pow(10,r);return Math.round(Math.floor(t*e)/e*i)/i}function getTileByteLength(t){var e=0;for(var r in t.meshes)for(var i=t.meshes[r],n=0;n<i.length;n++){var o=i[n];e+=o.buffer_size;for(var a=0;a<o.textures.length;a++)e+=t.textureManager.getByteLength(o.textures[a])}return e}function getMaxTileCacheSize(){var t=.1;return navigator&&navigator.deviceMemory?t=5*navigator.deviceMemory/100:window&&window.screen&&(t=window.screen.width/512*window.screen.height/512*.03*3,t=Math.min(t,1)),1024*t*1024*1024}var RenderState=function(){function t(e,r){_classCallCheck(this,t),r(e),this.value=e,this.setup=r}return _createClass(t,[{key:"get",value:function(){return this.value}},{key:"set",value:function(t){JSON.stringify(this.value)!==JSON.stringify(t)&&(this.setup(t),this.value=t)}}]),t}(),RenderStateManager=function t(e){_classCallCheck(this,t),this.defaults={},this.defaults.culling=!0,this.defaults.culling_face=e.BACK,this.defaults.blending=!1,this.defaults.blending_src=e.ONE_MINUS_SRC_ALPHA,this.defaults.blending_dst=e.ONE_MINUS_SRC_ALPHA,this.defaults.blending_src_alpha=e.ONE,this.defaults.blending_dst_alpha=e.ONE_MINUS_SRC_ALPHA,this.defaults.depth_write=!0,this.defaults.depth_test=!0,e.depthFunc(e.LESS),this.culling=new RenderState({cull:this.defaults.culling,face:this.defaults.culling_face},(function(t){t.cull?(e.enable(e.CULL_FACE),e.cullFace(t.face)):e.disable(e.CULL_FACE)})),this.blending=new RenderState({blend:this.defaults.blending,src:this.defaults.blending_src,dst:this.defaults.blending_dst,src_alpha:this.defaults.blending_src_alpha,dst_alpha:this.defaults.blending_dst_alpha},(function(t){t.blend?(e.enable(e.BLEND),t.src_alpha&&t.dst_alpha?e.blendFuncSeparate(t.src,t.dst,t.src_alpha,t.dst_alpha):e.blendFunc(t.src,t.dst)):e.disable(e.BLEND)})),this.depth_write=new RenderState({depth_write:this.defaults.depth_write},(function(t){e.depthMask(t.depth_write)})),this.depth_test=new RenderState({depth_test:this.defaults.depth_test},(function(t){t.depth_test?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST)}))},MediaCapture=function(){function t(){_classCallCheck(this,t),this.canvas=null,this.gl=null,this.screenshot_canvas=null,this.screenshot_context=null,this.queue_screenshot=null,this.video_capture=null}return _createClass(t,[{key:"setCanvas",value:function(t,e){this.canvas=t,this.gl=e}},{key:"screenshot",value:function(t){var e=this,r=(0<arguments.length&&void 0!==t?t:{}).background;return null!=this.queue_screenshot||(this.queue_screenshot={background:r},this.queue_screenshot.promise=new Promise((function(t,r){e.queue_screenshot.resolve=t,e.queue_screenshot.reject=r}))),this.queue_screenshot.promise}},{key:"completeScreenshot",value:function(){if(null!=this.queue_screenshot){var t=this.canvas.width,e=this.canvas.height,r=new Uint8Array(t*e*4);this.gl.readPixels(0,0,t,e,this.gl.RGBA,this.gl.UNSIGNED_BYTE,r);for(var i=(i=this.queue_screenshot.background)&&"transparent"!==i?StyleParser.parseColor(i).slice(0,3).map((function(t){return 255*t})):null,n=new Uint8ClampedArray(t*e*4),o=0;o<e;o++)for(var a=0;a<t;a++){var s=4*((e-o-1)*t+a),l=4*(o*t+a),c=r[3+s];n[0+l]=255*r[0+s]/c,n[1+l]=255*r[1+s]/c,n[2+l]=255*r[2+s]/c,n[3+l]=c,i&&(c/=255,n[0+l]=n[0+l]*c+i[0]*(1-c),n[1+l]=n[1+l]*c+i[1]*(1-c),n[2+l]=n[2+l]*c+i[2]*(1-c),n[3+l]=255)}this.screenshot_canvas=this.screenshot_canvas||document.createElement("canvas");var u=this.screenshot_canvas;u.width=t,u.height=e,this.screenshot_context=this.screenshot_context||u.getContext("2d");var h=this.screenshot_context,p=new ImageData(n,t,e);h.putImageData(p,0,0);for(var f=u.toDataURL("image/png"),d=atob(f.slice(22)),y=new Uint8Array(d.length),g=0;g<d.length;++g)y[g]=d.charCodeAt(g);var v=new Blob([y],{type:"image/png"});this.queue_screenshot.resolve({url:f,blob:v,type:"png"}),this.queue_screenshot=null}}},{key:"startVideoCapture",value:function(){var t=this;if("function"!=typeof window.MediaRecorder||!this.canvas||"function"!=typeof this.canvas.captureStream)return log("warn","Video capture (Canvas.captureStream and/or MediaRecorder APIs) not supported by browser"),!1;if(this.video_capture)return log("warn","Video capture already in progress, call Scene.stopVideoCapture() first"),!1;try{var e=this.video_capture={};e.chunks=[],e.stream=this.canvas.captureStream(),e.options={mimeType:"video/webm"},e.media_recorder=new MediaRecorder(e.stream,e.options),e.media_recorder.ondataavailable=function(r){var i,n;0<r.data.size&&e.chunks.push(r.data),e.resolve&&(n=createObjectURL(i=new Blob(e.chunks,{type:e.options.mimeType})),e.stream&&(e.stream.getTracks()||[]).forEach((function(t){t.stop(),e.stream.removeTrack(t)})),e.stream=null,e.media_recorder=null,t.video_capture=null,e.resolve({url:n,blob:i,type:"webm"}))},e.media_recorder.start()}catch(t){return this.video_capture=null,log("error","Scene video capture failed",t),!1}return!0}},{key:"stopVideoCapture",value:function(){var t=this;return this.video_capture?(this.video_capture.promise=new Promise((function(e,r){t.video_capture.resolve=e,t.video_capture.reject=r})),this.video_capture.media_recorder.stop(),this.video_capture.promise):(log("warn","No scene video capture in progress, call Scene.startVideoCapture() first"),Promise.resolve({}))}}]),t}(),SceneWorker=function(){function t(){_classCallCheck(this,t),this.sources={},this.styles={},this.layers={},this.tiles={},this._isConfigured=!1}return _createClass(t,[{key:"init",value:function(t,e,r,i,n,o,a){return this.setMeshVariantMaxLife(a),this.scene_id=t,this.textureManager=getTextureManager(t),this._worker_id=e,log.setLevel(r),Utils$1.device_pixel_ratio=i,VertexElements.setElementIndexUint(n),FeatureSelection.setPrefix(this._worker_id),this._style_manager=new StyleManager,this._importExternalScripts(o),Label.id_prefix=e,this._isConfigured=!1,e}},{key:"dispose",value:function(){this._last_config_sources=null,this._config_sources=null,this.sources=null,this._style_manager=null,this.styles=null,this.layers=null,this.tiles=null}},{key:"_importExternalScripts",value:function(t){var e;0!==t.length&&(log("debug","loading custom data source scripts in worker:",t),e=Object.getOwnPropertyNames(window),importScripts.apply(void 0,_toConsumableArray(t)),Object.getOwnPropertyNames(window).forEach((function(t){-1===e.indexOf(t)&&(self[t]=window[t])})))}},{key:"updateConfig",value:function(t,e){var r=t.config,i=t.generation,n=t.introspection;for(var o in r=JSON.parse(r),mergeDebugSettings(e),this._generation=i,this._isConfigured=!1,r.layers)r.layers[o]&&(r.layers[o].data=Utils$1.stringsToFunctions(r.layers[o].data));this.global=Utils$1.stringsToFunctions(r.global),this._createDataSources(r),r.styles=Utils$1.stringsToFunctions(r.styles,StyleParser.wrapFunction),this.styles=this._style_manager.build(r.styles),self.is_fake_worker=Thread.is_main,this._style_manager.initStyles({generation:this._generation,styles:this.styles,sources:this.sources,introspection:n,id:this.scene_id}),delete self.is_fake_worker,this.layers=parseLayers(r.layers,this._style_manager.styles),this._configuring=this._syncTextures(r.textures)}},{key:"setMeshVariantMaxLife",value:function(t){this.meshVariantMaxLife=t}},{key:"_createDataSources",value:function(t){var e=this;this._last_config_sources=this._config_sources||{},this._config_sources=t.sources;var r=this.sources,i=[];for(var n in t.sources=Utils$1.stringsToFunctions(t.sources),this.sources={},self.is_fake_worker=Thread.is_main,t.sources)if(JSON.stringify(this._last_config_sources[n])!==JSON.stringify(t.sources[n])){var o=void 0;try{o=DataSource.create(Object.assign({},t.sources[n],{name:n}),this.sources)}catch(r){log("error","Error creating source.",r.message,t.sources[n]);continue}o&&(this.sources[n]=o,i.push(n))}else this.sources[n]=r[n];delete self.is_fake_worker,i.forEach((function(t){for(var r in e.tiles)e.tiles[r].source===t&&delete e.tiles[r]}))}},{key:"awaitConfiguration",value:function(){return this._configuring}},{key:"_onConfig",value:function(t){var e=this;if((this._isConfigured=!0)!==t.loaded)t.loading=!0,t.loaded=!1,t.error=null,this._loadTileSourceData(t).then((function(){if(e.getTile(t.id)){t.loading=!1,t.loaded=!0;try{Tile.buildGeometry(t,e)}catch(r){t.error=r.toString(),WorkerBroker.postMessage("TileManager_".concat(e.scene_id,".buildTileError"),Tile.slice(t))}}else log("trace","stop tile build after data source load because tile was removed. Key: ".concat(t.key,", id: ").concat(t.id))}),(function(r){t.loading=!1,t.loaded=!1,t.error=r.stack,log("error","tile load error for tile with key ".concat(t.key," and id ").concat(t.id,": ").concat(t.error)),WorkerBroker.postMessage("TileManager_".concat(e.scene_id,".buildTileError"),Tile.slice(t))}));else{log("trace","used worker cache for tile with key ".concat(t.key," and id ").concat(t.id));try{Tile.buildGeometry(t,this)}catch(e){t.error=e.toString(),WorkerBroker.postMessage("TileManager_".concat(this.scene_id,".buildTileError"),Tile.slice(t))}}}},{key:"buildTile",value:function(t){var e,r=t.tile,i=this.getTile(r.id);i&&i.loading||(r=this.tiles[r.id]=Object.assign(i||{},r),this._isConfigured?this._onConfig(r):(e=this).awaitConfiguration().then((function(){return e._onConfig(r)})))}},{key:"_loadTileSourceData",value:function(t){return this.sources[t.source]?this.sources[t.source].load(t):(t.source_data={},Promise.resolve(t))}},{key:"getTile",value:function(t){return this.tiles[t]}},{key:"removeTile",value:function(t){var e=this.tiles[t];null!=e&&(!0===e.loading&&(log("trace","cancel tile load for tile id ".concat(t)),e.loading=!1,Tile.cancel(e)),delete this.tiles[t],log("trace","remove tile from cache, tile id: ".concat(t)))}},{key:"queryFeatures",value:function(t){var e=this,r=t.filter,i=t.visible,n=t.geometry,o=t.tile_ids,a=[],s=o.map((function(t){return e.tiles[t]})).filter((function(t){return t}));return null!=r&&(r=-1<["{","["].indexOf(r[0])?JSON.parse(r):r,r=Utils$1.stringsToFunctions(r,StyleParser.wrapFunction)),r=buildFilter(r,FilterOptions),s.forEach((function(t){for(var o in t.source_data.layers)!function(o){t.source_data.layers[o].features.forEach((function(s){var l,c;!0===i&&s.generation!==e._generation||!1===i&&s.generation===e._generation||((l=StyleParser.getFeatureParseContext(s,t,e.global)).source=t.source,l.layer=o,r(l)&&(c={type:s.type,properties:s.properties},!0===n&&(c.geometry=Geo$1.copyGeometry(s.geometry),Geo$1.tileSpaceToLatlng(c.geometry,t.coords.z,t.min)),a.push(c)))}))}(o)})),a}},{key:"resetFeatureSelection",value:function(){FeatureSelection.reset()}},{key:"_syncTextures",value:function(t){var e=[];return t&&e.push.apply(e,_toConsumableArray(Object.keys(t))),log("trace","sync textures to worker:",e),0<e.length?this.textureManager.syncTexturesToWorker(e):Promise.resolve()}},{key:"profile",value:function(t){console.profile("worker ".concat(this._worker_id,": ").concat(t))}},{key:"profileEnd",value:function(t){console.profileEnd("worker ".concat(this._worker_id,": ").concat(t))}},{key:"terminate",value:function(){this.dispose()}}]),t}();(Thread.is_worker||self.H&&self.H.DEBUG)&&WorkerBroker.addTarget("self",new SceneWorker);var Scene=function(){function t(e,r){_classCallCheck(this,t),r=r||{},subscribeMixin(this),this.id=t.id++,this.textureManager=getTextureManager(this.id),this.initialized=!1,this.initializing=null,this.sources={},this.view=new View(this,r),this.tile_manager=new TileManager({scene:this,view:this.view}),this.num_workers=r.numWorkers||2,!0===r.disableVertexArrayObjects&&(VertexArrayObject.disabled=!0),Utils$1.device_pixel_ratio=r.devicePixelRatio,this.config=null,this.config_source=e,this.config_bundle=null,this.last_valid_config_source=null,this.styles=null,this.style_manager=new StyleManager,this.building=null,this.dirty=!0,r.preUpdate&&this.subscribe({pre_update:r.preUpdate}),r.postUpdate&&this.subscribe({post_update:r.postUpdate}),this.render_loop=!r.disableRenderLoop,this.render_loop_active=!1,this.render_loop_stop=!1,this.render_count=0,this.last_render_count=0,this.render_count_changed=!1,this.frame=0,this.last_main_render=-1,this.last_selection_render=-1,this.media_capture=new MediaCapture,this.selection=null,this.introspection=!0===r.introspection,this.viewport=r.viewport,this.adjustMeshVariantMaxLife(),this.container=r.container,this.canvas=null,this.contextOptions=r.webGLContextOptions,this.lights=null,this.background=null,this.createListeners(),this.updating=0,this.generation=t.generation,this.last_complete_generation=t.generation,this.log_level=r.logLevel||"warn",log.setLevel(this.log_level),log.reset()}return _createClass(t,[{key:"load",value:function(t,e){var r=this,i=0<arguments.length&&void 0!==t?t:null,n=1<arguments.length&&void 0!==e?e:{};return this.initializing||(log.reset(),this.updating++,this.initialized=!1,this.initial_build_time=null,(n="string"==typeof n?{base_path:n}:n).blocking=void 0===n.blocking||n.blocking,!1!==this.render_loop&&this.setupRenderLoop(),this.createCanvas(),this.textureManager.destroy(this.gl),this.initializing=this.loadScene(i,n).then((function(){return r.createWorkers()})).then((function(){r.resetFeatureSelection();var t="object"===_typeof(r.config_source)||r.hasSubscribersFor("load"),e=r.updateConfig({serialize_funcs:t,normalize:!1,load_event:!0,fade_in:!0});if(!0===n.blocking)return e})).then((function(){r.updating--,r.initializing=null,r.initialized=!0,r.last_valid_config_source=r.config_source,r.last_valid_options={base_path:n.base_path,file_type:n.file_type},r.requestRedraw()})).catch((function(t){var e,i;if(r.initializing=null,r.updating=0,i="YAMLException"===t.name?(e="yaml","Error parsing scene YAML"):"Error initializing scene",r.trigger("error",{type:e,message:i,error:t,url:r.config_source}),i="Scene.load() failed to load ".concat(r.config_source,": ").concat(t.message),r.last_valid_config_source)return log("warn",i,t),log("info","Scene.load() reverting to last valid configuration"),r.load(r.last_valid_config_source,r.last_valid_base_path);throw log("error",i,t),t}))),this.initializing}},{key:"destroy",value:function(){var t;this.initialized=!1,this.render_loop_stop=!0,this.destroyListeners(),this.canvas&&this.canvas.parentNode&&(this.canvas.parentNode.removeChild(this.canvas),this.canvas=null),this.container=null,this.selection&&this.selection.destroy(),this.gl&&(this.textureManager.destroy(this.gl),this.style_manager.destroy(this.gl),this.styles={},ShaderProgram.reset(),(t=this.gl.getExtension("WEBGL_lose_context"))&&t.loseContext(),this.gl=null),this.sources={},this.tile_manager.destroy(),this.tile_manager=null,this.destroyWorkers(),log.reset()}},{key:"createCanvas",value:function(){if(!this.canvas){this.container=this.container||document.body,this.canvas=document.createElement("canvas"),this.canvas.style.position="absolute",this.canvas.style.top=0,this.canvas.style.left=0,this.container.style.backgroundColor="transparent",this.container.appendChild(this.canvas);try{this.gl=Context$1.getContext(this.canvas,Object.assign({alpha:!0,premultipliedAlpha:!1,stencil:!0,device_pixel_ratio:Utils$1.device_pixel_ratio},this.contextOptions))}catch(t){throw new Error("Couldn't create WebGL context. Your browser may not support WebGL, or it's turned off? Visit http://webglreport.com/ for more info.")}this.handleViewportUpdate(),VertexArrayObject.init(this.gl),this.render_states=new RenderStateManager(this.gl),this.media_capture.setCanvas(this.canvas,this.gl)}}},{key:"getWorkerUrl",value:function(){var t,e;if(void 0!==__worker_src__&&(e="("+__worker_src__+")()",__worker_src_origin__&&""!==__worker_src_map__&&(e+="\n//# sourceMappingURL="+__worker_src_origin__.slice(0,__worker_src_origin__.lastIndexOf("/")+1)+__worker_src_map__),t=createObjectURL(new Blob([e],{type:"application/javascript"}))),!t)throw new Error("Couldn't find internal Tangram source variable (may indicate the library did not build correctly)");return t}},{key:"updateExternalScripts",value:function(){var t=_toConsumableArray(this.external_scripts||[]),e=[];if(this.config.scene.scripts)for(var r in this.config.scene.scripts)-1===e.indexOf(this.config.scene.scripts[r])&&e.push(this.config.scene.scripts[r]);for(var i in this.config.sources){var n=this.config.sources[i];if(n.scripts)for(var o in n.scripts)-1===e.indexOf(n.scripts[o])&&e.push(n.scripts[o])}return this.external_scripts=e,!(this.external_scripts.length===t.length&&this.external_scripts.every((function(e,r){return e===t[r]})))}},{key:"createWorkers",value:function(){return this.updateExternalScripts()&&this.destroyWorkers(),this._workers?Promise.resolve():this.makeWorkers(this.getWorkerUrl())}},{key:"makeWorkers",value:function(t){var e=this,r=!!this.gl.getExtension("OES_element_index_uint"),i=[];this._workers=[];for(var n=0;n<this.num_workers;n++)!function(){var o=new Worker(t);e._workers[n]=o,WorkerBroker.addWorker(o),log("debug","Scene.makeWorkers: initializing worker ".concat(n));var a=n;i.push(WorkerBroker.postMessage(o,"self.init",e.id,n,e.log_level,Utils$1.device_pixel_ratio,r,e.external_scripts,e.meshVariantMaxLife).then((function(t){return log("debug","Scene.makeWorkers: initialized worker ".concat(t)),t}),(function(t){return log("error","Scene.makeWorkers: failed to initialize worker ".concat(a,":"),t),Promise.reject(t)})))}();var o=new SceneWorker;return this._workers.push(o),i.push(o.init(this.id,n,this.log_level,Utils$1.device_pixel_ratio,r,[],this.meshVariantMaxLife)),this.next_worker=0,Promise.all(i).then((function(){log.setWorkers(e._workers.slice(0,e.num_workers)),revokeObjectURL(t)}))}},{key:"getWorkers",value:function(t){return this._workers.filter((function(e){switch(t){case WorkerType.NATIVE:return e instanceof Worker;case WorkerType.FAKE:return e instanceof SceneWorker;default:return!0}}))}},{key:"destroyWorkers",value:function(){this.selection=null,Array.isArray(this._workers)&&(log.setWorkers(null),this._workers.forEach((function(t){t.terminate()})),this._workers=null)}},{key:"ready",value:function(){return!(!this.view.ready()||0===Object.keys(this.sources).length)}},{key:"handleViewportUpdate",value:function(){var t=this.viewport,e=t.width,r=t.height;0<e&&0<r&&(this.dirty=!0,this.view.handleViewportUpdate(),this.gl&&Context$1.resize(this.gl,e,r,Utils$1.device_pixel_ratio)),this.adjustMeshVariantMaxLife()&&this.syncMeshVariantMaxLife()}},{key:"adjustMeshVariantMaxLife",value:function(){var t=this.viewport,e=t.width,r=t.height,i=Utils$1.device_pixel_ratio,n=e/i/256*(r/i/256),o=Math.max(Math.ceil(2*n),8);if(this.meshVariantMaxLife!==o)return this.meshVariantMaxLife=o,!0}},{key:"syncMeshVariantMaxLife",value:function(){this._workers&&WorkerBroker.postMessage(this._workers,"self.setMeshVariantMaxLife",this.meshVariantMaxLife)}},{key:"requestRedraw",value:function(){this.dirty=!0}},{key:"immediateRedraw",value:function(){this.dirty=!0,this.update()}},{key:"renderLoop",value:function(){this.render_loop_active=!0,this.initialized&&this.update(),Task.setState({user_moving_view:this.view.user_input_active}),Task.processAll(),this.render_loop_stop?(this.render_loop_stop=!1,this.render_loop_active=!1):window.requestAnimationFrame(this.renderLoop.bind(this))}},{key:"setupRenderLoop",value:function(){var t=this;this.render_loop_active||setTimeout((function(){t.renderLoop()}),0)}},{key:"update",value:function(){var t=this.dirty,e=!!this.selection&&this.selection.hasPendingRequests(),r=!(!1===t&&!1===e||!1===this.initialized||0<this.updating||!1===this.ready());return this.trigger("pre_update",r),this.view.update(),r&&(this.dirty=!1,this.render({main:t,selection:e}),this.updateViewComplete(),this.media_capture.completeScreenshot(),this.trigger("post_update",r),!0!==this.animated&&!this.view.isAnimating()||(this.dirty=!0),this.frame++,log("trace","Scene.render()"),!0)}},{key:"render",value:function(t){var e=this,r=t.main,i=t.selection,n=this.gl;if(Object.keys(this.lights).forEach((function(t){return e.lights[t].update()})),r&&(this.render_count=this.renderPass(),this.last_main_render=this.frame),i){if(this.view.panning||this.view.user_input_active)return void this.selection.clearPendingRequests();(this.last_selection_render<this.last_main_render||this.selection.has_dirty_buffer)&&(this.selection.bind(),this.renderPass("selection_program",{allow_blend:!1}),n.bindFramebuffer(n.FRAMEBUFFER,null),n.viewport(0,0,this.canvas.width,this.canvas.height),n.clearColor.apply(n,_toConsumableArray(this.background.color)),this.last_selection_render=this.frame,this.selection.has_dirty_buffer=!1),this.selection.read(this.tile_manager.getRenderableTiles()),this.selection.has_dirty_buffer&&this.render({main:!1,selection:i})}return this.render_count_changed=!1,this.render_count!==this.last_render_count&&(this.render_count_changed=!0),this.last_render_count=this.render_count,!0}},{key:"renderPass",value:function(t,e){var r=this,i=0<arguments.length&&void 0!==t?t:"program",n=(1<arguments.length&&void 0!==e?e:{}).allow_blend,o=this.gl;n=null==n||n,this.clearFrame();for(var a,s=Style.sortByBlendOrderWithinLayers(this.tile_manager.getActiveStyles().map((function(t){return r.styles[t]})).filter((function(t){return t}))),l=0,c=0,u=0;u<s.length;u++){var h,p,f=s[u],d=c-(h=parseInt(f.name));(f.clean_depth||d)&&(this.render_states.depth_write.value.depth_write?o.clear(o.DEPTH_BUFFER_BIT):(o.depthMask(!0),o.clear(o.DEPTH_BUFFER_BIT),o.depthMask(!1)),d&&(c=h)),f.blend!==a&&(p=Object.assign({},Style.render_states[f.blend],{blend:n&&f.blend}),this.setRenderState(p));var y="translucent"===f.blend&&"program"===i;y&&(this.gl.colorMask(!1,!1,!1,!1),this.renderStyle(f.name,i),this.gl.colorMask(!0,!0,!0,!0),this.gl.depthFunc(this.gl.EQUAL),this.gl.enable(this.gl.STENCIL_TEST),this.gl.clear(this.gl.STENCIL_BUFFER_BIT),this.gl.stencilFunc(this.gl.EQUAL,this.gl.ZERO,255),this.gl.stencilOp(this.gl.KEEP,this.gl.KEEP,this.gl.INCR)),l+=this.renderStyle(f.name,i),y&&(this.gl.disable(this.gl.STENCIL_TEST),this.gl.depthFunc(this.gl.LESS)),a=f.blend}return l}},{key:"renderStyle",value:function(t,e){for(var r,i=this,n=this.styles[t],o=!0,a=0,s=this.tile_manager.getRenderableTiles(),l=Math.max.apply(Math,_toConsumableArray(s.map((function(e){return e.meshes[t]?Math.max.apply(Math,_toConsumableArray(e.meshes[t].map((function(t){return t.variant.order})))):-1})))),c=0;c<l+1;c++){var u=function(l){for(var c=0;c<s.length;c++){var u=s[c];if(null!=u.meshes[t]&&u.shouldProxyForStyle(t))for(var h=u.meshes[t].filter((function(t){return t.variant.order===l})),p=0,f=h.length;p<f;p+=1){var d=h[p];if(!0===o&&(o=!1,!(r=i.setupStyle(n,e))))return{v:0};i.view.setupTile(u,r),i.selection.setupDiscards(r),n.render(d)&&i.requestRedraw(),a+=d.geometry_count}}}(c);if("object"===_typeof(u))return u.v}return a}},{key:"setupStyle",value:function(t,e){var r;try{if(!(r=t.getProgram(e)))return}catch(e){return void this.trigger("warning",{type:"styles",message:"Error compiling style ".concat(t.name),style:t,shader_errors:t.program&&t.program.shader_errors})}for(var i in r.use(),t.setup(),this.view.setupProgram(r),this.lights)this.lights[i].setupProgram(r);return r}},{key:"clearFrame",value:function(){this.initialized&&(this.render_states.depth_write.set({depth_write:!0}),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT|this.gl.STENCIL_BUFFER_BIT))}},{key:"setRenderState",value:function(t){var e,r,i=0<arguments.length&&void 0!==t?t:{},n=i.depth_test,o=i.depth_write,a=i.cull_face,s=i.blend;this.initialized&&(e=this.render_states,n=!1!==n&&e.defaults.depth_test,o=!1!==o&&e.defaults.depth_write,a=!1!==a&&e.defaults.culling,s=null!=s?s:e.defaults.blending,r=this.gl,e.depth_test.set({depth_test:n}),e.depth_write.set({depth_write:o}),e.culling.set({cull:a,face:e.defaults.culling_face}),s&&"opaque"!==s?"overlay"===s||"inlay"===s||"translucent"===s?e.blending.set({blend:!0,src:r.SRC_ALPHA,dst:r.ONE_MINUS_SRC_ALPHA,src_alpha:r.ONE,dst_alpha:r.ONE_MINUS_SRC_ALPHA}):"add"===s?e.blending.set({blend:!0,src:r.ONE,dst:r.ONE}):"multiply"===s&&e.blending.set({blend:!0,src:r.ZERO,dst:r.SRC_COLOR}):e.blending.set({blend:!1}))}},{key:"getFeatureAt",value:function(t,e,r){var i,n=e.radius,o=e.top_most_only;this.initialized?(i={x:t.x/this.view.size.css.width,y:t.y/this.view.size.css.height},n=0<n?{x:n/this.view.size.css.width,y:n/this.view.size.css.height}:null,this.selection.getFeatureAt(i,{radius:n,top_most_only:o},r)):log("debug","Scene.getFeatureAt() called before scene was initialized")}},{key:"queryFeatures",value:function(t){var e=0<arguments.length&&void 0!==t?t:{},r=e.filter,i=e.unique,n=void 0===i||i,o=e.group_by,a=void 0===o?null:o,s=e.visible,l=void 0===s?null:s,c=e.geometry,u=void 0!==c&&c,h=(r=Utils$1.serializeWithFunctions(r),this.tile_manager.getRenderableTiles().map((function(t){return t.id})));return WorkerBroker.postMessage(this._workers,"self.queryFeatures",{filter:r,visible:l,geometry:u,tile_ids:h}).then((function(t){var e=[],r={},i={},o=(n="string"==typeof n?[n]:n)&&function(t){return JSON.stringify(Array.isArray(n)?sliceObject(t,n):t)},s=(a=("string"==typeof a||Array.isArray(a))&&a)&&function(t){return Array.isArray(a)?JSON.stringify(sliceObject(t,a)):t[a]};return t.forEach((function(t){return t.forEach((function(t){if(o){var n=o(t);if(r[n])return;r[n]=!0}var a;s?(a=s(t.properties),i[a]=i[a]||[],i[a].push(t)):e.push(t)}))})),s?i:e}))}},{key:"loadScene",value:function(t,e){var r=this,i=0<arguments.length&&void 0!==t?t:null,n=1<arguments.length&&void 0!==e?e:{},o=n.base_path,a=n.file_type;return this.config_source=i||this.config_source,"string"==typeof this.config_source?this.base_path=pathForURL(o||this.config_source):this.base_path=pathForURL(o),this.config_path=this.base_path,SceneLoader$1.loadScene(this.config_source,{path:this.base_path,type:a}).then((function(t){var e=t.config,i=t.bundle;return r.config=e,r.config_bundle=i,r.config}))}},{key:"createDataSources",value:function(){var t=this,e=[],r=Object.keys(this.sources),i=0;for(var n in this.config.sources){var o=this.config.sources[n],a=this.sources[n];try{var s=Object.assign({},o,{name:n,id:i++});if(this.sources[n]=DataSource.create(s,this.sources),!this.sources[n])throw{}}catch(r){delete this.sources[n];var l="Could not create data source: ".concat(r.message);log("warn","Scene: ".concat(l),o),this.trigger("warning",{type:"sources",source:o,message:l})}DataSource.sameConfig(this.sources[n],a)||e.push(n)}for(var c in r.forEach((function(r){t.config.sources[r]||(delete t.sources[r],e.push(r))})),0<e.length&&this.tile_manager.removeTiles((function(t){return-1<e.indexOf(t.source.name)})),this.config.layers){var u=this.config.layers[c];!1!==u.enabled&&u.data&&this.sources[u.data.source]&&(this.sources[u.data.source].builds_geometry_tiles=!0)}}},{key:"loadTextures",value:function(){var t=this;return this.textureManager.createFromObject(this.gl,this.config.textures).then((function(){return t.textureManager.createDefault(t.gl)}))}},{key:"updateStyles",value:function(){if(!this.initialized&&!this.initializing)throw new Error("Scene.updateStyles() called before scene was initialized");for(var t in this.styles=this.style_manager.build(this.config.styles),this.style_manager.initStyles(this),this.styles)this.styles[t].setGL(this.gl);this.dirty=!0}},{key:"createLights",value:function(){for(var t in this.lights={},this.config.lights){var e;this.config.lights[t]&&"object"===_typeof(this.config.lights[t])&&((e=this.config.lights[t]).name=t.replace("-","_"),e.visible=!1!==e.visible,e.visible&&(this.lights[e.name]=Light.create(this.view,e)))}Light.inject(this.lights)}},{key:"setBackground",value:function(){var t,e=this.config.scene.background;this.background={},e&&e.color&&(this.background.color=StyleParser.parseColor(e.color)),this.background.color||(this.background.color=[0,0,0,0]),1===this.background.color[3]?this.canvas.style.backgroundColor="rgba(".concat(this.background.color.map((function(t){return Math.floor(255*t)})).join(", "),")"):this.canvas.style.backgroundColor="transparent",(t=this.gl).clearColor.apply(t,_toConsumableArray(this.background.color))}},{key:"setIntrospection",value:function(t){var e=this;return t!==this.introspection?(this.introspection=t||!1,this.updating++,this.updateConfig({normalize:!1}).then((function(){return e.updating--}))):Promise.resolve()}},{key:"updateConfig",value:function(e){var r=0<arguments.length&&void 0!==e?e:{},i=r.load_event,n=void 0!==i&&i,o=r.serialize_funcs,a=r.normalize,s=void 0===a||a;r.fade_in,this.generation=++t.generation,this.updating++,this.config=SceneLoader$1.applyGlobalProperties(this.config),s?SceneLoader$1.normalize(this.config,this.config_bundle):(SceneLoader$1.hoistStyleShaderUniformTextures(this.config,this.config_bundle,{include_globals:!0}),SceneLoader$1.normalizeTextures(this.config,this.config_bundle)),this.trigger(n?"load":"update",{config:this.config}),this.style_manager.init(),this.createLights(),this.createDataSources(),this.loadTextures(),this.setBackground(),FontManager.loadFonts(this.config.fonts),this.updateStyles();var l=this.syncConfigToWorker({serialize_funcs:o});return this.updating--,this.view.updateBounds(),this.requestRedraw(),l}},{key:"syncConfigToWorker",value:function(t){var e=(0<arguments.length&&void 0!==t?t:{}).serialize_funcs,r=void 0===e||e?Utils$1.serializeWithFunctions(this.config):JSON.stringify(this.config);return WorkerBroker.postMessage(this._workers,"self.updateConfig",{config:r,generation:this.generation,introspection:this.introspection},debugSettings$1)}},{key:"createListeners",value:function(){var t=this;this.listeners={},this.listeners.view={move:function(){return t.trigger("move")}},this.view.subscribe(this.listeners.view),this.listeners.texture={update:function(){return t.dirty=!0},warning:function(e){return t.trigger("warning",Object.assign({type:"textures"},e))}},this.textureManager.subscribe(this.listeners.texture),this.listeners.scene_loader={error:function(e){return t.trigger("error",Object.assign({type:"scene"},e))}},SceneLoader$1.subscribe(this.listeners.scene_loader)}},{key:"destroyListeners",value:function(){this.unsubscribeAll(),this.view.unsubscribe(this.listeners.view),this.textureManager.unsubscribe(this.listeners.texture),SceneLoader$1.unsubscribe(this.listeners.scene_loader),this.listeners=null}},{key:"resetFeatureSelection",value:function(){this.selection?this._workers&&WorkerBroker.postMessage(this._workers,"self.resetFeatureSelection"):this.selection=new FeatureSelection(this.gl,this.id)}},{key:"updateViewComplete",value:function(){(this.render_count_changed||this.generation!==this.last_complete_generation)&&this.tile_manager.isReady()&&(this.last_complete_generation=this.generation,this.trigger("view_complete"))}},{key:"resetViewComplete",value:function(){this.last_complete_generation=null}},{key:"screenshot",value:function(t){var e=(0<arguments.length&&void 0!==t?t:{}).background,r=void 0===e?"white":e;return this.requestRedraw(),this.media_capture.screenshot({background:r})}},{key:"pixelRatio",value:function(){return Utils$1.device_pixel_ratio}},{key:"startVideoCapture",value:function(){return this.requestRedraw(),this.media_capture.startVideoCapture()}},{key:"stopVideoCapture",value:function(){return this.media_capture.stopVideoCapture()}},{key:"_profile",value:function(t){console.profile("main thread: ".concat(t)),WorkerBroker.postMessage(this._workers,"self.profile",t)}},{key:"_profileEnd",value:function(t){console.profileEnd("main thread: ".concat(t)),WorkerBroker.postMessage(this._workers,"self.profileEnd",t)}},{key:"getCameraMatrix",value:function(){return this.view.lookAtManipulator.getCameraMatrix()}},{key:"animated",get:function(){var t=this;return void 0!==this.config.scene.animated?this.config.scene.animated:this.tile_manager.getActiveStyles().some((function(e){return t.styles[e]&&t.styles[e].animated}))}}],[{key:"create",value:function(e,r){return new t(e,1<arguments.length&&void 0!==r?r:{})}}]),t}();Scene.id=0,Scene.generation=0;var RemoteTexture=function(){_inherits(e,Texture);var t=_createSuper(e);function e(r,i,n){var o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{};_classCallCheck(this,e);var a=Math.pow(2,o.coords.z),s=Math.abs(Math.floor(o.coords.x/a)),l=Math.abs(a*s-Math.abs(o.coords.x)),c=o.coords;return o.coords={x:l,y:c.y,z:c.z},t.call(this,r,i,n,o)}return _createClass(e,[{key:"load",value:function(t){var r=this;if(!t||!t.uid)return _get(_getPrototypeOf(e.prototype),"load",this).call(this,t);var i=t.coords,n=new Uint8Array([0,0,0,0]);return this.loading=new Promise((function(e,o){var a=H.map.DataModel.invoke(t.uid,"requestTileAsPromise",[i.x,i.y,i.z])||null;a?a.then((function(e){var i=e.data;r.loaded=!0,!i||i instanceof ArrayBuffer||"IMG"!==i.tagName.toUpperCase()&&"CANVAS"!==i.tagName.toUpperCase()?r.setData(1,1,n,{filtering:"nearest"}):r.setElement(i,t)}),(function(){r.loaded=!1})).then(e,(function(t){return o(t)})):o(new Error("Unable to invoke on target "+t.uid))})),this.loading}}]),e}();TextureManager.register(RemoteTexture,(function(t){return t&&t.uid})),self.H=self.H||{},self.H.gl={DataSource,Geo:Geo$1,MathUtils:MathUtils$1,Scene,Task,Tile,WorkerBroker,log,SceneLoader:SceneLoader$1,yaml:jsYaml$1}}()};f()}(),this.H=this.H||{},this.H.venues=function(t){function e(t,e){var r,i;e=(e=void 0===e?{}:e).insertAt,t&&"undefined"!=typeof document&&(r=document.head||document.getElementsByTagName("head")[0],(i=document.createElement("style")).type="text/css","top"===e&&r.firstChild?r.insertBefore(i,r.firstChild):r.appendChild(i),i.styleSheet?i.styleSheet.cssText=t:i.appendChild(document.createTextNode(t)))}function r(t,e){var r,i=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,r)),i}function i(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?r(Object(i),!0).forEach((function(e){u(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):r(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function n(){n=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,i=(d="function"==typeof Symbol?Symbol:{}).iterator||"@@iterator",o=d.asyncIterator||"@@asyncIterator",a=d.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(e){s=function(t,e,r){return t[e]=r}}function l(t,e,r,i){var n,o,a,s;return e=e&&e.prototype instanceof h?e:h,e=Object.create(e.prototype),i=new w(i||[]),e._invoke=(n=t,o=r,a=i,s="suspendedStart",function(t,e){if("executing"===s)throw new Error("Generator is already running");if("completed"===s){if("throw"===t)throw e;return{value:void 0,done:!0}}for(a.method=t,a.arg=e;;){var r=a.delegate;if(r&&(r=function t(e,r){var i=e.iterator[r.method];if(void 0===i){if(r.delegate=null,"throw"===r.method){if(e.iterator.return&&(r.method="return",r.arg=void 0,t(e,r),"throw"===r.method))return u;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return u}return"throw"===(i=c(i,e.iterator,r.arg)).type?(r.method="throw",r.arg=i.arg,r.delegate=null,u):(i=i.arg)?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=void 0),r.delegate=null,u):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,u)}(r,a),r)){if(r===u)continue;return r}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if("suspendedStart"===s)throw s="completed",a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);if(s="executing","normal"===(r=c(n,o,a)).type){if(s=a.done?"completed":"suspendedYield",r.arg===u)continue;return{value:r.arg,done:a.done}}"throw"===r.type&&(s="completed",a.method="throw",a.arg=r.arg)}}),e}function c(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=l;var u={};function h(){}function p(){}function f(){}var d,y,g=(s(d={},i,(function(){return this})),(y=(y=Object.getPrototypeOf)&&y(y(x([]))))&&y!==e&&r.call(y,i)&&(d=y),f.prototype=h.prototype=Object.create(d));function v(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function m(t,e){var i;this._invoke=function(n,o){function a(){return new e((function(i,a){!function i(n,o,a,s){var l;if("throw"!==(n=c(t[n],t,o)).type)return(o=(l=n.arg).value)&&"object"==typeof o&&r.call(o,"__await")?e.resolve(o.__await).then((function(t){i("next",t,a,s)}),(function(t){i("throw",t,a,s)})):e.resolve(o).then((function(t){l.value=t,a(l)}),(function(t){return i("throw",t,a,s)}));s(n.arg)}(n,o,i,a)}))}return i=i?i.then(a,a):a()}}function _(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function b(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function w(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(_,this),this.reset(!0)}function x(t){if(t){var e,n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return e=-1,(n=function i(){for(;++e<t.length;)if(r.call(t,e))return i.value=t[e],i.done=!1,i;return i.value=void 0,i.done=!0,i}).next=n}return{next:E}}function E(){return{value:void 0,done:!0}}return s(g,"constructor",p.prototype=f),s(f,"constructor",p),p.displayName=s(f,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){return!!(t="function"==typeof t&&t.constructor)&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,s(t,a,"GeneratorFunction")),t.prototype=Object.create(g),t},t.awrap=function(t){return{__await:t}},v(m.prototype),s(m.prototype,o,(function(){return this})),t.AsyncIterator=m,t.async=function(e,r,i,n,o){void 0===o&&(o=Promise);var a=new m(l(e,r,i,n),o);return t.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},v(g),s(g,a,"Generator"),s(g,i,(function(){return this})),s(g,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e,r=[];for(e in t)r.push(e);return r.reverse(),function e(){for(;r.length;){var i=r.pop();if(i in t)return e.value=i,e.done=!1,e}return e.done=!0,e}},t.values=x,w.prototype={constructor:w,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(b),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function i(r,i){return a.type="throw",a.arg=t,e.next=r,i&&(e.method="next",e.arg=void 0),!!i}for(var n=this.tryEntries.length-1;0<=n;--n){var o=this.tryEntries[n],a=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var s=r.call(o,"catchLoc"),l=r.call(o,"finallyLoc");if(s&&l){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(t,e){for(var i=this.tryEntries.length-1;0<=i;--i){var n=this.tryEntries[i];if(n.tryLoc<=this.prev&&r.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}var a=(o=o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc?null:o)?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,u):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),u},finish:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),b(r),u}},catch:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var r,i,n=this.tryEntries[e];if(n.tryLoc===t)return"throw"===(r=n.completion).type&&(i=r.arg,b(n)),i}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:x(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),u}},t}function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e,r,i,n,o,a){try{var s=t[o](a),l=s.value}catch(t){return void r(t)}s.done?e(l):Promise.resolve(l).then(i,n)}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function c(t,e,r){return e&&l(t.prototype,e),r&&l(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function u(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function h(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&f(t,e)}function p(t){return(p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function f(t,e){return(f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function d(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function y(t,e,r){return(y=d()?Reflect.construct.bind():function(t,e,r){var i=[null];return i.push.apply(i,e),e=new(Function.bind.apply(t,i)),r&&f(e,r.prototype),e}).apply(null,arguments)}function g(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function v(t){var e=d();return function(){var r,i=p(t);if(r=e?(r=p(this).constructor,Reflect.construct(i,arguments,r)):i.apply(this,arguments),i=this,r&&("object"==typeof r||"function"==typeof r))return r;if(void 0!==r)throw new TypeError("Derived constructors may only return object or undefined");return g(i)}}function m(){return(m="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=p(t)););return t}(t,e);if(i)return(i=Object.getOwnPropertyDescriptor(i,e)).get?i.get.call(arguments.length<3?t:r):i.value}).apply(this,arguments)}function _(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var i,n,o=[],a=!0,s=!1;try{for(r=r.call(t);!(a=(i=r.next()).done)&&(o.push(i.value),!e||o.length!==e);a=!0);}catch(t){s=!0,n=t}finally{try{a||null==r.return||r.return()}finally{if(s)throw n}}return o}}(t,e)||w(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(t){return function(t){if(Array.isArray(t))return x(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||w(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w(t,e){if(t){if("string"==typeof t)return x(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(r="Object"===r&&t.constructor?t.constructor.name:r)||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?x(t,e):void 0}}function x(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=t[r];return i}e(".H_l_right .venues-ui__drawings .trigger.button--active .arrow {\n  transform: rotate(90deg);\n}\n.H_l_right .venues-ui__drawings .drawings {\n  right: 45px;\n  left: initial;\n}");var E=function(){h(e,H.map.Feature);var t=v(e);function e(r){var i;return s(this,e),(i=t.call(this)).id=r.id,i.model=r,i}return c(e,[{key:"getData",value:function(){return this.model}},{key:"getAddress",value:function(){return this.model.getInternalAddress()}},{key:"getCenter",value:function(){var t=(e=_(this.model.getCenter(),2))[0],e=e[1];return new H.geo.Point(e,t)}},{key:"getId",value:function(){return this.model.getId()}},{key:"getIdentifier",value:function(){return this.model.getIdentifier()}},{key:"getName",value:function(){return this.model.getDisplayName()}},{key:"toGeoJSON",value:function(){return this.model.toJSON()}},{key:"getLevel",value:function(){return this.getParentEventTarget()}},{key:"getVenue",value:function(){return this.getLevel().getDrawing().getParentEventTarget()}}]),e}(),T=function(){h(e,H.map.Feature);var t=v(e);function e(r){var i;return s(this,e),(i=t.call(this)).id=r.id,i.model=r,i}return c(e,[{key:"getData",value:function(){return this.model}},{key:"getBoundingBox",value:function(){return y(H.geo.Rect,b(this.model.getBoundingBox()))}},{key:"getCenter",value:function(){var t=(e=_(this.model.getCenter(),2))[0],e=e[1];return new H.geo.Point(e,t)}},{key:"getId",value:function(){return this.model.getId()}},{key:"getIdentifier",value:function(){return this.model.getIdentifier()}},{key:"getName",value:function(){return this.model.getDisplayName()}},{key:"getLevel",value:function(t){return this.getLevels().find((function(e){return e.getIdentifier()===t}))}},{key:"getLevels",value:function(){var t=this.getData().getLevels().map((function(t){return t.getIdentifier()}));return this.getVenue().getLevels().filter((function(e){return-1!==t.indexOf(e.id)}))}},{key:"getMainLevel",value:function(){return this.getLevel(this.model.getMainLevel().getIdentifier())}},{key:"getVenue",value:function(){return this.getParentEventTarget()}}]),e}(),A=function(){h(e,H.map.Feature);var t=v(e);function e(r){var i;return s(this,e),(i=t.call(this)).id=r.id,i.model=r,i}return c(e,[{key:"getGeometry",value:function(t){return this.getGeometries().find((function(e){return e.getIdentifier()===t}))}},{key:"getGeometries",value:function(){var t=this.getData().getGeometries().map((function(t){return t.getIdentifier()}));return this.getDrawing().getVenue().getGeometries().filter((function(e){return-1!==t.indexOf(e.id)}))}},{key:"getData",value:function(){return this.model}},{key:"getId",value:function(){return this.model.getId()}},{key:"getIdentifier",value:function(){return this.model.getIdentifier()}},{key:"getName",value:function(){return this.model.getDisplayName()}},{key:"getShortName",value:function(){return this.model.getShortName()}},{key:"getZIndex",value:function(){return this.model.getZIndex()}},{key:"isMain",value:function(){return this.model.isMain()}},{key:"getDrawing",value:function(){return this.getParentEventTarget()}},{key:"getVenue",value:function(){return this.getDrawing().getParentEventTarget()}}]),e}();function S(t,e,r,i){for(var n,o=i,a=r-e>>1,s=r-e,l=t[e],c=t[e+1],u=t[r],h=t[r+1],p=e+3;p<r;p+=3){var f=function(t,e,r,i,n,o){var a,s=n-r,l=o-i;return 0===s&&0===l||(1<(a=((t-r)*s+(e-i)*l)/(s*s+l*l))?(r=n,i=o):0<a&&(r+=s*a,i+=l*a)),(s=t-r)*s+(l=e-i)*l}(t[p],t[p+1],l,c,u,h);o<f?(n=p,o=f):f===o&&(f=Math.abs(p-a))<s&&(n=p,s=f)}i<o&&(3<n-e&&S(t,e,n,i),t[n+2]=o,3<r-n&&S(t,n,r,i))}function k(t,e,r,i){var n=t={id:void 0===t?null:t,type:e,geometry:r,tags:i,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},o=n.geometry;if("Point"===(e=n.type)||"MultiPoint"===e||"LineString"===e)O(n,o);else if("Polygon"===e||"MultiLineString"===e)for(var a=0;a<o.length;a++)O(n,o[a]);else if("MultiPolygon"===e)for(a=0;a<o.length;a++)for(var s=0;s<o[a].length;s++)O(n,o[a][s]);return t}function O(t,e){for(var r=0;r<e.length;r+=3)t.minX=Math.min(t.minX,e[r]),t.minY=Math.min(t.minY,e[r+1]),t.maxX=Math.max(t.maxX,e[r]),t.maxY=Math.max(t.maxY,e[r+1])}function L(t,e,r,i){if(e.geometry){var n=e.geometry.coordinates,o=e.geometry.type,a=Math.pow(r.tolerance/((1<<r.maxZoom)*r.extent),2),s=[],l=e.id;if(r.promoteId?l=e.properties[r.promoteId]:r.generateId&&(l=i||0),"Point"===o)P(n,s);else if("MultiPoint"===o)for(var c=0;c<n.length;c++)P(n[c],s);else if("LineString"===o)R(n,s,a,!1);else if("MultiLineString"===o){if(r.lineMetrics){for(c=0;c<n.length;c++)R(n[c],s=[],a,!1),t.push(k(l,"LineString",s,e.properties));return}I(n,s,a,!1)}else if("Polygon"===o)I(n,s,a,!0);else{if("MultiPolygon"!==o){if("GeometryCollection"!==o)throw new Error("Input data is not a valid GeoJSON object.");for(c=0;c<e.geometry.geometries.length;c++)L(t,{id:l,geometry:e.geometry.geometries[c],properties:e.properties},r,i);return}for(c=0;c<n.length;c++){var u=[];I(n[c],u,a,!0),s.push(u)}}t.push(k(l,o,s,e.properties))}}function P(t,e){e.push(C(t[0])),e.push(M(t[1])),e.push(0)}function R(t,e,r,i){for(var n,o,a=0,s=0;s<t.length;s++){var l=C(t[s][0]),c=M(t[s][1]);e.push(l),e.push(c),e.push(0),0<s&&(a+=i?(n*c-l*o)/2:Math.sqrt(Math.pow(l-n,2)+Math.pow(c-o,2))),n=l,o=c}var u=e.length-3;e[2]=1,S(e,0,u,r),e[2+u]=1,e.size=Math.abs(a),e.start=0,e.end=e.size}function I(t,e,r,i){for(var n=0;n<t.length;n++){var o=[];R(t[n],o,r,i),e.push(o)}}function C(t){return t/360+.5}function M(t){return t=Math.sin(t*Math.PI/180),(t=.5-.25*Math.log((1+t)/(1-t))/Math.PI)<0?0:1<t?1:t}function N(t,e,r,i,n,o,a,s){if(i/=e,(r/=e)<=o&&a<i)return t;if(a<r||i<=o)return null;for(var l=[],c=0;c<t.length;c++){var u=t[c],h=u.geometry,p=u.type,f=0===n?u.minX:u.minY,d=0===n?u.maxX:u.maxY;if(r<=f&&d<i)l.push(u);else if(!(d<r||i<=f)){var y=[];if("Point"===p||"MultiPoint"===p){x=w=v=void 0;for(var g=h,v=y,m=r,_=i,b=n,w=0;w<g.length;w+=3){var x=g[w+b];m<=x&&x<=_&&(v.push(g[w]),v.push(g[w+1]),v.push(g[w+2]))}}else if("LineString"===p)j(h,y,r,i,n,!1,s.lineMetrics);else if("MultiLineString"===p)B(h,y,r,i,n,!1);else if("Polygon"===p)B(h,y,r,i,n,!0);else if("MultiPolygon"===p)for(var E=0;E<h.length;E++){var T=[];B(h[E],T,r,i,n,!0),T.length&&y.push(T)}if(y.length)if(s.lineMetrics&&"LineString"===p)for(E=0;E<y.length;E++)l.push(k(u.id,p,y[E],u.tags));else"LineString"!==p&&"MultiLineString"!==p||(1===y.length?(p="LineString",y=y[0]):p="MultiLineString"),"Point"!==p&&"MultiPoint"!==p||(p=3===y.length?"Point":"MultiPoint"),l.push(k(u.id,p,y,u.tags))}}return l.length?l:null}function j(t,e,r,i,n,o,a){for(var s,l,c=D(t),u=0===n?F:U,h=t.start,p=0;p<t.length-3;p+=3){var f=t[p],d=t[p+1],y=t[p+2],g=t[p+3],v=t[p+4],m=0===n?f:d,_=0===n?g:v,b=!1;a&&(s=Math.sqrt(Math.pow(f-g,2)+Math.pow(d-v,2))),m<r?r<_&&(l=u(c,f,d,g,v,r),a&&(c.start=h+s*l)):i<m?_<i&&(l=u(c,f,d,g,v,i),a&&(c.start=h+s*l)):z(c,f,d,y),_<r&&r<=m&&(l=u(c,f,d,g,v,r),b=!0),i<_&&m<=i&&(l=u(c,f,d,g,v,i),b=!0),!o&&b&&(a&&(c.end=h+s*l),e.push(c),c=D(t)),a&&(h+=s)}var w=t.length-3;f=t[w],d=t[1+w],y=t[2+w],r<=(m=0===n?f:d)&&m<=i&&z(c,f,d,y),w=c.length-3,o&&3<=w&&(c[w]!==c[0]||c[1+w]!==c[1])&&z(c,c[0],c[1],c[2]),c.length&&e.push(c)}function D(t){var e=[];return e.size=t.size,e.start=t.start,e.end=t.end,e}function B(t,e,r,i,n,o){for(var a=0;a<t.length;a++)j(t[a],e,r,i,n,o,!1)}function z(t,e,r,i){t.push(e),t.push(r),t.push(i)}function F(t,e,r,i,n,o){return i=(o-e)/(i-e),t.push(o),t.push(r+(n-r)*i),t.push(1),i}function U(t,e,r,i,n,o){return n=(o-r)/(n-r),t.push(e+(i-e)*n),t.push(o),t.push(1),n}function G(t,e){for(var r=[],i=0;i<t.length;i++){var n=t[i],o=n.type;if("Point"===o||"MultiPoint"===o||"LineString"===o)a=V(n.geometry,e);else if("MultiLineString"===o||"Polygon"===o)for(var a=[],s=0;s<n.geometry.length;s++)a.push(V(n.geometry[s],e));else if("MultiPolygon"===o)for(a=[],s=0;s<n.geometry.length;s++){for(var l=[],c=0;c<n.geometry[s].length;c++)l.push(V(n.geometry[s][c],e));a.push(l)}r.push(k(n.id,o,a,n.tags))}return r}function V(t,e){var r=[];r.size=t.size,void 0!==t.start&&(r.start=t.start,r.end=t.end);for(var i=0;i<t.length;i+=3)r.push(t[i]+e,t[i+1],t[i+2]);return r}function q(t,e){if(!t.transformed){for(var r,i=1<<t.z,n=t.x,o=t.y,a=0;a<t.features.length;a++){var s=t.features[a],l=s.geometry,c=s.type;if(s.geometry=[],1===c)for(r=0;r<l.length;r+=2)s.geometry.push($(l[r],l[r+1],e,i,n,o));else for(r=0;r<l.length;r++){for(var u=[],h=0;h<l[r].length;h+=2)u.push($(l[r][h],l[r][h+1],e,i,n,o));s.geometry.push(u)}}t.transformed=!0}return t}function $(t,e,r,i,n,o){return[Math.round(r*(t*i-n)),Math.round(r*(e*i-o))]}function W(t,e,r,i,n){for(var o=e===n.maxZoom?0:n.tolerance/((1<<e)*n.extent),a={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:r,y:i,z:e,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},s=0;s<t.length;s++){a.numFeatures++,h=_=m=v=g=y=d=h=l=void 0;var l=a,c=t[s],u=o,h=n,p=c.geometry,f=c.type,d=[];if("Point"===f||"MultiPoint"===f)for(var y=0;y<p.length;y+=3)d.push(p[y]),d.push(p[y+1]),l.numPoints++,l.numSimplified++;else if("LineString"===f)Y(d,p,l,u,!1,!1);else if("MultiLineString"===f||"Polygon"===f)for(y=0;y<p.length;y++)Y(d,p[y],l,u,"Polygon"===f,0===y);else if("MultiPolygon"===f)for(var g=0;g<p.length;g++){var v=p[g];for(y=0;y<v.length;y++)Y(d,v[y],l,u,!0,0===y)}if(d.length){var m=c.tags||null;if("LineString"===f&&h.lineMetrics){for(var _ in m={},c.tags)m[_]=c.tags[_];m.mapbox_clip_start=p.start/p.size,m.mapbox_clip_end=p.end/p.size}h={geometry:d,type:"Polygon"===f||"MultiPolygon"===f?3:"LineString"===f||"MultiLineString"===f?2:1,tags:m},null!==c.id&&(h.id=c.id),l.features.push(h)}h=t[s].minX;var b=t[s].minY,w=t[s].maxX,x=t[s].maxY;h<a.minX&&(a.minX=h),b<a.minY&&(a.minY=b),w>a.maxX&&(a.maxX=w),x>a.maxY&&(a.maxY=x)}return a}function Y(t,e,r,i,n,o){var a=i*i;if(0<i&&e.size<(n?a:i))r.numPoints+=e.length/3;else{for(var s=[],l=0;l<e.length;l+=3)(0===i||e[l+2]>a)&&(r.numSimplified++,s.push(e[l]),s.push(e[l+1])),r.numPoints++;if(n){for(var c=s,u=(n=o,0),h=0,p=c.length,f=p-2;h<p;f=h,h+=2)u+=(c[h]-c[f])*(c[h+1]+c[f+1]);if(0<u===n)for(h=0,p=c.length;h<p/2;h+=2){var d=c[h],y=c[h+1];c[h]=c[p-2-h],c[h+1]=c[p-1-h],c[p-2-h]=d,c[p-1-h]=y}}t.push(s)}}function X(t,e){var r,i,n,o,a,s=(e=this.options=function(t,e){for(var r in e)t[r]=e[r];return t}(Object.create(this.options),e)).debug;if(s&&console.time("preprocess data"),e.maxZoom<0||24<e.maxZoom)throw new Error("maxZoom should be in the 0-24 range");if(e.promoteId&&e.generateId)throw new Error("promoteId and generateId cannot be used together.");t=function(t,e){var r=[];if("FeatureCollection"===t.type)for(var i=0;i<t.features.length;i++)L(r,t.features[i],e,i);else"Feature"===t.type?L(r,t,e):L(r,{geometry:t},e);return r}(t,e),this.tiles={},this.tileCoords=[],s&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",e.indexMaxZoom,e.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),o=N(n=r=t,1,-1-(i=e.buffer/e.extent),i,0,-1,2,e),a=N(r,1,1-i,2+i,0,-1,2,e),(o||a)&&(n=N(r,1,-i,1+i,0,-1,2,e)||[],o&&(n=G(o,1).concat(n)),a&&(n=n.concat(G(a,-1)))),(t=n).length&&this.splitTile(t,0,0,0),s&&(t.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function K(t,e,r){return 32*((1<<t)*r+e)+t}function Z(t,e,r,i,n){var o;return e=1<<e,(o=[])[0]=(t[0]/n+r)/e,o[1]=(t[1]/n+i)/e,n=(t=r={x:o[0],y:o[1]}).x,t=t.y,n=360*(n-.5),i=Math.exp(Math.PI*(.5-t)/.25)-1,t=Math.exp(Math.PI*(.5-t)/.25)+1,[n,180*Math.asin(i/t)/Math.PI]}X.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},X.prototype.splitTile=function(t,e,r,i,n,o,a){for(var s=[t,e,r,i],l=this.options,c=l.debug;s.length;){i=s.pop(),r=s.pop(),e=s.pop(),t=s.pop();var u,h,p,f,d,y,g,v,m,_=1<<e,b=K(e,r,i),w=this.tiles[b];if(w||(1<c&&console.time("creation"),w=this.tiles[b]=W(t,e,r,i,l),this.tileCoords.push({z:e,x:r,y:i}),c&&(1<c&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",e,r,i,w.numFeatures,w.numPoints,w.numSimplified),console.timeEnd("creation")),this.stats[b="z"+e]=(this.stats[b]||0)+1,this.total++)),w.source=t,n){if(e===l.maxZoom||e===n)continue;if(b=1<<n-e,r!==Math.floor(o/b)||i!==Math.floor(a/b))continue}else if(e===l.indexMaxZoom||w.numPoints<=l.indexMaxPoints)continue;w.source=null,0!==t.length&&(1<c&&console.time("clipping"),u=.5-(b=.5*l.buffer/l.extent),p=1+b,g=f=d=y=null,v=N(t,_,r-b,r+(h=.5+b),0,w.minX,w.maxX,l),m=N(t,_,r+u,r+p,0,w.minX,w.maxX,l),t=null,v&&(g=N(v,_,i-b,i+h,1,w.minY,w.maxY,l),f=N(v,_,i+u,i+p,1,w.minY,w.maxY,l),v=null),m&&(d=N(m,_,i-b,i+h,1,w.minY,w.maxY,l),y=N(m,_,i+u,i+p,1,w.minY,w.maxY,l),m=null),1<c&&console.timeEnd("clipping"),s.push(g||[],e+1,2*r,2*i),s.push(f||[],e+1,2*r,2*i+1),s.push(d||[],e+1,2*r+1,2*i),s.push(y||[],e+1,2*r+1,2*i+1))}},X.prototype.getTile=function(t,e,r){var i=(n=this.options).extent,n=n.debug;if(t<0||24<t)return null;var o=K(t,e=(e%(o=1<<t)+o)%o,r);if(this.tiles[o])return q(this.tiles[o],i);1<n&&console.log("drilling down to z%d-%d-%d",t,e,r);for(var a,s=t,l=e,c=r;!a&&0<s;)s--,l=Math.floor(l/2),c=Math.floor(c/2),a=this.tiles[K(s,l,c)];return a&&a.source?(1<n&&console.log("found parent tile z%d-%d-%d",s,l,c),1<n&&console.time("drilling down"),this.splitTile(a.source,s,l,c,t,e,r),1<n&&console.timeEnd("drilling down"),this.tiles[o]?q(this.tiles[o],i):null):null};var J="Point",Q="Polygon",tt="MultiPoint",et="MultiLineString",rt="MultiPolygon",it={fillColor:"#e0e0e0",outlineColor:"#829DB4",outlineWidth:1},nt={fillColor:"#F2F285",outlineColor:"#0088BF",outlineWidth:1.2},ot={FOOTPRINT:"FOOTPRINT",ICON:"ICON",TEXT:"TEXT",VECTOR:"VECTOR"},at=Object.freeze({v1:1,v2:2}),st=function(t){return t=function(t){for(var e=0,r=t.length,i=0;i<r-1;i+=1){var n=t[i],o=t[i+1];e+=n[0]*o[1]-o[0]*n[1]}return e+(t[r-1][0]*t[0][1]-t[0][0]*t[r-1][1])}(t),0<t?"CW":t<0?"CCW":void 0};!function(t){function e(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return r[t].call(n.exports,n,n.exports,e),n.l=!0,n.exports}var r,i;t.exports=(r=[function(t,e,r){function i(t){return(i="function"==typeof Symbol&&"symbol"==o(Symbol.iterator)?function(t){return o(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":o(t)})(t)}var n=r(1),a=(r=r(7)).get,s=(r.deepValue,r.isArray);r=function(){function t(e,r){var i=void 0===(i=r.location)?0:i,n=void 0===(n=r.distance)?100:n,o=void 0===(o=r.threshold)?.6:o,s=void 0===(s=r.maxPatternLength)?32:s,l=void 0!==(l=r.caseSensitive)&&l,c=void 0===(c=r.tokenSeparator)?/ +/g:c,u=void 0!==(u=r.findAllMatches)&&u,h=void 0===(h=r.minMatchCharLength)?1:h,p=void 0===(p=r.id)?null:p,f=void 0===(f=r.keys)?[]:f,d=void 0===(d=r.shouldSort)||d,y=void 0===(y=r.getFn)?a:y,g=void 0===(g=r.sortFn)?function(t,e){return t.score-e.score}:g,v=void 0!==(v=r.tokenize)&&v,m=void 0!==(m=r.matchAllTokens)&&m,_=void 0!==(_=r.includeMatches)&&_,b=void 0!==(b=r.includeScore)&&b;if(r=void 0!==(r=r.verbose)&&r,!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.options={location:i,distance:n,threshold:o,maxPatternLength:s,isCaseSensitive:l,tokenSeparator:c,findAllMatches:u,minMatchCharLength:h,id:p,keys:f,includeMatches:_,includeScore:b,shouldSort:d,getFn:y,sortFn:g,verbose:r,tokenize:v,matchAllTokens:m},this.setCollection(e),this._processKeys(f)}for(var e=t.prototype,r=[{key:"setCollection",value:function(t){return this.list=t}},{key:"_processKeys",value:function(t){if(this._keyWeights={},this._keyNames=[],t.length&&"string"==typeof t[0])for(var e=0,r=t.length;e<r;e+=1){var i=t[e];this._keyWeights[i]=1,this._keyNames.push(i)}else{for(var n=null,o=null,a=0,s=0,l=t.length;s<l;s+=1){var c=t[s];if(!c.hasOwnProperty("name"))throw new Error('Missing "name" property in key object');var u=c.name;if(this._keyNames.push(u),!c.hasOwnProperty("weight"))throw new Error('Missing "weight" property in key object');if((c=c.weight)<0||1<c)throw new Error('"weight" property in key must bein the range of [0, 1)');o=null==o?c:Math.max(o,c),n=null==n?c:Math.min(n,c),a+=this._keyWeights[u]=c}if(1<a)throw new Error("Total of weights cannot exceed 1")}}},{key:"search",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{limit:!1},r=(this._log('---------\nSearch pattern: "'.concat(t,'"')),t=this._prepareSearchers(t)).tokenSearchers;return t=t.fullSearcher,r=this._search(r,t),this._computeScore(r),this.options.shouldSort&&this._sort(r),e.limit&&"number"==typeof e.limit&&(r=r.slice(0,e.limit)),this._format(r)}},{key:"_prepareSearchers",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",e=[];if(this.options.tokenize)for(var r=t.split(this.options.tokenSeparator),i=0,o=r.length;i<o;i+=1)e.push(new n(r[i],this.options));return{tokenSearchers:e,fullSearcher:new n(t,this.options)}}},{key:"_search",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=1<arguments.length?arguments[1]:void 0,r=this.list,i={},n=[];if("string"==typeof r[0])for(var o=0,a=r.length;o<a;o+=1)this._analyze({key:"",value:r[o],record:o,index:o},{resultMap:i,results:n,tokenSearchers:t,fullSearcher:e});else for(var s=0,l=r.length;s<l;s+=1)for(var c=r[s],u=0,h=this._keyNames.length;u<h;u+=1){var p=this._keyNames[u];this._analyze({key:p,value:this.options.getFn(c,p),record:c,index:s},{resultMap:i,results:n,tokenSearchers:t,fullSearcher:e})}return n}},{key:"_analyze",value:function(t,e){var r,i=this,n=t.key,o=t.arrayIndex,a=t.value,l=t.record,c=(t=t.index,void 0===(r=e.tokenSearchers)?[]:r),u=e.fullSearcher,h=void 0===(r=e.resultMap)?{}:r,p=void 0===(r=e.results)?[]:r;!function t(e,r,o,a){if(null!=r)if("string"==typeof r){var l=!1,f=-1,d=0,y=(i._log("\nKey: ".concat(""===n?"--":n)),u.search(r));if(i._log('Full text: "'.concat(r,'", score: ').concat(y.score)),i.options.tokenize){for(var g=r.split(i.options.tokenSeparator),v=g.length,m=[],_=0,b=c.length;_<b;_+=1){var w=c[_];i._log('\nPattern: "'.concat(w.pattern,'"'));for(var x=!1,E=0;E<v;E+=1){var T=g[E],A=w.search(T),S={};A.isMatch?(S[T]=A.score,x=l=!0,m.push(A.score)):(S[T]=1,i.options.matchAllTokens||m.push(1)),i._log('Token: "'.concat(T,'", score: ').concat(S[T]))}x&&(d+=1)}f=m[0];for(var k=m.length,O=1;O<k;O+=1)f+=m[O];i._log("Token score average:",f/=k)}var L=y.score,P=(i._log("Score average:",L=-1<f?(L+f)/2:L),!i.options.tokenize||!i.options.matchAllTokens||d>=c.length);i._log("\nCheck Matches: ".concat(P)),(l||y.isMatch)&&P&&(P={key:n,arrayIndex:e,value:r,score:L},i.options.includeMatches&&(P.matchedIndices=y.matchedIndices),(e=h[a])?e.output.push(P):(h[a]={item:o,output:[P]},p.push(h[a])))}else if(s(r))for(var R=0,I=r.length;R<I;R+=1)t(R,r[R],o,a)}(void 0===o?-1:o,a,l,t)}},{key:"_computeScore",value:function(t){this._log("\n\nComputing score:\n");for(var e=this._keyWeights,r=!!Object.keys(e).length,i=0,n=t.length;i<n;i+=1){for(var o=t[i],a=o.output,s=a.length,l=1,c=0;c<s;c+=1){var u=a[c],h=u.key,p=r?e[h]:1;h=0===u.score&&e&&0<e[h]?Number.EPSILON:u.score,l*=Math.pow(h,p)}o.score=l,this._log(o)}}},{key:"_sort",value:function(t){this._log("\n\nSorting...."),t.sort(this.options.sortFn)}},{key:"_format",value:function(t){var e,r=[],n=(this.options.verbose&&(e=[],this._log("\n\nOutput:\n\n",JSON.stringify(t,(function(t,r){if("object"===i(r)&&null!==r){if(-1!==e.indexOf(r))return;e.push(r)}return r}),2)),e=null),[]);this.options.includeMatches&&n.push((function(t,e){var r=t.output;e.matches=[];for(var i=0,n=r.length;i<n;i+=1){var o,a=r[i];0!==a.matchedIndices.length&&(o={indices:a.matchedIndices,value:a.value},a.key&&(o.key=a.key),a.hasOwnProperty("arrayIndex")&&-1<a.arrayIndex&&(o.arrayIndex=a.arrayIndex),e.matches.push(o))}})),this.options.includeScore&&n.push((function(t,e){e.score=t.score}));for(var o=0,a=t.length;o<a;o+=1){var s=t[o];if(this.options.id&&(s.item=this.options.getFn(s.item,this.options.id)[0]),n.length){for(var l={item:s.item},c=0,u=n.length;c<u;c+=1)n[c](s,l);r.push(l)}else r.push(s.item)}return r}},{key:"_log",value:function(){var t;this.options.verbose&&(t=console).log.apply(t,arguments)}}],o=0;o<r.length;o++){var l=r[o];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(e,l.key,l)}return t}(),t.exports=r},function(t,e,r){var i=r(2),n=r(3),o=r(6);r=function(){function t(e,r){var i=void 0===(i=r.location)?0:i,n=void 0===(n=r.distance)?100:n,a=void 0===(a=r.threshold)?.6:a,s=void 0===(s=r.maxPatternLength)?32:s,l=void 0!==(l=r.isCaseSensitive)&&l,c=void 0===(c=r.tokenSeparator)?/ +/g:c,u=void 0!==(u=r.findAllMatches)&&u,h=void 0===(h=r.minMatchCharLength)?1:h;if(r=void 0!==(r=r.includeMatches)&&r,!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.options={location:i,distance:n,threshold:a,maxPatternLength:s,isCaseSensitive:l,tokenSeparator:c,findAllMatches:u,includeMatches:r,minMatchCharLength:h},this.pattern=l?e:e.toLowerCase(),this.pattern.length<=s&&(this.patternAlphabet=o(this.pattern))}for(var e=t.prototype,r=[{key:"search",value:function(t){var e=(r=this.options).isCaseSensitive,r=r.includeMatches;if(e||(t=t.toLowerCase()),this.pattern===t)return e={isMatch:!0,score:0},r&&(e.matchedIndices=[[0,t.length-1]]),e;var o=(e=this.options).maxPatternLength;if(e=e.tokenSeparator,this.pattern.length>o)return i(t,this.pattern,e);e=(o=this.options).location;var a=o.distance,s=o.threshold,l=o.findAllMatches;return o=o.minMatchCharLength,n(t,this.pattern,this.patternAlphabet,{location:e,distance:a,threshold:s,findAllMatches:l,minMatchCharLength:o,includeMatches:r})}}],a=0;a<r.length;a++){var s=r[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}return t}(),t.exports=r},function(t,e){var r=/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g;t.exports=function(t,e){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:/ +/g,n=(e=new RegExp(e.replace(r,"\\$&").replace(i,"|")),t.match(e)),o=[];if(i=!!n)for(var a=0,s=n.length;a<s;a+=1){var l=n[a];o.push([t.indexOf(l),l.length-1])}return{score:i?.5:1,isMatch:i,matchedIndices:o}}},function(t,e,r){var i=r(4),n=r(5);t.exports=function(t,e,r,o){for(var a=o.location,s=void 0===(l=o.distance)?100:l,l=o.threshold,c=void 0!==(u=o.findAllMatches)&&u,u=void 0===(u=o.minMatchCharLength)?1:u,h=(o=void 0!==(o=o.includeMatches)&&o,void 0===a?0:a),p=t.length,f=void 0===l?.6:l,d=t.indexOf(e,h),y=e.length,g=[],v=0;v<p;v+=1)g[v]=0;-1!==d&&(a=i(e,{errors:0,currentLocation:d,expectedLocation:h,distance:s}),f=Math.min(a,f),-1!==(d=t.lastIndexOf(e,h+y))&&(l=i(e,{errors:0,currentLocation:d,expectedLocation:h,distance:s}),f=Math.min(l,f))),d=-1;for(var m=[],_=1,b=y+p,w=1<<(y<=31?y-1:30),x=0;x<y;x+=1){for(var E=0,T=b;E<T;)i(e,{errors:x,currentLocation:h+T,expectedLocation:h,distance:s})<=f?E=T:b=T,T=Math.floor((b-E)/2+E);b=T;var A=Math.max(1,h-T+1),S=c?p:Math.min(h+T,p)+y,k=Array(S+2);k[S+1]=(1<<x)-1;for(var O=S;A<=O;--O){var L=O-1,P=r[t.charAt(L)];if(P&&(g[L]=1),k[O]=(k[O+1]<<1|1)&P,0!==x&&(k[O]|=(m[O+1]|m[O])<<1|1|m[O+1]),k[O]&w&&(_=i(e,{errors:x,currentLocation:L,expectedLocation:h,distance:s}))<=f){if(f=_,(d=L)<=h)break;A=Math.max(1,2*h-d)}}if(i(e,{errors:x+1,currentLocation:h,expectedLocation:h,distance:s})>f)break;m=k}return a={isMatch:0<=d,score:0===_?.001:_},o&&(a.matchedIndices=n(g,u)),a}},function(t,e){t.exports=function(t,e){var r=e.errors,i=e.currentLocation,n=e.expectedLocation;return e=void 0===(e=e.distance)?100:e,r=(void 0===r?0:r)/t.length,t=Math.abs((void 0===n?0:n)-(void 0===i?0:i)),e?r+t/e:t?1:r}},function(t,e){t.exports=function(){for(var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,r=[],i=-1,n=0,o=t.length;n<o;n+=1){var a=t[n];a&&-1===i?i=n:a||-1===i||((a=n-1)-i+1>=e&&r.push([i,a]),i=-1)}return t[n-1]&&e<=n-i&&r.push([i,n-1]),r}},function(t,e){t.exports=function(t){for(var e={},r=t.length,i=0;i<r;i+=1)e[t.charAt(i)]=0;for(var n=0;n<r;n+=1)e[t.charAt(n)]|=1<<r-n-1;return e}},function(t,e){function r(t){return Array.isArray?Array.isArray(t):"[object Array]"===Object.prototype.toString.call(t)}function i(t){if(null==t)return"";if("string"==typeof t)return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function n(t){return"string"==typeof t}function o(t){return"number"==typeof t}t.exports={get:function(t,e){var a=[];return function t(e,s){if(s){var l=s.indexOf("."),c=s,u=null,h=(-1!==l&&(c=s.slice(0,l),u=s.slice(l+1)),e[c]);if(null!=h)if(u||!n(h)&&!o(h))if(r(h))for(var p=0,f=h.length;p<f;p+=1)t(h[p],u);else u&&t(h,u);else a.push(i(h))}else a.push(e)}(t,e),a},isArray:r,isString:n,isNum:o,toString:i}}],i={},e.m=r,e.c=i,e.d=function(t,r,i){e.o(t,r)||Object.defineProperty(t,r,{enumerable:!0,get:i})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,r){if(1&r&&(t=e(t)),8&r)return t;if(4&r&&"object"==o(t)&&t&&t.__esModule)return t;var i=Object.create(null);if(e.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&r&&"string"!=typeof t)for(var n in t)e.d(i,n,function(e){return t[e]}.bind(null,n));return i},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=0))}(Re={exports:{}});var lt=(Pt=Re=Re.exports)&&Pt.__esModule&&Object.prototype.hasOwnProperty.call(Pt,"default")?Pt.default:Pt,ct=(Re.Fuse,c((function t(e){var r=void 0===(r=e.addressList)?[]:r,i=void 0===(i=e.geometries)?[]:i,n=void 0===(n=e.entity)?null:n,o=void 0===(o=e.name)?"":o;e=void 0===(e=e.icon)?"":e,s(this,t),this.addressList=r,this.geometries=i,this.icon=e,this.entity=n,this.name=o}))),ut={keys:[{name:"name",weight:.6},{name:"addressList",weight:.4}],threshold:.2},ht=function(){function t(e){s(this,t),this.fuseSearch=null,this.levels_=null,this.searchListEntities_=[],this.searchListIcons_=[],this.searchList_=[],this.venueModel=e,this.init()}return c(t,[{key:"init",value:function(){var t=this.venueModel.getGeometries().reduce((function(t,e){return t[e.getId()]=e,t}),{});this.initEntityList(this.venueModel.getOccupant()),this.initIconList(t),this.levels_=this.venueModel.getLevels().map((function(t){return{levelId:t.getId(),levelName:t.getName(),drawingId:t.getDrawing().getId(),drawingName:t.getDrawing().getName()}})),t=[].concat(b(this.searchListEntities_),b(this.searchListIcons_)),this.searchList_=t.sort((function(t,e){return t.name.localeCompare(e.name)})),this.fuseSearch_=new lt(this.searchList_,ut)}},{key:"initEntityList",value:function(){var t=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]).map((function(t){return t.spaceIds?new ct({geometries:t.space,addressList:t.spaceIds||[],name:t.properties.name||"",entity:t}):null})).filter((function(t){return null!==t}));this.searchListEntities_=t}},{key:"initIconList",value:function(){this.searchListIcons_=Object.values(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).filter((function(t){return t.isIcon()})).map((function(t){var e=t.getIcon();return new ct({geometries:[t],icon:e,name:t.properties.name||""})}))}},{key:"all",value:function(){return this.searchList_}},{key:"allIconTypes",value:function(){var t=this.searchListIcons_.reduce((function(t,e){return t[e.name]=e.name,t}),{});return Object.keys(t)}},{key:"find",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";return""===t?this.searchList_:this.fuseSearch_.search(t)}}]),t}(),pt=Object.freeze({SITE:"SITE",IMAGES:"IMAGES",THEME:"THEME"}),ft="indoor.Site",dt="indoor.Occupant",yt="indoor.Space",gt="Address",vt="indoor.Level",mt="indoor.Entrance",_t="SPACE_TYPE_NAME",bt="SPACE_CATEGORY_NAME",wt="Point",xt="LineString",Et="Polygon",Tt="MultiPoint",At="MultiLineString",St="MultiPolygon",kt=Object.freeze({STANDARD:"STANDARD",FLATTEN:"FLATTEN",OUTDOOR_MAIN:"OUTDOOR_MAIN",INDOOR_MAIN:"INDOOR_MAIN",NO_OUTDOORS:"NO_OUTDOORS",FLATTEN_INDOOR_MAIN:"FLATTEN_INDOOR_MAIN",FLATTEN_OUTDOOR_COPY:"FLATTEN_OUTDOOR_COPY"}),Ot="9999999999999",Lt="https://interactive.data.api.platform.here.com/interactive/v1/catalogs",Pt=Object.freeze({THEME:"THEME",THEME_MAP:"THEME_MAP",PRESETS:"PRESETS",SDK_STRINGS:"SDK_STRINGS",ICON_FILE:"ICON_FILE",INPUT_COLORS:"INPUT_COLORS",BASE_MAP_INFO:"BASE_MAP_INFO",CONFIG_PROFILE:"CONFIG_PROFILE",NAV_THEME:"NAV_THEME",NAV_NAME_THEME:"NAV_NAME_THEME",NAV_PROP_MAP:"NAV_PROP_MAP",NAV_STRINGS:"NAV_STRINGS",NAV_THEME_MAP:"NAV_THEME_MAP",NAV_NAME_THEME_MAP:"NAV_NAME_THEME_MAP",V4_THEME_FAMILY:"V4_THEME_FAMILY",V4_MAPTYPE_THEME:"V4_MAPTYPE_THEME",ICON:"ICON",MARKER:"MARKER",PERMISSIONS:"PERMISSIONS",NAICS_ARRAY:"NAICS_ARRAY",NAICS_MAP:"NAICS_MAP"}),Rt=(Object.freeze((u(Re={},Pt.THEME,"themeUrls"),u(Re,Pt.THEME_MAP,"themeMapUrl"),u(Re,Pt.PRESETS,"presetsUrl"),u(Re,Pt.SDK_STRINGS,"stringsUrl"),Re)),Object.freeze((u(Re={},Pt.THEME,"themeOverrides"),u(Re,Pt.THEME_MAP,"themeMapOverrides"),u(Re,Pt.PRESETS,"presetOverrides"),u(Re,Pt.SDK_STRINGS,"stringsOverrides"),u(Re,Pt.INPUT_COLORS,"inputColorOverrides"),Re)),Object.freeze((u(Re={},Pt.THEME,["Modern","Standard","Factory","Navteq","TheBase","Westfield_noLabels","Westfield","TDM_noLabel"]),u(Re,Pt.SDK_STRINGS,["Standard","SDK","sdk/standard"]),u(Re,Pt.V4_THEME_FAMILY,["modern","standard"]),u(Re,Pt.V4_MAPTYPE_THEME,["Airport Terminal","Airport","Casino","College Building","College Campus","Convention","General","Hospital","Outdoor","Retail","School Building","School Campus","Shopping Mall","Traffic","Train Station"]),u(Re,Pt.NAV_THEME,["Factory","MapEditor"]),u(Re,Pt.ICON,["Multicolor","Standard","TheBase","Factory"]),Re)),Object.freeze((u(Re={},Pt.THEME,"Modern"),u(Re,Pt.THEME_MAP,"Standard"),u(Re,Pt.PRESETS,"Standard"),u(Re,Pt.SDK_STRINGS,"Standard"),u(Re,Pt.ICON_FILE,"Standard"),u(Re,Pt.INPUT_COLORS,"Standard"),u(Re,Pt.BASE_MAP_INFO,"Standard"),u(Re,Pt.CONFIG_PROFILE,"factory"),u(Re,Pt.NAV_THEME,"Factory"),u(Re,Pt.NAV_NAME_THEME,"FactoryName"),u(Re,Pt.NAV_PROP_MAP,"Standard"),u(Re,Pt.NAV_STRINGS,"Standard"),u(Re,Pt.NAV_THEME_MAP,"Standard"),u(Re,Pt.NAV_NAME_THEME_MAP,"StandardName"),u(Re,Pt.V4_THEME_FAMILY,"Standard"),u(Re,Pt.V4_MAPTYPE_THEME,"Standard"),u(Re,Pt.ICON,"Multicolor"),u(Re,Pt.MARKER,"Standard"),Re)),Pt=Object.freeze({GEO_JSON:"GEO_JSON",V5_MAP:"V5_MAP",V5_NAV:"V5_NAV",V5_INFO:"V5_INFO",KML:"KML",SVG:"SVG",PNG:"PNG"}),Object.freeze(u({},Pt.GEO_JSON,{COMMUNITY_MAP:"COMMUNITY_MAP",COMMUNITY_ENTITY:"COMMUNITY_ENTITY",PATH_LEVEL_GEOMETRY:"PATH_LEVEL_GEOMETRY",GEOJSON_LEVEL_GEOMETRY:"GEOJSON_LEVEL_GEOMETRY"})),Object.freeze({ACCOUNT_API:"ACCOUNT_API",DEFAULT_COLLECTION:"DEFAULT_COLLECTION",CATALOG_LAYER:"CATALOG_LAYER"})),It=Object.freeze((u(Re={},Rt.ACCOUNT_API,{BASE_URL:"https://account.api.here.com/authorization/v1.1/projects/me"}),u(Re,Rt.DEFAULT_COLLECTION,{BASE_URL:"https://config.data.api.platform.here.com/config/v1/catalogs",PARAMS:{CREATED_BY:"created",COLLECTION:"-collection"}}),u(Re,Rt.CATALOG_LAYER,{BASE_URL:"https://interactive.data.api.platform.here.com/interactive/v1/catalogs",MOMDATA_LAYER:"9999999999999",ICON_LAYER:"icons",THEMERULE_LAYER:"config",COLLECTION_LAYER:"layers/9999999999999/search",PARAMS:{FEATURE_TYPE:{KEY:"p.featureType",VALUE:"indoor.Site"}}}),Re)),Ct=Object.freeze({isIconsEnabled:!0,isMetaEnabled:!0,metaOptions:{},iconOptions:{}}),Mt=Object.freeze({GET:"GET",POST:"POST",PUT:"PUT",DELETE:"DELETE",PATCH:"PATCH",OPTIONS:"OPTIONS",HEAD:"HEAD"});function Nt(){}function jt(){jt.init.call(this)}function Dt(t){return void 0===t._maxListeners?jt.defaultMaxListeners:t._maxListeners}function Bt(t,e,r,i){var n,o;if("function"!=typeof r)throw new TypeError('"listener" argument must be a function');return(n=t._events)?(n.newListener&&(t.emit("newListener",e,r.listener||r),n=t._events),o=n[e]):(n=t._events=new Nt,t._eventsCount=0),o?("function"==typeof o?o=n[e]=i?[r,o]:[o,r]:i?o.unshift(r):o.push(r),o.warned||(i=Dt(t))&&0<i&&o.length>i&&(o.warned=!0,(i=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+e+" listeners added. Use emitter.setMaxListeners() to increase limit")).name="MaxListenersExceededWarning",i.emitter=t,i.type=e,i.count=o.length,"function"==typeof console.warn?console.warn(i):console.log(i))):(o=n[e]=r,++t._eventsCount),t}function zt(t,e,r){var i=!1;function n(){t.removeListener(e,n),i||(i=!0,r.apply(t,arguments))}return n.listener=r,n}function Ft(t){var e=this._events;if(e){if("function"==typeof(e=e[t]))return 1;if(e)return e.length}return 0}function Ut(t,e){for(var r=new Array(e);e--;)r[e]=t[e];return r}function Gt(t,e,r){return r===Oe.ObjectType.SEGMENT_START_MARKER?0===t?Se:null:r===Oe.ObjectType.SEGMENT_FINISH_MARKER?1===e.length||t===e.length-1?ke:null:"indoor"===e[t].departure.place.type?Te:Ae}Nt.prototype=Object.create(null),(jt.EventEmitter=jt).usingDomains=!1,jt.prototype.domain=void 0,jt.prototype._events=void 0,jt.prototype._maxListeners=void 0,jt.defaultMaxListeners=10,jt.init=function(){this.domain=null,jt.usingDomains&&(void 0).active,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new Nt,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},jt.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||isNaN(t))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=t,this},jt.prototype.getMaxListeners=function(){return Dt(this)},jt.prototype.emit=function(t){var e,r,i,n="error"===t,o=this._events;if(o)n=n&&null==o.error;else if(!n)return!1;if(a=this.domain,n){var a;if(n=arguments[1],a)return(n=n||new Error('Uncaught, unspecified "error" event')).domainEmitter=this,n.domain=a,n.domainThrown=!1,a.emit("error",n),!1;throw n instanceof Error?n:((a=new Error('Uncaught, unspecified "error" event. ('+n+")")).context=n,a)}if(!(e=o[t]))return!1;var s,l="function"==typeof e;switch(s=arguments.length){case 1:var c=e;if(f=l)c.call(this);else for(var u=c.length,h=Ut(c,u),p=0;p<u;++p)h[p].call(this);break;case 2:var f=e,d=arguments[1];if(c=l)f.call(this,d);else for(var y=f.length,g=Ut(f,y),v=0;v<y;++v)g[v].call(this,d);break;case 3:var m=e,_=arguments[1],b=arguments[2];if(T=l)m.call(this,_,b);else for(var w=m.length,x=Ut(m,w),E=0;E<w;++E)x[E].call(this,_,b);break;case 4:var T=e,A=arguments[1],S=arguments[2],k=arguments[3];if(m=l)T.call(this,A,S,k);else for(var O=T.length,L=Ut(T,O),P=0;P<O;++P)L[P].call(this,A,S,k);break;default:for(r=new Array(s-1),i=1;i<s;i++)r[i-1]=arguments[i];var R=e,I=r;if(l)R.apply(this,I);else for(var C=R.length,M=Ut(R,C),N=0;N<C;++N)M[N].apply(this,I)}return!0},jt.prototype.on=jt.prototype.addListener=function(t,e){return Bt(this,t,e,!1)},jt.prototype.prependListener=function(t,e){return Bt(this,t,e,!0)},jt.prototype.once=function(t,e){if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');return this.on(t,zt(this,t,e)),this},jt.prototype.prependOnceListener=function(t,e){if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');return this.prependListener(t,zt(this,t,e)),this},jt.prototype.removeListener=function(t,e){var r,i,n,o,a;if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');if((i=this._events)&&(r=i[t]))if(r===e||r.listener&&r.listener===e)0==--this._eventsCount?this._events=new Nt:(delete i[t],i.removeListener&&this.emit("removeListener",t,r.listener||e));else if("function"!=typeof r){for(n=-1,o=r.length;0<o--;)if(r[o]===e||r[o].listener&&r[o].listener===e){a=r[o].listener,n=o;break}if(n<0)return this;if(1===r.length){if(r[0]=void 0,0==--this._eventsCount)return this._events=new Nt,this;delete i[t]}else{for(var s=r,l=n,c=l+1,u=s.length;c<u;l+=1,c+=1)s[l]=s[c];s.pop()}i.removeListener&&this.emit("removeListener",t,a||e)}return this},jt.prototype.removeAllListeners=function(t){var e,r=this._events;if(r){if(!r.removeListener)return 0===arguments.length?(this._events=new Nt,this._eventsCount=0):r[t]&&(0==--this._eventsCount?this._events=new Nt:delete r[t]),this;if(0===arguments.length){for(var i,n=Object.keys(r),o=0;o<n.length;++o)"removeListener"!==(i=n[o])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=new Nt,this._eventsCount=0,this}if("function"==typeof(e=r[t]))this.removeListener(t,e);else if(e)for(;this.removeListener(t,e[e.length-1]),e[0];);}return this},jt.prototype.listeners=function(t){var e=this._events;return t=e&&(e=e[t])?"function"==typeof e?[e.listener||e]:function(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}(e):[],t},jt.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):Ft.call(t,e)},jt.prototype.listenerCount=Ft,jt.prototype.eventNames=function(){return 0<this._eventsCount?Reflect.ownKeys(this._events):[]};var Ht="venues-ui-button--active",Vt="venues-ui-button",qt="venues-ui__drawings",$t="data-drawing",Wt=function(){function t(e,r,i){var n=this,o=(s(this,t),this.clickHandler=i,this.containerDiv=document.createElement("div"),this.containerDiv.setAttribute("class",qt),document.createElement("div"));(o.setAttribute("class","trigger ".concat(Vt)),i=document.createElement("div")).setAttribute("class","arrow arrow--down"),o.appendChild(i),o.addEventListener("click",(function(){o.classList.toggle(Ht),n.containerButtons.classList.toggle("drawings--open")})),this.containerDiv.appendChild(o),this.containerButtons=document.createElement("div"),this.containerButtons.setAttribute("class","drawings"),this.containerDiv.appendChild(this.containerButtons),r&&this.update(r),e.appendChild(this.containerDiv)}return c(t,[{key:"drawButton",value:function(t,e,r){var i=this,n=document.createElement("div");r=Number(r)===Number(t),n.setAttribute("class",r?"".concat(Vt," ").concat(Ht):Vt),n.innerHTML=e,n.setAttribute($t,t),n.addEventListener("click",(function(){i.switch(t),i.clickHandler(t)})),this.containerButtons.appendChild(n)}},{key:"switch",value:function(t){this.containerButtons.querySelectorAll(".".concat(qt," .").concat(Ht)).forEach((function(t){return t.setAttribute("class",Vt)})),(t=this.containerButtons.querySelector("[".concat($t,"='").concat(t,"']")))&&t.setAttribute("class","".concat(Vt," ").concat(Ht))}},{key:"update",value:function(t){var e=this,r=(this.containerButtons.innerHTML="",function(t){return t=t.getDrawings(),new Map(t.map((function(t){var e=t.getDisplayName()||t.getName();return[t.getId(),e]})))}(t));0<r.size&&r.forEach((function(r,i){return e.drawButton(i,r,t.getRootDrawing().getId())}))}}]),t}(),Yt="venues-ui-button--active",Xt="venues-ui-button",Kt="data-level",Zt="venues-ui__levels",Jt=function(){function t(e,r,i,n){var o=4<arguments.length&&void 0!==arguments[4]?arguments[4]:4;s(this,t),this.clickHandler=n,this.levelButtonCount=o,this.currentScrollIndex=0,this.containerUI=document.createElement("div"),this.containerUI.setAttribute("class","".concat(Zt)),this.containerButtons=document.createElement("div"),this.containerButtons.setAttribute("class","levels"),this.containerUI.appendChild(this.containerButtons),r&&this.update(r,i),e.appendChild(this.containerUI)}return c(t,[{key:"clear",value:function(){this.containerButtons.innerHTML="",this.buttonScrollUp&&(this.containerUI.removeChild(this.buttonScrollUp),this.buttonScrollUp=null),this.buttonScrollDown&&(this.containerUI.removeChild(this.buttonScrollDown),this.buttonScrollDown=null)}},{key:"drawLevelButton",value:function(t,e){var r=this,i=document.createElement("div");i.innerHTML=e,i.style.fontSize="".concat(Math.max(Math.min(28.8/e.length,11.52),10),"px"),i.style.display="block",i.setAttribute("class",Xt),i.setAttribute(Kt,t),i.addEventListener("click",(function(){r.switch(t),r.clickHandler(t)})),this.containerButtons.appendChild(i)}},{key:"drawScrollButtons",value:function(){var t,e=this;((this.buttonScrollUp=document.createElement("div"),this.buttonScrollUp.setAttribute("class","".concat(Xt," ").concat(Xt,"--up")),t=document.createElement("div")).setAttribute("class","arrow arrow--up"),this.buttonScrollUp.appendChild(t),this.buttonScrollUp.addEventListener("click",(function(){return e.scroll(1)})),this.containerUI.insertBefore(this.buttonScrollUp,this.containerButtons),this.buttonScrollDown=document.createElement("div"),this.buttonScrollDown.setAttribute("class","".concat(Xt," ").concat(Xt,"--down")),t=document.createElement("div")).setAttribute("class","arrow arrow--down"),this.buttonScrollDown.appendChild(t),this.buttonScrollDown.addEventListener("click",(function(){return e.scroll(-1)})),this.containerUI.appendChild(this.buttonScrollDown)}},{key:"scroll",value:function(){var t,e,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,i=Array.from(this.containerButtons.querySelectorAll(".".concat(Xt))).reverse(),n=[];0<=r?(this.currentScrollIndex=Math.min(this.currentScrollIndex+r,i.length-this.levelButtonCount),t=Math.min(this.currentScrollIndex,i.length-this.levelButtonCount),e=Math.min(this.currentScrollIndex+this.levelButtonCount,i.length),n=i.slice(t,e)):r<0&&(this.currentScrollIndex=Math.max(this.currentScrollIndex+r,0),t=Math.max(0,this.currentScrollIndex),e=Math.min(i.length,this.currentScrollIndex+this.levelButtonCount),n=i.slice(t,e)),i.forEach((function(t){-1!==n.indexOf(t)?t.style.display="block":t.style.display="none"})),this.buttonScrollDown&&(0===this.currentScrollIndex?this.buttonScrollDown.setAttribute("disabled","disabled"):this.buttonScrollDown.removeAttribute("disabled")),this.buttonScrollUp&&(this.currentScrollIndex===i.length-this.levelButtonCount?this.buttonScrollUp.setAttribute("disabled","disabled"):this.buttonScrollUp.removeAttribute("disabled"))}},{key:"switch",value:function(t){var e;this.containerButtons.querySelectorAll(".".concat(Yt)).forEach((function(t){return t.setAttribute("class",Xt)})),(t=this.containerButtons.querySelector(".".concat(Zt," [").concat(Kt,"='").concat(t,"']")))&&(e=Array.from(this.containerButtons.querySelectorAll(".".concat(Xt))).reverse(),t.setAttribute("class","".concat(Xt," ").concat(Yt)),((e=e.indexOf(t))<this.currentScrollIndex||e>=this.currentScrollIndex+4)&&this.scroll(e-this.currentScrollIndex))}},{key:"update",value:function(t,e){var r,i=this,n=(e=function(){return new Map((0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]).map((function(t){return[t.getZIndex(),t.getShortName()||t.getDisplayName()||t.getName()]})))}((r=t,(e===kt.FLATTEN?(e=r.getVenueModel().getLevelMapFlattenedByZIndex_(),Object.values(e).map((function(t){return t[0]}))):r.getLevels()).sort((function(t,e){return e.getZIndex()-t.getZIndex()})))),t.getMainLevel().getZIndex());this.clear(),e.forEach((function(t,e){return i.drawLevelButton(e,t)})),e.size>this.levelButtonCount&&(e.size>this.levelButtonCount+1?this.currentScrollIndex=Math.min(Array.from(e).reverse().findIndex((function(t){return t[0]===n})),e.size-this.levelButtonCount):this.currentScrollIndex=0,this.drawScrollButtons(),this.scroll(0)),this.switch(n)}}]),t}(),Qt=function(){function t(e,r){s(this,t),this.baseTheme=e,this.metaInformation=r,this.labelStyleMap={},this.styleMap={},this.setStyleMap()}return c(t,[{key:"setStyleMap",value:function(){this.styleMap.ENTRANCE=this.baseTheme.entranceRules.default.styleProperties,this.labelStyleMap.ENTRANCE=this.baseTheme.entranceRules.default.textLabelStyleProperties;for(var t=0,e=Object.entries(this.baseTheme.spaceRules);t<e.length;t++){var r,i=(r=_(e[t],2))[0],n=(r=r[1]).properties.behavioralAppearance.default.styleProperties,o=r.properties.behavioralAppearance.default.textLabelStyleProperties;if(this.styleMap[i]=n,this.labelStyleMap[i]=o,r.spaceTypes)for(var a=0,s=Object.entries(r.spaceTypes);a<s.length;a++){var l=(u=_(s[a],2))[0],c=(u=u[1]).behavioralAppearance.default.styleProperties,u=u.behavioralAppearance.default.textLabelStyleProperties;this.styleMap["".concat(i,"_").concat(l)]=c&&0!==Object.keys(c)?c:n,this.labelStyleMap["".concat(i,"_").concat(l)]=u&&0!==Object.keys(u)?u:o}}}},{key:"getBaseTheme",value:function(){return this.baseTheme}},{key:"getStyleMap",value:function(){return this.styleMap}},{key:"getGeometryStyle",value:function(t){return this.styleMap&&Object.getOwnPropertyNames(this.styleMap)?this.styleMap[t]:null}},{key:"getLabelStyle",value:function(t){return this.labelStyleMap&&Object.getOwnPropertyNames(this.labelStyleMap)?this.labelStyleMap[t]:null}}],[{key:"getGeometryDefaultStyle",value:function(){return{fill:"#e5e5e5",fillOpacity:1,stroke:"#6c7a89",strokeOpacity:1,strokeWidth:2}}},{key:"getLabelDefaultStyle",value:function(){return{stroke:"#6c7a89",zmin:15}}}]),t}(),te=function(){function t(){s(this,t),this.config=Object.seal({emitEventOnOverrideUpdate:!0}),this.imageCache={},this.releaseSettings_={displayOptions:{},mom:[]},this.theme={}}return c(t,[{key:"getMomData",value:function(){return this.releaseSettings_.mom}},{key:"getTheme",value:function(){return this.theme||{}}},{key:"getStyle",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]&&arguments[1],r=this.getTheme(),i=Qt.getGeometryDefaultStyle(),n=t.properties.spaceType,o=t=t.properties.spaceCategory;return n&&(o="".concat(t,"_").concat(n)),{m:(t=(t=r.getGeometryStyle(o))&&!e?t:i).fill&&t.fill.toLowerCase()||"#fff",w:t.strokeWidth/10||.1,o:t.stroke&&t.stroke.toLowerCase()||"#fff",l:"Dark"}}},{key:"getLabelStyle",value:function(t){this.getTheme();var e=Qt.getLabelDefaultStyle();return{fill:e.stroke,zmin:e.zmin}}}]),t}(),ee=Math.PI/180,re=180/Math.PI,ie=function(){function t(){s(this,t)}return c(t,null,[{key:"toRadians",value:function(t){return t*ee}},{key:"toDegrees",value:function(t){return t*re}},{key:"getBoundingBox",value:function(e,r){var i=[];switch(e){case wt:i=[r,r];break;case Tt:case xt:i=r;break;case At:case Et:i=r.reduce((function(t,e){return t.concat(e)}),[]);break;case St:i=r.reduce((function(t,e){return t.concat(e)}),[]).reduce((function(t,e){return t.concat(e)}),[])}return t.getBoundingBoxVertices(i)}},{key:"getInverseTransform",value:function(t){var e=t[0]*t[3]-t[1]*t[2];return(e=[t[3]/e,-t[1]/e,-t[2]/e,t[0]/e,0,0])[4]=-(e[0]*t[4]+e[2]*t[5]),e[5]=-(e[1]*t[4]+e[3]*t[5]),e}},{key:"applyTransformToPoint",value:function(t,e){return[e[0]*t[0]+e[1]*t[2]+t[4],e[0]*t[1]+e[1]*t[3]+t[5]]}},{key:"transformProduct",value:function(t,e){var r=[0,0,0,0,0,0];return r[0]=e[0]*t[0]+e[2]*t[1],r[1]=e[1]*t[0]+e[3]*t[1],r[2]=e[0]*t[2]+e[2]*t[3],r[3]=e[1]*t[2]+e[3]*t[3],r[4]=e[0]*t[4]+e[2]*t[5]+e[4],r[5]=e[1]*t[4]+e[3]*t[5]+e[5],r}},{key:"convertLonLatToMerc",value:function(t){var e=t[0]*ee;return t=t[1]*ee,t=Math.sin(t),[.5+e/(2*Math.PI),.5-Math.log((1+t)/(1-t))/(4*Math.PI)]}},{key:"convertMercToLatLon",value:function(t){var e=2*Math.PI*(t[0]-.5);return t=Math.atan(Math.sinh(2*Math.PI*(.5-t[1]))),[e/ee,t/ee]}},{key:"getTransformScale",value:function(t){return Math.sqrt(t[0]*t[3]-t[1]*t[2])}},{key:"getLonLatToMercTransform",value:function(e){var r=[1/360,0,0,-1/(360*Math.cos(e[1]*ee)),0,0],i=t.applyTransformToPoint(r,e);return e=t.convertLonLatToMerc(e),r[4]=e[0]-i[0],r[5]=e[1]-i[1],r}},{key:"getNatToMercTransform",value:function(e){var r=[e[4],e[5]];return r=t.getLonLatToMercTransform(r),t.transformProduct(e,r)}},{key:"convertMxMy2LonLat",value:function(e,r){return e.length&&r.length?t.applyTransformToPoint(e,r):[]}},{key:"convertLonLat2MxMy",value:function(e,r){return e.length&&r.length?(e=t.getInverseTransform(e),t.applyTransformToPoint(e,r)):[]}},{key:"getFlattenedQuadraticBezierCurve",value:function(t,e,r){var i=[],n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:10;n<1&&(n=6);for(var o=0;o<=n;o+=1){var a=(1-(l=o/n))*(1-l),s=2*l*(1-l),l=l*l,c=a*t[0]+s*e[0]+l*r[0];a=a*t[1]+s*e[1]+l*r[1],i.push([c,a])}return i}},{key:"getFlattenedCubicBezierCurve",value:function(t,e,r,i){var n=[],o=4<arguments.length&&void 0!==arguments[4]?arguments[4]:10;o<1&&(o=6);for(var a=0;a<=o;a+=1){var s=(1-(u=a/o))*(1-u)*(1-u),l=3*u*(1-u)*(1-u),c=3*u*u*(1-u),u=u*u*u,h=s*t[0]+l*e[0]+c*r[0]+u*i[0];s=s*t[1]+l*e[1]+c*r[1]+u*i[1],n.push([h,s])}return n}},{key:"getRectangularCoordinatesOfLabelArea",value:function(e,r){var i=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],n=(l=_(e,6))[0],o=l[1],a=l[2],s=l[3],l=l[5],c=t.getDeltaLonLatForMeterAtGivenLonLat(n,o);return e=e[4],i?(l&&(e*=-1),null!=r&&(e=(e+=r<0?2*Math.PI+r:r)<0?2*Math.PI+e:e)):e=0,t.getRectVerticesFromSignatureRectRepresentation([n,o],{xLength:a,yLength:s},e,c)}},{key:"getRotatedPoint",value:function(t,e){var r,i=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:[0,0],o=Math.cos(e),a=(e=Math.sin(e),t[0]-n[0]);return t=t[1]-n[1],[(r=i?[a*o+t*e,t*o-a*e]:[a*o-t*e,t*o+a*e])[0]+n[0],r[1]+n[1]]}},{key:"getRectVerticesFromSignatureRectRepresentation",value:function(e,r,i,n){var o=r.xLength,a=(r=r.yLength,!(4<arguments.length&&void 0!==arguments[4])||arguments[4]),s=(e=_(e,2))[0],l=e[1],c=o/2,u=r/2,h=(e=_(n,2))[0],p=e[1];return[[1,1],[-1,1],[-1,-1],[1,-1]].map((function(t){return[t[0]*c,t[1]*u]})).map((function(e){return t.getRotatedPoint(e,i,a)})).map((function(t){return[t[0]*h,t[1]*p]})).map((function(t){return[t[0]+s,t[1]+l]}))}},{key:"getScaleFactorForRectInSpace",value:function(t,e,r,i){return t/=r,(r=e/i)<t?r:t}},{key:"getDeltaLonLatForMeterAtGivenLonLat",value:function(t,e){return[1/6371e3*(180/Math.PI)/Math.cos(e*Math.PI/180),1/6371e3*(180/Math.PI)]}},{key:"getBoundingBoxVertices",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=[[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY]];return t.reduce((function(t,e){return[[Math.min(e[0],t[0][0]),Math.min(e[1],t[0][1])],[Math.max(e[0],t[1][0]),Math.max(e[1],t[1][1])]]}),e)}},{key:"isPointInBoundingBox",value:function(t,e){var r,i,n,o;if(t&&e)return r=(t=_(t,2))[0],t=t[1],e=_(e,2),i=(n=_(e[0],2))[0],n=n[1],o=(e=_(e[1],2))[0],e=e[1],r<=o&&i<=r&&t<=e&&n<=t}},{key:"isPointOnLineSegment",value:function(t,e,r){var i=(t=_(t,2))[0],n=(t=t[1],(e=_(e,2))[0]),o=(e=e[1],(r=_(r,2))[0]),a=(e-t)*((r=r[1])-t)<=0;return n===o?n===i&&a:t-r==(r-e)/(o-n)*(i-o)&&a}},{key:"rayIntersectLineSegment",value:function(t,e,r){var i=(t=_(t,2))[0],n=(t=t[1],(e=_(e,2))[0]),o=(e=e[1],(r=_(r,2))[0]);return r=r[1],n!==o&&0<=(i=(i-n)/(o-n))&&i<1&&t<(r-e)*i+e}},{key:"isPointInPolygon",value:function(e,r){var i=(e=_(e,2))[0],n=e[1];if((e=r.length)<3)return!1;var o=0,a=r[e-1];return r.forEach((function(e){t.rayIntersectLineSegment([i,n],a,e)&&(o+=1),a=e})),o%2!=0}},{key:"isPointOnLineString",value:function(e,r){var i=(e=_(e,2))[0],n=e[1],o=r.length;if(!(o<2))for(var a=r[o-1],s=0;s<o;s+=1){var l=r[s];if(t.isPointOnLineSegment([i,n],a,l))return!0;a=r[s]}return!1}},{key:"getAreaOfPolygon",value:function(t){var e=t.length;if(e<3)return null;var r=0,i=t[e-1];return t.forEach((function(t){var e,n,o,a;r+=.5*(n=t,o=(e=_(e=i,2))[0],e=e[1],a=(n=_(n,2))[0],o*n[1]-e*a),i=t})),r}},{key:"getDistanceBetweenPoints",value:function(t,e){var r=(t=_(t,2))[0];return t=t[1],r-=(e=_(e,2))[0],t-=e[1],Math.sqrt(r*r+t*t)}}]),t}(),ne=function(){function t(){s(this,t),this.spaceRules={}}return c(t,null,[{key:"getDataEntriesOne",value:function(t,e){var r;return t=[t,""],null!==e&&Array.isArray(e)?t[1]=e.toString():null!==e&&"object"===o(e)?0<(r=Object.entries(e)).length&&(r=this.getDataEntriesOne(r[0][0],r[0][1]),t[0]="".concat(t[0],".").concat(r[0]),t[1]=r[1]):t[1]=e,t}},{key:"getDataEntriesAll",value:function(t){for(var e=[],r=0,i=Object.entries(t);r<i.length;r++){var n=(o=_(i[r],2))[0],o=o[1];n=this.getDataEntriesOne(n,o),e.push(n)}return e}},{key:"doFindComboMatch",value:function(t,e){var r="";if(t&&t.configuration&&t.configuration.combinations)for(var i=this.getDataEntriesAll(e),n=(e=Object.entries(t.configuration.combinations),0),o=0,a=e;o<a.length;o++)!function(){var t=a[o],e=Object.keys(t[1]).filter((function(e){return i.some((function(r){return e===r[0]&&t[1][e]===r[1]}))}));e.length===Object.keys(t[1]).length&&e.length>n&&(r=t[0],n=e.length)}();return r}},{key:"getIconFromCombinations",value:function(t,e){if(t&&t.configuration.combinations&&e&&0<Object.keys(e).length&&t.behavioralAppearance.combinations&&0<Object.keys(t.behavioralAppearance.combinations).length){if(""===(e=this.doFindComboMatch(t,e))||!t.behavioralAppearance.combinations[e].labelIcon)return"";if(t.behavioralAppearance.combinations&&t.behavioralAppearance.combinations[e]&&t.behavioralAppearance.combinations[e].labelIcon)return t.behavioralAppearance.combinations[e].labelIcon.referenceUri}return""}},{key:"findSpace",value:function(t,e){if(e.spaceTypes&&e.spaceTypes[t])return e.spaceTypes[t]}},{key:"findCategory",value:function(t){if(this.spaceRules[t])return this.spaceRules[t]}},{key:"setSpaceRules",value:function(t){this.spaceRules=t}},{key:"getSpaceIcon",value:function(t,e,r){var i,n="";return(e=this.findCategory(e))&&(t=this.findSpace(t,e))&&(i="",(i=r?this.getIconFromCombinations(t,r):i)&&""!==i?n=i:t.behavioralAppearance.default.labelIcon?n=t.behavioralAppearance.default.labelIcon.referenceUri:e.properties.behavioralAppearance.default.labelIcon&&(n=e.properties.behavioralAppearance.default.labelIcon.referenceUri)),n}}]),t}(),oe=function(){function t(){s(this,t),this.themeRule={},this.svgList={},this.defaultLang="ENG"}return c(t,null,[{key:"getNumberFromAlphaNumeric",value:function(t){try{var e=t.split("").reverse().join("").replace(/[^0-9]/g,"").substr(0,6);return parseInt(e,10)}catch(t){return null}}},{key:"extractNumFromSting",value:function(t){try{var e=t.replace(/[^0-9]/g,"");return parseInt(e,10)}catch(e){return console.warn("Exception in converting string to Id"),this.getNumberFromAlphaNumeric(t)}}},{key:"getVenueId",value:function(t){var e;return"number"!=typeof t?(e=t.substr(t.length-6),parseInt(e,10)):t}},{key:"getStringFormatIdentifier",value:function(t){return"number"==typeof t||t.length<13?"indoormap-00000000-0000-4000-a000-".concat(t.toString().padStart(12,"0")):t}},{key:"setSite",value:function(t,e){var r=this.getName(t);return(t={id:this.getStringFormatIdentifier(e),location:t.referencePoint,properties:t.properties,geometry:t.geometry,map_version:t.properties.indoorSiteMetadata.legacyVersion.mapVersion,identifier:this.getVenueId(e),obj_type:"CommunityMap"}).properties.name=r,t.properties.display_name=r,t}},{key:"setEntrance",value:function(t){var e=this.themeRule.entranceRules.default.labelIcon.referenceUri,r=this.extractNumFromSting(t.id),i=this.getName(t),n=t.properties;return n.icon=!0,n.svg=this.svgList[e.toLowerCase()],n.name=i||"entrance",n.display_name=i||"entrance",n.level={id:t.properties.level.id},{id:t.id,levelId:t.properties.level.id,momType:mt,geometry:t.geometry,location:t.geometry,properties:n,identifier:r,label_area:[t.referencePoint.coordinates[0],t.referencePoint.coordinates[1],50,50,180]}}},{key:"setStructure",value:function(t){var e=this.extractNumFromSting(t.id),r=this.getName(t),i=t.properties;return i.is_root=0===t.properties.drawOrder,i.display_name=r,i.map_type=t.properties.structureType,i.name=r,{id:t.id,obj_type:"Drawing",identifier:e,properties:i}}},{key:"getNameByPriority",value:function(t,e){for(var r,i="",n=0;n<t.length;n++){var o=t[n];if(("OFFICIAL"===(r=o).nameType&&r.languageCode&&r.languageCode===this.defaultLang||"OFFICIAL"===r.nameType)&&(e&&e===o.nameType||!e)){i=o.name;break}if("ABBREVIATION"===o.nameType&&(e&&e===o.nameType||!e)){i=o.name;break}if("UNCLASSIFIED"===o.nameType&&(e&&e===o.nameType||!e)){i=o.name;break}if(!o.nameType&&o.name){i=o.name;break}}return i}},{key:"getName",value:function(t,e){return t.properties&&t.properties.names?this.getNameByPriority(t.properties.names,e):t.properties.placeProperties&&t.properties.placeProperties&&t.properties.placeProperties.names?this.getNameByPriority(t.properties.placeProperties.names,e):t.properties.locationDetails&&t.properties.locationDetails[0]&&t.properties.locationDetails[0].names?this.getNameByPriority(t.properties.locationDetails[0].names,e):""}},{key:"setLevel",value:function(t){var e=this.extractNumFromSting(t.id),r=t.properties.names,i=t.properties;return i["short name"]=this.getNameByPriority(r,r&&1!==r.length?"ABBREVIATION":""),i.name=this.getNameByPriority(r,r&&1!==r.length?"ABBREVIATION":""),{id:t.id,obj_type:"Level",identifier:e,properties:i}}},{key:"setLevelConnector",value:function(t){var e=this.extractNumFromSting(t.id);return{id:t.id,obj_type:"LevelConnector",properties:t.properties,geometry:t.geometry,identifier:e,location:t.geometry}}},{key:"setOccupant",value:function(t){var e=this.getName(t),r=this.extractNumFromSting(t.id),i=t.properties;return i.occupantName=e,i.email=t.properties.placeProperties&&t.properties.placeProperties.contacts&&t.properties.placeProperties.contacts.find((function(t){return"EMAIL"===t.contactType}))&&t.properties.placeProperties.contacts.find((function(t){return"EMAIL"===t.contactType})).value,i.name=e,i.tags=t.properties.attributes&&t.properties.attributes.tags,{geometry:t.geometry,id:t.id,obj_type:"Geometry",properties:i,identifier:r,spaceIds:t.properties.spaces||[],type:"Feature",momType:dt}}},{key:"getIcon",value:function(t){var e=!1,r="";return this.svgList[t]&&(e=!0,r=this.svgList[t]),{icon:e,svg:r}}},{key:"setSpace",value:function(t){var e=ne.getSpaceIcon(t.properties.spaceType,t.properties.spaceCategory,t.properties.spaceTypeProperties),r=this.getName(t),i=(e=this.getIcon(e)).icon,n=(e=e.svg,this.extractNumFromSting(t.id)),o=(t.properties.level.id.includes("out"),t.properties.level.id),a=t.properties;return a.spaceName=r,a[t.properties.spaceCategory]=t.properties.spaceType,a.spaceType=t.properties.spaceType,a.spaceCategory=t.properties.spaceCategory,a.icon=i,a.svg=e,r={geometry:t.geometry,id:t.id,levelId:o,label_area:[t.referencePoint.coordinates[0],t.referencePoint.coordinates[1],50,50,180],location:t.referencePoint,obj_type:"Geometry",identifier:n,properties:a,momType:yt,type:"Feature"},t.properties.spaceAddress&&t.properties.spaceAddress.id&&(r.addressId=t.properties.spaceAddress.id),r}},{key:"setSpaceGroups",value:function(t){var e=this.extractNumFromSting(t.id);return{id:t.id,obj_type:"SpaceGroups",properties:t.properties,geometry:t.geometry,location:t.referencePoint,identifier:e}}},{key:"setTopology",value:function(t){var e=this.extractNumFromSting(t.id);return{id:t.id,obj_type:"Topology",properties:t.properties,geometry:t.geometry,identifier:e}}},{key:"setAddress",value:function(t){var e=this.extractNumFromSting(t.id),r=this.getName(t),i=t.properties;return i.addressName=r,i.name=r,{id:t.id,properties:i,obj_type:"Address",identifier:e}}},{key:"manageSvgDimensions",value:function(t){for(var e={},r=0,i=Object.entries(t);r<i.length;r++){var n,o,a,s=(a=_(i[r],2))[0];"string"==typeof(a=a[1])&&(n=-1!==a.indexOf("<g")&&a.indexOf("<g")||a.indexOf("<p"),o=a.indexOf("</s"),n&&o&&(a=a.substring(n-1,o-1),e[s]="<svg width='64' height='64' viewBox='0 0 24 32' fill='none' xmlns='http://www.w3.org/2000/svg'>".concat(a,"</svg>")))}return e}},{key:"getSiteBoundingBox",value:function(t){if(t){var e=(t=_(ie.getBoundingBox(t.geometry.type,t.geometry.coordinates),2))[0];if(t=t[1],e)return"".concat(e[0],",").concat(e[1],",").concat(t[0],",").concat(t[1])}return"null, null, null, null"}}]),t}(),ae=function(){function t(){s(this,t)}return c(t,null,[{key:"get",value:function(t){return fetch(t,1<arguments.length&&void 0!==arguments[1]?arguments[1]:{method:"GET"}).then((function(e){return e.ok?e.json():Promise.reject(new Error("Call failed for ".concat(t," : ").concat(e.status," ").concat(e.statusText)))}))}},{key:"getFormattedIndoorMapId",value:function(t){return"number"==typeof t?"indoormap-00000000-0000-4000-a000-".concat(t.toString().padStart(12,"0")):t.includes("indoormap")?t:"indoormap-00000000-0000-4000-a000-".concat(t.padStart(12,"0"))}},{key:"getConfigUrl",value:function(t,e,r){var i=r.apiKey,n=r.url,o=r.token,a=(r=r.hrn,{method:"GET",mode:"cors",cache:"default"});return n="".concat(n||Lt,"/").concat(r),r="",e===pt.SITE&&(r="".concat(n,"/layers/").concat(Ot,"/search?p.featureType=indoor.Site&p.indoorMapId='").concat(this.getFormattedIndoorMapId(t),"'")),e===pt.IMAGES&&(r="".concat(n,"/layers/").concat("icons","/features/svg")),e===pt.Theme&&(r="".concat(n,"/layers/").concat("config","/features/indoorMapRules")),o?a.headers={Authorization:"Bearer ".concat(o)}:r=r.concat("".concat(e===pt.SITE?"&":"?","apiKey=").concat(i)),this.get(r,a)}},{key:"getMomData",value:function(t,e){var r=e.apiKey,i=e.url,n=e.token,o=(e=e.hrn,{method:"GET",mode:"cors",cache:"default"});return i="".concat(i||Lt,"/").concat(e),e=t&&t.features&&t.features.find((function(t){return t.momType===ft})),t=oe.getSiteBoundingBox(e),i="".concat(i,"/layers/").concat(Ot,"/bbox?bbox=").concat(t,"&f.momType=indoor.Level,indoor.Space,indoor.Site,indoor.Structure,indoor.Occupant,indoor.SpaceGroups,Address,indoor.Entrance"),n?o.headers={Authorization:"Bearer ".concat(n)}:i=i.concat("&apiKey=".concat(r)),{mom:this.get(i,o),site:e}}},{key:"getDefaultCollection",value:function(t){t=t.token;var e=(r=It[Rt.DEFAULT_COLLECTION]).PARAMS,r=r.BASE_URL;return r=encodeURI("".concat(r,"?sortBy=").concat(e.CREATED_BY,"&q=").concat(e.COLLECTION)),t?(e={method:"GET",headers:{Authorization:"Bearer ".concat(t)}},this.get(r,e)):Promise.reject(new Error("Please provide valid token"))}},{key:"getProjectAccountDetails",value:function(t){t=t.token;var e=It[Rt.ACCOUNT_API].BASE_URL;return t?(t={method:"GET",mode:"cors",headers:{Authorization:"Bearer ".concat(t)}},this.get(e,t)):Promise.reject(new Error("Please provide valid token"))}},{key:"fetchIndoorMapList",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=t.hrn,r=t.url,i=(n=It[Rt.CATALOG_LAYER]).PARAMS,n=n.COLLECTION_LAYER;return r=r||Lt,e?(r=encodeURI("".concat(r,"/").concat(e,"/").concat(n,"?").concat(i.FEATURE_TYPE.KEY,"=").concat(i.FEATURE_TYPE.VALUE)),n=(e=this.createBaseUrl(r,Mt.GET,{},t)).URL,i=e.options,this.get(n,i)):Promise.reject(new Error("Please provide valid hrn"))}},{key:"createBaseUrl",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:Mt.GET,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},n=(o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{}).token,o=o.apiKey,a=t;return e={method:e,mode:"cors"},n?e.headers=i({Authorization:"Bearer ".concat(n)},r):a=t.concat("&apiKey=".concat(o)),{URL:a,options:e}}}]),t}(),se=function(){function t(){s(this,t)}return c(t,null,[{key:"isPointOnGeoJSONLineString",value:function(t,e){var r=!1;if(e&&1<e.length)for(var i,n,o=1;o<e.length;o+=1)if(i=e[o-1],n=e[o],ie.isPointOnLineSegment(t,i,n)){r=!0;break}return r}},{key:"isPointOnGeoJSONMultiLineString",value:function(e,r){for(var i=!1,n=0;n<r.length;n+=1)if(t.isPointOnGeoJSONLineString(e,r[n])){i=!0;break}return i}},{key:"isPointInsideGeoJSONPolygon",value:function(t,e){var r=!1;if(r=!!ie.isPointInPolygon(t,e[0])||r)for(var i=1;i<e.length;i+=1)if(ie.isPointInPolygon(t,e[i])){r=!1;break}return r}},{key:"isPointInsideGeoJSONMultiPolygon",value:function(e,r){for(var i=r.length,n=0;n<i;n+=1)if(t.isPointInsideGeoJSONPolygon(e,r[n]))return!0;return!1}},{key:"getGeometriesByLonLat",value:function(t,e){for(var r=2<arguments.length&&void 0!==arguments[2]&&arguments[2],i=[],n=e.filter((function(e){return ie.isPointInBoundingBox(t,e.getBoundingBox())})),o=0;o<n.length;o+=1){var a=n[o];if(a.isPointInsideGeometry(t,!0)&&(i.push(a),!r))break}return i.sort((function(t,e){return e.getZIndex()-t.getZIndex()}))}}]),t}(),le=function(){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=1<arguments.length?arguments[1]:void 0,i=2<arguments.length?arguments[2]:void 0;s(this,t),this.id=e.id,this.properties=e.properties||{},this.labelArea=e.label_area||[],this.geometry=e.geometry||{},this.location=e.location||{},this.address=e.address||{},this.level=r,this.zIndex=i,this.spaceId=e.spaceId,this.state_={isHighlighted:!1,highlightedStyle:{}},this.geometryData=e}return c(t,[{key:"getId",value:function(){return this.geometryData&&this.geometryData.identifier}},{key:"getIdentifier",value:function(){return this.id}},{key:"getProperties",value:function(){return this.properties}},{key:"getInternalAddress",value:function(){return this.address?this.address.properties&&this.address.properties.name:null}},{key:"getCenter",value:function(){return this.location.coordinates||[]}},{key:"getCoordinates",value:function(){return this.geometry.coordinates||[]}},{key:"getDisplayName",value:function(){return this.properties.display_name||""}},{key:"getName",value:function(){return this.properties.name||""}},{key:"getStyle",value:function(){return this.getMetaInformation_().getStyle(this)}},{key:"getIcon",value:function(){return this.properties.svg}},{key:"getLabelArea",value:function(){return this.labelArea||[]}},{key:"getLabelStyle",value:function(){return this.getMetaInformation_().getLabelStyle(this)||null}},{key:"getLevel",value:function(){return this.level}},{key:"getType",value:function(){return this.geometry.type}},{key:"getZIndex",value:function(){return this.zIndex}},{key:"getBoundingBox",value:function(){var t=this.getType(),e=this.getCoordinates(),r=[];switch(t){case wt:r=[e,e];break;case Tt:case xt:r=e;break;case At:case Et:r=e.reduce((function(t,e){return t.concat(e)}),[]);break;case St:r=e.reduce((function(t,e){return t.concat(e)}),[]).reduce((function(t,e){return t.concat(e)}),[])}return ie.getBoundingBoxVertices(r)}},{key:"isIcon",value:function(){return!!this.properties.icon}},{key:"isPointInsideGeometry",value:function(t){var e,r=1<arguments.length&&void 0!==arguments[1]&&arguments[1],i=!1;switch(this.getType()){case wt:e=this.getLabelArea()&&ie.getRectangularCoordinatesOfLabelArea(this.getLabelArea()),i=ie.isPointInPolygon(t,e);break;case Tt:break;case xt:i=r&&se.isPointOnGeoJSONLineString(t,this.getCoordinates());break;case At:i=r&&se.isPointOnGeoJSONMultiLineString(t,this.getCoordinates());break;case Et:i=se.isPointInsideGeoJSONPolygon(t,this.getCoordinates());break;case St:i=se.isPointInsideGeoJSONMultiPolygon(t,this.getCoordinates())}return i}},{key:"highlight",value:function(){var t=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],e=1<arguments.length?arguments[1]:void 0;this.state_.isHighlighted=t,this.state_.highlightedStyle=t?e:{}}},{key:"isHighlighted",value:function(){return Boolean(this.state_.isHighlighted)}},{key:"getHighlightedStyle",value:function(){return this.state_.highlightedStyle||{}}},{key:"toJSON",value:function(){return i({},this.geometry)}},{key:"getMetaInformation_",value:function(){return this.getLevel()?this.getLevel().getDrawing().getVenueModel().metaInformation_:null}}]),t}(),ce=function(){function t(e,r){var i=this;s(this,t),this.id=e&&e.id,this.properties=e&&e.properties,this.zIndexCount=0,this.geometries=e&&e.features&&Object.values(e.features).reduce((function(t,e){return t[[e.id]]=new le(e,i,e.properties.drawOrder),t}),{}),this.drawing=r,this.levelData=e}return c(t,[{key:"getId",value:function(){return this.levelData&&this.levelData.identifier}},{key:"getIdentifier",value:function(){return this.id}},{key:"getProperties",value:function(){return this.properties}},{key:"getName",value:function(){return this.properties&&this.properties.name||""}},{key:"getDisplayName",value:function(){return this.properties&&this.properties.display_name||""}},{key:"getDrawing",value:function(){return this.drawing}},{key:"getShortName",value:function(){return this.properties&&this.properties["short name"]||""}},{key:"getZIndex",value:function(){return this.properties&&this.properties.zLevel}},{key:"getFeatureCollectionArray",value:function(){return this.getGeometries().map((function(t){return t.toJSON()}))}},{key:"getGeometryById",value:function(t){return this.geometries[t]}},{key:"getGeometries",value:function(){return 0<arguments.length&&void 0!==arguments[0]&&arguments[0]?this.geometries&&Object.values(this.geometries).sort((function(t,e){return e.getZIndex()-t.getZIndex()})):this.geometries&&Object.values(this.geometries).sort((function(t,e){return t.getZIndex()-e.getZIndex()}))}},{key:"getGeometriesByAddress",value:function(t){return Object.values(this.geometries).filter((function(e){return e.address&&e.address.properties&&e.address.properties.name&&e.address.properties.name===t}))}},{key:"isMain",value:function(){return Boolean(this.properties.isMain)}}]),t}(),ue=function(){function t(e){var r=this,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:[],o=3<arguments.length?arguments[3]:void 0;s(this,t),this.venueModel=o,this.levels=n.map((function(t){return new ce(t,r)})),this.structure=e,this.id=e&&e.id,this.properties=i}return c(t,[{key:"getId",value:function(){return this.structure&&this.structure&&this.structure.identifier}},{key:"getIdentifier",value:function(){return this.id}},{key:"getProperties",value:function(){return this.properties}},{key:"isRoot",value:function(){return Boolean(this.properties.is_root)}},{key:"getDisplayName",value:function(){return this.properties.display_name||""}},{key:"getName",value:function(){return this.properties.name||""}},{key:"getBoundingBox",value:function(){if(this.structure&&this.structure.geometry){var t=(e=_(ie.getBoundingBox(this.structure.geometry.type,this.structure.geometry.coordinates),2))[0],e=e[1];if(t)return[e[1],t[0],t[1],e[0]]}return[null,null,null,null]}},{key:"getCenter",value:function(){return this.structure&&this.structure.location&&this.structure.location.coordinates}},{key:"getGeometryById",value:function(t){return this.getGeometries().find((function(e){return e.getId()===t||e.getIdentifier()===t}))}},{key:"getGeometries",value:function(){return this.levels.flatMap((function(t){return t.getGeometries()}))}},{key:"getLevelById",value:function(t){return this.levels.find((function(e){return e.getId()===t||e.getIdentifier()===t}))}},{key:"getLevelByZIndex",value:function(t){return this.levels.find((function(e){return e.getZIndex()===t}))}},{key:"getLevels",value:function(){return this.levels}},{key:"getMainLevel",value:function(){return this.levels.find((function(t){return t.isMain()}))}},{key:"getVenueModel",value:function(){return this.venueModel}}]),t}(),he=kt.STANDARD,pe=function(){function t(e){var r=this,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new te;s(this,t),this.metaInformation_=n,this.momStructure=e,this.id=e&&e.site&&e.site.id,this.location=e&&e.site&&e.site.location||{},this.properties=e&&e.site&&i({},e.site.properties),this.drawings=e&&e.structure&&Object.values(e.structure).map((function(t){var i=e.getStructureWiseGeometry(t.id);return new ue(t,t.properties,Object.values(i),r)}))}return c(t,[{key:"getDisplaySettings",value:function(){return(this.metaInformation_.releaseSettings_?this.metaInformation_.releaseSettings_.displayOptions:"").display||he}},{key:"getId",value:function(){return this.momStructure&&this.momStructure.site&&this.momStructure.site.identifier}},{key:"getIdentifier",value:function(){return this.id}},{key:"getName",value:function(){return this.properties.name}},{key:"getBoundingBox",value:function(){if(this.momStructure){var t=(e=_(ie.getBoundingBox(this.momStructure.site.geometry.type,this.momStructure.site.geometry.coordinates),2))[0],e=e[1];if(t)return[e[1],t[0],t[1],e[0]]}return[null,null,null,null]}},{key:"getCenter",value:function(){return this.location.coordinates}},{key:"getGeometryById",value:function(t){return this.getGeometries().find((function(e){return e.getId()===t||e.getIdentifier()===t}))}},{key:"getGeometries",value:function(){return this.getLevels().sort((function(t,e){return t.getZIndex()-e.getZIndex()})).flatMap((function(t){return t.getGeometries()}))}},{key:"getGeometriesByLonLat",value:function(t){var e,r=this,i=!(2<arguments.length&&void 0!==arguments[2])||arguments[2];return 0===(e=(e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[]).map((function(t){return r.getLevelById(t)}))).length&&(e=this.drawings.filter((function(e){return e=e.getBoundingBox(),ie.isPointInBoundingBox(t,e)})).flatMap((function(t){return t.getLevels()}))),se.getGeometriesByLonLat(t,e.flatMap((function(t){return t.getGeometries(!0)})),i)}},{key:"getDrawingById",value:function(t){return this.drawings.find((function(e){return e.getId()===t||e.getIdentifier()===t}))}},{key:"getDrawings",value:function(){return this.drawings}},{key:"getRootDrawing",value:function(){return this.drawings.find((function(t){return t.isRoot()}))}},{key:"getLevelById",value:function(t){return this.getLevels().find((function(e){return e.getId()===t||e.getIdentifier()===t}))}},{key:"getLevelsByZIndex",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;return this.getLevels().filter((function(e){return Number(e.getZIndex())===Number(t)}))}},{key:"getLevels",value:function(){return this.drawings.flatMap((function(t){return t.getLevels()}))}},{key:"getMomStructure",value:function(){return this.momStructure}},{key:"getLevelMapFlattenedByZIndex_",value:function(){return this.getLevels().reduce((function(t,e){var r=e.getZIndex();return t[r]||(t[r]=[]),t[r].push(e),t}),{})}},{key:"getOccupant",value:function(){var t=this.momStructure.occupant;return Object.values(t)}}]),t}(),fe=function(){function t(e){s(this,t),this.theme=e&&e.theme,this.level=e&&e.level,this.site=e&&e.site,this.spaces=e&&e.spaces,this.address=e&&e.address,this.levelConnector=e&&e.levelConnector,this.topology=e&&e.topology,this.entrance=e&&e.entrance,this.occupant=e&&e.occupant,this.structure=e&&e.structure,this.spaceGroups=e&&e.spaceGroups,this.levelWiseGeometry={},this.levelStructureMapping=e&&e.levelStructureMapping,this.outdoorLevelMapping=e&&e.outdoorLevelMapping||{},this.labelTextPreference=e&&e.labelTextPreference||null}return c(t,[{key:"setSpaceWithLevel",value:function(){var t=this;this.spaces&&Object.values(this.spaces).forEach((function(e){var r="",n=((e.addressId&&(r=t.address&&t.address[e.addressId]&&t.address[e.addressId].properties.addressName),n=e.properties).addressName=r,r=t.getLabelAsPerPreference(i(i({},e),{},{properties:n})),((n=e.properties).name=r,n.display_name=r,e.properties.icon&&(n.name=e.id,n.display_name=e.id),r=e).properties=n,r.address=t.address[e.addressId],(t.spaces[e.id]=e).levelId);t.outdoorLevelMapping[n]&&(n=t.outdoorLevelMapping[n]),t.levelWiseGeometry[n]||(t.levelWiseGeometry[n]={}),t.levelWiseGeometry[n][r.id]=r}))}},{key:"setOccupantWithLevel",value:function(){var t=this;this.occupant&&Object.values(this.occupant).forEach((function(e){var r,i;e.spaceIds&&e.properties.occupantName&&(r=[],i=[],e.spaceIds.forEach((function(n){function o(n){var o=!1,a=(t.labelTextPreference&&t.labelTextPreference.length&&(o=-1!==t.labelTextPreference.indexOf("OCCUPANT_NAMES")),o=null===t.labelTextPreference||o,n),s=n.properties;s.name=n.properties.icon||!o?n.properties.name:e.properties.occupantName,s.display_name=n.properties.icon||!o?n.properties.display_name:e.properties.occupantName,s.address=n.address,s.occupantName=e.properties.occupantName,o=n.levelId,t.outdoorLevelMapping[o]&&(o=t.outdoorLevelMapping[o]),t.levelWiseGeometry[o]||(t.levelWiseGeometry[o]={}),t.levelWiseGeometry[o][n.id]=a,r.push(a),i.push(n.id)}var a=n.id,s=(a=t.spaces[a],null);t.spaceGroups&&Object.values(t.spaceGroups).forEach((function(t){t.properties.spaceGroups&&t.properties.spaceGroups&&t.properties.spaceGroups.forEach((function(t){t.mainSpace&&t.mainSpace.id===n.id&&(s=t.spaces.map((function(t){return t.id})))}))})),s&&0<s.length&&s.forEach((function(e){o(t.spaces[e])})),a&&o(a)})),t.occupant[e.id]=e,t.occupant[e.id].space=r,t.occupant[e.id].spaceIds=i)}))}},{key:"setEntrance",value:function(){var t=this;this.entrance&&Object.values(this.entrance).forEach((function(e){var r=e.properties.level.id;t.levelWiseGeometry[r]||(t.levelWiseGeometry[e.properties.level.id]={}),t.outdoorLevelMapping[r]&&(r=t.outdoorLevelMapping[r]),t.levelWiseGeometry[r][e.id]=e}))}},{key:"setLevelWiseGeometry",value:function(){var t=this;this.level&&Object.keys(this.level).forEach((function(e){t.levelWiseGeometry[e]={}})),this.setSpaceWithLevel(),this.setOccupantWithLevel(),this.setEntrance()}},{key:"getStructureWiseGeometry",value:function(t){for(var e={},r=0,i=Object.entries(this.levelWiseGeometry);r<i.length;r++){var n=(o=_(i[r],2))[0],o=o[1];t===this.levelStructureMapping[n]&&(e[n]=this.level[n],e[n].features=o)}return e}},{key:"getLabelAsPerPreference",value:function(t){var e=(t=t.properties).spaceType,r=t.occupantName,i=t.spaceName,n=t.addressName,o=(t=t.spaceCategory,u(s={},"OCCUPANT_NAMES",r),u(s,"SPACE_NAME",i),u(s,_t,e?e.charAt(0).toUpperCase()+e.slice(1).toLowerCase():""),u(s,bt,t?t.charAt(0).toUpperCase()+t.slice(1).toLowerCase():""),u(s,"INTERNAL_ADDRESS_SHORT",n),u(s,"INTERNAL_ADDRESS",n),u(s,"INTERNAL_ADDRESS_LONG",n),s),a=(r=this.theme.spaceRules,"");if("NONE"===(i=t&&e&&r[t]&&r[t].spaceTypes&&r[t].spaceTypes[e].behavioralAppearance.default.labelType)){if(!this.labelTextPreference)return"";o[_t]=""}if(("NONE"===(n=t&&e&&r[t]&&r[t].properties&&r[t].properties.behavioralAppearance&&r[t].properties.behavioralAppearance.default&&r[t].properties.behavioralAppearance.default.labelType)||void 0===n)&&void 0===i){if(!this.labelTextPreference)return"";o[_t]="",o[bt]=""}var s=t&&e&&r[t]&&r[t].properties&&r[t].properties.behavioralAppearance&&r[t].properties.behavioralAppearance.default&&r[t].properties.behavioralAppearance.default.labelTextPreference,l=s&&this.labelTextPreference?this.labelTextPreference:s;if(l)for(var c=0;c<l.length;c++)if(o[l[c]]){a=o[l[c]];break}return a}}]),t}(),de=function(){function t(e){var r=e.apiKey,i=e.baseUrl,n=e.token;e=e.hrn,s(this,t),this.hostOptions_={apiKey:r,url:i,token:n,hrn:e},this.momData=[],this.theme={},this.loadOptions={}}var e,r;return c(t,[{key:"setHostOptions",value:function(t){0!==Object.keys(t).length&&(this.hostOptions_=i(i({},this.hostOptions_),t))}},{key:"getToken",value:function(){return this.hostOptions_.token}},{key:"getHrn",value:function(){return this.hostOptions_.hrn}},{key:"load",value:function(t){var e=this,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return this.loadOptions=i(i(i({},Ct),r),{},{venueId:t}),this.hostOptions_.mapData=r.mapData,this.hostOptions_.themeRule=r.themeRule,this.hostOptions_.svgList=r.svgList,this.hostOptions_.labelTextPreference=r.labelTextPreferenceOverride,this.getHrn()?this.getVenueModalInstance():this.getToken()?this.getDefaultCollectionWithToken().then((function(){return e.getVenueModalInstance()})).catch((function(){return Promise.reject(new Error("Unable to find indoor map collection. Please contact your administrator"))})):Promise.reject(new Error("In order to load indoor map, Please provide either hrn or token"))}},{key:"getVenueModalInstance",value:function(){var t=this;return Promise.resolve().then((function(){return t.loadOptions.isMetaEnabled?t.getMeta_(t.loadOptions.isIconsEnabled).catch((function(t){return console.warn(t),Promise.resolve()})):Promise.reject()})).then((function(e){return t.getVenue_(e)})).then((function(t){return t})).catch((function(t){console.debug("Captured event VENUE_ERROR_STATE",t)}))}},{key:"createMomStructure",value:function(){var t=this,e={site:{},structure:{},level:{},levelConnector:{},occupant:{},spaces:{},spaceGroups:{},topology:{},address:{},outdoorLevelMapping:{},entrance:{},levelStructureMapping:{}};return this.momData.forEach((function(r){var i="indoormap-00000000-0000-4000-a000-".concat(t.loadOptions.venueId.toString().padStart(12,"0")),n=r.id;r.momType!==gt&&!t.hostOptions_.mapData&&r.properties.indoorMapId!=t.loadOptions.venueId&&r.properties.indoorMapId!==i||(r.momType===ft?e.site=oe.setSite(r,t.loadOptions.venueId):"indoor.Structure"===r.momType?e.structure[n]=oe.setStructure(r):r.momType!==vt||r.properties.isOutdoor&&(!r.properties.isOutdoor||r.properties.parentIndoorLevel)?r.momType===vt&&r.properties.isOutdoor&&r.properties.parentIndoorLevel?e.outdoorLevelMapping[r.id]=r.properties.parentIndoorLevel.id:r.momType===mt?e.entrance[n]=oe.setEntrance(r):r.momType===dt?e.occupant[n]=oe.setOccupant(r):r.momType===yt?e.spaces[n]=oe.setSpace(r):"indoor.SpaceGroups"===r.momType?e.spaceGroups[n]=oe.setSpaceGroups(r):r.momType===gt&&(e.address[n]=oe.setAddress(r)):(e.level[n]=oe.setLevel(r),e.levelStructureMapping[n]=r.properties.structure.id))})),e.theme=this.theme,e.labelTextPreference=this.hostOptions_.labelTextPreference,new fe(e)}},{key:"getVenue_",value:function(t){this.momData=t.getMomData();var e=this.createMomStructure();return e.setLevelWiseGeometry(),new pe(e,t)}},{key:"setConfigData",value:function(t){var e=t.themeRule,r=t.svgList;t=t.defaultLang,ne.setSpaceRules(e.spaceRules),oe.svgList=r,oe.themeRule=e,oe.defaultLang=t,this.theme=e}},{key:"getMeta_",value:function(){var t=this,e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],r=new te,i=this.hostOptions_.mapData?{}:this.getMetaConfig_(this.loadOptions.venueId,pt.SITE),n=this.hostOptions_.themeRule||this.getMetaConfig_(this.loadOptions.venueId,pt.Theme),o=[];return e&&(o=this.hostOptions_.svgList||this.getMetaConfig_(this.loadOptions.venueId,pt.IMAGES)),new Promise((function(a){Promise.all([i,n,o]).then((function(i){var n=(i=_(i,3))[0],o=i[1],s=i[2],l=t.hostOptions_.mapData?{mom:new Promise((function(e){return e(t.hostOptions_.mapData)})),site:t.hostOptions_.mapData.features.find((function(t){return t.momType===ft}))}:ae.getMomData(n,t.hostOptions_);l.mom.then((function(i){var n=o.properties;r.imageCache=e?oe.manageSvgDimensions(s.properties):[],t.setConfigData({themeRule:n,svgList:r.imageCache,defaultLang:l&&l.site&&l.site.properties.defaultLanguageCode}),r.releaseSettings_={displayOptions:{display:n.entranceRules.default.displayName||kt.STANDARD},mom:i.features},r.theme=new Qt(n,r),a(r)}))}))}))}},{key:"getMetaConfig_",value:function(t,e){return ae.getConfigUrl(t,e,this.hostOptions_)}},{key:"fetchCollections",value:function(){return ae.getDefaultCollection(this.hostOptions_)}},{key:"fetchUserProjects",value:function(){return ae.getProjectAccountDetails(this.hostOptions_)}},{key:"getDefaultCollectionWithToken",value:(e=n().mark((function t(){var e=this;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Promise.all([this.fetchCollections(),this.fetchUserProjects()]).then((function(t){var r=(t=_(t,2))[0];return t=t[1],(r=e.getHrnFromDefaultCollection(r,t)).hrn?(t={hrn:r.hrn},e.setHostOptions(t),Promise.resolve()):Promise.reject()})).catch((function(t){return Promise.reject(t)})));case 1:case"end":return t.stop()}}),t,this)})),r=function(){var t=this,r=arguments;return new Promise((function(i,n){var o=e.apply(t,r);function s(t){a(o,i,n,s,l,"next",t)}function l(t){a(o,i,n,s,l,"throw",t)}s(void 0)}))},function(){return r.apply(this,arguments)})},{key:"getHrnFromDefaultCollection",value:function(t,e){var r;return t=t.results.items,Array.isArray(t)&&t.length?(r=this.getProjectRealm(e),t.find((function(t){return t.hrn.includes(r)}))):Promise.reject(new Error("Error while accessing default collection"))}},{key:"getProjectRealm",value:function(t){return Array.isArray(t.items)&&t.items.length&&t.items[0].id.includes("indoor-")?(t=t.items[0].hrn,this.getRealmNameFromHrn(t)):""}},{key:"getRealmNameFromHrn",value:function(t){return t?(t=t.split(":")).length&&t[4]:""}},{key:"getSupportedMapList",value:function(){var t=this,e=(r=this.hostOptions_).hrn,r=r.token;return e?this.fetchMapInfoList():r?this.getDefaultCollectionWithToken().then((function(){return t.fetchMapInfoList()})).catch((function(){return Promise.reject(new Error("Unable to find indoor map collection. Please contact your administrator"))})):Promise.reject(new Error("In order to load map list, Please provide either hrn or token"))}},{key:"fetchMapInfoList",value:function(){var t=this;return ae.fetchIndoorMapList(this.hostOptions_).then((function(e){return 0<(e=e.features).length?e.map((function(e){var r=(e=e.properties).placeProperties,i=(i=(e=e.indoorMapId).split("-").pop()).substring(i.length-5);return{mapIdentifier:e,mapName:t.getMapName(r.names).name,mapId:i}})):[]})).catch((function(t){Promise.reject(new Error("".concat(t,": Error while fetching map list")))}))}},{key:"getMapName",value:function(t){return Array.isArray(t)&&0<t.length?t.find((function(t){return"OFFICIAL"===t.nameType})):{}}}]),t}(),ye=["origin","destination"],ge=function(){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};if(s(this,t),!e.apiKey&&!e.token)throw new Error("API key or Token is missing");this.config_=i({baseUrl:"https://meta-indoor-routing.api-gateway.ls.hereapi.com"},e)}return c(t,[{key:"calculateRoute",value:function(t){var e=void 0===(e=t.origin)?{}:e,r=void 0===(r=t.destination)?{}:r;if(t=function(t,e){if(null==t)return{};var r,i=function(t,e){if(null==t)return{};for(var r,i={},n=Object.keys(t),o=0;o<n.length;o++)r=n[o],0<=e.indexOf(r)||(i[r]=t[r]);return i}(t,e);if(Object.getOwnPropertySymbols)for(var n=Object.getOwnPropertySymbols(t),o=0;o<n.length;o++)r=n[o],0<=e.indexOf(r)||Object.prototype.propertyIsEnumerable.call(t,r)&&(i[r]=t[r]);return i}(t,ye),!e.coordinates||!r.coordinates)throw new Error("Waypoint coordinates are missing");function i(t){var e=t.coordinates,r=t.venueId;return t=t.levelId,e=e.join(","),r&&t?e.concat(";indoorMapId=",r,";levelId=",t):e}var n=new URL("".concat(this.config_.baseUrl,"/v1/routes")),a=new URLSearchParams({origin:i(e),destination:i(r),apiKey:this.config_.apiKey});return Object.entries(t).forEach((function(t){var e=(t=_(t,2))[0];t=t[1],a.append(e,"object"===o(t)?JSON.stringify(t):t)})),n.search=a,fetch(n,{headers:{"X-Api-Key":this.config_.apiKey}}).then((function(t){return t.json()}))}}]),t}(),ve={VENUE_DATA_LOADED:"VENUE_DATA_LOADED",VENUE_THEME_LOADED:"VENUE_THEME_LOADED",VENUE_ICONS_LOADED:"VENUE_ICONS_LOADED",VENUE_MOM_DATA_LOADED:"VENUE_MOM_DATA_LOADED",VENUE_ERROR_STATE:"VENUE_ERROR_STATE",VENUE_MAP_DATA_LOADED:"VENUE_MAP_DATA_LOADED",VENUE_ENTITY_DATA_LOADED:"VENUE_ENTITY_DATA_LOADED",VENUE_DATA_MODEL_LOADED:"VENUE_DATA_MODEL_LOADED",VENUE_NAV_DATA_LOADED:"VENUE_NAV_DATA_LOADED",META_DATA_LOADED:"META_DATA_LOADED",META_DATA_MODEL_LOADED:"META_DATA_MODEL_LOADED",META_DATA_MODEL_UPDATED:"META_DATA_MODEL_UPDATED"},me=((Object.freeze((u(Pt={},ve.VENUE_DATA_LOADED,{description:"event fired when all requested files along with metadata & overrides are loaded",emitTemplate:{}}),u(Pt,ve.VENUE_MAP_DATA_LOADED,{description:"event fired when requested levels, drawings & community files are loaded",emitTemplate:{}}),u(Pt,ve.VENUE_ENTITY_DATA_LOADED,{description:"event fired when requested entity data is loaded",emitTemplate:{}}),u(Pt,ve.VENUE_DATA_MODEL_LOADED,{description:"event fired when a map file is loaded",emitTemplate:{}}),u(Pt,ve.VENUE_NAV_DATA_LOADED,{description:"event fired when requested navigation product is loaded",emitTemplate:{}}),u(Pt,ve.META_DATA_LOADED,{description:"event fired when all requested meta files are loaded except icon & marker",emitTemplate:{}}),u(Pt,ve.META_DATA_MODEL_LOADED,{description:"event fired when a specific model is loaded except icon & marker",emitTemplate:{}}),u(Pt,ve.META_DATA_MODEL_UPDATED,{description:"event fired when a specific meta override is added or removed",emitTemplate:{}}),u(Pt,ve.VENUE_ICONS_LOADED,{description:"event fired when all icons of venue are loaded",emitTemplate:{}}),Pt)),Re=new jt).EVENT_NAME=ve,Re.on("newListener",(function(t){ve[t]||console.warn("subscribing for un-registered/documented event")})),function(){h(e,H.map.Feature);var t=v(e);function e(r){var i;if(s(this,e),i=t.call(this),r instanceof pe)return i.venueModel=r,i.search_=new ht(r),i.status_={activeDrawingId:r.getRootDrawing().getIdentifier(),activeLevelIndex:r.getRootDrawing().getMainLevel().getZIndex()},i.mapObjectStore_=i.getDefaultMapObjectsStore_(),i.drawings=r.getDrawings().map((function(t){return(t=new T(t)).setParentEventTarget(g(i)),t})),i.levels=r.getLevels().map((function(t){var e=new A(t);return e.setParentEventTarget(i.drawings.find((function(t){return t.getIdentifier()===e.getData().getDrawing().getIdentifier()}))),e})),i.geometries=r.getGeometries().map((function(t){var e=new E(t);return e.setParentEventTarget(i.levels.find((function(t){return t.getIdentifier()===e.getData().getLevel().getIdentifier()}))),e})),i.mutualExclusiveHighlight_=!1,i;throw new Error("It is mandatory to provide valid instance of venueModel")}return c(e,[{key:"getData",value:function(){return this.venueModel}},{key:"getBoundingBox",value:function(){return y(H.geo.Rect,b(this.venueModel.getBoundingBox()))}},{key:"getCenter",value:function(){var t=(e=_(this.venueModel.getCenter(),2))[0],e=e[1];return new H.geo.Point(e,t)}},{key:"getId",value:function(){return this.venueModel.getId()}},{key:"getIdentifier",value:function(){return this.venueModel.getIdentifier()}},{key:"getName",value:function(){return this.venueModel.getName()}},{key:"getDrawing",value:function(t){return this.drawings.find((function(e){return e.getIdentifier()===t}))}},{key:"getDrawings",value:function(){return this.drawings}},{key:"getLevel",value:function(t){return this.levels.find((function(e){return e.getIdentifier()===t}))}},{key:"getLevels",value:function(){return this.levels}},{key:"getGeometry",value:function(t){return this.getGeometries().find((function(e){return e.getIdentifier()===t}))}},{key:"getGeometries",value:function(){return this.geometries}},{key:"getActiveLevels",value:function(){var t=this;return this.getData().getDisplaySettings()===kt.FLATTEN?this.venueModel.getLevelsByZIndex(this.status_.activeLevelIndex).map((function(e){return t.getLevel(e.getIdentifier())})):[this.venueModel.getDrawingById(this.status_.activeDrawingId).getLevelByZIndex(this.status_.activeLevelIndex)].map((function(e){return t.getLevel(e.getIdentifier())}))}},{key:"getActiveDrawing",value:function(){return this.getDrawing(this.status_.activeDrawingId)}},{key:"setActiveDrawing",value:function(t){if(this.status_.activeDrawingId!==t){var r=this.venueModel.getDrawingById(t);if(!r)throw new Error("Drawing ".concat(t," was not found"));var i=this.status_.activeDrawingId;this.status_.activeDrawingId=r.id,this.setActiveLevelIndex(r.getMainLevel().getZIndex()),this.dispatchEvent(new H.util.ChangeEvent(e.EVENTS.DRAWING_CHANGE,t,i))}}},{key:"getActiveLevelIndex",value:function(){return this.status_.activeLevelIndex}},{key:"setActiveLevelIndex",value:function(t){var r;this.venueModel.getLevelsByZIndex(t)&&(r=this.status_.activeLevelIndex,this.status_.activeLevelIndex=t,this.dispatchEvent(new H.util.ChangeEvent(e.EVENTS.LEVEL_CHANGE,t,r)))}},{key:"isActive",value:function(){var t=this.getParentEventTarget();return!!t&&this===t.activeVenue}},{key:"getHighlightedGeometries",value:function(){var t=this;return this.venueModel.getGeometries().filter((function(t){return t.isHighlighted()})).map((function(e){return t.getGeometry(e.getIdentifier())}))}},{key:"setHighlightedGeometries",value:function(){var t=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},o=3<arguments.length&&void 0!==arguments[3]&&arguments[3],a=(n=i(i({},nt),n)).fillColor,s=n.outlineColor,l=n.outlineWidth;this.mutualExclusiveHighlight_=!!o,this.mutualExclusiveHighlight_&&this.getHighlightedGeometries().forEach((function(t){t.getData().highlight(!1)})),r.forEach((function(e){e.getData().highlight(t,{m:a,o:s,w:l})})),this.dispatchEvent(e.EVENTS.GEOMETRY_HIGHLIGHT)}},{key:"getMapObjects",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.getActiveLevelIndex(),e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.getActiveDrawing();return this.mapObjectStore_[t][e.getIdentifier()]}},{key:"setMapObjects",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.getActiveLevelIndex(),r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:this.getActiveDrawing();this.mapObjectStore_[e]&&this.mapObjectStore_[e][r.getIdentifier()]&&(this.mapObjectStore_[e][r.getIdentifier()]=b(t)),this.updateMapObjectsVisibility_()}},{key:"search",value:function(){var t=this;return this.search_.find(0<arguments.length&&void 0!==arguments[0]?arguments[0]:"").flatMap((function(e){return e.geometries.map((function(e){return t.getGeometry(e.id)}))}))}},{key:"updateMapObjectsVisibility_",value:function(){Object.values(this.mapObjectStore_).forEach((function(t){Object.values(t).forEach((function(t){return t.forEach((function(t){return t.setVisibility(!1)}))}))})),this.isActive()&&this.mapObjectStore_[this.getActiveLevelIndex()][this.getActiveDrawing().getIdentifier()].forEach((function(t){return t.setVisibility(!0)}))}},{key:"getDefaultMapObjectsStore_",value:function(){var t=this,e=this.getData().getDisplaySettings()===kt.FLATTEN;return this.venueModel.getLevels().reduce((function(r,n){var o=n.getZIndex();return(r=i({},r))[o]||(r[o]={}),r[o][n.getDrawing().getIdentifier()]=[],e&&(r[o][t.venueModel.getRootDrawing().getIdentifier()]=[]),r}),{})}}]),e}()),_e=(me.EVENTS={ACTIVE_VENUE_CHANGE:"activevenuechange",DRAWING_CHANGE:"drawingchange",LEVEL_CHANGE:"levelchange",GEOMETRY_HIGHLIGHT:"geometryhighlight"},function(){function t(){s(this,t)}return c(t,null,[{key:"getIconLayer",value:function(){return{type:"FeatureCollection",features:(0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]).flatMap((function(t){return t.getData().getGeometries()})).filter((function(t){return t.isIcon()&&t.getIcon()})).map((function(t){var e=(r=_(t.getLabelArea(),2))[0],r=r[1],i=t.getLevel(),n=t.getIcon(),o=t.properties.spaceType||t.properties.spaceCategory||t.getDisplayName();return{type:"Feature",properties:{id:t.getIdentifier(),geometryId:t.getIdentifier(),levelId:i.getIdentifier(),name:o,venueId:i.getDrawing().getVenueModel().getIdentifier(),url:n?"data:image/svg+xml;utf8,".concat(encodeURIComponent(n)):""},geometry:{type:J,coordinates:[e,r]}}}))}}},{key:"getLabelLayer",value:function(){return{type:"FeatureCollection",features:(0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]).flatMap((function(t){return t.getData().getGeometries()})).filter((function(t){return t.getDisplayName()&&!t.isIcon()})).map((function(t){var e=(r=_(t.getLabelArea(),2))[0],r=r[1],i=(n=t.getLabelStyle()).fill,n=n.zmin,o=t.getLevel();return{type:"Feature",properties:{id:t.getIdentifier(),geometryId:t.getIdentifier(),levelId:o.getIdentifier(),venueId:o.getDrawing().getVenueModel().getIdentifier(),name:t.getDisplayName(),minZoom:n||15,textFillColor:i.toLowerCase()},geometry:{type:J,coordinates:[e,r]}}}))}}},{key:"getGeometryLayer",value:function(){return{type:"FeatureCollection",features:(0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]).flatMap((function(t){return t.getData().getGeometries()})).filter((function(t){return t.getType()!==J})).map((function(t){var e=(n=t.getHighlightedStyle()||{}).m,r=n.o,n=n.w,o=(s=i({},t.getStyle())).m,a=s.o,s=s.w,l=(u=it).fillColor,c=u.outlineColor,u=u.outlineWidth,h=t.getLevel();return{type:"Feature",properties:{id:t.getIdentifier(),fillColor:(e||o||l).toLowerCase(),geometryId:t.getIdentifier(),levelId:h.getIdentifier(),venueId:h.getDrawing().getVenueModel().getIdentifier(),outlineColor:(r||a||c).toLowerCase(),outlineWidth:Number(((n||s||u)/3).toFixed(2)),zIndex:t.getZIndex()},geometry:{type:t.getType(),coordinates:t.getCoordinates()}}}))}}},{key:"getFootprintLayer",value:function(t){return{type:"FeatureCollection",features:t.flatMap((function(t){var e=t.getData().getRootDrawing().getMainLevel().getIdentifier(),r=t.getLevel(e).getData().getGeometries().filter((function(t){return t.getType()===Q}));return[{type:"Feature",properties:{isFootprint:!0,levelId:e,venueId:t.getIdentifier(),zIndex:1},geometry:{type:"MultiPolygon",coordinates:r.map((function(t){return t.getCoordinates()}))}},{type:"Feature",properties:{isFootprint:!0,levelId:e,venueId:t.getIdentifier(),zIndex:2,venueName:t.getName()},geometry:{type:"Point",coordinates:t.getCenter().toGeoJSON().coordinates.slice(0,2)}}]}))}}}]),t}()),be=function(){function t(){s(this,t)}return c(t,null,[{key:"getStyle",value:function(){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],e={styles:[{layer:ot.FOOTPRINT,when:["==",["geometry-type"],"Polygon"],technique:"solid-line",color:"#613F8E",lineWidth:"2px",renderOrder:1},{layer:ot.FOOTPRINT,when:["==",["geometry-type"],"Polygon"],technique:"fill",color:"#AF91B4",renderOrder:2},{layer:ot.FOOTPRINT,when:["==",["geometry-type"],"Point"],technique:"text",color:"black",size:16,text:["get","venueName"],priority:61},{layer:ot.VECTOR,when:["==",["geometry-type"],"Polygon"],technique:"fill",color:["get","fillColor"],renderOrder:["get","zIndex"]},{layer:ot.VECTOR,technique:"solid-line",color:["get","outlineColor"],lineWidth:["get","outlineWidth"],renderOrder:["get","zIndex"]},{layer:ot.TEXT,minZoomLevel:["get","minZoom"],technique:"text",color:["get","textFillColor"],size:13,text:["get","name"],priority:60},{layer:ot.ICON,minZoomLevel:16,when:["==",["geometry-type"],"Point"],technique:"labeled-icon",textIsOptional:!0,size:0,imageTexture:["concat","texture",["get","name"]],screenWidth:["interpolate",["linear"],["zoom"],15,3,21,70],screenHeight:["interpolate",["linear"],["zoom"],15,3,21,70],priority:61}],images:{},imageTextures:[]};return(0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]).forEach((function(t){var r="texture"+t.properties.name;e.images[r]||(e.images[r]={url:t.properties.url,preload:!0},e.imageTextures.push({name:r,image:r}))})),t.forEach((function(t){var r,i=(o=t.getData().getHighlightedStyle()).m,n=o.o,o=o.w;(r=e.styles).push.apply(r,[{layer:ot.VECTOR,when:["==",["get","id"],t.id],technique:"fill",color:i,renderOrder:["get","zIndex"]},{layer:ot.VECTOR,when:["==",["get","id"],t.id],technique:"solid-line",color:n,lineWidth:o,renderOrder:["get","zIndex"]}])})),new H.map.render.harp.Style(e)}}]),t}(),we=function(){function t(){s(this,t)}return c(t,null,[{key:"getIconsTextures",value:function(){var t={},e={},r=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]).reduce((function(t,e){var r=e.properties.name;return t[r]||(t[r]=[]),t[r].push(e),t}),{});return Object.keys(r).forEach((function(i){var n="texture".concat(i),o="sprite".concat(i),a=r[i][0].properties.url;t[n]={url:a,sprites:u({},o,[0,0,50,50])},r[i].forEach((function(t){t=t.properties,e["icon".concat(t.name)]={filter:{name:t.name,$zoom:{min:16}},draw:{points:{interactive:!0,priority:1,size:[[15,"50%"],[16,"55%"],[17,"60%"],[18,"65%"],[19,"75%"],[20,"80%"],[21,"100%"]],texture:n,sprite:o}}}}))})),{textures:t,iconLayers:e}}},{key:"getFootprintLayer",value:function(){return{data:{source:"venues",layer:ot.FOOTPRINT},draw:{polygons:{interactive:!0,color:"#AF91B4",order:2},lines:{color:"#613F8E",width:"2px",order:1},points:{color:"[0, 0, 0, 0]",size:"0px",order:3,priority:1,text:{anchor:"center",collide:!1,font:{fill:"black",size:"16px"},text_source:"function() { return feature.venueName }"}}}}}},{key:"getGeometryLayer",value:function(){var t,e,r,i=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],n={};return i.length&&(t=(r=i[0].getData().getHighlightedStyle()).m,e=r.o,r=r.w,n={filter:{id:i.map((function(t){return t.id}))},draw:{polygons:{interactive:!0,color:t},lines:{color:e,width:r}}}),{data:{source:"venues",layer:ot.VECTOR},draw:{polygons:{interactive:!0,color:"function() { return feature.fillColor }",order:"function() { return feature.zIndex }"},lines:{color:"function() { return feature.outlineColor }",order:"function() { return feature.zIndex }",width:"function() { return feature.outlineWidth }"}},highlighted:n}}},{key:"getTextLayer",value:function(){return{filter:{$zoom:{min:18}},data:{source:"venues",layer:ot.TEXT},draw:{points:{filter:"function() { return $zoom > feature.minZoom }",color:"[0, 0, 0, 0]",size:"0px",offset:["0px","-10px"],priority:2,text:{font:{fill:"function() { return feature.textFillColor }",size:13},text_source:"function() { return feature.name }"}}}}}},{key:"getIconLayer",value:function(t){return i({data:{source:"venues",layer:ot.ICON}},t)}},{key:"getStyle",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],i=(e=t.getIconsTextures(e)).textures;return e=e.iconLayers,r={venue_footprints:t.getFootprintLayer(),venue_geometries:t.getGeometryLayer(r),venue_labels:t.getTextLayer(),venue_icons:t.getIconLayer(e)},e=H.gl.yaml.safeDump({sources:{venues:{max_zoom:24,type:"GeoJSONTileSource"}},layers:r,textures:i}),new H.map.render.webgl.Style(e)}}]),t}(),xe={type:"FeatureCollection",features:[]},Ee={extent:4096,indexMaxZoom:0,maxZoom:24,tolerance:3},Te=(Pt=function(){h(e,H.map.provider.RemoteTileProvider);var t=v(e);function e(r){return s(this,e),(r=t.call(this,r)).venues=[],r.activeVenue=null,r.dataLayers_={},r.tileIndexes_={},r.addEventListener(me.EVENTS.ACTIVE_VENUE_CHANGE,r.activeVenueChangeHandler_,void 0,g(r)),r}return c(e,[{key:"setStyle",value:function(t){return this.setStyleInternal(t)}},{key:"getStyle",value:function(){return this.getStyleInternal()}},{key:"isFeatureVisible_",value:function(t,e){var r=t.properties;return this.activeVenue&&r.venueId===this.activeVenue.getIdentifier()?e!==ot.FOOTPRINT&&this.activeVenue.getActiveLevels().some((function(t){return t.id===r.levelId})):!0===r.isFootprint&&e===ot.FOOTPRINT}},{key:"requestInternal",value:function(t,e,r,i){function n(i){for(var n=0;n<i.length;n+=1)i[n]=i[n].map((function(i){return Z(i,r,t,e,Ee.extent)}))}var o=this,a={};return Object.keys(this.tileIndexes_).forEach((function(i){var s=o.tileIndexes_[i].getTile(r,t,e);a[i]=s?function(t){var e=[],r=t&&t.features;if(r)for(var i=0,n=r.length;i<n;i+=1){var o=r[i],a=o.type,s=void 0,l=!1;switch(a){case 1:s={type:tt,coordinates:o.geometry.map((function(t){return t.slice()}))};break;case 2:case 3:s={type:et,coordinates:o.geometry.map((function(t){return t.map((function(t){return t.slice()}))}))},3===a&&null==(s=function(t){for(var e,r=[],i=[],n=0,o=t.coordinates.length;n<o;n+=1){var a=t.coordinates[n],s=st(a);null!==s&&(s===(e=e||s)&&i.length&&(r.push(i),i=[]),i.push(a))}return 0<i.length&&r.push(i),1===r.length?(t.type=Q,t.coordinates=r[0]):1<r.length?(t.type=rt,t.coordinates=r):t=null,t}(s))&&(l=!0);break;default:l=!0}l||e.push({geometry:s,id:o.id,properties:o.tags,type:"Feature"})}return{type:"FeatureCollection",features:e}}(s):xe,a[i].features=a[i].features.filter((function(t){return o.isFeatureVisible_(t,i)}));for(var l=0;l<a[i].features.length;l+=1){var c=a[i].features[l],u=c.geometry.type;if(u===Q||u===et)n(c.geometry.coordinates);else if(u===rt)c.geometry.coordinates.map(n);else for(var h=c.geometry.coordinates,p=0;p<h.length;p+=1)h[p]=Z(h[p],r,t,e,Ee.extent)}})),i(a),{cancel:function(){}}}},{key:"getActiveVenue",value:function(){return this.activeVenue}},{key:"getVenue",value:function(t){return t?this.venues.find((function(e){return e.getIdentifier()===t})):this.activeVenue}},{key:"setActiveVenue",value:function(t){var e=this.activeVenue;this.activeVenue=t,this.dispatchEvent(new H.util.ChangeEvent(me.EVENTS.ACTIVE_VENUE_CHANGE,t,e)),this.reload()}},{key:"addVenue",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(!(t instanceof me))throw new Error("Invalid argument");var r=t.getIdentifier();if(this.getVenue(r))throw new Error("Please invoke provider.removeVenue to remove old instance of venue ".concat(r," before adding new"));t.setParentEventTarget(this),this.venues.push(t),e||(this.reloadData_(),this.reloadStyle_())}},{key:"addVenues",value:function(){var t=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];0<e.length&&(e.forEach((function(e){e instanceof me&&t.addVenue(e,!0)})),this.reloadData_(),this.reloadStyle_())}},{key:"removeVenue",value:function(t){var e;t instanceof me&&-1<this.venues.indexOf(t)&&(e=t.getIdentifier(),this.activeVenue&&this.activeVenue.getIdentifier()===e&&this.setActiveVenue(null),this.venues.splice(this.venues.indexOf(t),1),this.reloadData_(),this.reloadStyle_(),this.reload())}},{key:"getFeatureProxy",value:function(t,e,r){var i=t.geometryId;return t=t.venueId,t=this.getVenue(t),i?r(t.getGeometries().find((function(t){return t.id===i}))):t&&r(t),!0}},{key:"addVenueEventListeners_",value:function(t){t&&(t.addEventListener(me.EVENTS.GEOMETRY_HIGHLIGHT,this.geometryHighlightHandler_,void 0,this),t.addEventListener(me.EVENTS.LEVEL_CHANGE,this.levelChangeHandler_,void 0,this),t.addEventListener(me.EVENTS.DRAWING_CHANGE,this.drawingChangeHandler_,void 0,this))}},{key:"removeVenueEventListeners_",value:function(t){t&&(t.removeEventListener(me.EVENTS.GEOMETRY_HIGHLIGHT,this.geometryHighlightHandler_,void 0,this),t.removeEventListener(me.EVENTS.LEVEL_CHANGE,this.levelChangeHandler_,void 0,this),t.removeEventListener(me.EVENTS.DRAWING_CHANGE,this.drawingChangeHandler_,void 0,this))}},{key:"activeVenueChangeHandler_",value:function(t){var e=t.oldValue;t=t.newValue,e&&(this.removeVenueEventListeners_(e),e.updateMapObjectsVisibility_()),t&&(this.addVenueEventListeners_(t),t.updateMapObjectsVisibility_())}},{key:"drawingChangeHandler_",value:function(){this.reload()}},{key:"levelChangeHandler_",value:function(){this.activeVenue&&(this.activeVenue.updateMapObjectsVisibility_(),this.reload())}},{key:"geometryHighlightHandler_",value:function(){this.reloadStyle_(this.activeVenue.getHighlightedGeometries())}},{key:"createDataLayers_",value:function(){var t=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:Object.keys(ot),r=ot.FOOTPRINT,i=ot.ICON,n=ot.TEXT,o=ot.VECTOR;e.forEach((function(e){switch(e){case o:t.dataLayers_[o]=_e.getGeometryLayer(t.venues);break;case r:t.dataLayers_[r]=_e.getFootprintLayer(t.venues);break;case i:t.dataLayers_[i]=_e.getIconLayer(t.venues);break;case n:t.dataLayers_[n]=_e.getLabelLayer(t.venues);break;default:throw new Error("Unsupported Layer ".concat(e))}}))}},{key:"createTileIndexes_",value:function(){var t=this;(0<arguments.length&&void 0!==arguments[0]?arguments[0]:Object.keys(ot)).forEach((function(e){t.tileIndexes_[e]=new X(t.dataLayers_[e],Ee)}))}},{key:"reloadData_",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:Object.keys(ot);this.createDataLayers_(t),this.createTileIndexes_(t)}},{key:"reloadStyle_",value:function(t){var e=this.dataLayers_[ot.ICON]?this.dataLayers_[ot.ICON].features:[];this.getEngineType()===H.Map.EngineType.WEBGL?this.setStyle(we.getStyle(e,t)):this.getEngineType()===H.Map.EngineType.HARP&&this.setStyle(be.getStyle(e,t))}},{key:"providesGeoJSON",value:function(){return!0}}]),e}(),new H.map.SpatialStyle({strokeColor:"#1ab4bf",lineWidth:3})),Ae=new H.map.SpatialStyle({strokeColor:"#1ab4bf",lineWidth:3}),Se=new H.map.Icon("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MCIgaGVpZ2h0PSI1MCIgdmlld0JveD0iMCAwIDQwIDUwIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+PGRlZnM+PHBhdGggaWQ9ImIiIGQ9Ik0zNC4yNSAzMS42NTJBMTkuMDE1IDE5LjAxNSAwIDAgMCAzOSAxOS4wNkMzOSA4LjU0OSAzMC40NzggMCAyMCAwUzEgOC41NSAxIDE5LjA1OWMwIDQuODIzIDEuNzk1IDkuMjMzIDQuNzUgMTIuNTkzTDE5Ljk3NSA0NiAzNC4yNSAzMS42NTJ6Ii8+PHBhdGggaWQ9ImEiIGQ9Ik0zNC4yNSAzMS42NTJBMTkuMDE1IDE5LjAxNSAwIDAgMCAzOSAxOS4wNkMzOSA4LjU0OSAzMC40NzggMCAyMCAwUzEgOC41NSAxIDE5LjA1OWMwIDQuODIzIDEuNzk1IDkuMjMzIDQuNzUgMTIuNTkzTDE5Ljk3NSA0NiAzNC4yNSAzMS42NTJ6Ii8+PG1hc2sgaWQ9ImMiIHdpZHRoPSIzOCIgaGVpZ2h0PSI0NiIgeD0iMCIgeT0iMCIgZmlsbD0iI2ZmZiI+PHVzZSB4bGluazpocmVmPSIjYSIvPjwvbWFzaz48L2RlZnM+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj48ZWxsaXBzZSBjeD0iMjAiIGN5PSI0NS4xNiIgZmlsbD0iI0ZGRiIgc3Ryb2tlPSIjOTc5Nzk3IiBzdHJva2Utd2lkdGg9Ii4yNSIgcng9IjMuNSIgcnk9IjMuNSIvPjx1c2UgZmlsbD0iIzAxQjZCMiIgeGxpbms6aHJlZj0iI2IiLz48cGF0aCBmaWxsPSIjMzIzMjMyIiBmaWxsLW9wYWNpdHk9Ii41IiBkPSJNMTEuODEgMzcuNjZoMTYuMzhsLTguMiA4eiIvPjx1c2Ugc3Ryb2tlPSIjNDE2QTg2IiBzdHJva2Utd2lkdGg9Ii41IiBtYXNrPSJ1cmwoI2MpIiB4bGluazpocmVmPSIjYSIvPjxlbGxpcHNlIGN4PSIxOS44MSIgY3k9IjE5LjE5IiBmaWxsPSIjRkZGIiByeD0iNC44MSIgcnk9IjQuODEiLz48L2c+PC9zdmc+"),ke=new H.map.Icon("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MCIgaGVpZ2h0PSI1MCIgdmlld0JveD0iMCAwIDQwIDUwIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+PGRlZnM+PHBhdGggaWQ9ImEiIGQ9Ik0zNC4yNSAzMS42NTJBMTkuMDE1IDE5LjAxNSAwIDAgMCAzOSAxOS4wNkMzOSA4LjU0OSAzMC40NzggMCAyMCAwUzEgOC41NSAxIDE5LjA1OWMwIDQuODIzIDEuNzk1IDkuMjMzIDQuNzUgMTIuNTkzTDE5Ljk3NSA0NiAzMi44MyAzMy4xMDRjLjQwNy0uMzc0IDEuNDE5LTEuNDUyIDEuNDE5LTEuNDUyeiIvPjxtYXNrIGlkPSJjIiB3aWR0aD0iMzgiIGhlaWdodD0iNDYiIHg9IjAiIHk9IjAiIGZpbGw9IiNmZmYiPjx1c2UgeGxpbms6aHJlZj0iI2EiLz48L21hc2s+PGVsbGlwc2UgaWQ9ImIiIGN4PSIxOS44MDciIGN5PSIxOS4xNjgiIHJ4PSIxMi4zNjMiIHJ5PSIxMi4xOTciLz48bWFzayBpZD0iZCIgd2lkdGg9IjI1LjcyNSIgaGVpZ2h0PSIyNS4zOTQiIHg9Ii0uNSIgeT0iLS41Ij48cGF0aCBmaWxsPSIjZmZmIiBkPSJNNi45NDQgNi40NzFoMjUuNzI1djI1LjM5NEg2Ljk0NHoiLz48dXNlIHhsaW5rOmhyZWY9IiNiIi8+PC9tYXNrPjwvZGVmcz48ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxlbGxpcHNlIGN4PSIyMCIgY3k9IjQ1LjE2IiBmaWxsPSIjRkZGIiBzdHJva2U9IiM5Nzk3OTciIHN0cm9rZS13aWR0aD0iLjI1IiByeD0iMy41IiByeT0iMy41Ii8+PHVzZSBmaWxsPSIjMzIzMjMyIiB4bGluazpocmVmPSIjYSIvPjxwYXRoIGZpbGw9IiM3RDdEN0QiIGQ9Ik0xMi4wMTEgMzcuODA1aDE1Ljk3OGwtNy45MTYgOHoiLz48dXNlIHN0cm9rZT0iIzdDN0M3QyIgc3Ryb2tlLXdpZHRoPSIuNSIgbWFzaz0idXJsKCNlKSIgeGxpbms6aHJlZj0iI2EiLz48dXNlIHN0cm9rZT0iI0ZGRiIgc3Ryb2tlLXdpZHRoPSIuNSIgbWFzaz0idXJsKCNjKSIgeGxpbms6aHJlZj0iI2EiLz48ZWxsaXBzZSBmaWxsPSIjRkZGIiBjeD0iMTkuODA3IiBjeT0iMTkuMTY4IiByeD0iMTIuMzYzIiByeT0iMTIuMTk3Ii8+PHBhdGggZmlsbD0iIzMyMzIzMiIgZD0iTTYuODEyIDYuOTQ4aDYuNDV2Ni4zNjRoLTYuNDV6bTAgMTIuNzI3aDYuNDV2Ni4zNjRoLTYuNDV6bTYuNDUtNi4zNjNoNi40NXY2LjM2NGgtNi40NXptMCAxMi43MjdoNi40NXY2LjM2NGgtNi40NXptNi40NS0xOS4wOTFoNi40NXY2LjM2NGgtNi40NXptMCAxMi43MjdoNi40NXY2LjM2NGgtNi40NXptNi40NS02LjM2M2g2LjQ1djYuMzY0aC02LjQ1em0wIDEyLjcyN2g2LjQ1djYuMzY0aC02LjQ1eiIvPjx1c2Ugc3Ryb2tlPSIjRkZGIiBtYXNrPSJ1cmwoI2QpIiB4bGluazpocmVmPSIjYiIgc3Ryb2tlLWxpbmVjYXA9InNxdWFyZSIvPjwvZz48L3N2Zz4="),Oe=function(){function t(e,r){s(this,t),this.indoorMapObjects_=null,this.outdoorMapObjects_=null,this.createRouteObjects_(e,r)}return c(t,[{key:"createRouteObjects_",value:function(e){for(var r=this,n=void 0===(e=e.sections)?[]:e,o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:Gt,a=(this.indoorMapObjects_={},this.outdoorMapObjects_=new H.map.Group,function(e){var a,s,l=n[e],c=(u=l.departure.place).id,u=u.type,h=H.util.flexiblePolyline.decode(l.polyline).polyline,p=void 0,f=void 0,d=((s=o(e,n,t.ObjectType.SEGMENT_START_MARKER))&&(p=new H.map.Marker(l.departure.place.location,{icon:s})),(s=o(e,n,t.ObjectType.SEGMENT_FINISH_MARKER))&&(f=new H.map.Marker(l.arrival.place.location,{icon:s})),o(e,n,t.ObjectType.SEGMENT_POLYLINE));"indoor"===u?(s=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=new Map,r=new H.geo.LineString,i=_(t[0],3)[2];return e.set(i,[r]),t.forEach((function(t){t[2]!==i&&(i=t[2],r=new H.geo.LineString,e.has(i)?e.get(i).push(r):e.set(i,[r])),r.pushLatLngAlt.apply(r,b(t))})),e}(h),a=Array.from(s.keys()).reduce((function(t,e){return t[e]||(t[e]=new H.map.Group),t}),{}),d&&s.forEach((function(t,e){t.forEach((function(t){1<t.getPointCount()&&(t=new H.map.Polyline(t,{style:d}),a[e].addObject(t))}))})),p&&a[l.departure.place.location.lvl].addObject(p),f&&a[l.arrival.place.location.lvl].addObject(f),r.indoorMapObjects_[c]=i(i({},r.indoorMapObjects_[c]||{}),a)):(d&&(e=new H.geo.LineString(h.flatMap((function(t){return[t[0],t[1],0]}))),u=new H.map.Polyline(e,{style:d}),r.outdoorMapObjects_.addObject(u)),p&&r.outdoorMapObjects_.addObject(p),f&&r.outdoorMapObjects_.addObject(f))}),s=0;s<n.length;s++)a(s)}},{key:"getIndoorObjects",value:function(){return this.indoorMapObjects_}},{key:"getOutdoorObjects",value:function(){return this.outdoorMapObjects_}}]),t}(),Le=(Oe.ObjectType={SEGMENT_START_MARKER:1,SEGMENT_FINISH_MARKER:2,SEGMENT_POLYLINE:3},function(){h(e,H.service.Service);var t=v(e);function e(r){s(this,e),n=t.call(this,e,i(i({},r),{},{baseUrl:void 0}));var n,o={apiKey:r.apikey,baseUrl:r.baseUrl,token:r.token},a={apiKey:o.apiKey,token:o.token},l=(o.apiKey||(o.apiKey=n.getUrl().getQuery().apikey),r.useLegacy||!1);return n.venueService_=new de(o,l),a.apiKey||(a.apiKey=n.getUrl().getQuery().apikey),r.routingBaseUrl&&(a.baseUrl=r.routingBaseUrl),n.routingService_=new ge(a),n}return c(e,[{key:"loadVenue",value:function(t){return console.warn("Venue service version 1 is no longer supported hence "+t+" could not be loaded"),Promise.resolve()}},{key:"calculateRoute",value:function(t){return console.warn("HERE Indoor Routing is deprecated and will be removed soon."),this.routingService_.calculateRoute(t)}}]),e}()),Pe=(Le.CONFIG_KEY="venues",function(){h(e,H.service.Service);var t=v(e);function e(r){s(this,e),n=t.call(this,e,i(i({},r),{},{baseUrl:void 0}));var n,o={apiKey:r.apikey,baseUrl:r.baseUrl,token:r.token,hrn:r.hrn};return o.apiKey||(o.apiKey=n.getUrl().getQuery().apikey),r=r.useLegacy||!1,n.venueService_=new de(o,r),n}return c(e,[{key:"loadVenue",value:function(t){return this.venueService_.load(t,1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).then((function(t){return new me(t)}))}},{key:"getMapInfoList",value:function(){return this.venueService_.getSupportedMapList()}}]),e}()),Re=(Pe.CONFIG_KEY="indoorMaps",H.service.Platform.prototype.getVenuesService=function(t,e){var r=Pe;return 1!==e&&e?e!==at.v2||t.token||(t.hrn?t.apikey||console.error("Venue Service version 2 requires either apikey or token"):console.error("Token is mandatory when Hrn is not provided in Venue Service version 2")):(console.warn("Venue service version 1 is no longer supported"),r=Le),this.createService(r,t)},Pe.LABEL_TEXT_PREFERENCE_OVERRIDE={OCCUPANT_NAMES:"OCCUPANT_NAMES",SPACE_NAME:"SPACE_NAME",SPACE_TYPE_NAME:"SPACE_TYPE_NAME",SPACE_CATEGORY_NAME:"SPACE_CATEGORY_NAME",INTERNAL_ADDRESS:"INTERNAL_ADDRESS"},function(){h(e,H.ui.Control);var t=v(e);function e(r){var i,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return s(this,e),(i=t.call(this)).provider_=null,i.levelSelectorUI_=null,i.setAlignment(n&&n.alignment||H.ui.LayoutAlignment.RIGHT_BOTTOM),i.addClass("venues-ui"),r instanceof me&&i.setVenue(r),i}return c(e,[{key:"renderInternal",value:function(t,r){m(p(e.prototype),"renderInternal",this).call(this,t,r),this.createLevelSelectorUI_(t),this.venue&&this.setVenue(this.venue)}},{key:"setVenue",value:function(t){t instanceof me&&(this.removeEventListeners_(),this.venue=t,this.provider_=t.getParentEventTarget(),this.update_(),this.addEventListeners_())}},{key:"createLevelSelectorUI_",value:function(t){var e=this;t.innerHTML="",this.levelSelectorUI_=null,this.levelSelectorUI_=new Jt(t,null,null,(function(t){return e.venue.setActiveLevelIndex(t)}))}},{key:"update_",value:function(){var t,e;this.levelSelectorUI_&&(t=this.venue.getActiveDrawing().getData(),e=this.venue.getData().getDisplaySettings(),this.levelSelectorUI_.update(t,e),this.levelChangeHandler_())}},{key:"addEventListeners_",value:function(){this.venue&&(this.venue.addEventListener(me.EVENTS.LEVEL_CHANGE,this.levelChangeHandler_,void 0,this),this.venue.addEventListener(me.EVENTS.DRAWING_CHANGE,this.drawingChangeHandler_,void 0,this)),this.provider_&&this.provider_.addEventListener(me.EVENTS.ACTIVE_VENUE_CHANGE,this.activeVenueChangeHandler_,void 0,this)}},{key:"removeEventListeners_",value:function(){this.venue&&(this.venue.removeEventListener(me.EVENTS.LEVEL_CHANGE,this.levelChangeHandler_,void 0,this),this.venue.removeEventListener(me.EVENTS.DRAWING_CHANGE,this.drawingChangeHandler_,void 0,this)),this.provider_&&this.provider_.removeEventListener(me.EVENTS.ACTIVE_VENUE_CHANGE,this.activeVenueChangeHandler_,void 0,this)}},{key:"levelChangeHandler_",value:function(){this.levelSelectorUI_.switch(this.venue.getActiveLevelIndex())}},{key:"drawingChangeHandler_",value:function(){this.update_()}},{key:"activeVenueChangeHandler_",value:function(t){this.setVenue(t.newValue)}}]),e}()),Ie=function(){h(e,H.ui.Control);var t=v(e);function e(r){var i,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return s(this,e),(i=t.call(this)).provider_=null,i.drawingSelectorUI_=null,i.addClass("venues-ui"),i.setAlignment(n&&n.alignment||H.ui.LayoutAlignment.RIGHT_BOTTOM),r instanceof me&&i.setVenue(r),i}return c(e,[{key:"renderInternal",value:function(t,r){m(p(e.prototype),"renderInternal",this).call(this,t,r),this.createDrawingSelectorUI_(t),this.venue&&this.setVenue(this.venue)}},{key:"setVenue",value:function(t){t instanceof me&&(this.removeEventListeners_(),this.venue=t,this.provider_=t.getParentEventTarget(),this.drawingSelectorUI_&&this.drawingSelectorUI_.update(t.getData()),this.addEventListeners_())}},{key:"createDrawingSelectorUI_",value:function(t){var e=this;t.innerHTML="",this.drawingSelectorUI_=null,this.drawingSelectorUI_=new Wt(t,null,(function(t){return e.venue.setActiveDrawing(t)}))}},{key:"addEventListeners_",value:function(){this.venue&&this.venue.addEventListener(me.EVENTS.DRAWING_CHANGE,this.drawingChangeHandler_,void 0,this),this.provider_&&this.provider_.addEventListener(me.EVENTS.ACTIVE_VENUE_CHANGE,this.activeVenueChangeHandler_,void 0,this)}},{key:"removeEventListeners_",value:function(){this.venue&&this.venue.removeEventListener(me.EVENTS.DRAWING_CHANGE,this.drawingChangeHandler_,void 0,this),this.provider_&&this.provider_.removeEventListener(me.EVENTS.ACTIVE_VENUE_CHANGE,this.activeVenueChangeHandler_,void 0,this)}},{key:"drawingChangeHandler_",value:function(){this.drawingSelectorUI_.switch(this.venue.getActiveDrawing().id)}},{key:"activeVenueChangeHandler_",value:function(t){this.setVenue(t.newValue)}}]),e}();return Ie=Object.freeze({__proto__:null,DrawingControl:Ie,LevelControl:Re}),e(".venues-ui * {\n  font-family: \"Fira Sans\", \"Helvetica Neue\", Helvetica, sans-serif;\n  color: #0F1621;\n}\n.venues-ui .arrow {\n  display: block;\n  width: 100%;\n  height: 100%;\n  background-repeat: no-repeat;\n  background-position: center;\n}\n.venues-ui .arrow--up {\n  background-image: url(\"data:image/svg+xml,%0A%3Csvg width='13px' height='9px' viewBox='0 0 13 9' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Cg id='VenueMap_Facilities_Detail' stroke='none' stroke-width='1' fill='none' fill-rule='evenodd'%3E%3Cg id='Floorplan-Switcher' transform='translate(-426.000000, -584.000000)' fill='%23383C45'%3E%3Cg id='Map-Controls-Copy' transform='translate(417.753906, 572.000000)'%3E%3Cg id='Chevron,-Dark' transform='translate(15.000000, 16.499023) rotate(-180.000000) translate(-15.000000, -16.499023) translate(9.000000, 12.749023)'%3E%3Cpath d='M6.0105,7.5 L4.1895,5.76404817 L0.1695,1.90510321 C0.057,1.79759174 0,1.68291284 0,1.56106651 C0,1.44065367 0.057,1.32597477 0.1695,1.2184633 L1.2465,0.16771789 C1.347,0.0587729358 1.47,0.00430045872 1.617,0.00430045872 C1.764,0.00430045872 1.887,0.0587729358 1.986,0.166284404 L6.009,3.98365826 L10.023,0.161983945 C10.122,0.0530389908 10.236,0 10.3695,0 C10.503,0 10.62,0.0530389908 10.7205,0.161983945 L11.841,1.21129587 C12.0525,1.43922018 12.0525,1.67144495 11.8425,1.89793578 L7.827,5.76118119 L6.0105,7.5 Z' id='Fill-3'%3E%3C/path%3E%3C/g%3E%3C/g%3E%3C/g%3E%3C/g%3E%3C/svg%3E\");\n}\n.venues-ui .arrow--down {\n  background-image: url(\"data:image/svg+xml,%0A%3Csvg width='13px' height='9px' viewBox='0 0 13 9' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Cg id='VenueMap_Facilities_Detail' stroke='none' stroke-width='1' fill='none' fill-rule='evenodd'%3E%3Cg id='Floorplan-Switcher' transform='translate(-347.000000, -704.000000)' fill='%23383C45'%3E%3Cg id='Map-Controls' transform='translate(338.251953, 572.000000)'%3E%3Cg id='Chevron,-Dark' transform='translate(9.000000, 132.746094)'%3E%3Cpath d='M6.0105,7.5 L4.1895,5.76404817 L0.1695,1.90510321 C0.057,1.79759174 0,1.68291284 0,1.56106651 C0,1.44065367 0.057,1.32597477 0.1695,1.2184633 L1.2465,0.16771789 C1.347,0.0587729358 1.47,0.00430045872 1.617,0.00430045872 C1.764,0.00430045872 1.887,0.0587729358 1.986,0.166284404 L6.009,3.98365826 L10.023,0.161983945 C10.122,0.0530389908 10.236,0 10.3695,0 C10.503,0 10.62,0.0530389908 10.7205,0.161983945 L11.841,1.21129587 C12.0525,1.43922018 12.0525,1.67144495 11.8425,1.89793578 L7.827,5.76118119 L6.0105,7.5 Z' id='Fill-3'%3E%3C/path%3E%3C/g%3E%3C/g%3E%3C/g%3E%3C/g%3E%3C/svg%3E\");\n}\n.venues-ui .venues-ui-button {\n  display: block;\n  width: 40px;\n  height: 40px;\n  line-height: 40px;\n  font-size: 16px;\n  font-weight: 600;\n  background-color: #fff;\n  border: none;\n  border-bottom: 1px solid #9FA2A6;\n  cursor: pointer;\n  overflow: hidden;\n  color: #6e737a;\n  text-align: center;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n.venues-ui .venues-ui-button:hover, .venues-ui .venues-ui-button--active {\n  background-color: #f0f0f0;\n  color: #0F1621;\n}\n@keyframes fade {\n  0% {\n    opacity: 0;\n  }\n  100% {\n    opacity: 1;\n  }\n}\n.venues-ui__drawings .drawings {\n  position: absolute;\n  top: 0;\n  right: 45px;\n  display: none;\n  opacity: 0;\n  border-radius: 5px;\n  box-shadow: 0 0 0.4em 0 rgba(15, 22, 33, 0.6);\n}\n.venues-ui__drawings .drawings--open {\n  display: block;\n  opacity: 1;\n  animation: fade 1s;\n}\n.venues-ui__drawings .drawings .venues-ui-button {\n  width: auto;\n  padding: 0 10px;\n}\n.venues-ui__drawings .drawings .venues-ui-button:first-of-type {\n  border-top-left-radius: 5px;\n  border-top-right-radius: 5px;\n}\n.venues-ui__drawings .drawings .venues-ui-button:last-of-type {\n  border-bottom-left-radius: 5px;\n  border-bottom-right-radius: 5px;\n}\n.venues-ui__drawings .trigger {\n  border-radius: 5px;\n  box-shadow: 0 0 0.4em 0 rgba(15, 22, 33, 0.6);\n}\n.venues-ui__drawings .trigger .arrow {\n  transform: rotate(0);\n  transition: 0.4s;\n}\n.venues-ui__drawings .trigger.venues-ui-button--active .arrow {\n  transform: rotate(90deg);\n  transition: 0.4s;\n}\n.venues-ui__levels {\n  border-radius: 5px;\n  box-shadow: 0 0 0.4em 0 rgba(15, 22, 33, 0.6);\n}\n.venues-ui__levels .levels {\n  overflow: hidden;\n}\n.venues-ui__levels .venues-ui-button--up + .levels .venues-ui-button {\n  border-radius: 0;\n}\n.venues-ui__levels .venues-ui-button:first-of-type {\n  border-top-left-radius: 5px;\n  border-top-right-radius: 5px;\n}\n.venues-ui__levels .venues-ui-button:last-of-type {\n  border-bottom-left-radius: 5px;\n  border-bottom-right-radius: 5px;\n}\n.venues-ui__levels .venues-ui-button[disabled=disabled] .arrow {\n  opacity: 0.5;\n}\n.venues-ui__directory {\n  position: absolute;\n  top: 10px;\n  right: 60px;\n  bottom: calc(100% - 45px);\n  width: 350px;\n  overflow: hidden;\n  background: white;\n  border-radius: 5px;\n  box-shadow: 0 0 0.4em 0 rgba(15, 22, 33, 0.6);\n}\n.venues-ui__directory.active {\n  bottom: 10px;\n}\n.venues-ui__directory .directory__list {\n  top: 80px;\n  bottom: 20px;\n  position: absolute;\n  overflow-y: scroll;\n  right: 10px;\n  left: 10px;\n  font-size: 12px;\n}\n.venues-ui__directory .directory__list svg {\n  width: 25px;\n  height: 25px;\n}\n.venues-ui__directory .directory__heading {\n  margin: 8px;\n  font-size: 15px;\n  font-weight: normal;\n  cursor: pointer;\n}\n.venues-ui__directory .directory__input {\n  margin: 10px;\n}\n.venues-ui__directory .directory__input input {\n  width: 100%;\n  padding: 5px 0;\n}\n.venues-ui__directory .directory__trigger {\n  position: absolute;\n  right: 10px;\n  top: 15px;\n  width: 10px;\n  height: 10px;\n}\n.venues-ui__directory .directory__trigger .arrow {\n  transform: rotate(0);\n  transition: 0.4s;\n}\n.venues-ui__directory .directory__trigger--active .arrow {\n  transform: rotate(-180deg);\n  transition: 0.4s;\n}"),t.Drawing=T,t.Geometry=E,t.Level=A,t.Provider=Pt,t.Route=Oe,t.Service=Le,t.Service2=Pe,t.Venue=me,t.ui=Ie,Object.defineProperty(t,"__esModule",{value:!0}),t}({})}.call(self);var __WEBPACK_DEFAULT_EXPORT__=H}},__webpack_module_cache__={};function __webpack_require__(t){var e=__webpack_module_cache__[t];if(void 0!==e)return e.exports;var r=__webpack_module_cache__[t]={id:t,loaded:!1,exports:{}};return __webpack_modules__[t](r,r.exports,__webpack_require__),r.loaded=!0,r.exports}__webpack_require__.d=(t,e)=>{for(var r in e)__webpack_require__.o(e,r)&&!__webpack_require__.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},__webpack_require__.hmd=t=>((t=Object.create(t)).children||(t.children=[]),Object.defineProperty(t,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+t.id)}}),t),__webpack_require__.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),__webpack_require__.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var __webpack_exports__={};(()=>{var t={};function e(t,e){return function(){return t.apply(e,arguments)}}__webpack_require__.r(t),__webpack_require__.d(t,{hasBrowserEnv:()=>et,hasStandardBrowserEnv:()=>rt,hasStandardBrowserWebWorkerEnv:()=>nt});const{toString:r}=Object.prototype,{getPrototypeOf:i}=Object,n=(o=Object.create(null),t=>{const e=r.call(t);return o[e]||(o[e]=e.slice(8,-1).toLowerCase())});var o;const a=t=>(t=t.toLowerCase(),e=>n(e)===t),s=t=>e=>typeof e===t,{isArray:l}=Array,c=s("undefined"),u=a("ArrayBuffer"),h=s("string"),p=s("function"),f=s("number"),d=t=>null!==t&&"object"==typeof t,y=t=>{if("object"!==n(t))return!1;const e=i(t);return!(null!==e&&e!==Object.prototype&&null!==Object.getPrototypeOf(e)||Symbol.toStringTag in t||Symbol.iterator in t)},g=a("Date"),v=a("File"),m=a("Blob"),_=a("FileList"),b=a("URLSearchParams");function w(t,e,{allOwnKeys:r=!1}={}){if(null==t)return;let i,n;if("object"!=typeof t&&(t=[t]),l(t))for(i=0,n=t.length;i<n;i++)e.call(null,t[i],i,t);else{const n=r?Object.getOwnPropertyNames(t):Object.keys(t),o=n.length;let a;for(i=0;i<o;i++)a=n[i],e.call(null,t[a],a,t)}}function x(t,e){e=e.toLowerCase();const r=Object.keys(t);let i,n=r.length;for(;n-- >0;)if(i=r[n],e===i.toLowerCase())return i;return null}const E="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:global,T=t=>!c(t)&&t!==E,A=(S="undefined"!=typeof Uint8Array&&i(Uint8Array),t=>S&&t instanceof S);var S;const k=a("HTMLFormElement"),O=(({hasOwnProperty:t})=>(e,r)=>t.call(e,r))(Object.prototype),L=a("RegExp"),P=(t,e)=>{const r=Object.getOwnPropertyDescriptors(t),i={};w(r,((r,n)=>{let o;!1!==(o=e(r,n,t))&&(i[n]=o||r)})),Object.defineProperties(t,i)},R="abcdefghijklmnopqrstuvwxyz",I="0123456789",C={DIGIT:I,ALPHA:R,ALPHA_DIGIT:R+R.toUpperCase()+I},M=a("AsyncFunction"),N={isArray:l,isArrayBuffer:u,isBuffer:function(t){return null!==t&&!c(t)&&null!==t.constructor&&!c(t.constructor)&&p(t.constructor.isBuffer)&&t.constructor.isBuffer(t)},isFormData:t=>{let e;return t&&("function"==typeof FormData&&t instanceof FormData||p(t.append)&&("formdata"===(e=n(t))||"object"===e&&p(t.toString)&&"[object FormData]"===t.toString()))},isArrayBufferView:function(t){let e;return e="undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer&&u(t.buffer),e},isString:h,isNumber:f,isBoolean:t=>!0===t||!1===t,isObject:d,isPlainObject:y,isUndefined:c,isDate:g,isFile:v,isBlob:m,isRegExp:L,isFunction:p,isStream:t=>d(t)&&p(t.pipe),isURLSearchParams:b,isTypedArray:A,isFileList:_,forEach:w,merge:function t(){const{caseless:e}=T(this)&&this||{},r={},i=(i,n)=>{const o=e&&x(r,n)||n;y(r[o])&&y(i)?r[o]=t(r[o],i):y(i)?r[o]=t({},i):l(i)?r[o]=i.slice():r[o]=i};for(let t=0,e=arguments.length;t<e;t++)arguments[t]&&w(arguments[t],i);return r},extend:(t,r,i,{allOwnKeys:n}={})=>(w(r,((r,n)=>{i&&p(r)?t[n]=e(r,i):t[n]=r}),{allOwnKeys:n}),t),trim:t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:t=>(65279===t.charCodeAt(0)&&(t=t.slice(1)),t),inherits:(t,e,r,i)=>{t.prototype=Object.create(e.prototype,i),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),r&&Object.assign(t.prototype,r)},toFlatObject:(t,e,r,n)=>{let o,a,s;const l={};if(e=e||{},null==t)return e;do{for(o=Object.getOwnPropertyNames(t),a=o.length;a-- >0;)s=o[a],n&&!n(s,t,e)||l[s]||(e[s]=t[s],l[s]=!0);t=!1!==r&&i(t)}while(t&&(!r||r(t,e))&&t!==Object.prototype);return e},kindOf:n,kindOfTest:a,endsWith:(t,e,r)=>{t=String(t),(void 0===r||r>t.length)&&(r=t.length),r-=e.length;const i=t.indexOf(e,r);return-1!==i&&i===r},toArray:t=>{if(!t)return null;if(l(t))return t;let e=t.length;if(!f(e))return null;const r=new Array(e);for(;e-- >0;)r[e]=t[e];return r},forEachEntry:(t,e)=>{const r=(t&&t[Symbol.iterator]).call(t);let i;for(;(i=r.next())&&!i.done;){const r=i.value;e.call(t,r[0],r[1])}},matchAll:(t,e)=>{let r;const i=[];for(;null!==(r=t.exec(e));)i.push(r);return i},isHTMLForm:k,hasOwnProperty:O,hasOwnProp:O,reduceDescriptors:P,freezeMethods:t=>{P(t,((e,r)=>{if(p(t)&&-1!==["arguments","caller","callee"].indexOf(r))return!1;const i=t[r];p(i)&&(e.enumerable=!1,"writable"in e?e.writable=!1:e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")}))}))},toObjectSet:(t,e)=>{const r={},i=t=>{t.forEach((t=>{r[t]=!0}))};return l(t)?i(t):i(String(t).split(e)),r},toCamelCase:t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,(function(t,e,r){return e.toUpperCase()+r})),noop:()=>{},toFiniteNumber:(t,e)=>(t=+t,Number.isFinite(t)?t:e),findKey:x,global:E,isContextDefined:T,ALPHABET:C,generateString:(t=16,e=C.ALPHA_DIGIT)=>{let r="";const{length:i}=e;for(;t--;)r+=e[Math.random()*i|0];return r},isSpecCompliantForm:function(t){return!!(t&&p(t.append)&&"FormData"===t[Symbol.toStringTag]&&t[Symbol.iterator])},toJSONObject:t=>{const e=new Array(10),r=(t,i)=>{if(d(t)){if(e.indexOf(t)>=0)return;if(!("toJSON"in t)){e[i]=t;const n=l(t)?[]:{};return w(t,((t,e)=>{const o=r(t,i+1);!c(o)&&(n[e]=o)})),e[i]=void 0,n}}return t};return r(t,0)},isAsyncFn:M,isThenable:t=>t&&(d(t)||p(t))&&p(t.then)&&p(t.catch)};function j(t,e,r,i,n){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=t,this.name="AxiosError",e&&(this.code=e),r&&(this.config=r),i&&(this.request=i),n&&(this.response=n)}N.inherits(j,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:N.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const D=j.prototype,B={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach((t=>{B[t]={value:t}})),Object.defineProperties(j,B),Object.defineProperty(D,"isAxiosError",{value:!0}),j.from=(t,e,r,i,n,o)=>{const a=Object.create(D);return N.toFlatObject(t,a,(function(t){return t!==Error.prototype}),(t=>"isAxiosError"!==t)),j.call(a,t.message,e,r,i,n),a.cause=t,a.name=t.name,o&&Object.assign(a,o),a};const z=j;function F(t){return N.isPlainObject(t)||N.isArray(t)}function U(t){return N.endsWith(t,"[]")?t.slice(0,-2):t}function G(t,e,r){return t?t.concat(e).map((function(t,e){return t=U(t),!r&&e?"["+t+"]":t})).join(r?".":""):e}const V=N.toFlatObject(N,{},null,(function(t){return/^is[A-Z]/.test(t)})),q=function(t,e,r){if(!N.isObject(t))throw new TypeError("target must be an object");e=e||new FormData;const i=(r=N.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,(function(t,e){return!N.isUndefined(e[t])}))).metaTokens,n=r.visitor||c,o=r.dots,a=r.indexes,s=(r.Blob||"undefined"!=typeof Blob&&Blob)&&N.isSpecCompliantForm(e);if(!N.isFunction(n))throw new TypeError("visitor must be a function");function l(t){if(null===t)return"";if(N.isDate(t))return t.toISOString();if(!s&&N.isBlob(t))throw new z("Blob is not supported. Use a Buffer instead.");return N.isArrayBuffer(t)||N.isTypedArray(t)?s&&"function"==typeof Blob?new Blob([t]):Buffer.from(t):t}function c(t,r,n){let s=t;if(t&&!n&&"object"==typeof t)if(N.endsWith(r,"{}"))r=i?r:r.slice(0,-2),t=JSON.stringify(t);else if(N.isArray(t)&&function(t){return N.isArray(t)&&!t.some(F)}(t)||(N.isFileList(t)||N.endsWith(r,"[]"))&&(s=N.toArray(t)))return r=U(r),s.forEach((function(t,i){!N.isUndefined(t)&&null!==t&&e.append(!0===a?G([r],i,o):null===a?r:r+"[]",l(t))})),!1;return!!F(t)||(e.append(G(n,r,o),l(t)),!1)}const u=[],h=Object.assign(V,{defaultVisitor:c,convertValue:l,isVisitable:F});if(!N.isObject(t))throw new TypeError("data must be an object");return function t(r,i){if(!N.isUndefined(r)){if(-1!==u.indexOf(r))throw Error("Circular reference detected in "+i.join("."));u.push(r),N.forEach(r,(function(r,o){!0===(!(N.isUndefined(r)||null===r)&&n.call(e,r,N.isString(o)?o.trim():o,i,h))&&t(r,i?i.concat(o):[o])})),u.pop()}}(t),e};function $(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,(function(t){return e[t]}))}function W(t,e){this._pairs=[],t&&q(t,this,e)}const Y=W.prototype;Y.append=function(t,e){this._pairs.push([t,e])},Y.toString=function(t){const e=t?function(e){return t.call(this,e,$)}:$;return this._pairs.map((function(t){return e(t[0])+"="+e(t[1])}),"").join("&")};const X=W;function K(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Z(t,e,r){if(!e)return t;const i=r&&r.encode||K,n=r&&r.serialize;let o;if(o=n?n(e,r):N.isURLSearchParams(e)?e.toString():new X(e,r).toString(i),o){const e=t.indexOf("#");-1!==e&&(t=t.slice(0,e)),t+=(-1===t.indexOf("?")?"?":"&")+o}return t}const J=class{constructor(){this.handlers=[]}use(t,e,r){return this.handlers.push({fulfilled:t,rejected:e,synchronous:!!r&&r.synchronous,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){N.forEach(this.handlers,(function(e){null!==e&&t(e)}))}},Q={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},tt={isBrowser:!0,classes:{URLSearchParams:"undefined"!=typeof URLSearchParams?URLSearchParams:X,FormData:"undefined"!=typeof FormData?FormData:null,Blob:"undefined"!=typeof Blob?Blob:null},protocols:["http","https","file","blob","url","data"]},et="undefined"!=typeof window&&"undefined"!=typeof document,rt=(it="undefined"!=typeof navigator&&navigator.product,et&&["ReactNative","NativeScript","NS"].indexOf(it)<0);var it;const nt="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"==typeof self.importScripts,ot={...t,...tt},at=function(t){function e(t,r,i,n){let o=t[n++];if("__proto__"===o)return!0;const a=Number.isFinite(+o),s=n>=t.length;return o=!o&&N.isArray(i)?i.length:o,s?(N.hasOwnProp(i,o)?i[o]=[i[o],r]:i[o]=r,!a):(i[o]&&N.isObject(i[o])||(i[o]=[]),e(t,r,i[o],n)&&N.isArray(i[o])&&(i[o]=function(t){const e={},r=Object.keys(t);let i;const n=r.length;let o;for(i=0;i<n;i++)o=r[i],e[o]=t[o];return e}(i[o])),!a)}if(N.isFormData(t)&&N.isFunction(t.entries)){const r={};return N.forEachEntry(t,((t,i)=>{e(function(t){return N.matchAll(/\w+|\[(\w*)]/g,t).map((t=>"[]"===t[0]?"":t[1]||t[0]))}(t),i,r,0)})),r}return null},st={transitional:Q,adapter:["xhr","http"],transformRequest:[function(t,e){const r=e.getContentType()||"",i=r.indexOf("application/json")>-1,n=N.isObject(t);if(n&&N.isHTMLForm(t)&&(t=new FormData(t)),N.isFormData(t))return i?JSON.stringify(at(t)):t;if(N.isArrayBuffer(t)||N.isBuffer(t)||N.isStream(t)||N.isFile(t)||N.isBlob(t))return t;if(N.isArrayBufferView(t))return t.buffer;if(N.isURLSearchParams(t))return e.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let o;if(n){if(r.indexOf("application/x-www-form-urlencoded")>-1)return function(t,e){return q(t,new ot.classes.URLSearchParams,Object.assign({visitor:function(t,e,r,i){return ot.isNode&&N.isBuffer(t)?(this.append(e,t.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)}},e))}(t,this.formSerializer).toString();if((o=N.isFileList(t))||r.indexOf("multipart/form-data")>-1){const e=this.env&&this.env.FormData;return q(o?{"files[]":t}:t,e&&new e,this.formSerializer)}}return n||i?(e.setContentType("application/json",!1),function(t,e,r){if(N.isString(t))try{return(0,JSON.parse)(t),N.trim(t)}catch(t){if("SyntaxError"!==t.name)throw t}return(0,JSON.stringify)(t)}(t)):t}],transformResponse:[function(t){const e=this.transitional||st.transitional,r=e&&e.forcedJSONParsing,i="json"===this.responseType;if(t&&N.isString(t)&&(r&&!this.responseType||i)){const r=!(e&&e.silentJSONParsing)&&i;try{return JSON.parse(t)}catch(t){if(r){if("SyntaxError"===t.name)throw z.from(t,z.ERR_BAD_RESPONSE,this,null,this.response);throw t}}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ot.classes.FormData,Blob:ot.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};N.forEach(["delete","get","head","post","put","patch"],(t=>{st.headers[t]={}}));const lt=st,ct=N.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),ut=Symbol("internals");function ht(t){return t&&String(t).trim().toLowerCase()}function pt(t){return!1===t||null==t?t:N.isArray(t)?t.map(pt):String(t)}function ft(t,e,r,i,n){return N.isFunction(i)?i.call(this,e,r):(n&&(e=r),N.isString(e)?N.isString(i)?-1!==e.indexOf(i):N.isRegExp(i)?i.test(e):void 0:void 0)}class dt{constructor(t){t&&this.set(t)}set(t,e,r){const i=this;function n(t,e,r){const n=ht(e);if(!n)throw new Error("header name must be a non-empty string");const o=N.findKey(i,n);(!o||void 0===i[o]||!0===r||void 0===r&&!1!==i[o])&&(i[o||e]=pt(t))}const o=(t,e)=>N.forEach(t,((t,r)=>n(t,r,e)));return N.isPlainObject(t)||t instanceof this.constructor?o(t,e):N.isString(t)&&(t=t.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim())?o((t=>{const e={};let r,i,n;return t&&t.split("\n").forEach((function(t){n=t.indexOf(":"),r=t.substring(0,n).trim().toLowerCase(),i=t.substring(n+1).trim(),!r||e[r]&&ct[r]||("set-cookie"===r?e[r]?e[r].push(i):e[r]=[i]:e[r]=e[r]?e[r]+", "+i:i)})),e})(t),e):null!=t&&n(e,t,r),this}get(t,e){if(t=ht(t)){const r=N.findKey(this,t);if(r){const t=this[r];if(!e)return t;if(!0===e)return function(t){const e=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let i;for(;i=r.exec(t);)e[i[1]]=i[2];return e}(t);if(N.isFunction(e))return e.call(this,t,r);if(N.isRegExp(e))return e.exec(t);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,e){if(t=ht(t)){const r=N.findKey(this,t);return!(!r||void 0===this[r]||e&&!ft(0,this[r],r,e))}return!1}delete(t,e){const r=this;let i=!1;function n(t){if(t=ht(t)){const n=N.findKey(r,t);!n||e&&!ft(0,r[n],n,e)||(delete r[n],i=!0)}}return N.isArray(t)?t.forEach(n):n(t),i}clear(t){const e=Object.keys(this);let r=e.length,i=!1;for(;r--;){const n=e[r];t&&!ft(0,this[n],n,t,!0)||(delete this[n],i=!0)}return i}normalize(t){const e=this,r={};return N.forEach(this,((i,n)=>{const o=N.findKey(r,n);if(o)return e[o]=pt(i),void delete e[n];const a=t?function(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,((t,e,r)=>e.toUpperCase()+r))}(n):String(n).trim();a!==n&&delete e[n],e[a]=pt(i),r[a]=!0})),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const e=Object.create(null);return N.forEach(this,((r,i)=>{null!=r&&!1!==r&&(e[i]=t&&N.isArray(r)?r.join(", "):r)})),e}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map((([t,e])=>t+": "+e)).join("\n")}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...e){const r=new this(t);return e.forEach((t=>r.set(t))),r}static accessor(t){const e=(this[ut]=this[ut]={accessors:{}}).accessors,r=this.prototype;function i(t){const i=ht(t);e[i]||(function(t,e){const r=N.toCamelCase(" "+e);["get","set","has"].forEach((i=>{Object.defineProperty(t,i+r,{value:function(t,r,n){return this[i].call(this,e,t,r,n)},configurable:!0})}))}(r,t),e[i]=!0)}return N.isArray(t)?t.forEach(i):i(t),this}}dt.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),N.reduceDescriptors(dt.prototype,(({value:t},e)=>{let r=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(t){this[r]=t}}})),N.freezeMethods(dt);const yt=dt;function gt(t,e){const r=this||lt,i=e||r,n=yt.from(i.headers);let o=i.data;return N.forEach(t,(function(t){o=t.call(r,o,n.normalize(),e?e.status:void 0)})),n.normalize(),o}function vt(t){return!(!t||!t.__CANCEL__)}function mt(t,e,r){z.call(this,null==t?"canceled":t,z.ERR_CANCELED,e,r),this.name="CanceledError"}N.inherits(mt,z,{__CANCEL__:!0});const _t=mt,bt=ot.hasStandardBrowserEnv?{write(t,e,r,i,n,o){const a=[t+"="+encodeURIComponent(e)];N.isNumber(r)&&a.push("expires="+new Date(r).toGMTString()),N.isString(i)&&a.push("path="+i),N.isString(n)&&a.push("domain="+n),!0===o&&a.push("secure"),document.cookie=a.join("; ")},read(t){const e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read:()=>null,remove(){}};function wt(t,e){return t&&!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)?function(t,e){return e?t.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):t}(t,e):e}const xt=ot.hasStandardBrowserEnv?function(){const t=/(msie|trident)/i.test(navigator.userAgent),e=document.createElement("a");let r;function i(r){let i=r;return t&&(e.setAttribute("href",i),i=e.href),e.setAttribute("href",i),{href:e.href,protocol:e.protocol?e.protocol.replace(/:$/,""):"",host:e.host,search:e.search?e.search.replace(/^\?/,""):"",hash:e.hash?e.hash.replace(/^#/,""):"",hostname:e.hostname,port:e.port,pathname:"/"===e.pathname.charAt(0)?e.pathname:"/"+e.pathname}}return r=i(window.location.href),function(t){const e=N.isString(t)?i(t):t;return e.protocol===r.protocol&&e.host===r.host}}():function(){return!0};function Et(t,e){let r=0;const i=function(t,e){t=t||10;const r=new Array(t),i=new Array(t);let n,o=0,a=0;return e=void 0!==e?e:1e3,function(s){const l=Date.now(),c=i[a];n||(n=l),r[o]=s,i[o]=l;let u=a,h=0;for(;u!==o;)h+=r[u++],u%=t;if(o=(o+1)%t,o===a&&(a=(a+1)%t),l-n<e)return;const p=c&&l-c;return p?Math.round(1e3*h/p):void 0}}(50,250);return n=>{const o=n.loaded,a=n.lengthComputable?n.total:void 0,s=o-r,l=i(s);r=o;const c={loaded:o,total:a,progress:a?o/a:void 0,bytes:s,rate:l||void 0,estimated:l&&a&&o<=a?(a-o)/l:void 0,event:n};c[e?"download":"upload"]=!0,t(c)}}const Tt={http:null,xhr:"undefined"!=typeof XMLHttpRequest&&function(t){return new Promise((function(e,r){let i=t.data;const n=yt.from(t.headers).normalize();let o,a,{responseType:s,withXSRFToken:l}=t;function c(){t.cancelToken&&t.cancelToken.unsubscribe(o),t.signal&&t.signal.removeEventListener("abort",o)}if(N.isFormData(i))if(ot.hasStandardBrowserEnv||ot.hasStandardBrowserWebWorkerEnv)n.setContentType(!1);else if(!1!==(a=n.getContentType())){const[t,...e]=a?a.split(";").map((t=>t.trim())).filter(Boolean):[];n.setContentType([t||"multipart/form-data",...e].join("; "))}let u=new XMLHttpRequest;if(t.auth){const e=t.auth.username||"",r=t.auth.password?unescape(encodeURIComponent(t.auth.password)):"";n.set("Authorization","Basic "+btoa(e+":"+r))}const h=wt(t.baseURL,t.url);function p(){if(!u)return;const i=yt.from("getAllResponseHeaders"in u&&u.getAllResponseHeaders());!function(t,e,r){const i=r.config.validateStatus;r.status&&i&&!i(r.status)?e(new z("Request failed with status code "+r.status,[z.ERR_BAD_REQUEST,z.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r)):t(r)}((function(t){e(t),c()}),(function(t){r(t),c()}),{data:s&&"text"!==s&&"json"!==s?u.response:u.responseText,status:u.status,statusText:u.statusText,headers:i,config:t,request:u}),u=null}if(u.open(t.method.toUpperCase(),Z(h,t.params,t.paramsSerializer),!0),u.timeout=t.timeout,"onloadend"in u?u.onloadend=p:u.onreadystatechange=function(){u&&4===u.readyState&&(0!==u.status||u.responseURL&&0===u.responseURL.indexOf("file:"))&&setTimeout(p)},u.onabort=function(){u&&(r(new z("Request aborted",z.ECONNABORTED,t,u)),u=null)},u.onerror=function(){r(new z("Network Error",z.ERR_NETWORK,t,u)),u=null},u.ontimeout=function(){let e=t.timeout?"timeout of "+t.timeout+"ms exceeded":"timeout exceeded";const i=t.transitional||Q;t.timeoutErrorMessage&&(e=t.timeoutErrorMessage),r(new z(e,i.clarifyTimeoutError?z.ETIMEDOUT:z.ECONNABORTED,t,u)),u=null},ot.hasStandardBrowserEnv&&(l&&N.isFunction(l)&&(l=l(t)),l||!1!==l&&xt(h))){const e=t.xsrfHeaderName&&t.xsrfCookieName&&bt.read(t.xsrfCookieName);e&&n.set(t.xsrfHeaderName,e)}void 0===i&&n.setContentType(null),"setRequestHeader"in u&&N.forEach(n.toJSON(),(function(t,e){u.setRequestHeader(e,t)})),N.isUndefined(t.withCredentials)||(u.withCredentials=!!t.withCredentials),s&&"json"!==s&&(u.responseType=t.responseType),"function"==typeof t.onDownloadProgress&&u.addEventListener("progress",Et(t.onDownloadProgress,!0)),"function"==typeof t.onUploadProgress&&u.upload&&u.upload.addEventListener("progress",Et(t.onUploadProgress)),(t.cancelToken||t.signal)&&(o=e=>{u&&(r(!e||e.type?new _t(null,t,u):e),u.abort(),u=null)},t.cancelToken&&t.cancelToken.subscribe(o),t.signal&&(t.signal.aborted?o():t.signal.addEventListener("abort",o)));const f=function(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}(h);f&&-1===ot.protocols.indexOf(f)?r(new z("Unsupported protocol "+f+":",z.ERR_BAD_REQUEST,t)):u.send(i||null)}))}};N.forEach(Tt,((t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch(t){}Object.defineProperty(t,"adapterName",{value:e})}}));const At=t=>`- ${t}`,St=t=>N.isFunction(t)||null===t||!1===t,kt=t=>{t=N.isArray(t)?t:[t];const{length:e}=t;let r,i;const n={};for(let o=0;o<e;o++){let e;if(r=t[o],i=r,!St(r)&&(i=Tt[(e=String(r)).toLowerCase()],void 0===i))throw new z(`Unknown adapter '${e}'`);if(i)break;n[e||"#"+o]=i}if(!i){const t=Object.entries(n).map((([t,e])=>`adapter ${t} `+(!1===e?"is not supported by the environment":"is not available in the build")));let r=e?t.length>1?"since :\n"+t.map(At).join("\n"):" "+At(t[0]):"as no adapter specified";throw new z("There is no suitable adapter to dispatch the request "+r,"ERR_NOT_SUPPORT")}return i};function Ot(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new _t(null,t)}function Lt(t){return Ot(t),t.headers=yt.from(t.headers),t.data=gt.call(t,t.transformRequest),-1!==["post","put","patch"].indexOf(t.method)&&t.headers.setContentType("application/x-www-form-urlencoded",!1),kt(t.adapter||lt.adapter)(t).then((function(e){return Ot(t),e.data=gt.call(t,t.transformResponse,e),e.headers=yt.from(e.headers),e}),(function(e){return vt(e)||(Ot(t),e&&e.response&&(e.response.data=gt.call(t,t.transformResponse,e.response),e.response.headers=yt.from(e.response.headers))),Promise.reject(e)}))}const Pt=t=>t instanceof yt?t.toJSON():t;function Rt(t,e){e=e||{};const r={};function i(t,e,r){return N.isPlainObject(t)&&N.isPlainObject(e)?N.merge.call({caseless:r},t,e):N.isPlainObject(e)?N.merge({},e):N.isArray(e)?e.slice():e}function n(t,e,r){return N.isUndefined(e)?N.isUndefined(t)?void 0:i(void 0,t,r):i(t,e,r)}function o(t,e){if(!N.isUndefined(e))return i(void 0,e)}function a(t,e){return N.isUndefined(e)?N.isUndefined(t)?void 0:i(void 0,t):i(void 0,e)}function s(r,n,o){return o in e?i(r,n):o in t?i(void 0,r):void 0}const l={url:o,method:o,data:o,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,withXSRFToken:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:s,headers:(t,e)=>n(Pt(t),Pt(e),!0)};return N.forEach(Object.keys(Object.assign({},t,e)),(function(i){const o=l[i]||n,a=o(t[i],e[i],i);N.isUndefined(a)&&o!==s||(r[i]=a)})),r}const It={};["object","boolean","number","function","string","symbol"].forEach(((t,e)=>{It[t]=function(r){return typeof r===t||"a"+(e<1?"n ":" ")+t}}));const Ct={};It.transitional=function(t,e,r){function i(t,e){return"[Axios v1.6.7] Transitional option '"+t+"'"+e+(r?". "+r:"")}return(r,n,o)=>{if(!1===t)throw new z(i(n," has been removed"+(e?" in "+e:"")),z.ERR_DEPRECATED);return e&&!Ct[n]&&(Ct[n]=!0,console.warn(i(n," has been deprecated since v"+e+" and will be removed in the near future"))),!t||t(r,n,o)}};const Mt={assertOptions:function(t,e,r){if("object"!=typeof t)throw new z("options must be an object",z.ERR_BAD_OPTION_VALUE);const i=Object.keys(t);let n=i.length;for(;n-- >0;){const o=i[n],a=e[o];if(a){const e=t[o],r=void 0===e||a(e,o,t);if(!0!==r)throw new z("option "+o+" must be "+r,z.ERR_BAD_OPTION_VALUE)}else if(!0!==r)throw new z("Unknown option "+o,z.ERR_BAD_OPTION)}},validators:It},Nt=Mt.validators;class jt{constructor(t){this.defaults=t,this.interceptors={request:new J,response:new J}}async request(t,e){try{return await this._request(t,e)}catch(t){if(t instanceof Error){let e;Error.captureStackTrace?Error.captureStackTrace(e={}):e=new Error;const r=e.stack?e.stack.replace(/^.+\n/,""):"";t.stack?r&&!String(t.stack).endsWith(r.replace(/^.+\n.+\n/,""))&&(t.stack+="\n"+r):t.stack=r}throw t}}_request(t,e){"string"==typeof t?(e=e||{}).url=t:e=t||{},e=Rt(this.defaults,e);const{transitional:r,paramsSerializer:i,headers:n}=e;void 0!==r&&Mt.assertOptions(r,{silentJSONParsing:Nt.transitional(Nt.boolean),forcedJSONParsing:Nt.transitional(Nt.boolean),clarifyTimeoutError:Nt.transitional(Nt.boolean)},!1),null!=i&&(N.isFunction(i)?e.paramsSerializer={serialize:i}:Mt.assertOptions(i,{encode:Nt.function,serialize:Nt.function},!0)),e.method=(e.method||this.defaults.method||"get").toLowerCase();let o=n&&N.merge(n.common,n[e.method]);n&&N.forEach(["delete","get","head","post","put","patch","common"],(t=>{delete n[t]})),e.headers=yt.concat(o,n);const a=[];let s=!0;this.interceptors.request.forEach((function(t){"function"==typeof t.runWhen&&!1===t.runWhen(e)||(s=s&&t.synchronous,a.unshift(t.fulfilled,t.rejected))}));const l=[];let c;this.interceptors.response.forEach((function(t){l.push(t.fulfilled,t.rejected)}));let u,h=0;if(!s){const t=[Lt.bind(this),void 0];for(t.unshift.apply(t,a),t.push.apply(t,l),u=t.length,c=Promise.resolve(e);h<u;)c=c.then(t[h++],t[h++]);return c}u=a.length;let p=e;for(h=0;h<u;){const t=a[h++],e=a[h++];try{p=t(p)}catch(t){e.call(this,t);break}}try{c=Lt.call(this,p)}catch(t){return Promise.reject(t)}for(h=0,u=l.length;h<u;)c=c.then(l[h++],l[h++]);return c}getUri(t){return Z(wt((t=Rt(this.defaults,t)).baseURL,t.url),t.params,t.paramsSerializer)}}N.forEach(["delete","get","head","options"],(function(t){jt.prototype[t]=function(e,r){return this.request(Rt(r||{},{method:t,url:e,data:(r||{}).data}))}})),N.forEach(["post","put","patch"],(function(t){function e(e){return function(r,i,n){return this.request(Rt(n||{},{method:t,headers:e?{"Content-Type":"multipart/form-data"}:{},url:r,data:i}))}}jt.prototype[t]=e(),jt.prototype[t+"Form"]=e(!0)}));const Dt=jt;class Bt{constructor(t){if("function"!=typeof t)throw new TypeError("executor must be a function.");let e;this.promise=new Promise((function(t){e=t}));const r=this;this.promise.then((t=>{if(!r._listeners)return;let e=r._listeners.length;for(;e-- >0;)r._listeners[e](t);r._listeners=null})),this.promise.then=t=>{let e;const i=new Promise((t=>{r.subscribe(t),e=t})).then(t);return i.cancel=function(){r.unsubscribe(e)},i},t((function(t,i,n){r.reason||(r.reason=new _t(t,i,n),e(r.reason))}))}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){this.reason?t(this.reason):this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const e=this._listeners.indexOf(t);-1!==e&&this._listeners.splice(e,1)}static source(){let t;return{token:new Bt((function(e){t=e})),cancel:t}}}const zt=Bt,Ft={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Ft).forEach((([t,e])=>{Ft[e]=t}));const Ut=Ft,Gt=function t(r){const i=new Dt(r),n=e(Dt.prototype.request,i);return N.extend(n,Dt.prototype,i,{allOwnKeys:!0}),N.extend(n,i,null,{allOwnKeys:!0}),n.create=function(e){return t(Rt(r,e))},n}(lt);Gt.Axios=Dt,Gt.CanceledError=_t,Gt.CancelToken=zt,Gt.isCancel=vt,Gt.VERSION="1.6.7",Gt.toFormData=q,Gt.AxiosError=z,Gt.Cancel=Gt.CanceledError,Gt.all=function(t){return Promise.all(t)},Gt.spread=function(t){return function(e){return t.apply(null,e)}},Gt.isAxiosError=function(t){return N.isObject(t)&&!0===t.isAxiosError},Gt.mergeConfig=Rt,Gt.AxiosHeaders=yt,Gt.formToJSON=t=>at(N.isHTMLForm(t)?new FormData(t):t),Gt.getAdapter=kt,Gt.HttpStatusCode=Ut,Gt.default=Gt;var Ht=Gt.create({baseURL:"http://localhost:3000"});Ht.interceptors.response.use((function(t){return t})),__webpack_require__(192);var Vt=new H.service.Platform({apikey:"OFV9bslywT8eoJN8RHd9n5sicXiLzMC-70-MY8BMXsM"}),qt=Vt.createDefaultLayers(),$t=new H.Map(document.getElementById("mapa0"),qt.vector.normal.map,{center:{lat:-26.821,lng:-49.2692},zoom:14,pixelRatio:window.devicePixelRatio||1});window.addEventListener("resize",(function(){return $t.getViewPort().resize()})),new H.mapevents.Behavior(new H.mapevents.MapEvents($t));var Wt=H.ui.UI.createDefault($t,qt);!function(t){var e,r,i,n;e=this,r=void 0,n=function(){function t(t){t.target.style.opacity=.6}function e(t){t.target.style.opacity=1}var r,i,n,o,a;return function(t,e){var r,i,n,o,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(l){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(a=0)),a;)try{if(r=1,i&&(n=2&s[0]?i.return:s[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,s[1])).done)return n;switch(i=0,n&&(s=[2&s[0],n.value]),s[0]){case 0:case 1:n=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,i=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!((n=(n=a.trys).length>0&&n[n.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!n||s[1]>n[0]&&s[1]<n[3])){a.label=s[1];break}if(6===s[0]&&a.label<n[1]){a.label=n[1],n=s;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(s);break}n[2]&&a.ops.pop(),a.trys.pop();continue}s=e.call(t,a)}catch(t){s=[6,t],i=0}finally{r=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}}(this,(function(s){switch(s.label){case 0:return(r=document.createElement("div")).style.userSelect="none",r.style.webkitUserSelect="none",r.style.cursor="default",(i=document.createElementNS("http://www.w3.org/2000/svg","svg")).setAttribute("xmlns","http://www.w3.org/2000/svg"),i.setAttribute("width","40"),i.setAttribute("height","40"),i.setAttribute("fill","rgba(75, 125, 176, 0.9)"),i.setAttribute("class","bi bi-droplet-fill"),i.setAttribute("viewBox","0 0 16 16"),(n=document.createElementNS("http://www.w3.org/2000/svg","path")).setAttribute("d","M8 16a6 6 0 0 0 6-6c0-1.655-1.122-2.904-2.432-4.362C10.254 4.176 8.75 2.503 8 0c0 0-6 5.686-6 10a6 6 0 0 0 6 6M6.646 4.646l.708.708c-.29.29-1.128 1.311-1.907 2.87l-.894-.448c.82-1.641 1.717-2.753 2.093-3.13"),n.style.stroke="rgba(43, 50, 76, 0.9)",n.style.strokeWidth="1",i.appendChild(n),r.appendChild(i),r.style.width="32px",r.style.height="32px",r.style.marginTop="-16px",r.style.marginLeft="-16px",o=new H.map.DomIcon(r,{onAttach:function(r,i,n){r.addEventListener("mouseover",t),r.addEventListener("mouseout",e)},onDetach:function(r,i,n){r.removeEventListener("mouseover",t),r.removeEventListener("mouseout",e)}}),a=new H.map.Group,$t.addObject(a),a.addEventListener("tap",(function(t){var e=new H.ui.InfoBubble(t.target.getGeometry(),{content:t.target.getData().html});Wt.addBubble(e),document.getElementById("adicionarMapa").addEventListener("click",(function(){return function(t,e,r){var i=Vt.createDefaultLayers({lg:"POR",static:!0}),n=new H.Map(document.getElementById("mapa1"),i.vector.normal.map,{zoom:16,center:e}),o=new H.map.Marker(e);n.addObject(o),window.addEventListener("resize",(function(){return n.getViewPort().resize()}))}(0,{lat:t.target.getData().latitude,lng:t.target.getData().longitude})}))}),!1),[4,Ht.get("/benchmarks")];case 1:return s.sent().data.forEach((function(t){var e=t.street,r=t.floodLevel,i=t.lat,n=t.long,s=new H.map.DomMarker({lat:i,lng:n},{icon:o});s.setData({html:'<div style="width: 250px">\n      <button id="adicionarMapa">\n      <img src="/Alerta_Cheias/frontend/assets/icones_main2/icon_add.png"> \n     </button>\n     <h2>Rua: '.concat(e,"</h2>\n     </br>\n     <h3>Cota de enchente: ").concat(r,"m</h3>\n     <p>Latitude: ").concat(i,"</p>\n     <p>Longitude: ").concat(n,"</p>\n     <div>\n\n    </div>\n    </div>"),latitude:i,longitude:n,benchmarkId:t.id}),a.addObject(s)})),[2]}}))},new((i=void 0)||(i=Promise))((function(t,o){function a(t){try{l(n.next(t))}catch(t){o(t)}}function s(t){try{l(n.throw(t))}catch(t){o(t)}}function l(e){var r;e.done?t(e.value):(r=e.value,r instanceof i?r:new i((function(t){t(r)}))).then(a,s)}l((n=n.apply(e,r||[])).next())}))}()})()})();